function Uo(t){return t&&t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}function zo(t){return t}function qo(t,e){e=e||{};const n=e.delimiter||".",o=e.maxDepth,r=e.transformKey||zo,i={};function a(f,s,c){c=c||1,Object.keys(f).forEach(function(u){const l=f[u],p=e.safe&&Array.isArray(l),d=Object.prototype.toString.call(l),g=Uo(l),m=d==="[object Object]"||d==="[object Array]",v=s?s+n+r(u):r(u);if(!p&&!g&&m&&Object.keys(l).length&&(!e.maxDepth||c<o))return a(l,v,c+1);i[v]=l})}return a(t),i}function Wo(){canvas.tokens?.controlledObjects.forEach(t=>t.release())}function Go(t){t.combatant?.isOwner&&t.combatant?.token?.object?.control({releaseOthers:!0})}function Jo(){return game.combat?.combatant?.players}const Ct="obs-utils",rn={trackall:"Track all Owned Tokens",trackone:"Track the currently active Owned Token",clonePlayer:"Clone the Selected Player's Viewport",cloneDM:"Clone the DM's Viewport",birdseye:"Fit Map to Screen",cloneTurnPlayer:"Clone the Turn Player's Viewport"},sn={trackall:"Track all Owned Tokens",trackmanual:"Track a manual List of Tokens",clonePlayer:"Clone a Player's Viewport",cloneDM:"Clone the DM's Viewport",birdseye:"Fit Map to Screen"},an={trackall:"fa-solid fa-users",trackone:"fa-solid fa-user",trackmanual:"fa-regular fa-users",clonePlayer:"fa-regular fa-users-viewfinder",cloneTurnPlayer:"fa-solid fa-arrows-repeat",cloneDM:"fa-solid fa-dice-d20",birdseye:"fa-solid fa-bird"},Lt={sidebar:void 0},kt=new Map;function tt(t,e){try{e.hide()}catch{e.style.display="none"}}function cn(t){t?.border?.alpha&&(t.border.alpha=0)}function ln(){return game.canvas?.tokens?.ownedTokens}function Yo(){return game.canvas?.scene?.tokens?.filter(t=>!!t.getFlag("obs-utils","tracked")).map(t=>t.object)}function Xo(t){const e=!t.getFlag("obs-utils","tracked");t.setFlag("obs-utils","tracked",e)}function Ko(){return game.userId}function un(){_e(ln())}function _e(t){const e=[];t?.forEach(f=>{const s={x:f?.document.x,y:f?.document.y,width:f?.w,height:f?.h};e.push(s)});const n=Zo(e);if(!n)return;const o=canvas.screenDimensions,r=o[0]/(n.maxX-n.minX+300),i=o[1]/(n.maxY-n.minY+300);let a=Math.min(r,i);a=Math.min(a,A("maxScale")),a=Math.max(a,A("minScale")),mt({x:n.center.x,y:n.center.y,scale:a})}function re(){if(game.combat?.started)switch(A("defaultInCombat")){case"trackall":un();break;case"trackone":_e([ln()?.find(t=>t.id===game.combat?.combatant?.tokenId)]);break}else switch(A("defaultOutOfCombat")){case"trackall":un();break;case"trackmanual":_e(Yo());break}}function Zo(t){let e,n,o,r;if(n=r=Number.MIN_VALUE,e=o=Number.MAX_VALUE,t.forEach(i=>{e=Math.min(e,i.x),o=Math.min(o,i.y),n=Math.max(n,i.x+i.width),r=Math.max(r,i.y+i.height)}),!(e===o&&e===Number.MAX_VALUE||n===r&&n===Number.MIN_VALUE))return{minX:e,minY:o,maxX:n,maxY:r,center:{x:e+(n-e)/2,y:o+(r-o)/2}}}function Ie(t){if(game.combat?.started)switch(A("defaultInCombat")){case"cloneDM":game.users?.get(t)?.isGM&&mt(kt.get(t));break;case"cloneTurnPlayer":Jo()?.some(e=>e.id===t)&&mt(kt.get(t));break;case"clonePlayer":t===A("trackedUser")&&mt(kt.get(t));break}else switch(A("defaultOutOfCombat")){case"cloneDM":game.users?.get(t)?.isGM&&mt(kt.get(t));break;case"clonePlayer":t===A("trackedUser")&&mt(kt.get(t));break}}function Qo(){return game.user?.isGM}function tr(t,e,n){if(game.user?.isGM){const o=e.find("div.col.right"),r=!!n.flags["obs-utils"]?.tracked,i=$(`<div class="control-icon ${r?"active":""}"><i title="Track Token" class="fa-solid fa-signal-stream" /></div>`);i.on("click",function(){Xo(t.object.document),$(this).toggleClass("active")}),o.append(i)}}function fn(){if(!(game.combat?.started&&A("defaultInCombat")==="birdseye"||!game.combat?.started&&A("defaultOutOfCombat")==="birdseye"))return;const t=canvas.screenDimensions,e=canvas.scene?.dimensions,n={x:e.width/2,y:e.height/2},o=Math.min(t[0]/e.width,t[1]/e.height);mt({...n,scale:o})}async function dn(t){const e=A("popupCloseDelay");e>0&&(await rs(e*1e3),t.close())}async function pn(t){if(A("fixedPopups")){const e={};e.left=A("fixedPopupX"),e.top=A("fixedPopupY"),e.width=A("fixedPopupWidth"),e.height=A("fixedPopupHeight"),t.setPosition(e)}}async function er(t){Lt.sidebar=t}async function nr(){A("showTrackerInCombat")&&(Lt.sidebar?.element.show(),Lt.sidebar?.tabs.combat?.element.show(),Lt.sidebar?.activateTab("combat"))}async function or(){Lt.sidebar?.element.hide()}async function mn(){fn(),re()}function rr(t){const e=canvas.screenDimensions,n=canvas.scene?.dimensions;let{x:o,y:r,scale:i}=t;const a=Math.max(e[0]/n.width,e[1]/n.height);i=Math.max(a,i);const f=(n.width*i-e[0])/i/2,s=(n.height*i-e[1])/i/2,c=n.width/2,u=n.height/2;return o=Math.min(c+f,Math.max(c-f,o)),r=Math.min(u+s,Math.max(u-s,r)),{x:o,y:r,scale:i}}function mt(t){A("clampCanvas")&&(t=rr(t)),canvas.animatePan(t)}function S(){}const Vt=t=>t;function se(t,e){for(const n in e)t[n]=e[n];return t}function hn(t){return t()}function gn(){return Object.create(null)}function et(t){t.forEach(hn)}function lt(t){return typeof t=="function"}function j(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let ae;function H(t,e){return t===e?!0:(ae||(ae=document.createElement("a")),ae.href=e,t===ae.href)}function sr(t){return Object.keys(t).length===0}function Oe(t,...e){if(t==null){for(const o of e)o(void 0);return S}const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ar(t){let e;return Oe(t,n=>e=n)(),e}function L(t,e,n){t.$$.on_destroy.push(Oe(e,n))}function ir(t,e,n,o){if(t){const r=yn(t,e,n,o);return t[0](r)}}function yn(t,e,n,o){return t[1]&&o?se(n.ctx.slice(),t[1](o(e))):n.ctx}function cr(t,e,n,o){if(t[2]&&o){const r=t[2](o(n));if(e.dirty===void 0)return r;if(typeof r=="object"){const i=[],a=Math.max(e.dirty.length,r.length);for(let f=0;f<a;f+=1)i[f]=e.dirty[f]|r[f];return i}return e.dirty|r}return e.dirty}function lr(t,e,n,o,r,i){if(r){const a=yn(e,n,o,i);t.p(a,r)}}function ur(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let o=0;o<n;o++)e[o]=-1;return e}return-1}function vn(t){const e={};for(const n in t)n[0]!=="$"&&(e[n]=t[n]);return e}function fr(t){const e={};for(const n in t)e[n]=!0;return e}function dr(t){return t??""}function pr(t,e,n){return t.set(n),e}function mr(t){return t&&lt(t.destroy)?t.destroy:S}const bn=typeof window<"u";let Ee=bn?()=>window.performance.now():()=>Date.now(),Ae=bn?t=>requestAnimationFrame(t):S;const $t=new Set;function wn(t){$t.forEach(e=>{e.c(t)||($t.delete(e),e.f())}),$t.size!==0&&Ae(wn)}function Fe(t){let e;return $t.size===0&&Ae(wn),{promise:new Promise(n=>{$t.add(e={c:t,f:n})}),abort(){$t.delete(e)}}}function G(t,e){t.appendChild(e)}function Cn(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function hr(t){const e=F("style");return e.textContent="/* empty */",gr(Cn(t),e),e.sheet}function gr(t,e){return G(t.head||t,e),e.sheet}function x(t,e,n){t.insertBefore(e,n||null)}function k(t){t.parentNode&&t.parentNode.removeChild(t)}function ut(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function F(t){return document.createElement(t)}function kn(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function W(t){return document.createTextNode(t)}function B(){return W(" ")}function ft(){return W("")}function xt(t,e,n,o){return t.addEventListener(e,n,o),()=>t.removeEventListener(e,n,o)}function yr(t){return function(e){return e.preventDefault(),t.call(this,e)}}function vr(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function y(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}const br=["width","height"];function wr(t,e){const n=Object.getOwnPropertyDescriptors(t.__proto__);for(const o in e)e[o]==null?t.removeAttribute(o):o==="style"?t.style.cssText=e[o]:o==="__value"?t.value=t[o]=e[o]:n[o]&&n[o].set&&br.indexOf(o)===-1?t[o]=e[o]:y(t,o,e[o])}function Cr(t,e,n){const o=e.toLowerCase();o in t?t[o]=typeof t[o]=="boolean"&&n===""?!0:n:e in t?t[e]=typeof t[e]=="boolean"&&n===""?!0:n:y(t,e,n)}function kr(t){let e;return{p(...n){e=n,e.forEach(o=>t.push(o))},r(){e.forEach(n=>t.splice(t.indexOf(n),1))}}}function $r(t){return t===""?null:+t}function xr(t){return Array.from(t.childNodes)}function Me(t,e){e=""+e,t.data!==e&&(t.data=e)}function Sr(t,e){t.value=e??""}function _r(t,e,n,o){n==null?t.style.removeProperty(e):t.style.setProperty(e,n,"")}function Ir(t,e,n){for(let o=0;o<t.options.length;o+=1){const r=t.options[o];if(r.__value===e){r.selected=!0;return}}(!n||e!==void 0)&&(t.selectedIndex=-1)}function Or(t){const e=t.querySelector(":checked");return e&&e.__value}let ie;function Er(){if(ie===void 0){ie=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{ie=!0}}return ie}function Ar(t,e){getComputedStyle(t).position==="static"&&(t.style.position="relative");const n=F("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const o=Er();let r;return o?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",r=xt(window,"message",i=>{i.source===n.contentWindow&&e()})):(n.src="about:blank",n.onload=()=>{r=xt(n.contentWindow,"resize",e),e()}),G(t,n),()=>{(o||r&&n.contentWindow)&&r(),k(n)}}function Fr(t,e,n){t.classList.toggle(e,!!n)}function $n(t,e,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(t,{detail:e,bubbles:n,cancelable:o})}class Mr{is_svg=!1;e=void 0;n=void 0;t=void 0;a=void 0;constructor(e=!1){this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,n,o=null){this.e||(this.is_svg?this.e=kn(n.nodeName):this.e=F(n.nodeType===11?"TEMPLATE":n.nodeName),this.t=n.tagName!=="TEMPLATE"?n:n.content,this.c(e)),this.i(o)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let n=0;n<this.n.length;n+=1)x(this.t,this.n[n],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(k)}}function Ut(t,e){return new t(e)}const ce=new Map;let le=0;function Nr(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Pr(t,e){const n={stylesheet:hr(e),rules:{}};return ce.set(t,n),n}function ue(t,e,n,o,r,i,a,f=0){const s=16.666/o;let c=`{
`;for(let v=0;v<=1;v+=s){const w=e+(n-e)*i(v);c+=v*100+`%{${a(w,1-w)}}
`}const u=c+`100% {${a(n,1-n)}}
}`,l=`__svelte_${Nr(u)}_${f}`,p=Cn(t),{stylesheet:d,rules:g}=ce.get(p)||Pr(p,t);g[l]||(g[l]=!0,d.insertRule(`@keyframes ${l} ${u}`,d.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?`${m}, `:""}${l} ${o}ms linear ${r}ms 1 both`,le+=1,l}function fe(t,e){const n=(t.style.animation||"").split(", "),o=n.filter(e?i=>i.indexOf(e)<0:i=>i.indexOf("__svelte")===-1),r=n.length-o.length;r&&(t.style.animation=o.join(", "),le-=r,le||Rr())}function Rr(){Ae(()=>{le||(ce.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&k(e)}),ce.clear())})}let zt;function qt(t){zt=t}function St(){if(!zt)throw new Error("Function called outside component initialization");return zt}function Dr(t){St().$$.before_update.push(t)}function xn(t){St().$$.on_mount.push(t)}function nt(t){St().$$.on_destroy.push(t)}function jr(){const t=St();return(e,n,{cancelable:o=!1}={})=>{const r=t.$$.callbacks[e];if(r){const i=$n(e,n,{cancelable:o});return r.slice().forEach(a=>{a.call(t,i)}),!i.defaultPrevented}return!0}}function Hr(t,e){return St().$$.context.set(t,e),e}function Tr(t){return St().$$.context.get(t)}function Br(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(o=>o.call(this,e))}const _t=[],dt=[];let It=[];const Ne=[],Sn=Promise.resolve();let Pe=!1;function _n(){Pe||(Pe=!0,Sn.then(De))}function Lr(){return _n(),Sn}function K(t){It.push(t)}function Wt(t){Ne.push(t)}const Re=new Set;let Ot=0;function De(){if(Ot!==0)return;const t=zt;do{try{for(;Ot<_t.length;){const e=_t[Ot];Ot++,qt(e),Vr(e.$$)}}catch(e){throw _t.length=0,Ot=0,e}for(qt(null),_t.length=0,Ot=0;dt.length;)dt.pop()();for(let e=0;e<It.length;e+=1){const n=It[e];Re.has(n)||(Re.add(n),n())}It.length=0}while(_t.length);for(;Ne.length;)Ne.pop()();Pe=!1,Re.clear(),qt(t)}function Vr(t){if(t.fragment!==null){t.update(),et(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(K)}}function Ur(t){const e=[],n=[];It.forEach(o=>t.indexOf(o)===-1?e.push(o):n.push(o)),n.forEach(o=>o()),It=e}let Gt;function je(){return Gt||(Gt=Promise.resolve(),Gt.then(()=>{Gt=null})),Gt}function ht(t,e,n){t.dispatchEvent($n(`${e?"intro":"outro"}${n}`))}const de=new Set;let ot;function J(){ot={r:0,c:[],p:ot}}function Y(){ot.r||et(ot.c),ot=ot.p}function M(t,e){t&&t.i&&(de.delete(t),t.i(e))}function D(t,e,n,o){if(t&&t.o){if(de.has(t))return;de.add(t),ot.c.push(()=>{de.delete(t),o&&(n&&t.d(1),o())}),t.o(e)}else o&&o()}const He={duration:0};function Et(t,e,n){const o={direction:"in"};let r=e(t,n,o),i=!1,a,f,s=0;function c(){a&&fe(t,a)}function u(){const{delay:p=0,duration:d=300,easing:g=Vt,tick:m=S,css:v}=r||He;v&&(a=ue(t,0,1,d,p,g,v,s++)),m(0,1);const w=Ee()+p,h=w+d;f&&f.abort(),i=!0,K(()=>ht(t,!0,"start")),f=Fe(b=>{if(i){if(b>=h)return m(1,0),ht(t,!0,"end"),c(),i=!1;if(b>=w){const C=g((b-w)/d);m(C,1-C)}}return i})}let l=!1;return{start(){l||(l=!0,fe(t),lt(r)?(r=r(o),je().then(u)):u())},invalidate(){l=!1},end(){i&&(c(),i=!1)}}}function At(t,e,n){const o={direction:"out"};let r=e(t,n,o),i=!0,a;const f=ot;f.r+=1;let s;function c(){const{delay:u=0,duration:l=300,easing:p=Vt,tick:d=S,css:g}=r||He;g&&(a=ue(t,1,0,l,u,p,g));const m=Ee()+u,v=m+l;K(()=>ht(t,!1,"start")),"inert"in t&&(s=t.inert,t.inert=!0),Fe(w=>{if(i){if(w>=v)return d(0,1),ht(t,!1,"end"),--f.r||et(f.c),!1;if(w>=m){const h=p((w-m)/l);d(1-h,h)}}return i})}return lt(r)?je().then(()=>{r=r(o),c()}):c(),{end(u){u&&"inert"in t&&(t.inert=s),u&&r.tick&&r.tick(1,0),i&&(a&&fe(t,a),i=!1)}}}function zr(t,e,n,o){let r=e(t,n,{direction:"both"}),i=o?0:1,a=null,f=null,s=null,c;function u(){s&&fe(t,s)}function l(d,g){const m=d.b-i;return g*=Math.abs(m),{a:i,b:d.b,d:m,duration:g,start:d.start,end:d.start+g,group:d.group}}function p(d){const{delay:g=0,duration:m=300,easing:v=Vt,tick:w=S,css:h}=r||He,b={start:Ee()+g,b:d};d||(b.group=ot,ot.r+=1),"inert"in t&&(d?c!==void 0&&(t.inert=c):(c=t.inert,t.inert=!0)),a||f?f=b:(h&&(u(),s=ue(t,i,d,m,g,v,h)),d&&w(0,1),a=l(b,m),K(()=>ht(t,d,"start")),Fe(C=>{if(f&&C>f.start&&(a=l(f,m),f=null,ht(t,a.b,"start"),h&&(u(),s=ue(t,i,a.b,a.duration,0,v,r.css))),a){if(C>=a.end)w(i=a.b,1-i),ht(t,a.b,"end"),f||(a.b?u():--a.group.r||et(a.group.c)),a=null;else if(C>=a.start){const I=C-a.start;i=a.a+a.d*v(I/a.duration),w(i,1-i)}}return!!(a||f)}))}return{run(d){lt(r)?je().then(()=>{r=r({direction:d?"in":"out"}),p(d)}):p(d)},end(){u(),a=f=null}}}function T(t){return t?.length!==void 0?t:Array.from(t)}function qr(t,e){t.d(1),e.delete(t.key)}function Te(t,e){D(t,1,1,()=>{e.delete(t.key)})}function Be(t,e,n,o,r,i,a,f,s,c,u,l){let p=t.length,d=i.length,g=p;const m={};for(;g--;)m[t[g].key]=g;const v=[],w=new Map,h=new Map,b=[];for(g=d;g--;){const _=l(r,i,g),N=n(_);let R=a.get(N);R?b.push(()=>R.p(_,e)):(R=c(N,_),R.c()),w.set(N,v[g]=R),N in m&&h.set(N,Math.abs(g-m[N]))}const C=new Set,I=new Set;function P(_){M(_,1),_.m(f,u),a.set(_.key,_),u=_.first,d--}for(;p&&d;){const _=v[d-1],N=t[p-1],R=_.key,q=N.key;_===N?(u=_.first,p--,d--):w.has(q)?!a.has(R)||C.has(R)?P(_):I.has(q)?p--:h.get(R)>h.get(q)?(I.add(R),P(_)):(C.add(q),p--):(s(N,a),p--)}for(;p--;){const _=t[p];w.has(_.key)||s(_,a)}for(;d;)P(v[d-1]);return et(b),v}function Jt(t,e,n){const o=t.$$.props[e];o!==void 0&&(t.$$.bound[o]=n,n(t.$$.ctx[o]))}function ct(t){t&&t.c()}function rt(t,e,n){const{fragment:o,after_update:r}=t.$$;o&&o.m(e,n),K(()=>{const i=t.$$.on_mount.map(hn).filter(lt);t.$$.on_destroy?t.$$.on_destroy.push(...i):et(i),t.$$.on_mount=[]}),r.forEach(K)}function st(t,e){const n=t.$$;n.fragment!==null&&(Ur(n.after_update),et(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Wr(t,e){t.$$.dirty[0]===-1&&(_t.push(t),_n(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function V(t,e,n,o,r,i,a=null,f=[-1]){const s=zt;qt(t);const c=t.$$={fragment:null,ctx:[],props:i,update:S,not_equal:r,bound:gn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:gn(),dirty:f,skip_bound:!1,root:e.target||s.$$.root};a&&a(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(l,p,...d)=>{const g=d.length?d[0]:p;return c.ctx&&r(c.ctx[l],c.ctx[l]=g)&&(!c.skip_bound&&c.bound[l]&&c.bound[l](g),u&&Wr(t,l)),p}):[],c.update(),u=!0,et(c.before_update),c.fragment=o?o(c.ctx):!1,e.target){if(e.hydrate){const l=xr(e.target);c.fragment&&c.fragment.l(l),l.forEach(k)}else c.fragment&&c.fragment.c();e.intro&&M(t.$$.fragment),rt(t,e.target,e.anchor),De()}qt(s)}class U{$$=void 0;$$set=void 0;$destroy(){st(this,1),this.$destroy=S}$on(e,n){if(!lt(n))return S;const o=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(e){this.$$set&&!sr(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Gr="4",Ft=[];function Jr(t,e){return{subscribe:Le(t,e).subscribe}}function Le(t,e=S){let n;const o=new Set;function r(f){if(j(t,f)&&(t=f,n)){const s=!Ft.length;for(const c of o)c[1](),Ft.push(c,t);if(s){for(let c=0;c<Ft.length;c+=2)Ft[c][0](Ft[c+1]);Ft.length=0}}}function i(f){r(f(t))}function a(f,s=S){const c=[f,s];return o.add(c),o.size===1&&(n=e(r,i)||S),f(t),()=>{o.delete(c),o.size===0&&n&&(n(),n=null)}}return{set:r,update:i,subscribe:a}}function Yr(t,e,n){const o=!Array.isArray(t),r=o?[t]:t;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const i=e.length<2;return Jr(n,(a,f)=>{let s=!1;const c=[];let u=0,l=S;const p=()=>{if(u)return;l();const g=e(o?c[0]:c,a,f);i?a(g):l=lt(g)?g:S},d=r.map((g,m)=>Oe(g,v=>{c[m]=v,u&=~(1<<m),s&&p()},()=>{u|=1<<m}));return s=!0,p(),function(){et(d),l(),s=!1}})}const gt={SwitchScene:"Switch Scene",ToggleSource:"Toggle Source",EnableSource:"Enable Source",DisableSource:"Disable Source"};class Xr{targetAction=gt.SwitchScene;sceneName="";targetName=""}class Kr{url="localhost";port="4455";password=""}class Zr{sceneName="";obsActions=[]}class Ve{onLoad=[];onCombatStart=[];onCombatEnd=[];onPause=[];onUnpause=[];onSceneLoad=[];onStopStreaming=[]}const In=2;function Qr(){return game.users?.find(t=>t.isGM)}async function Ue(){if(!Nt())return;fn(),re(),Ie(A("trackedUser"));const t=Qr()?.id;t&&Ie(t)}function ts(){const t=A("settingsVersion");if(t<In){if(console.warn("Running OBS Utils Migrations"),t<1){console.warn("Migrations for Data-Model Version 1");let e=A("obsRemote");e=foundry.utils.mergeObject(new Ve,e),delete e.onCloseObs,Mt("obsRemote",e)}if(t<2){console.warn("Migrations for Data-Model Version 2");let e=A("obsRemote");e=foundry.utils.mergeObject(new Ve,e),Mt("obsRemote",e)}console.warn("OBS Utils Migrations Finished"),Mt("settingsVersion",In)}}function A(t){return game.settings.get("obs-utils",t)}async function Mt(t,e){await game.settings.set("obs-utils",t,e)}function es(){const t={ic:[],ooc:[],players:[],onlineUsers:[]};for(const[e,n]of Object.entries(rn))t.ic.push({icon:an[e],tooltip:n,id:e});for(const[e,n]of Object.entries(sn))t.ooc.push({icon:an[e],tooltip:n,id:e});return t.players=game.users?.filter(e=>!e.isGM),t.onlineUsers=game.users?.filter(e=>e.active),t}var On=new Map;function ns(){E("minScale",{default:.1,type:Number,range:{min:.01,max:5,step:.01},scope:"world",config:!0}),E("maxScale",{default:2,type:Number,range:{min:.01,max:5,step:.01},scope:"world",config:!0}),E("clampCanvas",{default:!1,type:Boolean,scope:"world",config:!1}),E("defaultOutOfCombat",{default:"trackall",type:String,choices:sn,scope:"world",config:!1,onChange:Ue}),E("defaultInCombat",{default:"trackall",type:String,choices:rn,scope:"world",config:!1,onChange:Ue}),E("popupCloseDelay",{default:10,type:Number,range:{min:0,max:300,step:1},scope:"world",config:!0}),E("showTrackerInCombat",{default:!1,type:Boolean,scope:"world",config:!0}),E("trackedUser",{default:game.userId,type:String,scope:"world",config:!1,onChange:Ue}),E("obsRemote",{type:Object,scope:"world",config:!1,default:new Ve}),E("enableOBSWebsocket",{type:Boolean,scope:"world",config:!0,default:!1}),E("websocketSettings",{type:Object,scope:"client",config:!1,default:new Kr,onChange:()=>foundry.utils.debouncedReload()}),E("streamOverlays",{type:Object,scope:"world",config:!1,default:[]}),E("overlayActors",{type:Object,scope:"world",config:!1,default:[]}),E("settingsVersion",{type:Number,scope:"world",config:!1,default:2}),E("showAV",{type:Boolean,scope:"world",config:!0,default:!1}),E("showUserConfig",{type:Boolean,scope:"world",config:!0,default:!1}),E("lastReadNotification",{type:Number,scope:"client",config:!1,default:0}),E("fixedPopups",{type:Boolean,scope:"world",config:!0,default:!1}),E("fixedPopupX",{type:Number,scope:"world",config:!0,default:1e3}),E("fixedPopupY",{type:Number,scope:"world",config:!0,default:1e3}),E("fixedPopupWidth",{type:Number,scope:"world",config:!0,default:1e3}),E("fixedPopupHeight",{type:Number,scope:"world",config:!0,default:800}),E("obsMode",{default:!1,type:Boolean,scope:"client",config:!0,requiresReload:!0}),E("obsModeUser",{default:"none",type:String,scope:"world",choices:{},config:!0,requiresReload:!0}),E("obsModeGlobalDisable",{default:!1,type:Boolean,scope:"world",config:!0,requiresReload:!0})}function os(){E("rollOverlayPreRollDelay",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayRollFadeIn",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayRollFadeOut",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayRollStay",{type:Number,scope:"world",config:!1,default:5e3}),E("rollOverlayPreRollFadeIn",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayPreRollFadeOut",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayPreRollStay",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayPostRollFadeIn",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayPostRollFadeOut",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayPostRollStay",{type:Number,scope:"world",config:!1,default:0}),E("rollOverlayPreRollImage",{type:String,scope:"world",config:!1,default:""}),E("rollOverlayRollBackground",{type:String,scope:"world",config:!1,default:""}),E("rollOverlayRollForeground",{type:String,scope:"world",config:!1,default:""}),E("rollOverlayPostRollImage",{type:String,scope:"world",config:!1,default:""}),E("rollOverlayPostRollEnabled",{type:Boolean,scope:"world",config:!1,default:!1}),E("rollOverlayPreRollEnabled",{type:Boolean,scope:"world",config:!1,default:!1})}function E(t,e){let n,o=!1;function r(a){o||(e.onChange&&e.onChange(a),o=!0,n?.set(a)),o=!1}game?.settings.register(Ct,t,{name:`${Ct}.settings.${t}.Name`,hint:`${Ct}.settings.${t}.Hint`,...e,onChange:r});const i=game?.settings.get(Ct,t)??e.default??new e.type;n=Le(i),n.subscribe(a=>{o||(o=!0,game?.ready&&game?.settings.set(Ct,t,a)),o=!1}),On.set(t,n)}function z(t){return On.get(t)}function rs(t){return new Promise(e=>setTimeout(e,t))}function Nt(){return(!!window.obsstudio||A("obsMode")||A("obsModeUser")===game?.userId)&&!A("obsModeGlobalDisable")}let pe;function ss(){return pe||(pe=Object.keys(qo(JSON.parse(JSON.stringify(new CONFIG.Actor.documentClass({name:"actor",type:"character"})))))),pe}function as(t){pe=t}function yt(){const t=game.modules.get("obs-utils");if(t)return t.api;throw new Error("Something went very wrong!")}function me(t){let e=t.match(/^(?<!\\)(["'«»‘’‚‛“”„‟‹›])(.*)(?<!\\)["'«»‘’‚‛“”„‟‹›]$/),n=t.match(/^\\(["'«»‘’‚‛“”„‟‹›]?.*)\\(["'«»‘’‚‛“”„‟‹›]?)$/);return e?e[2]:n?n[1]+n[2]:t}var Pt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function he(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function is(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(o){var r=Object.getOwnPropertyDescriptor(t,o);Object.defineProperty(n,o,r.get?r:{enumerable:!0,get:function(){return t[o]}})}),n}var ze={exports:{}},qe,En;function cs(){if(En)return qe;En=1;var t=1e3,e=t*60,n=e*60,o=n*24,r=o*7,i=o*365.25;qe=function(u,l){l=l||{};var p=typeof u;if(p==="string"&&u.length>0)return a(u);if(p==="number"&&isFinite(u))return l.long?s(u):f(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function a(u){if(u=String(u),!(u.length>100)){var l=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(l){var p=parseFloat(l[1]),d=(l[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return p*i;case"weeks":case"week":case"w":return p*r;case"days":case"day":case"d":return p*o;case"hours":case"hour":case"hrs":case"hr":case"h":return p*n;case"minutes":case"minute":case"mins":case"min":case"m":return p*e;case"seconds":case"second":case"secs":case"sec":case"s":return p*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return p;default:return}}}}function f(u){var l=Math.abs(u);return l>=o?Math.round(u/o)+"d":l>=n?Math.round(u/n)+"h":l>=e?Math.round(u/e)+"m":l>=t?Math.round(u/t)+"s":u+"ms"}function s(u){var l=Math.abs(u);return l>=o?c(u,l,o,"day"):l>=n?c(u,l,n,"hour"):l>=e?c(u,l,e,"minute"):l>=t?c(u,l,t,"second"):u+" ms"}function c(u,l,p,d){var g=l>=p*1.5;return Math.round(u/p)+" "+d+(g?"s":"")}return qe}function ls(t){n.debug=n,n.default=n,n.coerce=s,n.disable=i,n.enable=r,n.enabled=a,n.humanize=cs(),n.destroy=c,Object.keys(t).forEach(u=>{n[u]=t[u]}),n.names=[],n.skips=[],n.formatters={};function e(u){let l=0;for(let p=0;p<u.length;p++)l=(l<<5)-l+u.charCodeAt(p),l|=0;return n.colors[Math.abs(l)%n.colors.length]}n.selectColor=e;function n(u){let l,p=null,d,g;function m(...v){if(!m.enabled)return;const w=m,h=Number(new Date),b=h-(l||h);w.diff=b,w.prev=l,w.curr=h,l=h,v[0]=n.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let C=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(I,P)=>{if(I==="%%")return"%";C++;const _=n.formatters[P];if(typeof _=="function"){const N=v[C];I=_.call(w,N),v.splice(C,1),C--}return I}),n.formatArgs.call(w,v),(w.log||n.log).apply(w,v)}return m.namespace=u,m.useColors=n.useColors(),m.color=n.selectColor(u),m.extend=o,m.destroy=n.destroy,Object.defineProperty(m,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(d!==n.namespaces&&(d=n.namespaces,g=n.enabled(u)),g),set:v=>{p=v}}),typeof n.init=="function"&&n.init(m),m}function o(u,l){const p=n(this.namespace+(typeof l>"u"?":":l)+u);return p.log=this.log,p}function r(u){n.save(u),n.namespaces=u,n.names=[],n.skips=[];let l;const p=(typeof u=="string"?u:"").split(/[\s,]+/),d=p.length;for(l=0;l<d;l++)p[l]&&(u=p[l].replace(/\*/g,".*?"),u[0]==="-"?n.skips.push(new RegExp("^"+u.slice(1)+"$")):n.names.push(new RegExp("^"+u+"$")))}function i(){const u=[...n.names.map(f),...n.skips.map(f).map(l=>"-"+l)].join(",");return n.enable(""),u}function a(u){if(u[u.length-1]==="*")return!0;let l,p;for(l=0,p=n.skips.length;l<p;l++)if(n.skips[l].test(u))return!1;for(l=0,p=n.names.length;l<p;l++)if(n.names[l].test(u))return!0;return!1}function f(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function s(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var us=ls;(function(t,e){e.formatArgs=o,e.save=r,e.load=i,e.useColors=n,e.storage=a(),e.destroy=(()=>{let s=!1;return()=>{s||(s=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const c="color: "+this.color;s.splice(1,0,c,"color: inherit");let u=0,l=0;s[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(u++,p==="%c"&&(l=u))}),s.splice(l,0,c)}e.log=console.debug||console.log||(()=>{});function r(s){try{s?e.storage.setItem("debug",s):e.storage.removeItem("debug")}catch{}}function i(){let s;try{s=e.storage.getItem("debug")}catch{}return!s&&typeof process<"u"&&"env"in process&&(s=process.env.DEBUG),s}function a(){try{return localStorage}catch{}}t.exports=us(e);const{formatters:f}=t.exports;f.j=function(s){try{return JSON.stringify(s)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}}})(ze,ze.exports);var fs=ze.exports;const ds=he(fs);var An={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(n=!1));function r(s,c,u){this.fn=s,this.context=c,this.once=u||!1}function i(s,c,u,l,p){if(typeof u!="function")throw new TypeError("The listener must be a function");var d=new r(u,l||s,p),g=n?n+c:c;return s._events[g]?s._events[g].fn?s._events[g]=[s._events[g],d]:s._events[g].push(d):(s._events[g]=d,s._eventsCount++),s}function a(s,c){--s._eventsCount===0?s._events=new o:delete s._events[c]}function f(){this._events=new o,this._eventsCount=0}f.prototype.eventNames=function(){var s=[],c,u;if(this._eventsCount===0)return s;for(u in c=this._events)e.call(c,u)&&s.push(n?u.slice(1):u);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(c)):s},f.prototype.listeners=function(s){var c=n?n+s:s,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var l=0,p=u.length,d=new Array(p);l<p;l++)d[l]=u[l].fn;return d},f.prototype.listenerCount=function(s){var c=n?n+s:s,u=this._events[c];return u?u.fn?1:u.length:0},f.prototype.emit=function(s,c,u,l,p,d){var g=n?n+s:s;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,w,h;if(m.fn){switch(m.once&&this.removeListener(s,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,u),!0;case 4:return m.fn.call(m.context,c,u,l),!0;case 5:return m.fn.call(m.context,c,u,l,p),!0;case 6:return m.fn.call(m.context,c,u,l,p,d),!0}for(h=1,w=new Array(v-1);h<v;h++)w[h-1]=arguments[h];m.fn.apply(m.context,w)}else{var b=m.length,C;for(h=0;h<b;h++)switch(m[h].once&&this.removeListener(s,m[h].fn,void 0,!0),v){case 1:m[h].fn.call(m[h].context);break;case 2:m[h].fn.call(m[h].context,c);break;case 3:m[h].fn.call(m[h].context,c,u);break;case 4:m[h].fn.call(m[h].context,c,u,l);break;default:if(!w)for(C=1,w=new Array(v-1);C<v;C++)w[C-1]=arguments[C];m[h].fn.apply(m[h].context,w)}}return!0},f.prototype.on=function(s,c,u){return i(this,s,c,u,!1)},f.prototype.once=function(s,c,u){return i(this,s,c,u,!0)},f.prototype.removeListener=function(s,c,u,l){var p=n?n+s:s;if(!this._events[p])return this;if(!c)return a(this,p),this;var d=this._events[p];if(d.fn)d.fn===c&&(!l||d.once)&&(!u||d.context===u)&&a(this,p);else{for(var g=0,m=[],v=d.length;g<v;g++)(d[g].fn!==c||l&&!d[g].once||u&&d[g].context!==u)&&m.push(d[g]);m.length?this._events[p]=m.length===1?m[0]:m:a(this,p)}return this},f.prototype.removeAllListeners=function(s){var c;return s?(c=n?n+s:s,this._events[c]&&a(this,c)):(this._events=new o,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=n,f.EventEmitter=f,t.exports=f})(An);var ps=An.exports;const Fn=he(ps);var Rt=null;typeof WebSocket<"u"?Rt=WebSocket:typeof MozWebSocket<"u"?Rt=MozWebSocket:typeof global<"u"?Rt=global.WebSocket||global.MozWebSocket:typeof window<"u"?Rt=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(Rt=self.WebSocket||self.MozWebSocket);const Mn=Rt;var Nn={exports:{}};function ms(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Pn={exports:{}};const hs={},gs=Object.freeze(Object.defineProperty({__proto__:null,default:hs},Symbol.toStringTag,{value:"Module"})),ys=is(gs);var Rn;function Dn(){return Rn||(Rn=1,function(t,e){(function(n,o){t.exports=o()})(Pt,function(){var n=n||function(o,r){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof Pt<"u"&&Pt.crypto&&(i=Pt.crypto),!i&&typeof ms=="function")try{i=ys}catch{}var a=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},f=Object.create||function(){function h(){}return function(b){var C;return h.prototype=b,C=new h,h.prototype=null,C}}(),s={},c=s.lib={},u=c.Base=function(){return{extend:function(h){var b=f(this);return h&&b.mixIn(h),(!b.hasOwnProperty("init")||this.init===b.init)&&(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var h=this.extend();return h.init.apply(h,arguments),h},init:function(){},mixIn:function(h){for(var b in h)h.hasOwnProperty(b)&&(this[b]=h[b]);h.hasOwnProperty("toString")&&(this.toString=h.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),l=c.WordArray=u.extend({init:function(h,b){h=this.words=h||[],b!=r?this.sigBytes=b:this.sigBytes=h.length*4},toString:function(h){return(h||d).stringify(this)},concat:function(h){var b=this.words,C=h.words,I=this.sigBytes,P=h.sigBytes;if(this.clamp(),I%4)for(var _=0;_<P;_++){var N=C[_>>>2]>>>24-_%4*8&255;b[I+_>>>2]|=N<<24-(I+_)%4*8}else for(var R=0;R<P;R+=4)b[I+R>>>2]=C[R>>>2];return this.sigBytes+=P,this},clamp:function(){var h=this.words,b=this.sigBytes;h[b>>>2]&=4294967295<<32-b%4*8,h.length=o.ceil(b/4)},clone:function(){var h=u.clone.call(this);return h.words=this.words.slice(0),h},random:function(h){for(var b=[],C=0;C<h;C+=4)b.push(a());return new l.init(b,h)}}),p=s.enc={},d=p.Hex={stringify:function(h){for(var b=h.words,C=h.sigBytes,I=[],P=0;P<C;P++){var _=b[P>>>2]>>>24-P%4*8&255;I.push((_>>>4).toString(16)),I.push((_&15).toString(16))}return I.join("")},parse:function(h){for(var b=h.length,C=[],I=0;I<b;I+=2)C[I>>>3]|=parseInt(h.substr(I,2),16)<<24-I%8*4;return new l.init(C,b/2)}},g=p.Latin1={stringify:function(h){for(var b=h.words,C=h.sigBytes,I=[],P=0;P<C;P++){var _=b[P>>>2]>>>24-P%4*8&255;I.push(String.fromCharCode(_))}return I.join("")},parse:function(h){for(var b=h.length,C=[],I=0;I<b;I++)C[I>>>2]|=(h.charCodeAt(I)&255)<<24-I%4*8;return new l.init(C,b)}},m=p.Utf8={stringify:function(h){try{return decodeURIComponent(escape(g.stringify(h)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(h){return g.parse(unescape(encodeURIComponent(h)))}},v=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(h){typeof h=="string"&&(h=m.parse(h)),this._data.concat(h),this._nDataBytes+=h.sigBytes},_process:function(h){var b,C=this._data,I=C.words,P=C.sigBytes,_=this.blockSize,N=_*4,R=P/N;h?R=o.ceil(R):R=o.max((R|0)-this._minBufferSize,0);var q=R*_,X=o.min(q*4,P);if(q){for(var it=0;it<q;it+=_)this._doProcessBlock(I,it);b=I.splice(0,q),C.sigBytes-=X}return new l.init(b,X)},clone:function(){var h=u.clone.call(this);return h._data=this._data.clone(),h},_minBufferSize:0});c.Hasher=v.extend({cfg:u.extend(),init:function(h){this.cfg=this.cfg.extend(h),this.reset()},reset:function(){v.reset.call(this),this._doReset()},update:function(h){return this._append(h),this._process(),this},finalize:function(h){h&&this._append(h);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(h){return function(b,C){return new h.init(C).finalize(b)}},_createHmacHelper:function(h){return function(b,C){return new w.HMAC.init(h,C).finalize(b)}}});var w=s.algo={};return s}(Math);return n})}(Pn)),Pn.exports}(function(t,e){(function(n,o){t.exports=o(Dn())})(Pt,function(n){return function(o){var r=n,i=r.lib,a=i.WordArray,f=i.Hasher,s=r.algo,c=[],u=[];(function(){function d(w){for(var h=o.sqrt(w),b=2;b<=h;b++)if(!(w%b))return!1;return!0}function g(w){return(w-(w|0))*4294967296|0}for(var m=2,v=0;v<64;)d(m)&&(v<8&&(c[v]=g(o.pow(m,1/2))),u[v]=g(o.pow(m,1/3)),v++),m++})();var l=[],p=s.SHA256=f.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(d,g){for(var m=this._hash.words,v=m[0],w=m[1],h=m[2],b=m[3],C=m[4],I=m[5],P=m[6],_=m[7],N=0;N<64;N++){if(N<16)l[N]=d[g+N]|0;else{var R=l[N-15],q=(R<<25|R>>>7)^(R<<14|R>>>18)^R>>>3,X=l[N-2],it=(X<<15|X>>>17)^(X<<13|X>>>19)^X>>>10;l[N]=q+l[N-7]+it+l[N-16]}var Tt=C&I^~C&P,ee=v&w^v&h^w&h,ne=(v<<30|v>>>2)^(v<<19|v>>>13)^(v<<10|v>>>22),oe=(C<<26|C>>>6)^(C<<21|C>>>11)^(C<<7|C>>>25),Bt=_+oe+Tt+u[N]+l[N],pt=ne+ee;_=P,P=I,I=C,C=b+Bt|0,b=h,h=w,w=v,v=Bt+pt|0}m[0]=m[0]+v|0,m[1]=m[1]+w|0,m[2]=m[2]+h|0,m[3]=m[3]+b|0,m[4]=m[4]+C|0,m[5]=m[5]+I|0,m[6]=m[6]+P|0,m[7]=m[7]+_|0},_doFinalize:function(){var d=this._data,g=d.words,m=this._nDataBytes*8,v=d.sigBytes*8;return g[v>>>5]|=128<<24-v%32,g[(v+64>>>9<<4)+14]=o.floor(m/4294967296),g[(v+64>>>9<<4)+15]=m,d.sigBytes=g.length*4,this._process(),this._hash},clone:function(){var d=f.clone.call(this);return d._hash=this._hash.clone(),d}});r.SHA256=f._createHelper(p),r.HmacSHA256=f._createHmacHelper(p)}(Math),n.SHA256})})(Nn);var vs=Nn.exports;const jn=he(vs);var Hn={exports:{}};(function(t,e){(function(n,o){t.exports=o(Dn())})(Pt,function(n){return function(){var o=n,r=o.lib,i=r.WordArray,a=o.enc;a.Base64={stringify:function(s){var c=s.words,u=s.sigBytes,l=this._map;s.clamp();for(var p=[],d=0;d<u;d+=3)for(var g=c[d>>>2]>>>24-d%4*8&255,m=c[d+1>>>2]>>>24-(d+1)%4*8&255,v=c[d+2>>>2]>>>24-(d+2)%4*8&255,w=g<<16|m<<8|v,h=0;h<4&&d+h*.75<u;h++)p.push(l.charAt(w>>>6*(3-h)&63));var b=l.charAt(64);if(b)for(;p.length%4;)p.push(b);return p.join("")},parse:function(s){var c=s.length,u=this._map,l=this._reverseMap;if(!l){l=this._reverseMap=[];for(var p=0;p<u.length;p++)l[u.charCodeAt(p)]=p}var d=u.charAt(64);if(d){var g=s.indexOf(d);g!==-1&&(c=g)}return f(s,c,l)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function f(s,c,u){for(var l=[],p=0,d=0;d<c;d++)if(d%4){var g=u[s.charCodeAt(d-1)]<<d%4*2,m=u[s.charCodeAt(d)]>>>6-d%4*2,v=g|m;l[p>>>2]|=v<<24-p%4*8,p++}return i.create(l,p)}}(),n.enc.Base64})})(Hn);var bs=Hn.exports;const Tn=he(bs);function Yt(){return Yt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Yt.apply(this,arguments)}function ws(t,e){if(t==null)return{};var n={},o=Object.keys(t),r,i;for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}var Z;(function(t){t[t.Hello=0]="Hello",t[t.Identify=1]="Identify",t[t.Identified=2]="Identified",t[t.Reidentify=3]="Reidentify",t[t.Event=5]="Event",t[t.Request=6]="Request",t[t.RequestResponse=7]="RequestResponse",t[t.RequestBatch=8]="RequestBatch",t[t.RequestBatchResponse=9]="RequestBatchResponse"})(Z||(Z={}));var Bn;(function(t){t[t.None=0]="None",t[t.General=1]="General",t[t.Config=2]="Config",t[t.Scenes=4]="Scenes",t[t.Inputs=8]="Inputs",t[t.Transitions=16]="Transitions",t[t.Filters=32]="Filters",t[t.Outputs=64]="Outputs",t[t.SceneItems=128]="SceneItems",t[t.MediaInputs=256]="MediaInputs",t[t.Vendors=512]="Vendors",t[t.Ui=1024]="Ui",t[t.All=2047]="All",t[t.InputVolumeMeters=65536]="InputVolumeMeters",t[t.InputActiveStateChanged=131072]="InputActiveStateChanged",t[t.InputShowStateChanged=262144]="InputShowStateChanged",t[t.SceneItemTransformChanged=524288]="SceneItemTransformChanged"})(Bn||(Bn={}));var Ln;(function(t){t[t.None=-1]="None",t[t.SerialRealtime=0]="SerialRealtime",t[t.SerialFrame=1]="SerialFrame",t[t.Parallel=2]="Parallel"})(Ln||(Ln={}));function Cs(t,e,n){const o=Tn.stringify(jn(n+t));return Tn.stringify(jn(o+e))}const ks=["authentication","rpcVersion"],Xt=ds("obs-websocket-js");class Kt extends Error{constructor(e,n){super(n),this.code=void 0,this.code=e}}class Ht extends Fn{constructor(...e){super(...e),this._identified=!1,this.internalListeners=new Fn,this.socket=void 0}static generateMessageId(){return String(Ht.requestCounter++)}get identified(){return this._identified}async connect(e="ws://127.0.0.1:4455",n,o={}){var r=this;this.socket&&await this.disconnect();try{const i=this.internalEventPromise("ConnectionClosed"),a=this.internalEventPromise("ConnectionError");return await Promise.race([async function(){const f=await r.createConnection(e);return r.emit("Hello",f),r.identify(f,n,o)}(),new Promise((f,s)=>{a.then(c=>{c.message&&s(c)}),i.then(c=>{s(c)})})])}catch(i){throw await this.disconnect(),i}}async disconnect(){if(!this.socket||this.socket.readyState===Mn.CLOSED)return;const e=this.internalEventPromise("ConnectionClosed");this.socket.close(),await e}async reidentify(e){const n=this.internalEventPromise(`op:${Z.Identified}`);return await this.message(Z.Reidentify,e),n}async call(e,n){const o=Ht.generateMessageId(),r=this.internalEventPromise(`res:${o}`);await this.message(Z.Request,{requestId:o,requestType:e,requestData:n});const{requestStatus:i,responseData:a}=await r;if(!i.result)throw new Kt(i.code,i.comment);return a}async callBatch(e,n={}){const o=Ht.generateMessageId(),r=this.internalEventPromise(`res:${o}`);await this.message(Z.RequestBatch,Yt({requestId:o,requests:e},n));const{results:i}=await r;return i}cleanup(){this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket=void 0,this._identified=!1,this.internalListeners.removeAllListeners())}async createConnection(e){var n;const o=this.internalEventPromise("ConnectionOpened"),r=this.internalEventPromise(`op:${Z.Hello}`);this.socket=new Mn(e,this.protocol),this.socket.onopen=this.onOpen.bind(this),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),await o;const i=(n=this.socket)==null?void 0:n.protocol;if(!i)throw new Kt(-1,"Server sent no subprotocol");if(i!==this.protocol)throw new Kt(-1,"Server sent an invalid subprotocol");return r}async identify(e,n,o={}){let{authentication:r,rpcVersion:i}=e,a=ws(e,ks);const f=Yt({rpcVersion:i},o);r&&n&&(f.authentication=Cs(r.salt,r.challenge,n));const s=this.internalEventPromise(`op:${Z.Identified}`);await this.message(Z.Identify,f);const c=await s;return this._identified=!0,this.emit("Identified",c),Yt({rpcVersion:i},a,c)}async message(e,n){if(!this.socket)throw new Error("Not connected");if(!this.identified&&e!==1)throw new Error("Socket not identified");const o=await this.encodeMessage({op:e,d:n});this.socket.send(o)}async internalEventPromise(e){return new Promise(n=>{this.internalListeners.once(e,n)})}onOpen(e){Xt("socket.open"),this.emit("ConnectionOpened"),this.internalListeners.emit("ConnectionOpened",e)}async onMessage(e){try{const{op:n,d:o}=await this.decodeMessage(e.data);if(Xt("socket.message: %d %j",n,o),n===void 0||o===void 0)return;switch(n){case Z.Event:{const{eventType:r,eventData:i}=o;this.emit(r,i);return}case Z.RequestResponse:case Z.RequestBatchResponse:{const{requestId:r}=o;this.internalListeners.emit(`res:${r}`,o);return}default:this.internalListeners.emit(`op:${n}`,o)}}catch(n){Xt("error handling message: %o",n)}}onError(e){Xt("socket.error: %o",e);const n=new Kt(-1,e.message);this.emit("ConnectionError",n),this.internalListeners.emit("ConnectionError",n)}onClose(e){Xt("socket.close: %s (%d)",e.reason,e.code);const n=new Kt(e.code,e.reason);this.emit("ConnectionClosed",n),this.internalListeners.emit("ConnectionClosed",n),this.cleanup()}}Ht.requestCounter=1,typeof exports<"u"&&Object.defineProperty(exports,"__esModule",{value:!0});class $s extends Ht{constructor(...e){super(...e),this.protocol="obswebsocket.json"}async encodeMessage(e){return JSON.stringify(e)}async decodeMessage(e){return JSON.parse(e)}}typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Gr);function Vn(t,e,n){const o=t.slice();return o[3]=e[n],o}function Un(t,e,n){const o=t.slice();return o[6]=e[n],o[8]=n,o}function zn(t,e){let n,o,r,i;var a=e[2](e[6].type);function f(s,c){return{props:{overlayData:s[6],actorID:s[3],overlayIndex:s[8]}}}return a&&(o=Ut(a,f(e))),{key:t,first:null,c(){n=ft(),o&&ct(o.$$.fragment),r=ft(),this.first=n},m(s,c){x(s,n,c),o&&rt(o,s,c),x(s,r,c),i=!0},p(s,c){if(e=s,c&1&&a!==(a=e[2](e[6].type))){if(o){J();const u=o;D(u.$$.fragment,1,0,()=>{st(u,1)}),Y()}a?(o=Ut(a,f(e)),ct(o.$$.fragment),M(o.$$.fragment,1),rt(o,r.parentNode,r)):o=null}else if(a){const u={};c&1&&(u.overlayData=e[6]),c&2&&(u.actorID=e[3]),c&1&&(u.overlayIndex=e[8]),o.$set(u)}},i(s){i||(o&&M(o.$$.fragment,s),i=!0)},o(s){o&&D(o.$$.fragment,s),i=!1},d(s){s&&(k(n),k(r)),o&&st(o,s)}}}function qn(t){let e,n=[],o=new Map,r,i,a,f=T(t[0]);const s=c=>c[0].indexOf(c[6]);for(let c=0;c<f.length;c+=1){let u=Un(t,f,c),l=s(u);o.set(l,n[c]=zn(l,u))}return{c(){e=F("div");for(let c=0;c<n.length;c+=1)n[c].c();r=B(),y(e,"class","actor"),y(e,"id",i="actor"+t[3])},m(c,u){x(c,e,u);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null);G(e,r),a=!0},p(c,u){u&7&&(f=T(c[0]),J(),n=Be(n,u,s,1,c,f,o,e,Te,zn,r,Un),Y()),(!a||u&2&&i!==(i="actor"+c[3]))&&y(e,"id",i)},i(c){if(!a){for(let u=0;u<f.length;u+=1)M(n[u]);a=!0}},o(c){for(let u=0;u<n.length;u+=1)D(n[u]);a=!1},d(c){c&&k(e);for(let u=0;u<n.length;u+=1)n[u].d()}}}function xs(t){let e,n,o=T(t[1]),r=[];for(let a=0;a<o.length;a+=1)r[a]=qn(Vn(t,o,a));const i=a=>D(r[a],1,1,()=>{r[a]=null});return{c(){e=F("div");for(let a=0;a<r.length;a+=1)r[a].c();y(e,"class","obs-utils overlay")},m(a,f){x(a,e,f);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(e,null);n=!0},p(a,[f]){if(f&7){o=T(a[1]);let s;for(s=0;s<o.length;s+=1){const c=Vn(a,o,s);r[s]?(r[s].p(c,f),M(r[s],1)):(r[s]=qn(c),r[s].c(),M(r[s],1),r[s].m(e,null))}for(J(),s=o.length;s<r.length;s+=1)i(s);Y()}},i(a){if(!n){for(let f=0;f<o.length;f+=1)M(r[f]);n=!0}},o(a){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)D(r[f]);n=!1},d(a){a&&k(e),ut(r,a)}}}function Ss(t,e,n){let{overlays:o}=e,{actorIDs:r}=e;function i(a){return yt().overlayTypes.get(a).overlayClass}return t.$$set=a=>{"overlays"in a&&n(0,o=a.overlays),"actorIDs"in a&&n(1,r=a.actorIDs)},[o,r,i]}class Wn extends U{constructor(e){super(),V(this,e,Ss,xs,j,{overlays:0,actorIDs:1})}}function _s(t){let e;return{c(){e=F("div")},m(n,o){x(n,e,o),t[2](e)},p:S,i:S,o:S,d(n){n&&k(e),t[2](null)}}}function Is(t,e,n){let o,{externalClass:r}=e;xn(()=>{new r({target:o,props:e})});function i(a){dt[a?"unshift":"push"](()=>{o=a,n(0,o)})}return t.$$set=a=>{n(3,e=se(se({},e),vn(a))),"externalClass"in a&&n(1,r=a.externalClass)},e=vn(e),[o,r,i]}class Os extends U{constructor(e){super(),V(this,e,Is,_s,j,{externalClass:1})}}function Gn(t,e,n){const o=t.slice();return o[4]=e[n],o}function Jn(t){let e,n;return e=new Os({props:{externalClass:t[4]}}),{c(){ct(e.$$.fragment)},m(o,r){rt(e,o,r),n=!0},p:S,i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){st(e,o)}}}function Es(t){let e,n,o,r;n=new Wn({props:{actorIDs:t[1],overlays:t[0]}});let i=T([...t[2]]),a=[];for(let s=0;s<i.length;s+=1)a[s]=Jn(Gn(t,i,s));const f=s=>D(a[s],1,1,()=>{a[s]=null});return{c(){e=F("div"),ct(n.$$.fragment),o=B();for(let s=0;s<a.length;s+=1)a[s].c();y(e,"class","overlay-renderer")},m(s,c){x(s,e,c),rt(n,e,null),G(e,o);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(e,null);r=!0},p(s,[c]){const u={};if(c&2&&(u.actorIDs=s[1]),c&1&&(u.overlays=s[0]),n.$set(u),c&4){i=T([...s[2]]);let l;for(l=0;l<i.length;l+=1){const p=Gn(s,i,l);a[l]?(a[l].p(p,c),M(a[l],1)):(a[l]=Jn(p),a[l].c(),M(a[l],1),a[l].m(e,null))}for(J(),l=i.length;l<a.length;l+=1)f(l);Y()}},i(s){if(!r){M(n.$$.fragment,s);for(let c=0;c<i.length;c+=1)M(a[c]);r=!0}},o(s){D(n.$$.fragment,s),a=a.filter(Boolean);for(let c=0;c<a.length;c+=1)D(a[c]);r=!1},d(s){s&&k(e),st(n),ut(a,s)}}}function As(t,e,n){let o=A("streamOverlays"),r=A("overlayActors"),i=Hooks.on("updateSetting",(f,s)=>{f.key==="obs-utils.streamOverlays"?n(0,o=JSON.parse(s.value)):f.key==="obs-utils.overlayActors"&&n(1,r=JSON.parse(s.value))});nt(()=>{Hooks.off("updateSettings",i)});const a=yt().singleInstanceOverlays;return[o,r,a]}class Fs extends U{constructor(e){super(),V(this,e,As,Es,j,{})}}class Ms{type;components;style;constructor(e="sl",n=[],o=""){this.type=e,this.components=n,this.style=o}}class Ns{type;data;style;constructor(e="pt",n="",o=""){this.type=e,this.data=n,this.style=o}}function Ps(){game.actors instanceof Actors&&new Fs({target:$("body").get(0)})}let Zt;function Rs(){const t=getComputedStyle(document.documentElement).getPropertyValue("--local-obs-host"),e=getComputedStyle(document.documentElement).getPropertyValue("--local-obs-port"),n=getComputedStyle(document.documentElement).getPropertyValue("--local-obs-password"),o=A("websocketSettings");return t&&(o.url=t),e&&(o.port=e),n&&(o.password=n),o}async function vt(t){if(!Nt())return;const e=A("obsRemote")[t],n=A("enableOBSWebsocket");e.forEach(async o=>await Yn(o,n))}async function Ds(t){if(!Nt())return;const e=A("obsRemote").onSceneLoad,n=A("enableOBSWebsocket");e.forEach(o=>{o.sceneName===t&&o.obsActions.forEach(async r=>await Yn(r,n))})}async function Yn(t,e){if(!e)window.obsstudio.getControlLevel(async n=>{switch(t.targetAction){case gt.SwitchScene:if(n!==4)throw new Error("Control Level too Low");window.obsstudio.setCurrentScene(t.sceneName);break;default:throw new Error("OBS Websocket is Disabled! How are you triggering this?!?")}});else{const n=await We();switch(t.targetAction){case gt.SwitchScene:await n.call("SetCurrentProgramScene",{sceneName:t.sceneName});break;case gt.EnableSource:await n.call("SetSceneItemEnabled",{sceneName:t.sceneName,sceneItemId:await ge(t.sceneName,t.targetName),sceneItemEnabled:!0});break;case gt.DisableSource:await n.call("SetSceneItemEnabled",{sceneName:t.sceneName,sceneItemId:await ge(t.sceneName,t.targetName),sceneItemEnabled:!1});break;case gt.ToggleSource:{const o=await n.call("GetSceneItemEnabled",{sceneName:t.sceneName,sceneItemId:await ge(t.sceneName,t.targetName)});await n.call("SetSceneItemEnabled",{sceneName:t.sceneName,sceneItemId:await ge(t.sceneName,t.targetName),sceneItemEnabled:!o.sceneItemEnabled});break}}}}async function ge(t,e){return(await(await We()).call("GetSceneItemId",{sceneName:t,sourceName:e})).sceneItemId}async function We(){if(Zt)return Zt;const t=Rs();return Zt=new $s,await Zt.connect(`ws://${t.url}:${t.port}`,t.password),Zt}async function js(){A("enableOBSWebsocket")?(await We()).addListener("StreamStateChanged",t=>{t.outputState==="OBS_WEBSOCKET_OUTPUT_STOPPED"&&vt("onStopStreaming")}):window.addEventListener("obsStreamingStopped",async()=>await vt("onStopStreaming"))}function Hs(){game.view==="stream"&&Hooks.once("renderChatLog",()=>Ps()),game.view==="game"&&(Hooks.on("canvasReady",mn),Hooks.on("canvasReady",async t=>{await Ds(t.scene.name)}),Hooks.on("renderSidebar",tt),Hooks.on("renderSceneNavigation",tt),Hooks.on("renderMainMenu",tt),Hooks.on("renderSceneControls",tt),Hooks.on("renderTokenHUD",tt),Hooks.on("renderUserConfig",tt),A("showAV")||Hooks.on("renderCameraViews",tt),Hooks.on("renderPlayerList",tt),Hooks.on("renderHotbar",tt),Hooks.on("renderUserConfig",(...t)=>{A("showUserConfig")||tt(...t)}),Hooks.on("renderSidebar",er),$("section#ui-left img#logo").remove(),Hooks.on("drawToken",cn),Hooks.on("refreshToken",cn),Hooks.on("updateToken",re),Hooks.on("updateCombat",Go),Hooks.on("updateCombat",re),Hooks.on("updateCombat",nr),Hooks.on("deleteCombat",Wo),Hooks.on("deleteCombat",or),Hooks.on("renderJournalSheet",dn),Hooks.on("renderImagePopout",dn),Hooks.on("renderJournalSheet",pn),Hooks.on("renderImagePopout",pn),Hooks.on("updateCombat",async(t,e)=>{e.turn===0&&e.round===1&&await vt("onCombatStart")}),Hooks.on("deleteCombat",async()=>{await vt("onCombatEnd")}),Hooks.on("pauseGame",async t=>{t?await vt("onPause"):await vt("onUnpause")}),Hooks.once("ready",async()=>{await vt("onLoad"),ui.sidebar.collapse()}),Hooks.on("updateSetting",async t=>{t.key==="obs-utils.clampCanvas"&&await mn()}),js().then(),Hooks.call("obs-utils.streamModeInit"))}function Ts(t){let e,n;return{c(){e=F("div"),e.textContent="The component used to render this is missing.",n=W(`
;`)},m(o,r){x(o,e,r),x(o,n,r)},p:S,i:S,o:S,d(o){o&&(k(e),k(n))}}}class Bs extends U{constructor(e){super(),V(this,e,null,Ts,j,{})}}function Xn(t,e,n){const o=t.slice();return o[5]=e[n],o[7]=n,o}function Kn(t,e){let n,o,r,i;var a=e[3](e[5].type.toString());function f(s,c){return{props:{data:s[5].data,componentIndex:s[7],actorID:s[1],style:s[5].style}}}return a&&(o=Ut(a,f(e))),{key:t,first:null,c(){n=ft(),o&&ct(o.$$.fragment),r=ft(),this.first=n},m(s,c){x(s,n,c),o&&rt(o,s,c),x(s,r,c),i=!0},p(s,c){if(e=s,c&1&&a!==(a=e[3](e[5].type.toString()))){if(o){J();const u=o;D(u.$$.fragment,1,0,()=>{st(u,1)}),Y()}a?(o=Ut(a,f(e)),ct(o.$$.fragment),M(o.$$.fragment,1),rt(o,r.parentNode,r)):o=null}else if(a){const u={};c&1&&(u.data=e[5].data),c&1&&(u.componentIndex=e[7]),c&2&&(u.actorID=e[1]),c&1&&(u.style=e[5].style),o.$set(u)}},i(s){i||(o&&M(o.$$.fragment,s),i=!0)},o(s){o&&D(o.$$.fragment,s),i=!1},d(s){s&&(k(n),k(r)),o&&st(o,s)}}}function Ls(t){let e,n=[],o=new Map,r,i,a,f=T(t[0].components);const s=c=>c[0].components.indexOf(c[5]);for(let c=0;c<f.length;c+=1){let u=Xn(t,f,c),l=s(u);o.set(l,n[c]=Kn(l,u))}return{c(){e=F("div");for(let c=0;c<n.length;c+=1)n[c].c();y(e,"class","single-line-overlay"),y(e,"id",r="overlay"+t[2].toString()),y(e,"style",i=t[0].style)},m(c,u){x(c,e,u);for(let l=0;l<n.length;l+=1)n[l]&&n[l].m(e,null);a=!0},p(c,[u]){u&11&&(f=T(c[0].components),J(),n=Be(n,u,s,1,c,f,o,e,Te,Kn,null,Xn),Y()),(!a||u&4&&r!==(r="overlay"+c[2].toString()))&&y(e,"id",r),(!a||u&1&&i!==(i=c[0].style))&&y(e,"style",i)},i(c){if(!a){for(let u=0;u<f.length;u+=1)M(n[u]);a=!0}},o(c){for(let u=0;u<n.length;u+=1)D(n[u]);a=!1},d(c){c&&k(e);for(let u=0;u<n.length;u+=1)n[u].d()}}}function Vs(t,e,n){let{overlayData:o}=e,{actorID:r}=e,{overlayIndex:i}=e,a=yt().overlayTypes.get("sl").overlayComponents;function f(s){return a.get(s)??Bs}return t.$$set=s=>{"overlayData"in s&&n(0,o=s.overlayData),"actorID"in s&&n(1,r=s.actorID),"overlayIndex"in s&&n(2,i=s.overlayIndex)},[o,r,i,f]}class Us extends U{constructor(e){super(),V(this,e,Vs,Ls,j,{overlayData:0,actorID:1,overlayIndex:2})}}function zs(t){let e,n,o;return{c(){e=F("div"),n=F("i"),y(n,"class",t[0]),y(e,"class","component fa-icon-component"),y(e,"id",o="component"+t[2].toString()),y(e,"style",t[1])},m(r,i){x(r,e,i),G(e,n)},p(r,[i]){i&1&&y(n,"class",r[0]),i&4&&o!==(o="component"+r[2].toString())&&y(e,"id",o),i&2&&y(e,"style",r[1])},i:S,o:S,d(r){r&&k(e)}}}function qs(t,e,n){let{data:o}=e,{style:r}=e,{componentIndex:i}=e;return t.$$set=a=>{"data"in a&&n(0,o=a.data),"style"in a&&n(1,r=a.style),"componentIndex"in a&&n(2,i=a.componentIndex)},[o,r,i]}class Zn extends U{constructor(e){super(),V(this,e,qs,zs,j,{data:0,style:1,componentIndex:2})}}var Ws=typeof global=="object"&&global&&global.Object===Object&&global,Gs=typeof self=="object"&&self&&self.Object===Object&&self,Ge=Ws||Gs||Function("return this")(),Dt=Ge.Symbol,Qn=Object.prototype,Js=Qn.hasOwnProperty,Ys=Qn.toString,Qt=Dt?Dt.toStringTag:void 0;function Xs(t){var e=Js.call(t,Qt),n=t[Qt];try{t[Qt]=void 0;var o=!0}catch{}var r=Ys.call(t);return o&&(e?t[Qt]=n:delete t[Qt]),r}var Ks=Object.prototype,Zs=Ks.toString;function Qs(t){return Zs.call(t)}var ta="[object Null]",ea="[object Undefined]",to=Dt?Dt.toStringTag:void 0;function Je(t){return t==null?t===void 0?ea:ta:to&&to in Object(t)?Xs(t):Qs(t)}function Ye(t){return t!=null&&typeof t=="object"}var na="[object Symbol]";function Xe(t){return typeof t=="symbol"||Ye(t)&&Je(t)==na}function oa(t,e){for(var n=-1,o=t==null?0:t.length,r=Array(o);++n<o;)r[n]=e(t[n],n,t);return r}var ye=Array.isArray,ra=1/0,eo=Dt?Dt.prototype:void 0,no=eo?eo.toString:void 0;function oo(t){if(typeof t=="string")return t;if(ye(t))return oa(t,oo)+"";if(Xe(t))return no?no.call(t):"";var e=t+"";return e=="0"&&1/t==-ra?"-0":e}function ro(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var sa="[object AsyncFunction]",aa="[object Function]",ia="[object GeneratorFunction]",ca="[object Proxy]";function la(t){if(!ro(t))return!1;var e=Je(t);return e==aa||e==ia||e==sa||e==ca}var Ke=Ge["__core-js_shared__"],so=function(){var t=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function ua(t){return!!so&&so in t}var fa=Function.prototype,da=fa.toString;function pa(t){if(t!=null){try{return da.call(t)}catch{}try{return t+""}catch{}}return""}var ma=/[\\^$.*+?()[\]{}|]/g,ha=/^\[object .+?Constructor\]$/,ga=Function.prototype,ya=Object.prototype,va=ga.toString,ba=ya.hasOwnProperty,wa=RegExp("^"+va.call(ba).replace(ma,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ca(t){if(!ro(t)||ua(t))return!1;var e=la(t)?wa:ha;return e.test(pa(t))}function ka(t,e){return t?.[e]}function ao(t,e){var n=ka(t,e);return Ca(n)?n:void 0}var $a=9007199254740991,xa=/^(?:0|[1-9]\d*)$/;function Sa(t,e){var n=typeof t;return e=e??$a,!!e&&(n=="number"||n!="symbol"&&xa.test(t))&&t>-1&&t%1==0&&t<e}function _a(t,e){return t===e||t!==t&&e!==e}var Ia=9007199254740991;function Oa(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ia}var Ea="[object Arguments]";function io(t){return Ye(t)&&Je(t)==Ea}var co=Object.prototype,Aa=co.hasOwnProperty,Fa=co.propertyIsEnumerable,Ma=io(function(){return arguments}())?io:function(t){return Ye(t)&&Aa.call(t,"callee")&&!Fa.call(t,"callee")},Na=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Pa=/^\w*$/;function Ra(t,e){if(ye(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||Xe(t)?!0:Pa.test(t)||!Na.test(t)||e!=null&&t in Object(e)}var te=ao(Object,"create");function Da(){this.__data__=te?te(null):{},this.size=0}function ja(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Ha="__lodash_hash_undefined__",Ta=Object.prototype,Ba=Ta.hasOwnProperty;function La(t){var e=this.__data__;if(te){var n=e[t];return n===Ha?void 0:n}return Ba.call(e,t)?e[t]:void 0}var Va=Object.prototype,Ua=Va.hasOwnProperty;function za(t){var e=this.__data__;return te?e[t]!==void 0:Ua.call(e,t)}var qa="__lodash_hash_undefined__";function Wa(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=te&&e===void 0?qa:e,this}function bt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}bt.prototype.clear=Da,bt.prototype.delete=ja,bt.prototype.get=La,bt.prototype.has=za,bt.prototype.set=Wa;function Ga(){this.__data__=[],this.size=0}function ve(t,e){for(var n=t.length;n--;)if(_a(t[n][0],e))return n;return-1}var Ja=Array.prototype,Ya=Ja.splice;function Xa(t){var e=this.__data__,n=ve(e,t);if(n<0)return!1;var o=e.length-1;return n==o?e.pop():Ya.call(e,n,1),--this.size,!0}function Ka(t){var e=this.__data__,n=ve(e,t);return n<0?void 0:e[n][1]}function Za(t){return ve(this.__data__,t)>-1}function Qa(t,e){var n=this.__data__,o=ve(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}function jt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}jt.prototype.clear=Ga,jt.prototype.delete=Xa,jt.prototype.get=Ka,jt.prototype.has=Za,jt.prototype.set=Qa;var ti=ao(Ge,"Map");function ei(){this.size=0,this.__data__={hash:new bt,map:new(ti||jt),string:new bt}}function ni(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function be(t,e){var n=t.__data__;return ni(e)?n[typeof e=="string"?"string":"hash"]:n.map}function oi(t){var e=be(this,t).delete(t);return this.size-=e?1:0,e}function ri(t){return be(this,t).get(t)}function si(t){return be(this,t).has(t)}function ai(t,e){var n=be(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}function wt(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}wt.prototype.clear=ei,wt.prototype.delete=oi,wt.prototype.get=ri,wt.prototype.has=si,wt.prototype.set=ai;var ii="Expected a function";function Ze(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(ii);var n=function(){var o=arguments,r=e?e.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var a=t.apply(this,o);return n.cache=i.set(r,a)||i,a};return n.cache=new(Ze.Cache||wt),n}Ze.Cache=wt;var ci=500;function li(t){var e=Ze(t,function(o){return n.size===ci&&n.clear(),o}),n=e.cache;return e}var fi=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,di=/\\(\\)?/g,pi=li(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(fi,function(n,o,r,i){e.push(r?i.replace(di,"$1"):o||n)}),e});function mi(t){return t==null?"":oo(t)}function lo(t,e){return ye(t)?t:Ra(t,e)?[t]:pi(mi(t))}var hi=1/0;function uo(t){if(typeof t=="string"||Xe(t))return t;var e=t+"";return e=="0"&&1/t==-hi?"-0":e}function gi(t,e){e=lo(e,t);for(var n=0,o=e.length;t!=null&&n<o;)t=t[uo(e[n++])];return n&&n==o?t:void 0}function at(t,e,n){var o=t==null?void 0:gi(t,e);return o===void 0?n:o}function yi(t,e,n){e=lo(e,t);for(var o=-1,r=e.length,i=!1;++o<r;){var a=uo(e[o]);if(!(i=t!=null&&n(t,a)))break;t=t[a]}return i||++o!=r?i:(r=t==null?0:t.length,!!r&&Oa(r)&&Sa(a,r)&&(ye(t)||Ma(t)))}var vi=Object.prototype,bi=vi.hasOwnProperty;function wi(t,e){return t!=null&&bi.call(t,e)}function we(t,e){return t!=null&&yi(t,e,wi)}function fo(t){let e=t[4]()+"",n;return{c(){n=W(e)},m(o,r){x(o,n,r)},p:S,d(o){o&&k(n)}}}function Ci(t){let e=t[0],n,o,r,i,a=fo(t);return{c(){a.c(),n=B(),o=F("div"),r=W(t[3]),y(o,"class","component actor-val-component"),y(o,"id",i="component"+t[2].toString()),y(o,"style",t[1])},m(f,s){a.m(f,s),x(f,n,s),x(f,o,s),G(o,r)},p(f,[s]){s&1&&j(e,e=f[0])?(a.d(1),a=fo(f),a.c(),a.m(n.parentNode,n)):a.p(f,s),s&8&&Me(r,f[3]),s&4&&i!==(i="component"+f[2].toString())&&y(o,"id",i),s&2&&y(o,"style",f[1])},i:S,o:S,d(f){f&&(k(n),k(o)),a.d(f)}}}function ki(t,e,n){let{data:o}=e,{actorID:r}=e,{style:i}=e,{componentIndex:a}=e,f=game.actors?.get(r),s="",c=Hooks.on("obs-utils.refreshActor",l=>{l.id===r&&(f=l,u())});function u(){return we(f,o)?n(3,s=at(f,o,"")):n(3,s=o!=null?me(o):""),""}return nt(()=>{Hooks.off("obs-utils.refreshActor",c)}),t.$$set=l=>{"data"in l&&n(0,o=l.data),"actorID"in l&&n(5,r=l.actorID),"style"in l&&n(1,i=l.style),"componentIndex"in l&&n(2,a=l.componentIndex)},[o,i,a,s,u,r]}class Ce extends U{constructor(e){super(),V(this,e,ki,Ci,j,{data:0,actorID:5,style:1,componentIndex:2})}}function po(t){let e=t[6]()+"",n;return{c(){n=W(e)},m(o,r){x(o,n,r)},p:S,d(o){o&&k(n)}}}function $i(t){let e;return{c(){e=F("i"),y(e,"class",t[5])},m(n,o){x(n,e,o)},p(n,o){o&32&&y(e,"class",n[5])},d(n){n&&k(e)}}}function xi(t){let e;return{c(){e=F("i"),y(e,"class",t[4])},m(n,o){x(n,e,o)},p(n,o){o&16&&y(e,"class",n[4])},d(n){n&&k(e)}}}function Si(t){let e=t[0],n,o,r,i=po(t);function a(c,u){return c[3]?xi:$i}let f=a(t),s=f(t);return{c(){i.c(),n=B(),o=F("div"),s.c(),y(o,"class","component actor-val-component bool-component fa-icon-component"),y(o,"id",r="component"+t[2].toString()),y(o,"style",t[1])},m(c,u){i.m(c,u),x(c,n,u),x(c,o,u),s.m(o,null)},p(c,[u]){u&1&&j(e,e=c[0])?(i.d(1),i=po(c),i.c(),i.m(n.parentNode,n)):i.p(c,u),f===(f=a(c))&&s?s.p(c,u):(s.d(1),s=f(c),s&&(s.c(),s.m(o,null))),u&4&&r!==(r="component"+c[2].toString())&&y(o,"id",r),u&2&&y(o,"style",c[1])},i:S,o:S,d(c){c&&(k(n),k(o)),i.d(c),s.d()}}}function _i(t,e,n){let{data:o}=e,{actorID:r}=e,{style:i}=e,{componentIndex:a}=e,f=game.actors?.get(r),s="",c="",u="",l=Hooks.on("obs-utils.refreshActor",d=>{d.id===r&&p()});function p(){return n(3,s=at(f,o.split(";")[0],"")),n(4,c=o.split(";")[1]??"fa-solid fa-check"),n(5,u=o.split(";")[2]??"fa-solid fa-x"),""}return nt(()=>{Hooks.off("obs-utils.refreshActor",l)}),t.$$set=d=>{"data"in d&&n(0,o=d.data),"actorID"in d&&n(7,r=d.actorID),"style"in d&&n(1,i=d.style),"componentIndex"in d&&n(2,a=d.componentIndex)},[o,i,a,s,c,u,p,r]}class mo extends U{constructor(e){super(),V(this,e,_i,Si,j,{data:0,actorID:7,style:1,componentIndex:2})}}function ho(t){const e=t-1;return e*e*e+1}function Q(t,{delay:e=0,duration:n=400,easing:o=Vt}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:o,css:i=>`opacity: ${i*r}`}}function Ii(t,{delay:e=0,duration:n=400,easing:o=ho,axis:r="y"}={}){const i=getComputedStyle(t),a=+i.opacity,f=r==="y"?"height":"width",s=parseFloat(i[f]),c=r==="y"?["top","bottom"]:["left","right"],u=c.map(w=>`${w[0].toUpperCase()}${w.slice(1)}`),l=parseFloat(i[`padding${u[0]}`]),p=parseFloat(i[`padding${u[1]}`]),d=parseFloat(i[`margin${u[0]}`]),g=parseFloat(i[`margin${u[1]}`]),m=parseFloat(i[`border${u[0]}Width`]),v=parseFloat(i[`border${u[1]}Width`]);return{delay:e,duration:n,easing:o,css:w=>`overflow: hidden;opacity: ${Math.min(w*20,1)*a};${f}: ${w*s}px;padding-${c[0]}: ${w*l}px;padding-${c[1]}: ${w*p}px;margin-${c[0]}: ${w*d}px;margin-${c[1]}: ${w*g}px;border-${c[0]}-width: ${w*m}px;border-${c[1]}-width: ${w*v}px;`}}function go(t){let e,n=t[14]&&yo(t);return{c(){n&&n.c(),e=ft()},m(o,r){n&&n.m(o,r),x(o,e,r)},p(o,r){o[14]?n?(n.p(o,r),r[0]&16384&&M(n,1)):(n=yo(o),n.c(),M(n,1),n.m(e.parentNode,e)):n&&(J(),D(n,1,1,()=>{n=null}),Y())},d(o){o&&k(e),n&&n.d(o)}}}function yo(t){let e,n,o,r,i,a,f;return{c(){e=F("img"),y(e,"class","before layer"),H(e.src,n=t[15])||y(e,"src",n),y(e,"alt","pre roll")},m(s,c){x(s,e,c),i=!0,a||(f=xt(e,"introend",t[39]),a=!0)},p(s,c){t=s,(!i||c[0]&32768&&!H(e.src,n=t[15]))&&y(e,"src",n)},i(s){i||(s&&K(()=>{i&&(r&&r.end(1),o=Et(e,Q,{delay:t[13],duration:t[12]}),o.start())}),i=!0)},o(s){o&&o.invalidate(),s&&(r=At(e,Q,{delay:t[11],duration:t[10]})),i=!1},d(s){s&&k(e),s&&r&&r.end(),a=!1,f()}}}function vo(t){let e,n,o,r,i,a,f,s,c,u,l=t[16]&&bo(t),p=t[17]&&wo(t);return{c(){l&&l.c(),e=B(),n=F("span"),o=W(t[4]),a=B(),p&&p.c(),f=ft(),y(n,"class","roll layer")},m(d,g){l&&l.m(d,g),x(d,e,g),x(d,n,g),G(n,o),x(d,a,g),p&&p.m(d,g),x(d,f,g),s=!0,c||(u=xt(n,"introend",t[40]),c=!0)},p(d,g){t=d,t[16]?l?(l.p(t,g),g[0]&65536&&M(l,1)):(l=bo(t),l.c(),M(l,1),l.m(e.parentNode,e)):l&&(J(),D(l,1,1,()=>{l=null}),Y()),(!s||g[0]&16)&&Me(o,t[4]),t[17]?p?(p.p(t,g),g[0]&131072&&M(p,1)):(p=wo(t),p.c(),M(p,1),p.m(f.parentNode,f)):p&&(J(),D(p,1,1,()=>{p=null}),Y())},i(d){s||(M(l),d&&K(()=>{s&&(i&&i.end(1),r=Et(n,Q,{delay:t[5],duration:t[9]}),r.start())}),M(p),s=!0)},o(d){D(l),r&&r.invalidate(),d&&(i=At(n,Q,{delay:t[8],duration:t[7]})),D(p),s=!1},d(d){d&&(k(e),k(n),k(a),k(f)),l&&l.d(d),d&&i&&i.end(),p&&p.d(d),c=!1,u()}}}function bo(t){let e,n,o,r,i;return{c(){e=F("img"),y(e,"class","background layer"),H(e.src,n=t[16])||y(e,"src",n),y(e,"alt","roll background")},m(a,f){x(a,e,f),i=!0},p(a,f){t=a,(!i||f[0]&65536&&!H(e.src,n=t[16]))&&y(e,"src",n)},i(a){i||(a&&K(()=>{i&&(r&&r.end(1),o=Et(e,Q,{delay:t[5],duration:t[9]}),o.start())}),i=!0)},o(a){o&&o.invalidate(),a&&(r=At(e,Q,{delay:t[8],duration:t[7]})),i=!1},d(a){a&&k(e),a&&r&&r.end()}}}function wo(t){let e,n,o,r,i;return{c(){e=F("img"),y(e,"class","foreground layer"),H(e.src,n=t[17])||y(e,"src",n),y(e,"alt","roll foreground")},m(a,f){x(a,e,f),i=!0},p(a,f){t=a,(!i||f[0]&131072&&!H(e.src,n=t[17]))&&y(e,"src",n)},i(a){i||(a&&K(()=>{i&&(r&&r.end(1),o=Et(e,Q,{delay:t[5],duration:t[9]}),o.start())}),i=!0)},o(a){o&&o.invalidate(),a&&(r=At(e,Q,{delay:t[8],duration:t[7]})),i=!1},d(a){a&&k(e),a&&r&&r.end()}}}function Co(t){let e,n=t[18]&&t[19]&&ko(t);return{c(){n&&n.c(),e=ft()},m(o,r){n&&n.m(o,r),x(o,e,r)},p(o,r){o[18]&&o[19]?n?(n.p(o,r),r[0]&786432&&M(n,1)):(n=ko(o),n.c(),M(n,1),n.m(e.parentNode,e)):n&&(J(),D(n,1,1,()=>{n=null}),Y())},d(o){o&&k(e),n&&n.d(o)}}}function ko(t){let e,n,o,r,i,a,f;return{c(){e=F("img"),y(e,"class","after layer"),H(e.src,n=t[19])||y(e,"src",n),y(e,"alt","post roll")},m(s,c){x(s,e,c),i=!0,a||(f=xt(e,"introend",t[41]),a=!0)},p(s,c){t=s,(!i||c[0]&524288&&!H(e.src,n=t[19]))&&y(e,"src",n)},i(s){i||(s&&K(()=>{i&&(r&&r.end(1),o=Et(e,Q,{delay:t[6],duration:t[20]}),o.start())}),i=!0)},o(s){o&&o.invalidate(),s&&(r=At(e,Q,{delay:t[21],duration:t[22]})),i=!1},d(s){s&&k(e),s&&r&&r.end(),a=!1,f()}}}function Oi(t){let e,n,o,r=t[0]&&go(t),i=t[1]&&vo(t),a=t[2]&&Co(t);return{c(){e=F("div"),r&&r.c(),n=B(),i&&i.c(),o=B(),a&&a.c(),y(e,"class","display-area"),y(e,"id",t[3])},m(f,s){x(f,e,s),r&&r.m(e,null),G(e,n),i&&i.m(e,null),G(e,o),a&&a.m(e,null)},p(f,s){f[0]?r?r.p(f,s):(r=go(f),r.c(),r.m(e,n)):r&&(r.d(1),r=null),f[1]?i?(i.p(f,s),s[0]&2&&M(i,1)):(i=vo(f),i.c(),M(i,1),i.m(e,o)):i&&(J(),D(i,1,1,()=>{i=null}),Y()),f[2]?a?a.p(f,s):(a=Co(f),a.c(),a.m(e,null)):a&&(a.d(1),a=null),s[0]&8&&y(e,"id",f[3])},i(f){M(i)},o(f){D(i)},d(f){f&&k(e),r&&r.d(),i&&i.d(),a&&a.d()}}}function Ei(t,e,n){let o,r,i,a,f,s,c,u,l,p,d,g,m,v,w,h,{id:b}=e,C=z("rollOverlayPostRollEnabled");L(t,C,O=>n(14,u=O));let I=z("rollOverlayPreRollEnabled");L(t,I,O=>n(18,g=O));let P=z("rollOverlayPreRollDelay");L(t,P,O=>n(13,c=O));let _=z("rollOverlayPreRollStay");L(t,_,O=>n(11,f=O));let N=z("rollOverlayPreRollFadeIn");L(t,N,O=>n(12,s=O));let R=z("rollOverlayPreRollFadeOut");L(t,R,O=>n(10,a=O));let q=u?c+s+f+a:0,X=z("rollOverlayRollStay");L(t,X,O=>n(8,r=O));let it=z("rollOverlayRollFadeIn");L(t,it,O=>n(9,i=O));let Tt=z("rollOverlayRollFadeOut");L(t,Tt,O=>n(7,o=O));let ee=q+i+r+o,ne=z("rollOverlayPostRollStay");L(t,ne,O=>n(21,w=O));let oe=z("rollOverlayPostRollFadeIn");L(t,oe,O=>n(20,v=O));let Bt=z("rollOverlayPostRollFadeOut");L(t,Bt,O=>n(22,h=O));function pt(){n(5,q=u?c+s+f+a:0)}P.subscribe(pt),N.subscribe(pt),_.subscribe(pt),R.subscribe(pt),C.subscribe(pt);function ke(){n(6,ee=q+i+r+o)}it.subscribe(ke),X.subscribe(ke),Tt.subscribe(ke);let Qe=z("rollOverlayPreRollImage");L(t,Qe,O=>n(15,l=O));let tn=z("rollOverlayRollBackground");L(t,tn,O=>n(16,p=O));let en=z("rollOverlayRollForeground");L(t,en,O=>n(17,d=O));let nn=z("rollOverlayPostRollImage");L(t,nn,O=>n(19,m=O));let{rollValue:on="0"}=e,{preRollShow:$e=!1}=e,{rollShow:xe=!1}=e,{postRollShow:Se=!1}=e;const Bo=()=>n(0,$e=!1),Lo=()=>n(1,xe=!1),Vo=()=>n(2,Se=!1);return t.$$set=O=>{"id"in O&&n(3,b=O.id),"rollValue"in O&&n(4,on=O.rollValue),"preRollShow"in O&&n(0,$e=O.preRollShow),"rollShow"in O&&n(1,xe=O.rollShow),"postRollShow"in O&&n(2,Se=O.postRollShow)},[$e,xe,Se,b,on,q,ee,o,r,i,a,f,s,c,u,l,p,d,g,m,v,w,h,C,I,P,_,N,R,X,it,Tt,ne,oe,Bt,Qe,tn,en,nn,Bo,Lo,Vo]}class $o extends U{constructor(e){super(),V(this,e,Ei,Oi,j,{id:3,rollValue:4,preRollShow:0,rollShow:1,postRollShow:2},null,[-1,-1])}}function Ai(t){let e,n,o,r,i,a;function f(p){t[3](p)}function s(p){t[4](p)}function c(p){t[5](p)}function u(p){t[6](p)}let l={id:t[0]};return t[1]!==void 0&&(l.postRollShow=t[1]),t[1]!==void 0&&(l.preRollShow=t[1]),t[1]!==void 0&&(l.rollShow=t[1]),t[2]!==void 0&&(l.rollValue=t[2]),e=new $o({props:l}),dt.push(()=>Jt(e,"postRollShow",f)),dt.push(()=>Jt(e,"preRollShow",s)),dt.push(()=>Jt(e,"rollShow",c)),dt.push(()=>Jt(e,"rollValue",u)),{c(){ct(e.$$.fragment)},m(p,d){rt(e,p,d),a=!0},p(p,[d]){const g={};d&1&&(g.id=p[0]),!n&&d&2&&(n=!0,g.postRollShow=p[1],Wt(()=>n=!1)),!o&&d&2&&(o=!0,g.preRollShow=p[1],Wt(()=>o=!1)),!r&&d&2&&(r=!0,g.rollShow=p[1],Wt(()=>r=!1)),!i&&d&4&&(i=!0,g.rollValue=p[2],Wt(()=>i=!1)),e.$set(g)},i(p){a||(M(e.$$.fragment,p),a=!0)},o(p){D(e.$$.fragment,p),a=!1},d(p){st(e,p)}}}function Fi(t,e,n){let{id:o}=e,r=!1,i,a=Hooks.on("createChatMessage",l=>{l.user.id===o&&l.whisper.length===0&&(n(2,i=l.roll.result),n(1,r=!1),n(1,r=!0))});nt(()=>{Hooks.off("createChatMessage",a)});function f(l){r=l,n(1,r)}function s(l){r=l,n(1,r)}function c(l){r=l,n(1,r)}function u(l){i=l,n(2,i)}return t.$$set=l=>{"id"in l&&n(0,o=l.id)},[o,r,i,f,s,c,u]}class Mi extends U{constructor(e){super(),V(this,e,Fi,Ai,j,{id:0})}}function xo(t,e,n){const o=t.slice();return o[1]=e[n],o}function So(t){let e,n;return e=new Mi({props:{id:t[1]}}),{c(){ct(e.$$.fragment)},m(o,r){rt(e,o,r),n=!0},p:S,i(o){n||(M(e.$$.fragment,o),n=!0)},o(o){D(e.$$.fragment,o),n=!1},d(o){st(e,o)}}}function Ni(t){let e,n,o=T(t[0]),r=[];for(let a=0;a<o.length;a+=1)r[a]=So(xo(t,o,a));const i=a=>D(r[a],1,1,()=>{r[a]=null});return{c(){e=F("div");for(let a=0;a<r.length;a+=1)r[a].c();y(e,"class","obs-utils roll-overlay")},m(a,f){x(a,e,f);for(let s=0;s<r.length;s+=1)r[s]&&r[s].m(e,null);n=!0},p(a,[f]){if(f&1){o=T(a[0]);let s;for(s=0;s<o.length;s+=1){const c=xo(a,o,s);r[s]?(r[s].p(c,f),M(r[s],1)):(r[s]=So(c),r[s].c(),M(r[s],1),r[s].m(e,null))}for(J(),s=o.length;s<r.length;s+=1)i(s);Y()}},i(a){if(!n){for(let f=0;f<o.length;f+=1)M(r[f]);n=!0}},o(a){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)D(r[f]);n=!1},d(a){a&&k(e),ut(r,a)}}}function Pi(t){return[game.users.filter(e=>e.id!==game.user.id).map(e=>e.id)]}class Ri extends U{constructor(e){super(),V(this,e,Pi,Ni,j,{})}}function _o(t){let e=t[4]()+"",n;return{c(){n=W(e)},m(o,r){x(o,n,r)},p:S,d(o){o&&k(n)}}}function Di(t){let e=t[0],n,o,r,i,a,f=_o(t);return{c(){f.c(),n=B(),o=F("div"),r=F("img"),y(r,"alt","actor value img renderer"),H(r.src,i=t[3])||y(r,"src",i),y(o,"class","component actor-val-component image-component"),y(o,"id",a="component"+t[2].toString()),y(o,"style",t[1])},m(s,c){f.m(s,c),x(s,n,c),x(s,o,c),G(o,r)},p(s,[c]){c&1&&j(e,e=s[0])?(f.d(1),f=_o(s),f.c(),f.m(n.parentNode,n)):f.p(s,c),c&8&&!H(r.src,i=s[3])&&y(r,"src",i),c&4&&a!==(a="component"+s[2].toString())&&y(o,"id",a),c&2&&y(o,"style",s[1])},i:S,o:S,d(s){s&&(k(n),k(o)),f.d(s)}}}function ji(t,e,n){let{data:o=""}=e,{actorID:r=void 0}=e,{style:i}=e,{componentIndex:a}=e,f=game.actors?.get(r),s="",c=Hooks.on("obs-utils.refreshActor",l=>{l.id===r&&(f=l,u())});function u(){return we(f,o)?n(3,s=at(f,o,"")):n(3,s=o!=null?me(o):""),""}return nt(()=>{Hooks.off("obs-utils.refreshActor",c)}),t.$$set=l=>{"data"in l&&n(0,o=l.data),"actorID"in l&&n(5,r=l.actorID),"style"in l&&n(1,i=l.style),"componentIndex"in l&&n(2,a=l.componentIndex)},[o,i,a,s,u,r]}class Io extends U{constructor(e){super(),V(this,e,ji,Di,j,{data:0,actorID:5,style:1,componentIndex:2})}}function Oo(t,e,n){const o=t.slice();return o[12]=e[n],o}function Eo(t,e,n){const o=t.slice();return o[12]=e[n],o}function Ao(t){let e=t[7]()+"",n,o,r=t[8]()+"",i;return{c(){n=W(e),o=B(),i=W(r)},m(a,f){x(a,n,f),x(a,o,f),x(a,i,f)},p:S,d(a){a&&(k(n),k(o),k(i))}}}function Fo(t){let e,n;return{c(){e=F("i"),y(e,"class",n=t[5]+" icon-"+t[12])},m(o,r){x(o,e,r)},p(o,r){r&40&&n!==(n=o[5]+" icon-"+o[12])&&y(e,"class",n)},d(o){o&&k(e)}}}function Mo(t){let e,n;return{c(){e=F("i"),y(e,"class",n=t[6]+" icon-"+(t[3]+t[12]))},m(o,r){x(o,e,r)},p(o,r){r&88&&n!==(n=o[6]+" icon-"+(o[3]+o[12]))&&y(e,"class",n)},d(o){o&&k(e)}}}function Hi(t){let e=t[0],n,o,r,i,a=Ao(t),f=T([...Array(t[3]).keys()]),s=[];for(let l=0;l<f.length;l+=1)s[l]=Fo(Eo(t,f,l));let c=T([...Array(t[4]).keys()]),u=[];for(let l=0;l<c.length;l+=1)u[l]=Mo(Oo(t,c,l));return{c(){a.c(),n=B(),o=F("div");for(let l=0;l<s.length;l+=1)s[l].c();r=B();for(let l=0;l<u.length;l+=1)u[l].c();y(o,"class","component actor-val-component multi-icon-component"),y(o,"id",i="component"+t[2].toString()),y(o,"style",t[1])},m(l,p){a.m(l,p),x(l,n,p),x(l,o,p);for(let d=0;d<s.length;d+=1)s[d]&&s[d].m(o,null);G(o,r);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(o,null)},p(l,[p]){if(p&1&&j(e,e=l[0])?(a.d(1),a=Ao(l),a.c(),a.m(n.parentNode,n)):a.p(l,p),p&40){f=T([...Array(l[3]).keys()]);let d;for(d=0;d<f.length;d+=1){const g=Eo(l,f,d);s[d]?s[d].p(g,p):(s[d]=Fo(g),s[d].c(),s[d].m(o,r))}for(;d<s.length;d+=1)s[d].d(1);s.length=f.length}if(p&88){c=T([...Array(l[4]).keys()]);let d;for(d=0;d<c.length;d+=1){const g=Oo(l,c,d);u[d]?u[d].p(g,p):(u[d]=Mo(g),u[d].c(),u[d].m(o,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}p&4&&i!==(i="component"+l[2].toString())&&y(o,"id",i),p&2&&y(o,"style",l[1])},i:S,o:S,d(l){l&&(k(n),k(o)),a.d(l),ut(s,l),ut(u,l)}}}function Ti(t,e,n){let{data:o=""}=e,{actorID:r}=e,{style:i}=e,{componentIndex:a}=e,f=game.actors?.get(r),s="",c="",u="",l="",p=Hooks.on("obs-utils.refreshActor",m=>{m.id===r&&d()});function d(){return n(3,s=at(f,o.split(";")[0],"")),n(4,c=at(f,o.split(";")[2],"")-s),(isNaN(c)||c<0)&&n(4,c=0),""}function g(){return n(5,u=o.split(";")[1]),n(6,l=o.split(";")[3]),""}return nt(()=>{Hooks.off("obs-utils.refreshActor",p)}),t.$$set=m=>{"data"in m&&n(0,o=m.data),"actorID"in m&&n(9,r=m.actorID),"style"in m&&n(1,i=m.style),"componentIndex"in m&&n(2,a=m.componentIndex)},[o,i,a,s,c,u,l,d,g,r]}class Bi extends U{constructor(e){super(),V(this,e,Ti,Hi,j,{data:0,actorID:9,style:1,componentIndex:2})}}function No(t,e,n){const o=t.slice();return o[12]=e[n],o}function Po(t,e,n){const o=t.slice();return o[12]=e[n],o}function Ro(t){let e=t[7]()+"",n,o,r=t[8]()+"",i;return{c(){n=W(e),o=B(),i=W(r)},m(a,f){x(a,n,f),x(a,o,f),x(a,i,f)},p:S,d(a){a&&(k(n),k(o),k(i))}}}function Do(t){let e,n,o;return{c(){e=F("img"),y(e,"alt",n="actor value multi img renderer image-"+t[12]),H(e.src,o=t[5])||y(e,"src",o)},m(r,i){x(r,e,i)},p(r,i){i&8&&n!==(n="actor value multi img renderer image-"+r[12])&&y(e,"alt",n),i&32&&!H(e.src,o=r[5])&&y(e,"src",o)},d(r){r&&k(e)}}}function jo(t){let e,n,o;return{c(){e=F("img"),y(e,"alt",n="actor value multi img renderer image-"+(t[3]+t[12])),H(e.src,o=t[6])||y(e,"src",o)},m(r,i){x(r,e,i)},p(r,i){i&24&&n!==(n="actor value multi img renderer image-"+(r[3]+r[12]))&&y(e,"alt",n),i&64&&!H(e.src,o=r[6])&&y(e,"src",o)},d(r){r&&k(e)}}}function Li(t){let e=t[0],n,o,r,i,a=Ro(t),f=T([...Array(t[3]).keys()]),s=[];for(let l=0;l<f.length;l+=1)s[l]=Do(Po(t,f,l));let c=T([...Array(t[4]).keys()]),u=[];for(let l=0;l<c.length;l+=1)u[l]=jo(No(t,c,l));return{c(){a.c(),n=B(),o=F("div");for(let l=0;l<s.length;l+=1)s[l].c();r=B();for(let l=0;l<u.length;l+=1)u[l].c();y(o,"class","component actor-val-component multi-image-component"),y(o,"id",i="component"+t[2].toString()),y(o,"style",t[1])},m(l,p){a.m(l,p),x(l,n,p),x(l,o,p);for(let d=0;d<s.length;d+=1)s[d]&&s[d].m(o,null);G(o,r);for(let d=0;d<u.length;d+=1)u[d]&&u[d].m(o,null)},p(l,[p]){if(p&1&&j(e,e=l[0])?(a.d(1),a=Ro(l),a.c(),a.m(n.parentNode,n)):a.p(l,p),p&40){f=T([...Array(l[3]).keys()]);let d;for(d=0;d<f.length;d+=1){const g=Po(l,f,d);s[d]?s[d].p(g,p):(s[d]=Do(g),s[d].c(),s[d].m(o,r))}for(;d<s.length;d+=1)s[d].d(1);s.length=f.length}if(p&88){c=T([...Array(l[4]).keys()]);let d;for(d=0;d<c.length;d+=1){const g=No(l,c,d);u[d]?u[d].p(g,p):(u[d]=jo(g),u[d].c(),u[d].m(o,null))}for(;d<u.length;d+=1)u[d].d(1);u.length=c.length}p&4&&i!==(i="component"+l[2].toString())&&y(o,"id",i),p&2&&y(o,"style",l[1])},i:S,o:S,d(l){l&&(k(n),k(o)),a.d(l),ut(s,l),ut(u,l)}}}function Vi(t,e,n){let{data:o=""}=e,{actorID:r}=e,{style:i}=e,{componentIndex:a}=e,f=game.actors?.get(r),s="",c="",u="",l="",p=Hooks.on("obs-utils.refreshActor",m=>{m.id===r&&d()});function d(){return n(3,s=at(f,o.split(";")[0],"")),n(4,c=at(f,o.split(";")[2],"")-s),(isNaN(c)||c<0)&&n(4,c=0),""}function g(){return n(5,u=o.split(";")[1]),n(6,l=o.split(";")[3]),""}return nt(()=>{Hooks.off("obs-utils.refreshActor",p)}),t.$$set=m=>{"data"in m&&n(0,o=m.data),"actorID"in m&&n(9,r=m.actorID),"style"in m&&n(1,i=m.style),"componentIndex"in m&&n(2,a=m.componentIndex)},[o,i,a,s,c,u,l,d,g,r]}class Ui extends U{constructor(e){super(),V(this,e,Vi,Li,j,{data:0,actorID:9,style:1,componentIndex:2})}}function Ho(t){let e=t[5]()+"",n;return{c(){n=W(e)},m(o,r){x(o,n,r)},p:S,d(o){o&&k(n)}}}function zi(t){let e=t[0],n,o,r,i,a=Ho(t);return{c(){a.c(),n=B(),o=F("div"),r=F("progress"),r.value=t[3],y(r,"max",t[4]),y(o,"class","component actor-val-component progress-bar-component"),y(o,"id",i="component"+t[2].toString()),y(o,"style",t[1])},m(f,s){a.m(f,s),x(f,n,s),x(f,o,s),G(o,r)},p(f,[s]){s&1&&j(e,e=f[0])?(a.d(1),a=Ho(f),a.c(),a.m(n.parentNode,n)):a.p(f,s),s&8&&(r.value=f[3]),s&16&&y(r,"max",f[4]),s&4&&i!==(i="component"+f[2].toString())&&y(o,"id",i),s&2&&y(o,"style",f[1])},i:S,o:S,d(f){f&&(k(n),k(o)),a.d(f)}}}function qi(t,e,n){let{data:o=""}=e,{actorID:r}=e,{style:i}=e,{componentIndex:a}=e,f=game.actors?.get(r),s="",c="",u=Hooks.on("obs-utils.refreshActor",p=>{p.id===r&&(f=p,l())});function l(){let p=o.split(";")[0];we(f,p)?n(3,s=at(f,p,"")):n(3,s=p!=null?me(p):"");let d=o.split(";")[1];return we(f,d)?n(4,c=at(f,d,"")):n(4,c=d!=null?me(d):""),""}return nt(()=>{Hooks.off("obs-utils.refreshActor",u)}),t.$$set=p=>{"data"in p&&n(0,o=p.data),"actorID"in p&&n(6,r=p.actorID),"style"in p&&n(1,i=p.style),"componentIndex"in p&&n(2,a=p.componentIndex)},[o,i,a,s,c,l,r]}class Wi extends U{constructor(e){super(),V(this,e,qi,zi,j,{data:0,actorID:6,style:1,componentIndex:2})}}function To(t){let e=t[6]()+"",n;return{c(){n=W(e)},m(o,r){x(o,n,r)},p:S,d(o){o&&k(n)}}}function Gi(t){let e,n;return{c(){e=F("img"),y(e,"alt","actor value img renderer"),H(e.src,n=t[5])||y(e,"src",n)},m(o,r){x(o,e,r)},p(o,r){r&32&&!H(e.src,n=o[5])&&y(e,"src",n)},d(o){o&&k(e)}}}function Ji(t){let e,n;return{c(){e=F("img"),y(e,"alt","actor value img renderer"),H(e.src,n=t[4])||y(e,"src",n)},m(o,r){x(o,e,r)},p(o,r){r&16&&!H(e.src,n=o[4])&&y(e,"src",n)},d(o){o&&k(e)}}}function Yi(t){let e=t[0],n,o,r,i=To(t);function a(c,u){if(c[3]&&c[4]!=="")return Ji;if(!c[3]&&c[5]!=="")return Gi}let f=a(t),s=f&&f(t);return{c(){i.c(),n=B(),o=F("div"),s&&s.c(),y(o,"class","component actor-val-component bool-component image-component"),y(o,"id",r="component"+t[2].toString()),y(o,"style",t[1])},m(c,u){i.m(c,u),x(c,n,u),x(c,o,u),s&&s.m(o,null)},p(c,[u]){u&1&&j(e,e=c[0])?(i.d(1),i=To(c),i.c(),i.m(n.parentNode,n)):i.p(c,u),f===(f=a(c))&&s?s.p(c,u):(s&&s.d(1),s=f&&f(c),s&&(s.c(),s.m(o,null))),u&4&&r!==(r="component"+c[2].toString())&&y(o,"id",r),u&2&&y(o,"style",c[1])},i:S,o:S,d(c){c&&(k(n),k(o)),i.d(c),s&&s.d()}}}function Xi(t,e,n){let{data:o}=e,{actorID:r}=e,{style:i}=e,{componentIndex:a}=e,f=game.actors?.get(r),s="",c="",u="",l=Hooks.on("obs-utils.refreshActor",d=>{d.id===r&&p()});function p(){return n(3,s=at(f,o.split(";")[0],"")),n(4,c=o.split(";")[1]??"fa-solid fa-check"),n(5,u=o.split(";")[2]??"fa-solid fa-x"),""}return nt(()=>{Hooks.off("obs-utils.refreshActor",l)}),t.$$set=d=>{"data"in d&&n(0,o=d.data),"actorID"in d&&n(7,r=d.actorID),"style"in d&&n(1,i=d.style),"componentIndex"in d&&n(2,a=d.componentIndex)},[o,i,a,s,c,u,p,r]}class Ki extends U{constructor(e){super(),V(this,e,Xi,Yi,j,{data:0,actorID:7,style:1,componentIndex:2})}}class Zi{actorValues=[];constructor(){this.overlayTypes=new Map,this.overlayTypeNames=new Map,this.singleInstanceOverlays=new Set}registerOverlayType(e,n,o){this.overlayTypes.set(e,o),this.overlayTypeNames.set(e,n)}registerUniqueOverlay(e){this.singleInstanceOverlays.add(e)}getSelectedActors(){return A("overlayActors")}async setSelectedActors(e){await Mt("overlayActors",e)}setAVData(e){as(e)}}class Qi{overlayEditor;constructor(e){this.overlayComponents=new Map,this.overlayClass=e,this.overlayComponentNames=new Map,this.overlayComponentEditors=new Map,this.compactEditorButtons=new Map}registerOverlayEditor(e){this.overlayEditor=e}registerComponent(e,n,o){this.overlayComponents.set(e,o),this.overlayComponentNames.set(e,n)}registerComponentEditor(e,n,o=!1){this.overlayComponentEditors.set(e,n),this.compactEditorButtons.set(e,o)}}function tc(){const t=new Qi(Us);t.registerComponent("pt","Plain Text",Ce),t.registerComponent("fai","Font Awesome Icon",Zn),t.registerComponent("bav","Boolean AV Icon",mo),t.registerComponent("bavimg","Boolean AV Image",Ki),t.registerComponent("img","Image",Io),t.registerComponent("micoav","Multi Icon AV",Bi),t.registerComponent("mimgav","Multi Image AV",Ui),t.registerComponent("pb","Progress Bar",Wi),t.overlayComponents.set("Plain Text",Ce),t.overlayComponents.set("Font Awesome Icon",Zn),t.overlayComponents.set("Actor Value",Ce),t.overlayComponents.set("Boolean Actor Value",mo),t.overlayComponents.set("iav",Io),t.overlayComponents.set("av",Ce),yt().registerOverlayType("sl","Single Line",t),yt().overlayTypes.set("Single Line",t),yt().registerUniqueOverlay(Ri)}Hooks.once("init",()=>{game.socket.on("module.obs-utils",ec)});async function ec({eventType:t,targetUser:e,payload:n}){e&&game.userId!==e||(t==="viewport"?rc(n):t==="websocketSettings"&&await nc(n))}async function nc(t){await Mt("websocketSettings",t),foundry.utils.debouncedReload()}function oc(t,e){game.socket.emit("module.obs-utils",{eventType:"websocketSettings",targetUser:t,payload:e})}function rc({viewport:t,userId:e}){Nt()&&(kt.set(e,t),Ie(e))}function sc(t,e){game.socket.emit("module.obs-utils",{eventType:"viewport",targetUser:void 0,payload:{viewport:e,userId:Ko()}})}function ac(){Hooks.once("init",async function(){const t=game?.modules?.get("obs-utils");if(t&&(t.api=new Zi,tc(),Hooks.call("obs-utils.init")),ns(),os(),game.view==="game"){const e=await import("./ui-C9-cmR-L.js");e.registerUI(),Hooks.once("ready",()=>e.showNotifications())}Nt()&&Hs()}),Hooks.once("ready",async function(){Qo()&&(Hooks.on("renderTokenHUD",tr),ts()),Nt()&&document.dispatchEvent(new KeyboardEvent("keydown",{key:"a"})),game.settings.settings.get("obs-utils.obsModeUser").choices=Object.fromEntries([["none","None"]].concat(game.users.filter(t=>!t.isGM||game.users.filter(e=>e.isGM).length>1).map(t=>[t.id,t.name])))}),Hooks.on("canvasPan",sc),Hooks.on("updateActor",t=>Hooks.call("obs-utils.refreshActor",t)),Hooks.on("getSceneControlButtons",ic)}ac();function ic(t){if(!game.user?.isGM)return;const e=t.find(o=>o.name==="token"),n={icon:"fa-solid fa-signal-stream",name:"openStreamDirector",title:"Open Stream Director",toggle:!0,onClick:async()=>{await(await import("./ui-C9-cmR-L.js")).openDirector(n)}};e?.tools.push(n)}export{Hr as $,D as A,ft as B,ct as C,rt as D,st as E,Xr as F,Le as G,Yr as H,ar as I,ho as J,Vt as K,De as L,Fr as M,vr as N,gt as O,yr as P,mr as Q,S as R,U as S,Mr as T,Tr as U,L as V,_r as W,H as X,Ut as Y,se as Z,dt as _,F as a,xn as a0,ir as a1,lr as a2,ur as a3,cr as a4,Et as a5,At as a6,Zr as a7,nt as a8,Lr as a9,Ii as aA,Ct as aB,kn as aa,wr as ab,fr as ac,jr as ad,Dr as ae,Br as af,Jt as ag,Wt as ah,A as ai,Mt as aj,es as ak,oc as al,$r as am,Cr as an,Ar as ao,z as ap,pr as aq,dr as ar,yt as as,Ns as at,Ms as au,Wn as av,qr as aw,kr as ax,ss as ay,$o as az,B as b,y as c,K as d,T as e,x as f,G as g,Ir as h,V as i,Sr as j,lt as k,xt as l,zr as m,k as n,ut as o,Me as p,Q as q,et as r,j as s,W as t,Or as u,J as v,Be as w,Te as x,Y as y,M as z};
//# sourceMappingURL=index-B-TggPxp.js.map
