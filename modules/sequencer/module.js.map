{"version":3,"file":"module.js","sources":["src/constants.js","src/canvas-effects/ease.js","src/lib/lib.js","node_modules/svelte/src/runtime/internal/utils.js","node_modules/svelte/src/runtime/internal/environment.js","node_modules/svelte/src/runtime/internal/loop.js","node_modules/svelte/src/runtime/internal/dom.js","node_modules/svelte/src/runtime/internal/style_manager.js","node_modules/svelte/src/runtime/internal/lifecycle.js","node_modules/svelte/src/runtime/internal/scheduler.js","node_modules/svelte/src/runtime/internal/transitions.js","node_modules/svelte/src/runtime/internal/each.js","node_modules/svelte/src/runtime/internal/spread.js","node_modules/svelte/src/runtime/internal/Component.js","node_modules/svelte/src/shared/version.js","node_modules/svelte/src/runtime/store/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/writable-derived/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/object/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/store/index.js","node_modules/svelte/src/runtime/easing/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/math/interpolate/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/browser/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/math/gl-matrix/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/util/animate/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/math/util/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/position/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/util/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/state-app/ApplicationState.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/state-svelte/GetSvelteData.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/store/web-storage/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/state-reactive/SvelteReactive.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/util/applicationShellContract.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/util/isApplicationShell.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/util/loadSvelteConfig.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/internal/TJSAppIndex.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/SvelteApplication.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/cssVariables.js","node_modules/svelte/src/runtime/internal/disclose-version/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/action/dom/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/transition/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/AppShellContextInternal.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/helper/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSHeaderButton.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSApplicationHeader.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/TJSFocusWrap.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/ResizableHandle.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/application/ApplicationShell.svelte","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/component/core/index.js","node_modules/@typhonjs-fvtt/runtime/_dist/svelte/application/index.js","src/utils/loadingBar.js","src/lib/filters/color-matrix-filter.js","src/lib/filters/blur-filter.js","src/lib/filters/noise-filter.js","src/lib/filters/glow-filter.js","src/lib/filters/clip-filter.js","src/lib/filters.js","src/modules/sequencer-animation-engine.js","src/modules/sequence-manager.js","src/formapplications/effects-ui/HowTo.svelte","src/formapplications/effects-ui/Tabs.svelte","src/formapplications/effects-ui/effect-player-store.js","src/modules/sequencer-interaction-manager.js","src/formapplications/effects-ui/components/EffectEntry.svelte","src/formapplications/effects-ui/components/SoundEntry.svelte","src/formapplications/effects-ui/Manager.svelte","src/formapplications/effects-ui/components/SliderInput.svelte","src/formapplications/effects-ui/components/Checkbox.svelte","src/formapplications/effects-ui/components/NumberInput.svelte","src/formapplications/effects-ui/components/SwitchToggle.svelte","src/formapplications/effects-ui/Player.svelte","src/formapplications/effects-ui/components/SequenceStatus.svelte","src/formapplications/effects-ui/components/SequenceSection.svelte","src/formapplications/effects-ui/components/Sequence.svelte","src/formapplications/effects-ui/Sequences.svelte","src/formapplications/effects-ui/effects-ui-shell.svelte","src/formapplications/effects-ui/effects-ui-app.js","src/modules/sequencer-effect-manager.js","src/canvas-effects/effects-layer.js","src/lib/filters/vision-mask-filter.js","src/lib/filters/mask-filter.js","src/canvas-effects/canvas-effect.js","src/lib/canvas-lib.js","src/utils/flag-manager.js","src/modules/sequencer-foundry-replicator.js","src/modules/sequencer-preloader.js","src/sockets.js","src/modules/sequencer-sound-manager.js","src/modules/sequencer-file-cache.js","src/modules/sequencer-file.js","src/modules/sequencer-database.js","src/formapplications/database/TreeViewEntry.svelte","src/formapplications/database/TreeViewSeparator.svelte","src/formapplications/database/DatabaseStore.js","src/formapplications/database/DatabaseEntry.svelte","node_modules/svelte-virtual-scroll-list/dist/virtual.js","node_modules/svelte-virtual-scroll-list/dist/Item.svelte","node_modules/svelte-virtual-scroll-list/dist/VirtualScroll.svelte","src/formapplications/database/database-shell.svelte","src/formapplications/database/database-viewer-app.js","src/settings.js","src/layers.js","src/hotkeys.js","typings/typings.js","src/modules/sequencer-presets.js","src/sections/section.js","src/sections/func.js","src/sections/traits/animation.js","src/sections/traits/audio.js","src/sections/traits/files.js","src/sections/traits/moves.js","src/sections/traits/opacity.js","src/sections/traits/rotation.js","src/sections/traits/scale.js","src/sections/traits/time.js","src/sections/traits/users.js","src/sections/traits/filter.js","src/sections/traits/tint.js","src/sections/traits/location.js","src/sections/traits/offset.js","src/sections/traits/text.js","src/sections/traits/name.js","src/sections/traits/_traits.js","src/sections/effect.js","src/sections/sound.js","src/sections/animation.js","src/sections/scrollingText.js","src/sections/canvasPan.js","src/sections/wait.js","src/modules/sequencer.js","src/modules/sequencer-section-manager.js","src/lib/libWrapper/shim.js","src/libwrapper.js","src/migrations.js","src/module.js"],"sourcesContent":["const CONSTANTS = {\n  MODULE_NAME: \"sequencer\",\n  EFFECTS_FLAG_NAME: \"effects\",\n  SOUNDS_FLAG_NAME: \"sounds\",\n\tIS_V12: false,\n  COLOR: {\n    PRIMARY: 0xee442f,\n    SECONDARY: 0x601a4a,\n    TERTIARY: 0x601a4a,\n  },\n  SHAPES: {\n    POLY: \"polygon\",\n    RECT: \"rectangle\",\n    CIRC: \"circle\",\n    ELIP: \"ellipse\",\n    RREC: \"roundedRect\",\n  },\n  FEET_REGEX: new RegExp(/\\.[0-9]+ft\\.*/g),\n  ARRAY_REGEX: new RegExp(/\\.[0-9]$/g),\n  STATUS: {\n    READY: 0,\n    RUNNING: 1,\n    COMPLETE: 2,\n    SKIPPED: 3,\n    ABORTED: 4,\n  },\n};\n\nCONSTANTS.INTEGRATIONS = {};\nCONSTANTS.INTEGRATIONS.ISOMETRIC = {};\nCONSTANTS.INTEGRATIONS.ISOMETRIC.ACTIVE = false;\nCONSTANTS.INTEGRATIONS.ISOMETRIC.MODULE_NAME = \"grape_juice-isometrics\";\nCONSTANTS.INTEGRATIONS.ISOMETRIC.SCENE_ENABLED = `flags.${CONSTANTS.INTEGRATIONS.ISOMETRIC.MODULE_NAME}.is_isometric`;\nCONSTANTS.INTEGRATIONS.ISOMETRIC.PROJECTION_FLAG = `flags.${CONSTANTS.INTEGRATIONS.ISOMETRIC.MODULE_NAME}.original_image_projection_type`;\nCONSTANTS.INTEGRATIONS.ISOMETRIC.PROJECTION_TYPES = {\n  TOPDOWN: \"topdown\",\n  TRUE: \"true_isometric\",\n  DIAMETRIC: \"diametric\",\n};\nCONSTANTS.INTEGRATIONS.ISOMETRIC.ISOMETRIC_CONVERSION = Math.sqrt(3);\nCONSTANTS.INTEGRATIONS.ISOMETRIC.DIMETRIC_CONVERSION =\n  2 / CONSTANTS.INTEGRATIONS.ISOMETRIC.ISOMETRIC_CONVERSION;\nCONSTANTS.INTEGRATIONS.ISOMETRIC.DUNGEON_BUILDER_CONVERSION =\n  278 / 154 / CONSTANTS.INTEGRATIONS.ISOMETRIC.ISOMETRIC_CONVERSION;\n\nCONSTANTS.EFFECTS_FLAG = `flags.${CONSTANTS.MODULE_NAME}.${CONSTANTS.EFFECTS_FLAG_NAME}`;\nCONSTANTS.SOUNDS_FLAG = `flags.${CONSTANTS.MODULE_NAME}.${CONSTANTS.SOUNDS_FLAG_NAME}`;\n\nexport default CONSTANTS;\n","import * as lib from \"../lib/lib.js\";\n\nexport function registerEase(easeName, easeFunction, overwrite = false) {\n  if (typeof easeName !== \"string\")\n    throw lib.custom_error(\"registerEase\", \"easeName must be of type string\");\n  if (!lib.is_function(easeFunction))\n    throw lib.custom_error(\n      \"registerEase\",\n      \"easeFunction must be of type function\"\n    );\n  if (easeFunctions[easeName] !== undefined && !overwrite) return;\n  lib.debug(`registerEase | Registered ease function: ${easeName}`);\n  easeFunctions[easeName] = easeFunction;\n}\n\nexport const easeFunctions = {\n  linear: linear,\n  easeInSine: easeInSine,\n  easeOutSine: easeOutSine,\n  easeInOutSine: easeInOutSine,\n  easeInQuad: easeInQuad,\n  easeOutQuad: easeOutQuad,\n  easeInOutQuad: easeInOutQuad,\n  easeInCubic: easeInCubic,\n  easeOutCubic: easeOutCubic,\n  easeInOutCubic: easeInOutCubic,\n  easeInQuart: easeInQuart,\n  easeOutQuart: easeOutQuart,\n  easeInOutQuart: easeInOutQuart,\n  easeInQuint: easeInQuint,\n  easeOutQuint: easeOutQuint,\n  easeInOutQuint: easeInOutQuint,\n  easeInExpo: easeInExpo,\n  easeOutExpo: easeOutExpo,\n  easeInOutExpo: easeInOutExpo,\n  easeInCirc: easeInCirc,\n  easeOutCirc: easeOutCirc,\n  easeInOutCirc: easeInOutCirc,\n  easeInBack: easeInBack,\n  easeOutBack: easeOutBack,\n  easeInOutBack: easeInOutBack,\n  easeInElastic: easeInElastic,\n  easeOutElastic: easeOutElastic,\n  easeInOutElastic: easeInOutElastic,\n  easeInBounce: easeInBounce,\n  easeOutBounce: easeOutBounce,\n  easeInOutBounce: easeInOutBounce,\n};\n\nexport const EASE = {\n  LINEAR: \"linear\",\n  SINE_IN: \"easeInSine\",\n  SINE_OUT: \"easeOutSine\",\n  SINE_IN_OUT: \"easeInOutSine\",\n  QUAD_IN: \"easeInQuad\",\n  QUAD_OUT: \"easeOutQuad\",\n  QUAD_IN_OUT: \"easeInOutQuad\",\n  CUBIC_IN: \"easeInCubic\",\n  CUBIC_OUT: \"easeOutCubic\",\n  CUBIC_IN_OUT: \"easeInOutCubic\",\n  QUART_IN: \"easeInQuart\",\n  QUART_OUT: \"easeOutQuart\",\n  QUART_IN_OUT: \"easeInOutQuart\",\n  QUINT_IN: \"easeInQuint\",\n  QUINT_OUT: \"easeOutQuint\",\n  QUINT_IN_OUT: \"easeInOutQuint\",\n  EXPO_IN: \"easeInExpo\",\n  EXPO_OUT: \"easeOutExpo\",\n  EXPO_IN_OUT: \"easeInOutExpo\",\n  CIRC_IN: \"easeInCirc\",\n  CIRC_OUT: \"easeOutCirc\",\n  CIRC_IN_OUT: \"easeInOutCirc\",\n  BACK_IN: \"easeInBack\",\n  BACK_OUT: \"easeOutBack\",\n  BACK_IN_OUT: \"easeInOutBack\",\n  ELASTIC_IN: \"easeInElastic\",\n  ELASTIC_OUT: \"easeOutElastic\",\n  ELASTIC_IN_OUT: \"easeInOutElastic\",\n  BOUNCE_IN: \"easeInBounce\",\n  BOUNCE_OUT: \"easeOutBounce\",\n  BOUNCE_IN_OUT: \"easeInOutBounce\",\n};\n\nfunction linear(x) {\n  return x;\n}\n\nfunction easeInSine(x) {\n  return 1 - Math.cos((x * Math.PI) / 2);\n}\n\nfunction easeOutSine(x) {\n  return Math.sin((x * Math.PI) / 2);\n}\n\nfunction easeInOutSine(x) {\n  return -(Math.cos(Math.PI * x) - 1) / 2;\n}\n\nfunction easeInQuad(x) {\n  return x * x;\n}\n\nfunction easeOutQuad(x) {\n  return 1 - (1 - x) * (1 - x);\n}\n\nfunction easeInOutQuad(x) {\n  return x < 0.5 ? 2 * x * x : 1 - Math.pow(-2 * x + 2, 2) / 2;\n}\n\nfunction easeInCubic(x) {\n  return x * x * x;\n}\n\nfunction easeOutCubic(x) {\n  return 1 - Math.pow(1 - x, 3);\n}\n\nfunction easeInOutCubic(x) {\n  return x < 0.5 ? 4 * x * x * x : 1 - Math.pow(-2 * x + 2, 3) / 2;\n}\n\nfunction easeInQuart(x) {\n  return x * x * x * x;\n}\n\nfunction easeOutQuart(x) {\n  return 1 - Math.pow(1 - x, 4);\n}\n\nfunction easeInOutQuart(x) {\n  return x < 0.5 ? 8 * x * x * x * x : 1 - Math.pow(-2 * x + 2, 4) / 2;\n}\n\nfunction easeInQuint(x) {\n  return x * x * x * x * x;\n}\n\nfunction easeOutQuint(x) {\n  return 1 - Math.pow(1 - x, 5);\n}\n\nfunction easeInOutQuint(x) {\n  return x < 0.5 ? 16 * x * x * x * x * x : 1 - Math.pow(-2 * x + 2, 5) / 2;\n}\n\nfunction easeInExpo(x) {\n  return x === 0 ? 0 : Math.pow(2, 10 * x - 10);\n}\n\nfunction easeOutExpo(x) {\n  return x === 1 ? 1 : 1 - Math.pow(2, -10 * x);\n}\n\nfunction easeInOutExpo(x) {\n  return x === 0\n    ? 0\n    : x === 1\n    ? 1\n    : x < 0.5\n    ? Math.pow(2, 20 * x - 10) / 2\n    : (2 - Math.pow(2, -20 * x + 10)) / 2;\n}\n\nfunction easeInCirc(x) {\n  return 1 - Math.sqrt(1 - Math.pow(x, 2));\n}\n\nfunction easeOutCirc(x) {\n  return Math.sqrt(1 - Math.pow(x - 1, 2));\n}\n\nfunction easeInOutCirc(x) {\n  return x < 0.5\n    ? (1 - Math.sqrt(1 - Math.pow(2 * x, 2))) / 2\n    : (Math.sqrt(1 - Math.pow(-2 * x + 2, 2)) + 1) / 2;\n}\n\nfunction easeInBack(x) {\n  const c1 = 1.70158;\n  const c3 = c1 + 1;\n\n  return c3 * x * x * x - c1 * x * x;\n}\n\nfunction easeOutBack(x) {\n  const c1 = 1.70158;\n  const c3 = c1 + 1;\n\n  return 1 + c3 * Math.pow(x - 1, 3) + c1 * Math.pow(x - 1, 2);\n}\n\nfunction easeInOutBack(x) {\n  const c1 = 1.70158;\n  const c2 = c1 * 1.525;\n\n  return x < 0.5\n    ? (Math.pow(2 * x, 2) * ((c2 + 1) * 2 * x - c2)) / 2\n    : (Math.pow(2 * x - 2, 2) * ((c2 + 1) * (x * 2 - 2) + c2) + 2) / 2;\n}\n\nfunction easeInElastic(x) {\n  const c4 = (2 * Math.PI) / 3;\n\n  return x === 0\n    ? 0\n    : x === 1\n    ? 1\n    : -Math.pow(2, 10 * x - 10) * Math.sin((x * 10 - 10.75) * c4);\n}\n\nfunction easeOutElastic(x) {\n  const c4 = (2 * Math.PI) / 3;\n\n  return x === 0\n    ? 0\n    : x === 1\n    ? 1\n    : Math.pow(2, -10 * x) * Math.sin((x * 10 - 0.75) * c4) + 1;\n}\n\nfunction easeInOutElastic(x) {\n  const c5 = (2 * Math.PI) / 4.5;\n\n  return x === 0\n    ? 0\n    : x === 1\n    ? 1\n    : x < 0.5\n    ? -(Math.pow(2, 20 * x - 10) * Math.sin((20 * x - 11.125) * c5)) / 2\n    : (Math.pow(2, -20 * x + 10) * Math.sin((20 * x - 11.125) * c5)) / 2 + 1;\n}\n\nfunction easeInBounce(x) {\n  return 1 - easeOutBounce(1 - x);\n}\n\nfunction easeOutBounce(x) {\n  const n1 = 7.5625;\n  const d1 = 2.75;\n\n  if (x < 1 / d1) {\n    return n1 * x * x;\n  } else if (x < 2 / d1) {\n    return n1 * (x -= 1.5 / d1) * x + 0.75;\n  } else if (x < 2.5 / d1) {\n    return n1 * (x -= 2.25 / d1) * x + 0.9375;\n  } else {\n    return n1 * (x -= 2.625 / d1) * x + 0.984375;\n  }\n}\n\nfunction easeInOutBounce(x) {\n  return x < 0.5\n    ? (1 - easeOutBounce(1 - 2 * x)) / 2\n    : (1 + easeOutBounce(2 * x - 1)) / 2;\n}\n","import CONSTANTS from \"../constants.js\";\nimport { easeFunctions } from \"../canvas-effects/ease.js\";\n\n/**\n *  This function linearly interpolates between p1 and p2 based on a normalized value of t\n *\n * @param  {string}         inFile      The start value\n * @param  {object}         inOptions   The end value\n * @return {array|boolean}              Interpolated value\n */\nexport async function getFiles(\n  inFile,\n  { applyWildCard = false, softFail = false } = {}\n) {\n  let source = \"data\";\n  const browseOptions = { wildcard: applyWildCard };\n\n  if (/\\.s3\\./.test(inFile)) {\n    source = \"s3\";\n    const { bucket, keyPrefix } = FilePicker.parseS3URL(inFile);\n    if (bucket) {\n      browseOptions.bucket = bucket;\n      inFile = keyPrefix;\n    }\n  }\n\n  try {\n    return (await FilePicker.browse(source, inFile, browseOptions)).files;\n  } catch (err) {\n    if (softFail) return false;\n    throw custom_error(\"Sequencer\", `getFiles | ${err}`);\n  }\n}\n\n/**\n *  This function interpolates between p1 and p2 based on a normalized value of t, determined by the ease provided (string or function)\n *\n * @param  {number}             p1      The start value\n * @param  {number}             p2      The end value\n * @param  {number}             t       The normalized percentage\n * @param  {string|function}    ease    Type of ease to interpolate\n * @return {number}                     Interpolated value\n */\nexport function interpolate(p1, p2, t, ease = \"linear\") {\n  const easeFunction = is_function(ease) ? ease : easeFunctions[ease];\n  return p1 + (p2 - p1) * easeFunction(t);\n}\n\n/**\n *  Returns a floating point number between a minimum and maximum value\n *\n * @param  {number}     min                     The minimum value\n * @param  {number}     max                     The maximum value\n * @param  {boolean|MersenneTwister} twister    The twister to generate the random results from\n * @return {number}                             A random value between the range given\n */\nexport function random_float_between(min, max, twister = false) {\n  const random = twister ? twister.random() : Math.random();\n  const _max = Math.max(max, min);\n  const _min = Math.min(max, min);\n  return random * (_max - _min) + _min;\n}\n\n/**\n *  Returns an integer between a minimum and maximum value\n *\n * @param  {number}     min                     The minimum value\n * @param  {number}     max                     The maximum value\n * @param  {boolean|MersenneTwister} twister    The twister to generate the random results from\n * @return {int}                                A random integer between the range given\n */\nexport function random_int_between(min, max, twister = false) {\n  return Math.floor(random_float_between(min, max, twister));\n}\n\nexport function flip_negate(num_1, num_2) {\n  if (num_1 > 0) {\n    num_1 -= num_2;\n  } else {\n    num_1 += num_2;\n  }\n  return num_1;\n}\n\n/**\n *  Returns a shuffled copy of the original array.\n *\n * @param  {array}   inArray\n * @param  {boolean|MersenneTwister} twister    The twister to generate the random results from\n * @return {array}\n */\nexport function shuffle_array(inArray, twister = false) {\n  let shuffled = [...inArray];\n  const randomMethod = twister?.random ?? Math.random;\n  for (let i = shuffled.length - 1; i > 0; i--) {\n    let j = Math.floor(randomMethod() * (i + 1));\n    let temp = shuffled[i];\n    shuffled[i] = shuffled[j];\n    shuffled[j] = temp;\n  }\n  return shuffled;\n}\n\n/**\n *  This function determines if the given parameter is a callable function\n *\n * @param  {function}   inFunc    The function object to be tested\n * @return {boolean}              A boolean whether the function is actually a function\n */\nexport function is_function(inFunc) {\n  return (\n    inFunc &&\n    ({}.toString.call(inFunc) === \"[object Function]\" ||\n      {}.toString.call(inFunc) === \"[object AsyncFunction]\")\n  );\n}\n\n/**\n *  Returns a random element in the given array\n *\n * @param  {array}   inArray                    An array\n * @param  {boolean} recurse                    Whether to recurse if the randomly chosen element is also an array\n * @param  {boolean|MersenneTwister} twister    The twister to generate the random results from\n * @param  {boolean} index                      Whether to return the chosen index instead\n * @return {object}                             A random element from the array\n */\nexport function random_array_element(\n  inArray,\n  { recurse = false, twister = false, index = false } = {}\n) {\n  const chosenIndex = random_int_between(0, inArray.length, twister);\n  let choice = inArray[chosenIndex];\n  if (recurse && Array.isArray(choice)) {\n    return random_array_element(choice, { recurse, twister, index });\n  }\n  if (index) {\n    return chosenIndex;\n  }\n  return choice;\n}\n\n/**\n *  Returns a random element in the given object\n *\n * @param  {object}   inObject                  An object\n * @param  {boolean}  recurse                   Whether to recurse if the randomly chosen element is also an object\n * @param  {boolean|MersenneTwister} twister    The twister to generate the random results from\n * @return {object}                             A random element from the object\n */\nexport function random_object_element(\n  inObject,\n  { recurse = false, twister = false } = {}\n) {\n  let keys = Object.keys(inObject).filter((k) => !k.startsWith(\"_\"));\n  let choice = inObject[random_array_element(keys, { twister })];\n  if (typeof choice === \"object\" && recurse) {\n    return random_object_element(choice, { recurse: true });\n  }\n  return choice;\n}\n\n/**\n *  Tests a parameter whether it is a real number\n *\n * @param  {any}        inNumber    The parameter to test\n * @return {boolean}                Whether it is of type number, not infinite, and not NaN\n */\nexport function is_real_number(inNumber) {\n  return !isNaN(inNumber) && typeof inNumber === \"number\" && isFinite(inNumber);\n}\n\n/**\n *  Gets a property in an object based on a path in dot-notated string\n *\n * @param   {object}         obj       The object to be queried\n * @param   {array|string}   path      The path in the object to the property in a dot-notated string\n * @returns {any}                      Property value, if found\n */\nexport function deep_get(obj, path) {\n  if (!Array.isArray(path)) path = path.split(\".\");\n  try {\n    let i;\n    for (i = 0; i < path.length - 1; i++) {\n      obj = obj[path[i]];\n    }\n    return obj[path[i]];\n  } catch (err) {}\n}\n\n/**\n *  Sets a property in an object based on a path in dot-notated string, example:\n *  let obj = { first: { second: { third: \"value\" } } }\n *  deep_set(obj, \"newValue\", \"first.second.third\")\n *  let obj = { first: { second: { third: \"newValue\" } } }\n *\n * @param  {object}         obj       The object to be modified\n * @param  {array|string}   path      The path in the object to the property in a dot-notated string\n * @param  {any}            value     The value to set\n */\nexport function deep_set(obj, path, value) {\n  if (!Array.isArray(path)) path = path.split(\".\");\n  try {\n    let i;\n    for (i = 0; i < path.length - 1; i++) {\n      obj = obj[path[i]];\n    }\n    if (is_function(obj[path[i]])) {\n      obj[path[i]](value);\n    } else {\n      obj[path[i]] = value;\n    }\n  } catch (err) {}\n}\n\n/**\n *  Flattens an object in a dot-notated format, like:\n *  { data: { entry: { thing: \"stuff\" } } }\n *  Becomes:\n *  [{ \"data.entry.thing\": \"stuff\" }]\n *\n * @param  {object}     obj       The object to be flattened\n * @return {object}               The flattened object\n */\nexport function flatten_object(obj) {\n  let toReturn = [];\n  for (let i in obj) {\n    if (i.startsWith(\"_\")) continue;\n    if (!obj.hasOwnProperty(i)) continue;\n    if (typeof obj[i] == \"object\") {\n      let flatObject = flatten_object(obj[i]);\n      for (let x in flatObject) {\n        if (!flatObject.hasOwnProperty(x)) continue;\n        toReturn[i + \".\" + x] = flatObject[x];\n      }\n    } else {\n      toReturn[i] = obj[i];\n    }\n  }\n  return toReturn;\n}\n\n/**\n *  Wait for a duration.\n *\n * @param  {number}     ms      Milliseconds to wait\n * @return {Promise}            A promise that resolves after a given amount of milliseconds\n */\nexport function wait(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n/**\n *  Clamps a value between two numbers\n *\n * @param  {number}     num     Number to clamp\n * @param  {number}     min     The minimum the number can be\n * @param  {number}     max     The maximum the number can be\n * @return {number}             The clamped number\n */\nexport function clamp(num, min, max) {\n  const _max = Math.max(min, max);\n  const _min = Math.min(min, max);\n  return Math.max(_min, Math.min(_max, num));\n}\n\n/**\n * Checks whether a given string is a valid UUID or not\n *\n * @param {string} inId\n * @returns {boolean}\n */\nexport function is_UUID(inId) {\n  return (\n    typeof inId === \"string\" &&\n    (inId.startsWith(\"Scene\") ||\n      inId.startsWith(\"Actor\") ||\n      inId.startsWith(\"Item\")) &&\n    (inId.match(/\\./g) || []).length &&\n    !inId.endsWith(\".\")\n  );\n}\n\n/**\n *  Gets an object by an unique identifier, such as an ID, name, tag, label\n *\n * @param  {String}     inObjectId  The object identifier to search for\n * @param  {String}     inSceneId   The scene ID to search within\n * @return {any}                    Object if found, else undefined\n */\nexport function get_object_from_scene(\n  inObjectId,\n  inSceneId = game.user.viewedScene\n) {\n  let tryUUID = is_UUID(inObjectId);\n  if (tryUUID) {\n    const obj = fromUuidSync(inObjectId);\n    if (obj) return obj;\n    tryUUID = false;\n  }\n  return get_all_documents_from_scene(inSceneId).find((obj) => {\n    return get_object_identifier(obj, tryUUID) === inObjectId;\n  });\n}\n\n/**\n * Gets all documents from the given scene\n *\n * @param {Boolean/String} inSceneId\n * @returns {Array<Document>}\n */\nexport function get_all_documents_from_scene(inSceneId = false) {\n  const scene = inSceneId\n    ? game.scenes.get(inSceneId)\n    : game.scenes.get(game.user?.viewedScene);\n  if (!scene) return [];\n  return [\n\t  ...canvas.layers.map(layer => layer?.preview?.children ?? []),\n    ...Array.from(scene?.tokens ?? []),\n    ...Array.from(scene?.lights ?? []),\n    ...Array.from(scene?.sounds ?? []),\n    ...Array.from(scene?.templates ?? []),\n    ...Array.from(scene?.tiles ?? []),\n    ...Array.from(scene?.walls ?? []),\n    ...Array.from(scene?.drawings ?? []),\n  ]\n    .deepFlatten()\n    .filter(Boolean);\n}\n\n/**\n * Gets the document from an object, if it has one\n *\n * @param inObject\n * @returns {Document|{document}|*}\n */\nexport function validate_document(inObject) {\n  const document = inObject?.document ?? inObject;\n  return is_UUID(document?.uuid) ? document : inObject;\n}\n\n/**\n *  Get the unique identifier from an object\n *\n * @param  {Object}     inObject    The object to get the unique identifier from\n * @param  {Boolean}    tryUUID     The object to get the unique identifier from\n * @return {String}                 The identifier\n */\nexport function get_object_identifier(inObject, tryUUID = true) {\n  const uuid = tryUUID && is_UUID(inObject?.uuid) ? inObject?.uuid : undefined;\n  return (\n    uuid ??\n    inObject?.id ??\n    inObject?.document?.name ??\n    inObject?.name ??\n    (inObject?.tag !== \"\" ? inObject?.tag : undefined) ??\n    (inObject?.label !== \"\" ? inObject?.label : undefined)\n  );\n}\n\n/**\n *  Turns an array containing multiples of the same string, objects, etc, and removes duplications, and returns a fresh array\n *\n * @param  {Array}     inArray     An array of multiple duplicate collections to be made unique\n * @return {Array}                 An array containing only unique objects\n */\nexport function make_array_unique(inArray) {\n  return Array.from(new Set(inArray));\n}\n\nexport function debug(msg, args = \"\") {\n  if (game.settings.get(CONSTANTS.MODULE_NAME, \"debug\"))\n    console.log(`DEBUG | Sequencer | ${msg}`, args);\n}\n\nexport function debug_error(msg, args) {\n  if (game.settings.get(CONSTANTS.MODULE_NAME, \"debug\"))\n    console.error(`DEBUG | Sequencer | ${msg}`, args);\n}\n\nexport function custom_warning(inClassName, warning, notify = false) {\n  inClassName =\n    inClassName !== \"Sequencer\"\n      ? \"Sequencer | Module: \" + inClassName\n      : inClassName;\n  warning = `${inClassName} | ${warning}`;\n  if (notify) ui.notifications.warn(warning, { console: false });\n  console.warn(warning.replace(\"<br>\", \"\\n\"));\n}\n\nconst throttledWarnings = {};\nexport function throttled_custom_warning(\n  inClassName,\n  warning,\n  delay = 10000,\n  notify = false\n) {\n  inClassName =\n    inClassName !== \"Sequencer\"\n      ? \"Sequencer | Module: \" + inClassName\n      : inClassName;\n  warning = `${inClassName} | ${warning}`;\n  if (throttledWarnings[warning]) return;\n  throttledWarnings[warning] = true;\n  if (notify) ui.notifications.warn(warning, { console: false });\n  console.warn(warning.replace(\"<br>\", \"\\n\"));\n  setTimeout(() => {\n    delete throttledWarnings[warning];\n  }, delay);\n}\n\nexport function custom_error(inClassName, error, notify = true) {\n  inClassName =\n    inClassName !== \"Sequencer\"\n      ? \"Sequencer | Module: \" + inClassName\n      : inClassName;\n  error = `${inClassName} | ${error}`;\n  if (notify) ui.notifications.error(error, { console: false });\n  return new Error(error.replace(\"<br>\", \"\\n\"));\n}\n\nexport function user_can_do(inSetting) {\n  return game.user.role > game.settings.get(CONSTANTS.MODULE_NAME, inSetting);\n}\n\nexport function group_by(xs, key) {\n  return xs.reduce(function (acc, obj) {\n    let property = foundry.utils.getProperty(obj, key);\n    acc[property] = acc[property] || [];\n    acc[property].push(obj);\n    return acc;\n  }, {});\n}\n\nfunction objHasProperty(obj, prop) {\n  return obj.constructor.prototype.hasOwnProperty(prop);\n}\n\nexport function sequence_proxy_wrap(inSequence) {\n  return new Proxy(inSequence, {\n    get: function (target, prop) {\n      if (!objHasProperty(target, prop)) {\n        if (Sequencer.SectionManager.externalSections[prop] === undefined) {\n          const section = target.sections[target.sections.length - 1];\n          if (section && objHasProperty(section, prop)) {\n            const targetProperty = Reflect.get(section, prop);\n            return is_function(targetProperty)\n              ? targetProperty.bind(section)\n              : targetProperty;\n          }\n          return Reflect.get(target, prop);\n        }\n        target.sectionToCreate =\n          Sequencer.SectionManager.externalSections[prop];\n        return Reflect.get(target, \"_createCustomSection\");\n      }\n      return Reflect.get(target, prop);\n    },\n  });\n}\n\nexport function section_proxy_wrap(inClass) {\n  return new Proxy(inClass, {\n    get: function (target, prop) {\n      if (\n        !objHasProperty(target, prop) &&\n        objHasProperty(target.sequence, prop)\n      ) {\n        const targetProperty = Reflect.get(target.sequence, prop);\n        return is_function(targetProperty)\n          ? targetProperty.bind(target.sequence)\n          : targetProperty;\n      }\n      return Reflect.get(target, prop);\n    },\n  });\n}\n\nexport function str_to_search_regex_str(str) {\n  return str\n    .trim()\n    .replace(/[.+?^${}()|[\\]\\\\]/g, '\\\\$&')\n    .replace(/\\*+/g, \".*?\");\n}\n\nexport function safe_str(str) {\n  return str.normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\");\n}\n\nexport function scroll_to_element(\n  scrollElement,\n  scrollToElement,\n  duration = 500\n) {\n  if (!duration) {\n    scrollElement.scrollTop(\n      scrollElement.scrollTop() -\n        scrollElement.offset().top +\n        scrollToElement.offset().top\n    );\n    return;\n  }\n\n  scrollElement.animate(\n    {\n      scrollTop:\n        scrollElement.scrollTop() -\n        scrollElement.offset().top +\n        scrollToElement.offset().top,\n    },\n    duration\n  );\n\n  return wait(duration);\n}\n\nexport async function highlight_element(\n  element,\n  { duration = false, color = \"#FF0000\", size = \"3px\" } = {}\n) {\n  element.prop(\n    \"style\",\n    `-webkit-box-shadow: inset 0px 0px ${size} ${size} ${color}; box-shadow: inset 0px 0px ${size} ${size} ${color};`\n  );\n  if (!duration) return;\n  await wait(duration);\n  element.prop(\"style\", \"\");\n}\n\nexport function get_hash(input) {\n  let hash = 0;\n  const len = input.length;\n  for (let i = 0; i < len; i++) {\n    hash = (hash << 5) - hash + input.charCodeAt(i);\n    hash |= 0; // to 32bit integer\n  }\n  return hash;\n}\n\nexport function parseColor(inColor) {\n  return {\n    hexadecimal: is_real_number(inColor) ? inColor.toString(16) : inColor,\n    decimal:\n      typeof inColor === \"string\" && inColor.startsWith(\"#\")\n        ? parseInt(inColor.slice(1), 16)\n        : inColor,\n  };\n}\n\nexport function getCanvasMouse() {\n  return canvas?.app?.renderer?.events?.pointer ?? canvas?.app?.renderer?.plugins?.interaction?.pointer;\n}\n\nexport function createMersenneTwister(seed){\n\tconst twister = foundry?.dice?.MersenneTwister ?? MersenneTwister;\n\treturn new twister(seed);\n}\n","/** @returns {void} */\nexport function noop() {}\n\nexport const identity = (x) => x;\n\n/**\n * @template T\n * @template S\n * @param {T} tar\n * @param {S} src\n * @returns {T & S}\n */\nexport function assign(tar, src) {\n\t// @ts-ignore\n\tfor (const k in src) tar[k] = src[k];\n\treturn /** @type {T & S} */ (tar);\n}\n\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\n/**\n * @param {any} value\n * @returns {value is PromiseLike<any>}\n */\nexport function is_promise(value) {\n\treturn (\n\t\t!!value &&\n\t\t(typeof value === 'object' || typeof value === 'function') &&\n\t\ttypeof (/** @type {any} */ (value).then) === 'function'\n\t);\n}\n\n/** @returns {void} */\nexport function add_location(element, file, line, column, char) {\n\telement.__svelte_meta = {\n\t\tloc: { file, line, column, char }\n\t};\n}\n\nexport function run(fn) {\n\treturn fn();\n}\n\nexport function blank_object() {\n\treturn Object.create(null);\n}\n\n/**\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function run_all(fns) {\n\tfns.forEach(run);\n}\n\n/**\n * @param {any} thing\n * @returns {thing is Function}\n */\nexport function is_function(thing) {\n\treturn typeof thing === 'function';\n}\n\n/** @returns {boolean} */\nexport function safe_not_equal(a, b) {\n\treturn a != a ? b == b : a !== b || (a && typeof a === 'object') || typeof a === 'function';\n}\n\nlet src_url_equal_anchor;\n\n/**\n * @param {string} element_src\n * @param {string} url\n * @returns {boolean}\n */\nexport function src_url_equal(element_src, url) {\n\tif (element_src === url) return true;\n\tif (!src_url_equal_anchor) {\n\t\tsrc_url_equal_anchor = document.createElement('a');\n\t}\n\t// This is actually faster than doing URL(..).href\n\tsrc_url_equal_anchor.href = url;\n\treturn element_src === src_url_equal_anchor.href;\n}\n\n/** @param {string} srcset */\nfunction split_srcset(srcset) {\n\treturn srcset.split(',').map((src) => src.trim().split(' ').filter(Boolean));\n}\n\n/**\n * @param {HTMLSourceElement | HTMLImageElement} element_srcset\n * @param {string | undefined | null} srcset\n * @returns {boolean}\n */\nexport function srcset_url_equal(element_srcset, srcset) {\n\tconst element_urls = split_srcset(element_srcset.srcset);\n\tconst urls = split_srcset(srcset || '');\n\n\treturn (\n\t\turls.length === element_urls.length &&\n\t\turls.every(\n\t\t\t([url, width], i) =>\n\t\t\t\twidth === element_urls[i][1] &&\n\t\t\t\t// We need to test both ways because Vite will create an a full URL with\n\t\t\t\t// `new URL(asset, import.meta.url).href` for the client when `base: './'`, and the\n\t\t\t\t// relative URLs inside srcset are not automatically resolved to absolute URLs by\n\t\t\t\t// browsers (in contrast to img.src). This means both SSR and DOM code could\n\t\t\t\t// contain relative or absolute URLs.\n\t\t\t\t(src_url_equal(element_urls[i][0], url) || src_url_equal(url, element_urls[i][0]))\n\t\t)\n\t);\n}\n\n/** @returns {boolean} */\nexport function not_equal(a, b) {\n\treturn a != a ? b == b : a !== b;\n}\n\n/** @returns {boolean} */\nexport function is_empty(obj) {\n\treturn Object.keys(obj).length === 0;\n}\n\n/** @returns {void} */\nexport function validate_store(store, name) {\n\tif (store != null && typeof store.subscribe !== 'function') {\n\t\tthrow new Error(`'${name}' is not a store with a 'subscribe' method`);\n\t}\n}\n\nexport function subscribe(store, ...callbacks) {\n\tif (store == null) {\n\t\tfor (const callback of callbacks) {\n\t\t\tcallback(undefined);\n\t\t}\n\t\treturn noop;\n\t}\n\tconst unsub = store.subscribe(...callbacks);\n\treturn unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\n\n/**\n * Get the current value from a store by subscribing and immediately unsubscribing.\n *\n * https://svelte.dev/docs/svelte-store#get\n * @template T\n * @param {import('../store/public.js').Readable<T>} store\n * @returns {T}\n */\nexport function get_store_value(store) {\n\tlet value;\n\tsubscribe(store, (_) => (value = _))();\n\treturn value;\n}\n\n/** @returns {void} */\nexport function component_subscribe(component, store, callback) {\n\tcomponent.$$.on_destroy.push(subscribe(store, callback));\n}\n\nexport function create_slot(definition, ctx, $$scope, fn) {\n\tif (definition) {\n\t\tconst slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n\t\treturn definition[0](slot_ctx);\n\t}\n}\n\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n\treturn definition[1] && fn ? assign($$scope.ctx.slice(), definition[1](fn(ctx))) : $$scope.ctx;\n}\n\nexport function get_slot_changes(definition, $$scope, dirty, fn) {\n\tif (definition[2] && fn) {\n\t\tconst lets = definition[2](fn(dirty));\n\t\tif ($$scope.dirty === undefined) {\n\t\t\treturn lets;\n\t\t}\n\t\tif (typeof lets === 'object') {\n\t\t\tconst merged = [];\n\t\t\tconst len = Math.max($$scope.dirty.length, lets.length);\n\t\t\tfor (let i = 0; i < len; i += 1) {\n\t\t\t\tmerged[i] = $$scope.dirty[i] | lets[i];\n\t\t\t}\n\t\t\treturn merged;\n\t\t}\n\t\treturn $$scope.dirty | lets;\n\t}\n\treturn $$scope.dirty;\n}\n\n/** @returns {void} */\nexport function update_slot_base(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tslot_changes,\n\tget_slot_context_fn\n) {\n\tif (slot_changes) {\n\t\tconst slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n\t\tslot.p(slot_context, slot_changes);\n\t}\n}\n\n/** @returns {void} */\nexport function update_slot(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tdirty,\n\tget_slot_changes_fn,\n\tget_slot_context_fn\n) {\n\tconst slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n\tupdate_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\n\n/** @returns {any[] | -1} */\nexport function get_all_dirty_from_scope($$scope) {\n\tif ($$scope.ctx.length > 32) {\n\t\tconst dirty = [];\n\t\tconst length = $$scope.ctx.length / 32;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tdirty[i] = -1;\n\t\t}\n\t\treturn dirty;\n\t}\n\treturn -1;\n}\n\n/** @returns {{}} */\nexport function exclude_internal_props(props) {\n\tconst result = {};\n\tfor (const k in props) if (k[0] !== '$') result[k] = props[k];\n\treturn result;\n}\n\n/** @returns {{}} */\nexport function compute_rest_props(props, keys) {\n\tconst rest = {};\n\tkeys = new Set(keys);\n\tfor (const k in props) if (!keys.has(k) && k[0] !== '$') rest[k] = props[k];\n\treturn rest;\n}\n\n/** @returns {{}} */\nexport function compute_slots(slots) {\n\tconst result = {};\n\tfor (const key in slots) {\n\t\tresult[key] = true;\n\t}\n\treturn result;\n}\n\n/** @returns {(this: any, ...args: any[]) => void} */\nexport function once(fn) {\n\tlet ran = false;\n\treturn function (...args) {\n\t\tif (ran) return;\n\t\tran = true;\n\t\tfn.call(this, ...args);\n\t};\n}\n\nexport function null_to_empty(value) {\n\treturn value == null ? '' : value;\n}\n\nexport function set_store_value(store, ret, value) {\n\tstore.set(value);\n\treturn ret;\n}\n\nexport const has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n\nexport function action_destroyer(action_result) {\n\treturn action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\n/** @param {number | string} value\n * @returns {[number, string]}\n */\nexport function split_css_unit(value) {\n\tconst split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n\treturn split ? [parseFloat(split[1]), split[2] || 'px'] : [/** @type {number} */ (value), 'px'];\n}\n\nexport const contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n","import { noop } from './utils.js';\n\nexport const is_client = typeof window !== 'undefined';\n\n/** @type {() => number} */\nexport let now = is_client ? () => window.performance.now() : () => Date.now();\n\nexport let raf = is_client ? (cb) => requestAnimationFrame(cb) : noop;\n\n// used internally for testing\n/** @returns {void} */\nexport function set_now(fn) {\n\tnow = fn;\n}\n\n/** @returns {void} */\nexport function set_raf(fn) {\n\traf = fn;\n}\n","import { raf } from './environment.js';\n\nconst tasks = new Set();\n\n/**\n * @param {number} now\n * @returns {void}\n */\nfunction run_tasks(now) {\n\ttasks.forEach((task) => {\n\t\tif (!task.c(now)) {\n\t\t\ttasks.delete(task);\n\t\t\ttask.f();\n\t\t}\n\t});\n\tif (tasks.size !== 0) raf(run_tasks);\n}\n\n/**\n * For testing purposes only!\n * @returns {void}\n */\nexport function clear_loops() {\n\ttasks.clear();\n}\n\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n * @param {import('./private.js').TaskCallback} callback\n * @returns {import('./private.js').Task}\n */\nexport function loop(callback) {\n\t/** @type {import('./private.js').TaskEntry} */\n\tlet task;\n\tif (tasks.size === 0) raf(run_tasks);\n\treturn {\n\t\tpromise: new Promise((fulfill) => {\n\t\t\ttasks.add((task = { c: callback, f: fulfill }));\n\t\t}),\n\t\tabort() {\n\t\t\ttasks.delete(task);\n\t\t}\n\t};\n}\n","import { contenteditable_truthy_values, has_prop } from './utils.js';\n\nimport { ResizeObserverSingleton } from './ResizeObserverSingleton.js';\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\n\n/**\n * @returns {void}\n */\nexport function start_hydrating() {\n\tis_hydrating = true;\n}\n\n/**\n * @returns {void}\n */\nexport function end_hydrating() {\n\tis_hydrating = false;\n}\n\n/**\n * @param {number} low\n * @param {number} high\n * @param {(index: number) => number} key\n * @param {number} value\n * @returns {number}\n */\nfunction upper_bound(low, high, key, value) {\n\t// Return first index of value larger than input value in the range [low, high)\n\twhile (low < high) {\n\t\tconst mid = low + ((high - low) >> 1);\n\t\tif (key(mid) <= value) {\n\t\t\tlow = mid + 1;\n\t\t} else {\n\t\t\thigh = mid;\n\t\t}\n\t}\n\treturn low;\n}\n\n/**\n * @param {NodeEx} target\n * @returns {void}\n */\nfunction init_hydrate(target) {\n\tif (target.hydrate_init) return;\n\ttarget.hydrate_init = true;\n\t// We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n\n\tlet children = /** @type {ArrayLike<NodeEx2>} */ (target.childNodes);\n\t// If target is <head>, there may be children without claim_order\n\tif (target.nodeName === 'HEAD') {\n\t\tconst my_children = [];\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst node = children[i];\n\t\t\tif (node.claim_order !== undefined) {\n\t\t\t\tmy_children.push(node);\n\t\t\t}\n\t\t}\n\t\tchildren = my_children;\n\t}\n\t/*\n\t * Reorder claimed children optimally.\n\t * We can reorder claimed children optimally by finding the longest subsequence of\n\t * nodes that are already claimed in order and only moving the rest. The longest\n\t * subsequence of nodes that are claimed in order can be found by\n\t * computing the longest increasing subsequence of .claim_order values.\n\t *\n\t * This algorithm is optimal in generating the least amount of reorder operations\n\t * possible.\n\t *\n\t * Proof:\n\t * We know that, given a set of reordering operations, the nodes that do not move\n\t * always form an increasing subsequence, since they do not move among each other\n\t * meaning that they must be already ordered among each other. Thus, the maximal\n\t * set of nodes that do not move form a longest increasing subsequence.\n\t */\n\t// Compute longest increasing subsequence\n\t// m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n\tconst m = new Int32Array(children.length + 1);\n\t// Predecessor indices + 1\n\tconst p = new Int32Array(children.length);\n\tm[0] = -1;\n\tlet longest = 0;\n\tfor (let i = 0; i < children.length; i++) {\n\t\tconst current = children[i].claim_order;\n\t\t// Find the largest subsequence length such that it ends in a value less than our current value\n\t\t// upper_bound returns first greater value, so we subtract one\n\t\t// with fast path for when we are on the current longest subsequence\n\t\tconst seq_len =\n\t\t\t(longest > 0 && children[m[longest]].claim_order <= current\n\t\t\t\t? longest + 1\n\t\t\t\t: upper_bound(1, longest, (idx) => children[m[idx]].claim_order, current)) - 1;\n\t\tp[i] = m[seq_len] + 1;\n\t\tconst new_len = seq_len + 1;\n\t\t// We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n\t\tm[new_len] = i;\n\t\tlongest = Math.max(new_len, longest);\n\t}\n\t// The longest increasing subsequence of nodes (initially reversed)\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst lis = [];\n\t// The rest of the nodes, nodes that will be moved\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst to_move = [];\n\tlet last = children.length - 1;\n\tfor (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n\t\tlis.push(children[cur - 1]);\n\t\tfor (; last >= cur; last--) {\n\t\t\tto_move.push(children[last]);\n\t\t}\n\t\tlast--;\n\t}\n\tfor (; last >= 0; last--) {\n\t\tto_move.push(children[last]);\n\t}\n\tlis.reverse();\n\t// We sort the nodes being moved to guarantee that their insertion order matches the claim order\n\tto_move.sort((a, b) => a.claim_order - b.claim_order);\n\t// Finally, we move the nodes\n\tfor (let i = 0, j = 0; i < to_move.length; i++) {\n\t\twhile (j < lis.length && to_move[i].claim_order >= lis[j].claim_order) {\n\t\t\tj++;\n\t\t}\n\t\tconst anchor = j < lis.length ? lis[j] : null;\n\t\ttarget.insertBefore(to_move[i], anchor);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @returns {void}\n */\nexport function append(target, node) {\n\ttarget.appendChild(node);\n}\n\n/**\n * @param {Node} target\n * @param {string} style_sheet_id\n * @param {string} styles\n * @returns {void}\n */\nexport function append_styles(target, style_sheet_id, styles) {\n\tconst append_styles_to = get_root_for_style(target);\n\tif (!append_styles_to.getElementById(style_sheet_id)) {\n\t\tconst style = element('style');\n\t\tstyle.id = style_sheet_id;\n\t\tstyle.textContent = styles;\n\t\tappend_stylesheet(append_styles_to, style);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {ShadowRoot | Document}\n */\nexport function get_root_for_style(node) {\n\tif (!node) return document;\n\tconst root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n\tif (root && /** @type {ShadowRoot} */ (root).host) {\n\t\treturn /** @type {ShadowRoot} */ (root);\n\t}\n\treturn node.ownerDocument;\n}\n\n/**\n * @param {Node} node\n * @returns {CSSStyleSheet}\n */\nexport function append_empty_stylesheet(node) {\n\tconst style_element = element('style');\n\t// For transitions to work without 'style-src: unsafe-inline' Content Security Policy,\n\t// these empty tags need to be allowed with a hash as a workaround until we move to the Web Animations API.\n\t// Using the hash for the empty string (for an empty tag) works in all browsers except Safari.\n\t// So as a workaround for the workaround, when we append empty style tags we set their content to /* empty */.\n\t// The hash 'sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=' will then work even in Safari.\n\tstyle_element.textContent = '/* empty */';\n\tappend_stylesheet(get_root_for_style(node), style_element);\n\treturn style_element.sheet;\n}\n\n/**\n * @param {ShadowRoot | Document} node\n * @param {HTMLStyleElement} style\n * @returns {CSSStyleSheet}\n */\nfunction append_stylesheet(node, style) {\n\tappend(/** @type {Document} */ (node).head || node, style);\n\treturn style.sheet;\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @returns {void}\n */\nexport function append_hydration(target, node) {\n\tif (is_hydrating) {\n\t\tinit_hydrate(target);\n\t\tif (\n\t\t\ttarget.actual_end_child === undefined ||\n\t\t\t(target.actual_end_child !== null && target.actual_end_child.parentNode !== target)\n\t\t) {\n\t\t\ttarget.actual_end_child = target.firstChild;\n\t\t}\n\t\t// Skip nodes of undefined ordering\n\t\twhile (target.actual_end_child !== null && target.actual_end_child.claim_order === undefined) {\n\t\t\ttarget.actual_end_child = target.actual_end_child.nextSibling;\n\t\t}\n\t\tif (node !== target.actual_end_child) {\n\t\t\t// We only insert if the ordering of this node should be modified or the parent node is not target\n\t\t\tif (node.claim_order !== undefined || node.parentNode !== target) {\n\t\t\t\ttarget.insertBefore(node, target.actual_end_child);\n\t\t\t}\n\t\t} else {\n\t\t\ttarget.actual_end_child = node.nextSibling;\n\t\t}\n\t} else if (node.parentNode !== target || node.nextSibling !== null) {\n\t\ttarget.appendChild(node);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @param {Node} [anchor]\n * @returns {void}\n */\nexport function insert(target, node, anchor) {\n\ttarget.insertBefore(node, anchor || null);\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @param {NodeEx} [anchor]\n * @returns {void}\n */\nexport function insert_hydration(target, node, anchor) {\n\tif (is_hydrating && !anchor) {\n\t\tappend_hydration(target, node);\n\t} else if (node.parentNode !== target || node.nextSibling != anchor) {\n\t\ttarget.insertBefore(node, anchor || null);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {void}\n */\nexport function detach(node) {\n\tif (node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function destroy_each(iterations, detaching) {\n\tfor (let i = 0; i < iterations.length; i += 1) {\n\t\tif (iterations[i]) iterations[i].d(detaching);\n\t}\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element(name) {\n\treturn document.createElement(name);\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @param {string} is\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element_is(name, is) {\n\treturn document.createElement(name, { is });\n}\n\n/**\n * @template T\n * @template {keyof T} K\n * @param {T} obj\n * @param {K[]} exclude\n * @returns {Pick<T, Exclude<keyof T, K>>}\n */\nexport function object_without_properties(obj, exclude) {\n\tconst target = /** @type {Pick<T, Exclude<keyof T, K>>} */ ({});\n\tfor (const k in obj) {\n\t\tif (\n\t\t\thas_prop(obj, k) &&\n\t\t\t// @ts-ignore\n\t\t\texclude.indexOf(k) === -1\n\t\t) {\n\t\t\t// @ts-ignore\n\t\t\ttarget[k] = obj[k];\n\t\t}\n\t}\n\treturn target;\n}\n\n/**\n * @template {keyof SVGElementTagNameMap} K\n * @param {K} name\n * @returns {SVGElement}\n */\nexport function svg_element(name) {\n\treturn document.createElementNS('http://www.w3.org/2000/svg', name);\n}\n\n/**\n * @param {string} data\n * @returns {Text}\n */\nexport function text(data) {\n\treturn document.createTextNode(data);\n}\n\n/**\n * @returns {Text} */\nexport function space() {\n\treturn text(' ');\n}\n\n/**\n * @returns {Text} */\nexport function empty() {\n\treturn text('');\n}\n\n/**\n * @param {string} content\n * @returns {Comment}\n */\nexport function comment(content) {\n\treturn document.createComment(content);\n}\n\n/**\n * @param {EventTarget} node\n * @param {string} event\n * @param {EventListenerOrEventListenerObject} handler\n * @param {boolean | AddEventListenerOptions | EventListenerOptions} [options]\n * @returns {() => void}\n */\nexport function listen(node, event, handler, options) {\n\tnode.addEventListener(event, handler, options);\n\treturn () => node.removeEventListener(event, handler, options);\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function prevent_default(fn) {\n\treturn function (event) {\n\t\tevent.preventDefault();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopPropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_immediate_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopImmediatePropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function self(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.target === this) fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function trusted(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.isTrusted) fn.call(this, event);\n\t};\n}\n\n/**\n * @param {Element} node\n * @param {string} attribute\n * @param {string} [value]\n * @returns {void}\n */\nexport function attr(node, attribute, value) {\n\tif (value == null) node.removeAttribute(attribute);\n\telse if (node.getAttribute(attribute) !== value) node.setAttribute(attribute, value);\n}\n/**\n * List of attributes that should always be set through the attr method,\n * because updating them through the property setter doesn't work reliably.\n * In the example of `width`/`height`, the problem is that the setter only\n * accepts numeric values, but the attribute can also be set to a string like `50%`.\n * If this list becomes too big, rethink this approach.\n */\nconst always_set_through_set_attribute = ['width', 'height'];\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_attributes(node, attributes) {\n\t// @ts-ignore\n\tconst descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n\tfor (const key in attributes) {\n\t\tif (attributes[key] == null) {\n\t\t\tnode.removeAttribute(key);\n\t\t} else if (key === 'style') {\n\t\t\tnode.style.cssText = attributes[key];\n\t\t} else if (key === '__value') {\n\t\t\t/** @type {any} */ (node).value = node[key] = attributes[key];\n\t\t} else if (\n\t\t\tdescriptors[key] &&\n\t\t\tdescriptors[key].set &&\n\t\t\talways_set_through_set_attribute.indexOf(key) === -1\n\t\t) {\n\t\t\tnode[key] = attributes[key];\n\t\t} else {\n\t\t\tattr(node, key, attributes[key]);\n\t\t}\n\t}\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_svg_attributes(node, attributes) {\n\tfor (const key in attributes) {\n\t\tattr(node, key, attributes[key]);\n\t}\n}\n\n/**\n * @param {Record<string, unknown>} data_map\n * @returns {void}\n */\nexport function set_custom_element_data_map(node, data_map) {\n\tObject.keys(data_map).forEach((key) => {\n\t\tset_custom_element_data(node, key, data_map[key]);\n\t});\n}\n\n/**\n * @returns {void} */\nexport function set_custom_element_data(node, prop, value) {\n\tconst lower = prop.toLowerCase(); // for backwards compatibility with existing behavior we do lowercase first\n\tif (lower in node) {\n\t\tnode[lower] = typeof node[lower] === 'boolean' && value === '' ? true : value;\n\t} else if (prop in node) {\n\t\tnode[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n\t} else {\n\t\tattr(node, prop, value);\n\t}\n}\n\n/**\n * @param {string} tag\n */\nexport function set_dynamic_element_data(tag) {\n\treturn /-/.test(tag) ? set_custom_element_data_map : set_attributes;\n}\n\n/**\n * @returns {void}\n */\nexport function xlink_attr(node, attribute, value) {\n\tnode.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\n/**\n * @param {HTMLElement} node\n * @returns {string}\n */\nexport function get_svelte_dataset(node) {\n\treturn node.dataset.svelteH;\n}\n\n/**\n * @returns {unknown[]} */\nexport function get_binding_group_value(group, __value, checked) {\n\tconst value = new Set();\n\tfor (let i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) value.add(group[i].__value);\n\t}\n\tif (!checked) {\n\t\tvalue.delete(__value);\n\t}\n\treturn Array.from(value);\n}\n\n/**\n * @param {HTMLInputElement[]} group\n * @returns {{ p(...inputs: HTMLInputElement[]): void; r(): void; }}\n */\nexport function init_binding_group(group) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\treturn {\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\t_inputs.forEach((input) => group.push(input));\n\t\t},\n\t\t/* remove */ r() {\n\t\t\t_inputs.forEach((input) => group.splice(group.indexOf(input), 1));\n\t\t}\n\t};\n}\n\n/**\n * @param {number[]} indexes\n * @returns {{ u(new_indexes: number[]): void; p(...inputs: HTMLInputElement[]): void; r: () => void; }}\n */\nexport function init_binding_group_dynamic(group, indexes) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _group = get_binding_group(group);\n\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\n\tfunction get_binding_group(group) {\n\t\tfor (let i = 0; i < indexes.length; i++) {\n\t\t\tgroup = group[indexes[i]] = group[indexes[i]] || [];\n\t\t}\n\t\treturn group;\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction push() {\n\t\t_inputs.forEach((input) => _group.push(input));\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction remove() {\n\t\t_inputs.forEach((input) => _group.splice(_group.indexOf(input), 1));\n\t}\n\treturn {\n\t\t/* update */ u(new_indexes) {\n\t\t\tindexes = new_indexes;\n\t\t\tconst new_group = get_binding_group(group);\n\t\t\tif (new_group !== _group) {\n\t\t\t\tremove();\n\t\t\t\t_group = new_group;\n\t\t\t\tpush();\n\t\t\t}\n\t\t},\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\tpush();\n\t\t},\n\t\t/* remove */ r: remove\n\t};\n}\n\n/** @returns {number} */\nexport function to_number(value) {\n\treturn value === '' ? null : +value;\n}\n\n/** @returns {any[]} */\nexport function time_ranges_to_array(ranges) {\n\tconst array = [];\n\tfor (let i = 0; i < ranges.length; i += 1) {\n\t\tarray.push({ start: ranges.start(i), end: ranges.end(i) });\n\t}\n\treturn array;\n}\n\n/**\n * @param {Element} element\n * @returns {ChildNode[]}\n */\nexport function children(element) {\n\treturn Array.from(element.childNodes);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {void}\n */\nfunction init_claim_info(nodes) {\n\tif (nodes.claim_info === undefined) {\n\t\tnodes.claim_info = { last_index: 0, total_claimed: 0 };\n\t}\n}\n\n/**\n * @template {ChildNodeEx} R\n * @param {ChildNodeArray} nodes\n * @param {(node: ChildNodeEx) => node is R} predicate\n * @param {(node: ChildNodeEx) => ChildNodeEx | undefined} process_node\n * @param {() => R} create_node\n * @param {boolean} dont_update_last_index\n * @returns {R}\n */\nfunction claim_node(nodes, predicate, process_node, create_node, dont_update_last_index = false) {\n\t// Try to find nodes in an order such that we lengthen the longest increasing subsequence\n\tinit_claim_info(nodes);\n\tconst result_node = (() => {\n\t\t// We first try to find an element after the previous one\n\t\tfor (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// Otherwise, we try to find one before\n\t\t// We iterate in reverse so that we don't go too far back\n\t\tfor (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t} else if (replacement === undefined) {\n\t\t\t\t\t// Since we spliced before the last_index, we decrease it\n\t\t\t\t\tnodes.claim_info.last_index--;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// If we can't find any matching node, we create a new one\n\t\treturn create_node();\n\t})();\n\tresult_node.claim_order = nodes.claim_info.total_claimed;\n\tnodes.claim_info.total_claimed += 1;\n\treturn result_node;\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @param {(name: string) => Element | SVGElement} create_element\n * @returns {Element | SVGElement}\n */\nfunction claim_element_base(nodes, name, attributes, create_element) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Element | SVGElement} */\n\t\t(node) => node.nodeName === name,\n\t\t/** @param {Element} node */\n\t\t(node) => {\n\t\t\tconst remove = [];\n\t\t\tfor (let j = 0; j < node.attributes.length; j++) {\n\t\t\t\tconst attribute = node.attributes[j];\n\t\t\t\tif (!attributes[attribute.name]) {\n\t\t\t\t\tremove.push(attribute.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tremove.forEach((v) => node.removeAttribute(v));\n\t\t\treturn undefined;\n\t\t},\n\t\t() => create_element(name)\n\t);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_svg_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, svg_element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Text}\n */\nexport function claim_text(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Text} */\n\t\t(node) => node.nodeType === 3,\n\t\t/** @param {Text} node */\n\t\t(node) => {\n\t\t\tconst data_str = '' + data;\n\t\t\tif (node.data.startsWith(data_str)) {\n\t\t\t\tif (node.data.length !== data_str.length) {\n\t\t\t\t\treturn node.splitText(data_str.length);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode.data = data_str;\n\t\t\t}\n\t\t},\n\t\t() => text(data),\n\t\ttrue // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n\t);\n}\n\n/**\n * @returns {Text} */\nexport function claim_space(nodes) {\n\treturn claim_text(nodes, ' ');\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Comment}\n */\nexport function claim_comment(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Comment} */\n\t\t(node) => node.nodeType === 8,\n\t\t/** @param {Comment} node */\n\t\t(node) => {\n\t\t\tnode.data = '' + data;\n\t\t\treturn undefined;\n\t\t},\n\t\t() => comment(data),\n\t\ttrue\n\t);\n}\n\nfunction get_comment_idx(nodes, text, start) {\n\tfor (let i = start; i < nodes.length; i += 1) {\n\t\tconst node = nodes[i];\n\t\tif (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * @param {boolean} is_svg\n * @returns {HtmlTagHydration}\n */\nexport function claim_html_tag(nodes, is_svg) {\n\t// find html opening tag\n\tconst start_index = get_comment_idx(nodes, 'HTML_TAG_START', 0);\n\tconst end_index = get_comment_idx(nodes, 'HTML_TAG_END', start_index + 1);\n\tif (start_index === -1 || end_index === -1) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\n\tinit_claim_info(nodes);\n\tconst html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n\tdetach(html_tag_nodes[0]);\n\tdetach(html_tag_nodes[html_tag_nodes.length - 1]);\n\tconst claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n\tif (claimed_nodes.length === 0) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\tfor (const n of claimed_nodes) {\n\t\tn.claim_order = nodes.claim_info.total_claimed;\n\t\tnodes.claim_info.total_claimed += 1;\n\t}\n\treturn new HtmlTagHydration(is_svg, claimed_nodes);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data(text, data) {\n\tdata = '' + data;\n\tif (text.data === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data_contenteditable(text, data) {\n\tdata = '' + data;\n\tif (text.wholeText === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @param {string} attr_value\n * @returns {void}\n */\nexport function set_data_maybe_contenteditable(text, data, attr_value) {\n\tif (~contenteditable_truthy_values.indexOf(attr_value)) {\n\t\tset_data_contenteditable(text, data);\n\t} else {\n\t\tset_data(text, data);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_input_value(input, value) {\n\tinput.value = value == null ? '' : value;\n}\n\n/**\n * @returns {void} */\nexport function set_input_type(input, type) {\n\ttry {\n\t\tinput.type = type;\n\t} catch (e) {\n\t\t// do nothing\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_style(node, key, value, important) {\n\tif (value == null) {\n\t\tnode.style.removeProperty(key);\n\t} else {\n\t\tnode.style.setProperty(key, value, important ? 'important' : '');\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_option(select, value, mounting) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\tif (option.__value === value) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!mounting || value !== undefined) {\n\t\tselect.selectedIndex = -1; // no option should be selected\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_options(select, value) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\toption.selected = ~value.indexOf(option.__value);\n\t}\n}\n\nexport function select_value(select) {\n\tconst selected_option = select.querySelector(':checked');\n\treturn selected_option && selected_option.__value;\n}\n\nexport function select_multiple_value(select) {\n\treturn [].map.call(select.querySelectorAll(':checked'), (option) => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\n\n/**\n * @type {boolean} */\nlet crossorigin;\n\n/**\n * @returns {boolean} */\nexport function is_crossorigin() {\n\tif (crossorigin === undefined) {\n\t\tcrossorigin = false;\n\t\ttry {\n\t\t\tif (typeof window !== 'undefined' && window.parent) {\n\t\t\t\tvoid window.parent.document;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tcrossorigin = true;\n\t\t}\n\t}\n\treturn crossorigin;\n}\n\n/**\n * @param {HTMLElement} node\n * @param {() => void} fn\n * @returns {() => void}\n */\nexport function add_iframe_resize_listener(node, fn) {\n\tconst computed_style = getComputedStyle(node);\n\tif (computed_style.position === 'static') {\n\t\tnode.style.position = 'relative';\n\t}\n\tconst iframe = element('iframe');\n\tiframe.setAttribute(\n\t\t'style',\n\t\t'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n\t\t\t'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;'\n\t);\n\tiframe.setAttribute('aria-hidden', 'true');\n\tiframe.tabIndex = -1;\n\tconst crossorigin = is_crossorigin();\n\n\t/**\n\t * @type {() => void}\n\t */\n\tlet unsubscribe;\n\tif (crossorigin) {\n\t\tiframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n\t\tunsubscribe = listen(\n\t\t\twindow,\n\t\t\t'message',\n\t\t\t/** @param {MessageEvent} event */ (event) => {\n\t\t\t\tif (event.source === iframe.contentWindow) fn();\n\t\t\t}\n\t\t);\n\t} else {\n\t\tiframe.src = 'about:blank';\n\t\tiframe.onload = () => {\n\t\t\tunsubscribe = listen(iframe.contentWindow, 'resize', fn);\n\t\t\t// make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n\t\t\t// see https://github.com/sveltejs/svelte/issues/4233\n\t\t\tfn();\n\t\t};\n\t}\n\tappend(node, iframe);\n\treturn () => {\n\t\tif (crossorigin) {\n\t\t\tunsubscribe();\n\t\t} else if (unsubscribe && iframe.contentWindow) {\n\t\t\tunsubscribe();\n\t\t}\n\t\tdetach(iframe);\n\t};\n}\nexport const resize_observer_content_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'content-box'\n});\nexport const resize_observer_border_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'border-box'\n});\nexport const resize_observer_device_pixel_content_box = /* @__PURE__ */ new ResizeObserverSingleton(\n\t{ box: 'device-pixel-content-box' }\n);\nexport { ResizeObserverSingleton };\n\n/**\n * @returns {void} */\nexport function toggle_class(element, name, toggle) {\n\t// The `!!` is required because an `undefined` flag means flipping the current state.\n\telement.classList.toggle(name, !!toggle);\n}\n\n/**\n * @template T\n * @param {string} type\n * @param {T} [detail]\n * @param {{ bubbles?: boolean, cancelable?: boolean }} [options]\n * @returns {CustomEvent<T>}\n */\nexport function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n\treturn new CustomEvent(type, { detail, bubbles, cancelable });\n}\n\n/**\n * @param {string} selector\n * @param {HTMLElement} parent\n * @returns {ChildNodeArray}\n */\nexport function query_selector_all(selector, parent = document.body) {\n\treturn Array.from(parent.querySelectorAll(selector));\n}\n\n/**\n * @param {string} nodeId\n * @param {HTMLElement} head\n * @returns {any[]}\n */\nexport function head_selector(nodeId, head) {\n\tconst result = [];\n\tlet started = 0;\n\tfor (const node of head.childNodes) {\n\t\tif (node.nodeType === 8 /* comment node */) {\n\t\t\tconst comment = node.textContent.trim();\n\t\t\tif (comment === `HEAD_${nodeId}_END`) {\n\t\t\t\tstarted -= 1;\n\t\t\t\tresult.push(node);\n\t\t\t} else if (comment === `HEAD_${nodeId}_START`) {\n\t\t\t\tstarted += 1;\n\t\t\t\tresult.push(node);\n\t\t\t}\n\t\t} else if (started > 0) {\n\t\t\tresult.push(node);\n\t\t}\n\t}\n\treturn result;\n}\n/** */\nexport class HtmlTag {\n\t/**\n\t * @private\n\t * @default false\n\t */\n\tis_svg = false;\n\t/** parent for creating node */\n\te = undefined;\n\t/** html tag nodes */\n\tn = undefined;\n\t/** target */\n\tt = undefined;\n\t/** anchor */\n\ta = undefined;\n\tconstructor(is_svg = false) {\n\t\tthis.is_svg = is_svg;\n\t\tthis.e = this.n = null;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tthis.h(html);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @param {HTMLElement | SVGElement} target\n\t * @param {HTMLElement | SVGElement} anchor\n\t * @returns {void}\n\t */\n\tm(html, target, anchor = null) {\n\t\tif (!this.e) {\n\t\t\tif (this.is_svg)\n\t\t\t\tthis.e = svg_element(/** @type {keyof SVGElementTagNameMap} */ (target.nodeName));\n\t\t\t/** #7364  target for <template> may be provided as #document-fragment(11) */ else\n\t\t\t\tthis.e = element(\n\t\t\t\t\t/** @type {keyof HTMLElementTagNameMap} */ (\n\t\t\t\t\t\ttarget.nodeType === 11 ? 'TEMPLATE' : target.nodeName\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\tthis.t =\n\t\t\t\ttarget.tagName !== 'TEMPLATE'\n\t\t\t\t\t? target\n\t\t\t\t\t: /** @type {HTMLTemplateElement} */ (target).content;\n\t\t\tthis.c(html);\n\t\t}\n\t\tthis.i(anchor);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\th(html) {\n\t\tthis.e.innerHTML = html;\n\t\tthis.n = Array.from(\n\t\t\tthis.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes\n\t\t);\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert(this.t, this.n[i], anchor);\n\t\t}\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tp(html) {\n\t\tthis.d();\n\t\tthis.h(html);\n\t\tthis.i(this.a);\n\t}\n\n\t/**\n\t * @returns {void} */\n\td() {\n\t\tthis.n.forEach(detach);\n\t}\n}\n\nexport class HtmlTagHydration extends HtmlTag {\n\t/** @type {Element[]} hydration claimed nodes */\n\tl = undefined;\n\n\tconstructor(is_svg = false, claimed_nodes) {\n\t\tsuper(is_svg);\n\t\tthis.e = this.n = null;\n\t\tthis.l = claimed_nodes;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tif (this.l) {\n\t\t\tthis.n = this.l;\n\t\t} else {\n\t\t\tsuper.c(html);\n\t\t}\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert_hydration(this.t, this.n[i], anchor);\n\t\t}\n\t}\n}\n\n/**\n * @param {NamedNodeMap} attributes\n * @returns {{}}\n */\nexport function attribute_to_object(attributes) {\n\tconst result = {};\n\tfor (const attribute of attributes) {\n\t\tresult[attribute.name] = attribute.value;\n\t}\n\treturn result;\n}\n\nconst escaped = {\n\t'\"': '&quot;',\n\t'&': '&amp;',\n\t'<': '&lt;'\n};\n\nconst regex_attribute_characters_to_escape = /[\"&<]/g;\n\n/**\n * Note that the attribute itself should be surrounded in double quotes\n * @param {any} attribute\n */\nfunction escape_attribute(attribute) {\n\treturn String(attribute).replace(regex_attribute_characters_to_escape, (match) => escaped[match]);\n}\n\n/**\n * @param {Record<string, string>} attributes\n */\nexport function stringify_spread(attributes) {\n\tlet str = ' ';\n\tfor (const key in attributes) {\n\t\tif (attributes[key] != null) {\n\t\t\tstr += `${key}=\"${escape_attribute(attributes[key])}\" `;\n\t\t}\n\t}\n\n\treturn str;\n}\n\n/**\n * @param {HTMLElement} element\n * @returns {{}}\n */\nexport function get_custom_elements_slots(element) {\n\tconst result = {};\n\telement.childNodes.forEach(\n\t\t/** @param {Element} node */ (node) => {\n\t\t\tresult[node.slot || 'default'] = true;\n\t\t}\n\t);\n\treturn result;\n}\n\nexport function construct_svelte_component(component, props) {\n\treturn new component(props);\n}\n\n/**\n * @typedef {Node & {\n * \tclaim_order?: number;\n * \thydrate_init?: true;\n * \tactual_end_child?: NodeEx;\n * \tchildNodes: NodeListOf<NodeEx>;\n * }} NodeEx\n */\n\n/** @typedef {ChildNode & NodeEx} ChildNodeEx */\n\n/** @typedef {NodeEx & { claim_order: number }} NodeEx2 */\n\n/**\n * @typedef {ChildNodeEx[] & {\n * \tclaim_info?: {\n * \t\tlast_index: number;\n * \t\ttotal_claimed: number;\n * \t};\n * }} ChildNodeArray\n */\n","import { append_empty_stylesheet, detach, get_root_for_style } from './dom.js';\nimport { raf } from './environment.js';\n\n// we need to store the information for multiple documents because a Svelte application could also contain iframes\n// https://github.com/sveltejs/svelte/issues/3624\n/** @type {Map<Document | ShadowRoot, import('./private.d.ts').StyleInformation>} */\nconst managed_styles = new Map();\n\nlet active = 0;\n\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\n/**\n * @param {string} str\n * @returns {number}\n */\nfunction hash(str) {\n\tlet hash = 5381;\n\tlet i = str.length;\n\twhile (i--) hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n\treturn hash >>> 0;\n}\n\n/**\n * @param {Document | ShadowRoot} doc\n * @param {Element & ElementCSSInlineStyle} node\n * @returns {{ stylesheet: any; rules: {}; }}\n */\nfunction create_style_information(doc, node) {\n\tconst info = { stylesheet: append_empty_stylesheet(node), rules: {} };\n\tmanaged_styles.set(doc, info);\n\treturn info;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {number} a\n * @param {number} b\n * @param {number} duration\n * @param {number} delay\n * @param {(t: number) => number} ease\n * @param {(t: number, u: number) => string} fn\n * @param {number} uid\n * @returns {string}\n */\nexport function create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n\tconst step = 16.666 / duration;\n\tlet keyframes = '{\\n';\n\tfor (let p = 0; p <= 1; p += step) {\n\t\tconst t = a + (b - a) * ease(p);\n\t\tkeyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n\t}\n\tconst rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n\tconst name = `__svelte_${hash(rule)}_${uid}`;\n\tconst doc = get_root_for_style(node);\n\tconst { stylesheet, rules } = managed_styles.get(doc) || create_style_information(doc, node);\n\tif (!rules[name]) {\n\t\trules[name] = true;\n\t\tstylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n\t}\n\tconst animation = node.style.animation || '';\n\tnode.style.animation = `${\n\t\tanimation ? `${animation}, ` : ''\n\t}${name} ${duration}ms linear ${delay}ms 1 both`;\n\tactive += 1;\n\treturn name;\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {string} [name]\n * @returns {void}\n */\nexport function delete_rule(node, name) {\n\tconst previous = (node.style.animation || '').split(', ');\n\tconst next = previous.filter(\n\t\tname\n\t\t\t? (anim) => anim.indexOf(name) < 0 // remove specific animation\n\t\t\t: (anim) => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n\t);\n\tconst deleted = previous.length - next.length;\n\tif (deleted) {\n\t\tnode.style.animation = next.join(', ');\n\t\tactive -= deleted;\n\t\tif (!active) clear_rules();\n\t}\n}\n\n/** @returns {void} */\nexport function clear_rules() {\n\traf(() => {\n\t\tif (active) return;\n\t\tmanaged_styles.forEach((info) => {\n\t\t\tconst { ownerNode } = info.stylesheet;\n\t\t\t// there is no ownerNode if it runs on jsdom.\n\t\t\tif (ownerNode) detach(ownerNode);\n\t\t});\n\t\tmanaged_styles.clear();\n\t});\n}\n","import { custom_event } from './dom.js';\n\nexport let current_component;\n\n/** @returns {void} */\nexport function set_current_component(component) {\n\tcurrent_component = component;\n}\n\nexport function get_current_component() {\n\tif (!current_component) throw new Error('Function called outside component initialization');\n\treturn current_component;\n}\n\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#beforeupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function beforeUpdate(fn) {\n\tget_current_component().$$.before_update.push(fn);\n}\n\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * If a function is returned _synchronously_ from `onMount`, it will be called when the component is unmounted.\n *\n * `onMount` does not run inside a [server-side component](https://svelte.dev/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs/svelte#onmount\n * @template T\n * @param {() => import('./private.js').NotFunction<T> | Promise<import('./private.js').NotFunction<T>> | (() => any)} fn\n * @returns {void}\n */\nexport function onMount(fn) {\n\tget_current_component().$$.on_mount.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#afterupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function afterUpdate(fn) {\n\tget_current_component().$$.after_update.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs/svelte#ondestroy\n * @param {() => any} fn\n * @returns {void}\n */\nexport function onDestroy(fn) {\n\tget_current_component().$$.on_destroy.push(fn);\n}\n\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](https://svelte.dev/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * The event dispatcher can be typed to narrow the allowed event names and the type of the `detail` argument:\n * ```ts\n * const dispatch = createEventDispatcher<{\n *  loaded: never; // does not take a detail argument\n *  change: string; // takes a detail argument of type string, which is required\n *  optional: number | null; // takes an optional detail argument of type number\n * }>();\n * ```\n *\n * https://svelte.dev/docs/svelte#createeventdispatcher\n * @template {Record<string, any>} [EventMap=any]\n * @returns {import('./public.js').EventDispatcher<EventMap>}\n */\nexport function createEventDispatcher() {\n\tconst component = get_current_component();\n\treturn (type, detail, { cancelable = false } = {}) => {\n\t\tconst callbacks = component.$$.callbacks[type];\n\t\tif (callbacks) {\n\t\t\t// TODO are there situations where events could be dispatched\n\t\t\t// in a server (non-DOM) environment?\n\t\t\tconst event = custom_event(/** @type {string} */ (type), detail, { cancelable });\n\t\t\tcallbacks.slice().forEach((fn) => {\n\t\t\t\tfn.call(component, event);\n\t\t\t});\n\t\t\treturn !event.defaultPrevented;\n\t\t}\n\t\treturn true;\n\t};\n}\n\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#setcontext\n * @template T\n * @param {any} key\n * @param {T} context\n * @returns {T}\n */\nexport function setContext(key, context) {\n\tget_current_component().$$.context.set(key, context);\n\treturn context;\n}\n\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#getcontext\n * @template T\n * @param {any} key\n * @returns {T}\n */\nexport function getContext(key) {\n\treturn get_current_component().$$.context.get(key);\n}\n\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs/svelte#getallcontexts\n * @template {Map<any, any>} [T=Map<any, any>]\n * @returns {T}\n */\nexport function getAllContexts() {\n\treturn get_current_component().$$.context;\n}\n\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#hascontext\n * @param {any} key\n * @returns {boolean}\n */\nexport function hasContext(key) {\n\treturn get_current_component().$$.context.has(key);\n}\n\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\n/**\n * @param component\n * @param event\n * @returns {void}\n */\nexport function bubble(component, event) {\n\tconst callbacks = component.$$.callbacks[event.type];\n\tif (callbacks) {\n\t\t// @ts-ignore\n\t\tcallbacks.slice().forEach((fn) => fn.call(this, event));\n\t}\n}\n","import { run_all } from './utils.js';\nimport { current_component, set_current_component } from './lifecycle.js';\n\nexport const dirty_components = [];\nexport const intros = { enabled: false };\nexport const binding_callbacks = [];\n\nlet render_callbacks = [];\n\nconst flush_callbacks = [];\n\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\n\nlet update_scheduled = false;\n\n/** @returns {void} */\nexport function schedule_update() {\n\tif (!update_scheduled) {\n\t\tupdate_scheduled = true;\n\t\tresolved_promise.then(flush);\n\t}\n}\n\n/** @returns {Promise<void>} */\nexport function tick() {\n\tschedule_update();\n\treturn resolved_promise;\n}\n\n/** @returns {void} */\nexport function add_render_callback(fn) {\n\trender_callbacks.push(fn);\n}\n\n/** @returns {void} */\nexport function add_flush_callback(fn) {\n\tflush_callbacks.push(fn);\n}\n\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\n\nlet flushidx = 0; // Do *not* move this inside the flush() function\n\n/** @returns {void} */\nexport function flush() {\n\t// Do not reenter flush while dirty components are updated, as this can\n\t// result in an infinite loop. Instead, let the inner flush handle it.\n\t// Reentrancy is ok afterwards for bindings etc.\n\tif (flushidx !== 0) {\n\t\treturn;\n\t}\n\tconst saved_component = current_component;\n\tdo {\n\t\t// first, call beforeUpdate functions\n\t\t// and update components\n\t\ttry {\n\t\t\twhile (flushidx < dirty_components.length) {\n\t\t\t\tconst component = dirty_components[flushidx];\n\t\t\t\tflushidx++;\n\t\t\t\tset_current_component(component);\n\t\t\t\tupdate(component.$$);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// reset dirty state to not end up in a deadlocked state and then rethrow\n\t\t\tdirty_components.length = 0;\n\t\t\tflushidx = 0;\n\t\t\tthrow e;\n\t\t}\n\t\tset_current_component(null);\n\t\tdirty_components.length = 0;\n\t\tflushidx = 0;\n\t\twhile (binding_callbacks.length) binding_callbacks.pop()();\n\t\t// then, once components are updated, call\n\t\t// afterUpdate functions. This may cause\n\t\t// subsequent updates...\n\t\tfor (let i = 0; i < render_callbacks.length; i += 1) {\n\t\t\tconst callback = render_callbacks[i];\n\t\t\tif (!seen_callbacks.has(callback)) {\n\t\t\t\t// ...so guard against infinite loops\n\t\t\t\tseen_callbacks.add(callback);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\trender_callbacks.length = 0;\n\t} while (dirty_components.length);\n\twhile (flush_callbacks.length) {\n\t\tflush_callbacks.pop()();\n\t}\n\tupdate_scheduled = false;\n\tseen_callbacks.clear();\n\tset_current_component(saved_component);\n}\n\n/** @returns {void} */\nfunction update($$) {\n\tif ($$.fragment !== null) {\n\t\t$$.update();\n\t\trun_all($$.before_update);\n\t\tconst dirty = $$.dirty;\n\t\t$$.dirty = [-1];\n\t\t$$.fragment && $$.fragment.p($$.ctx, dirty);\n\t\t$$.after_update.forEach(add_render_callback);\n\t}\n}\n\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function flush_render_callbacks(fns) {\n\tconst filtered = [];\n\tconst targets = [];\n\trender_callbacks.forEach((c) => (fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c)));\n\ttargets.forEach((c) => c());\n\trender_callbacks = filtered;\n}\n","import { identity as linear, is_function, noop, run_all } from './utils.js';\nimport { now } from './environment.js';\nimport { loop } from './loop.js';\nimport { create_rule, delete_rule } from './style_manager.js';\nimport { custom_event } from './dom.js';\nimport { add_render_callback } from './scheduler.js';\n\n/**\n * @type {Promise<void> | null}\n */\nlet promise;\n\n/**\n * @returns {Promise<void>}\n */\nfunction wait() {\n\tif (!promise) {\n\t\tpromise = Promise.resolve();\n\t\tpromise.then(() => {\n\t\t\tpromise = null;\n\t\t});\n\t}\n\treturn promise;\n}\n\n/**\n * @param {Element} node\n * @param {INTRO | OUTRO | boolean} direction\n * @param {'start' | 'end'} kind\n * @returns {void}\n */\nfunction dispatch(node, direction, kind) {\n\tnode.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\n\nconst outroing = new Set();\n\n/**\n * @type {Outro}\n */\nlet outros;\n\n/**\n * @returns {void} */\nexport function group_outros() {\n\toutros = {\n\t\tr: 0,\n\t\tc: [],\n\t\tp: outros // parent group\n\t};\n}\n\n/**\n * @returns {void} */\nexport function check_outros() {\n\tif (!outros.r) {\n\t\trun_all(outros.c);\n\t}\n\toutros = outros.p;\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} [local]\n * @returns {void}\n */\nexport function transition_in(block, local) {\n\tif (block && block.i) {\n\t\toutroing.delete(block);\n\t\tblock.i(local);\n\t}\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} local\n * @param {0 | 1} [detach]\n * @param {() => void} [callback]\n * @returns {void}\n */\nexport function transition_out(block, local, detach, callback) {\n\tif (block && block.o) {\n\t\tif (outroing.has(block)) return;\n\t\toutroing.add(block);\n\t\toutros.c.push(() => {\n\t\t\toutroing.delete(block);\n\t\t\tif (callback) {\n\t\t\t\tif (detach) block.d(1);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t\tblock.o(local);\n\t} else if (callback) {\n\t\tcallback();\n\t}\n}\n\n/**\n * @type {import('../transition/public.js').TransitionConfig}\n */\nconst null_transition = { duration: 0 };\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ start(): void; invalidate(): void; end(): void; }}\n */\nexport function create_in_transition(node, fn, params) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'in' };\n\tlet config = fn(node, params, options);\n\tlet running = false;\n\tlet animation_name;\n\tlet task;\n\tlet uid = 0;\n\n\t/**\n\t * @returns {void} */\n\tfunction cleanup() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\t\tif (css) animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n\t\ttick(0, 1);\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tif (task) task.abort();\n\t\trunning = true;\n\t\tadd_render_callback(() => dispatch(node, true, 'start'));\n\t\ttask = loop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(1, 0);\n\t\t\t\t\tdispatch(node, true, 'end');\n\t\t\t\t\tcleanup();\n\t\t\t\t\treturn (running = false);\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\tlet started = false;\n\treturn {\n\t\tstart() {\n\t\t\tif (started) return;\n\t\t\tstarted = true;\n\t\t\tdelete_rule(node);\n\t\t\tif (is_function(config)) {\n\t\t\t\tconfig = config(options);\n\t\t\t\twait().then(go);\n\t\t\t} else {\n\t\t\t\tgo();\n\t\t\t}\n\t\t},\n\t\tinvalidate() {\n\t\t\tstarted = false;\n\t\t},\n\t\tend() {\n\t\t\tif (running) {\n\t\t\t\tcleanup();\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ end(reset: any): void; }}\n */\nexport function create_out_transition(node, fn, params) {\n\t/** @type {TransitionOptions} */\n\tconst options = { direction: 'out' };\n\tlet config = fn(node, params, options);\n\tlet running = true;\n\tlet animation_name;\n\tconst group = outros;\n\tgroup.r += 1;\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\tif (css) animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tadd_render_callback(() => dispatch(node, false, 'start'));\n\n\t\tif ('inert' in node) {\n\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\tnode.inert = true;\n\t\t}\n\n\t\tloop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(0, 1);\n\t\t\t\t\tdispatch(node, false, 'end');\n\t\t\t\t\tif (!--group.r) {\n\t\t\t\t\t\t// this will result in `end()` being called,\n\t\t\t\t\t\t// so we don't need to clean up here\n\t\t\t\t\t\trun_all(group.c);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(1 - t, t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\n\tif (is_function(config)) {\n\t\twait().then(() => {\n\t\t\t// @ts-ignore\n\t\t\tconfig = config(options);\n\t\t\tgo();\n\t\t});\n\t} else {\n\t\tgo();\n\t}\n\n\treturn {\n\t\tend(reset) {\n\t\t\tif (reset && 'inert' in node) {\n\t\t\t\tnode.inert = original_inert_value;\n\t\t\t}\n\t\t\tif (reset && config.tick) {\n\t\t\t\tconfig.tick(1, 0);\n\t\t\t}\n\t\t\tif (running) {\n\t\t\t\tif (animation_name) delete_rule(node, animation_name);\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @param {boolean} intro\n * @returns {{ run(b: 0 | 1): void; end(): void; }}\n */\nexport function create_bidirectional_transition(node, fn, params, intro) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'both' };\n\tlet config = fn(node, params, options);\n\tlet t = intro ? 0 : 1;\n\n\t/**\n\t * @type {Program | null} */\n\tlet running_program = null;\n\n\t/**\n\t * @type {PendingProgram | null} */\n\tlet pending_program = null;\n\tlet animation_name = null;\n\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction clear_animation() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @param {PendingProgram} program\n\t * @param {number} duration\n\t * @returns {Program}\n\t */\n\tfunction init(program, duration) {\n\t\tconst d = /** @type {Program['d']} */ (program.b - t);\n\t\tduration *= Math.abs(d);\n\t\treturn {\n\t\t\ta: t,\n\t\t\tb: program.b,\n\t\t\td,\n\t\t\tduration,\n\t\t\tstart: program.start,\n\t\t\tend: program.start + duration,\n\t\t\tgroup: program.group\n\t\t};\n\t}\n\n\t/**\n\t * @param {INTRO | OUTRO} b\n\t * @returns {void}\n\t */\n\tfunction go(b) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\t/**\n\t\t * @type {PendingProgram} */\n\t\tconst program = {\n\t\t\tstart: now() + delay,\n\t\t\tb\n\t\t};\n\n\t\tif (!b) {\n\t\t\t// @ts-ignore todo: improve typings\n\t\t\tprogram.group = outros;\n\t\t\toutros.r += 1;\n\t\t}\n\n\t\tif ('inert' in node) {\n\t\t\tif (b) {\n\t\t\t\tif (original_inert_value !== undefined) {\n\t\t\t\t\t// aborted/reversed outro  restore previous inert value\n\t\t\t\t\tnode.inert = original_inert_value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\t\tnode.inert = true;\n\t\t\t}\n\t\t}\n\n\t\tif (running_program || pending_program) {\n\t\t\tpending_program = program;\n\t\t} else {\n\t\t\t// if this is an intro, and there's a delay, we need to do\n\t\t\t// an initial tick and/or apply CSS animation immediately\n\t\t\tif (css) {\n\t\t\t\tclear_animation();\n\t\t\t\tanimation_name = create_rule(node, t, b, duration, delay, easing, css);\n\t\t\t}\n\t\t\tif (b) tick(0, 1);\n\t\t\trunning_program = init(program, duration);\n\t\t\tadd_render_callback(() => dispatch(node, b, 'start'));\n\t\t\tloop((now) => {\n\t\t\t\tif (pending_program && now > pending_program.start) {\n\t\t\t\t\trunning_program = init(pending_program, duration);\n\t\t\t\t\tpending_program = null;\n\t\t\t\t\tdispatch(node, running_program.b, 'start');\n\t\t\t\t\tif (css) {\n\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\tanimation_name = create_rule(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tt,\n\t\t\t\t\t\t\trunning_program.b,\n\t\t\t\t\t\t\trunning_program.duration,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\teasing,\n\t\t\t\t\t\t\tconfig.css\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (running_program) {\n\t\t\t\t\tif (now >= running_program.end) {\n\t\t\t\t\t\ttick((t = running_program.b), 1 - t);\n\t\t\t\t\t\tdispatch(node, running_program.b, 'end');\n\t\t\t\t\t\tif (!pending_program) {\n\t\t\t\t\t\t\t// we're done\n\t\t\t\t\t\t\tif (running_program.b) {\n\t\t\t\t\t\t\t\t// intro  we can tidy up immediately\n\t\t\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// outro  needs to be coordinated\n\t\t\t\t\t\t\t\tif (!--running_program.group.r) run_all(running_program.group.c);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trunning_program = null;\n\t\t\t\t\t} else if (now >= running_program.start) {\n\t\t\t\t\t\tconst p = now - running_program.start;\n\t\t\t\t\t\tt = running_program.a + running_program.d * easing(p / running_program.duration);\n\t\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn !!(running_program || pending_program);\n\t\t\t});\n\t\t}\n\t}\n\treturn {\n\t\trun(b) {\n\t\t\tif (is_function(config)) {\n\t\t\t\twait().then(() => {\n\t\t\t\t\tconst opts = { direction: b ? 'in' : 'out' };\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tconfig = config(opts);\n\t\t\t\t\tgo(b);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tgo(b);\n\t\t\t}\n\t\t},\n\t\tend() {\n\t\t\tclear_animation();\n\t\t\trunning_program = pending_program = null;\n\t\t}\n\t};\n}\n\n/** @typedef {1} INTRO */\n/** @typedef {0} OUTRO */\n/** @typedef {{ direction: 'in' | 'out' | 'both' }} TransitionOptions */\n/** @typedef {(node: Element, params: any, options: TransitionOptions) => import('../transition/public.js').TransitionConfig} TransitionFn */\n\n/**\n * @typedef {Object} Outro\n * @property {number} r\n * @property {Function[]} c\n * @property {Object} p\n */\n\n/**\n * @typedef {Object} PendingProgram\n * @property {number} start\n * @property {INTRO|OUTRO} b\n * @property {Outro} [group]\n */\n\n/**\n * @typedef {Object} Program\n * @property {number} a\n * @property {INTRO|OUTRO} b\n * @property {1|-1} d\n * @property {number} duration\n * @property {number} start\n * @property {number} end\n * @property {Outro} [group]\n */\n","import { transition_in, transition_out } from './transitions.js';\nimport { run_all } from './utils.js';\n\n// general each functions:\n\nexport function ensure_array_like(array_like_or_iterator) {\n\treturn array_like_or_iterator?.length !== undefined\n\t\t? array_like_or_iterator\n\t\t: Array.from(array_like_or_iterator);\n}\n\n// keyed each functions:\n\n/** @returns {void} */\nexport function destroy_block(block, lookup) {\n\tblock.d(1);\n\tlookup.delete(block.key);\n}\n\n/** @returns {void} */\nexport function outro_and_destroy_block(block, lookup) {\n\ttransition_out(block, 1, 1, () => {\n\t\tlookup.delete(block.key);\n\t});\n}\n\n/** @returns {void} */\nexport function fix_and_destroy_block(block, lookup) {\n\tblock.f();\n\tdestroy_block(block, lookup);\n}\n\n/** @returns {void} */\nexport function fix_and_outro_and_destroy_block(block, lookup) {\n\tblock.f();\n\toutro_and_destroy_block(block, lookup);\n}\n\n/** @returns {any[]} */\nexport function update_keyed_each(\n\told_blocks,\n\tdirty,\n\tget_key,\n\tdynamic,\n\tctx,\n\tlist,\n\tlookup,\n\tnode,\n\tdestroy,\n\tcreate_each_block,\n\tnext,\n\tget_context\n) {\n\tlet o = old_blocks.length;\n\tlet n = list.length;\n\tlet i = o;\n\tconst old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\tconst new_blocks = [];\n\tconst new_lookup = new Map();\n\tconst deltas = new Map();\n\tconst updates = [];\n\ti = n;\n\twhile (i--) {\n\t\tconst child_ctx = get_context(ctx, list, i);\n\t\tconst key = get_key(child_ctx);\n\t\tlet block = lookup.get(key);\n\t\tif (!block) {\n\t\t\tblock = create_each_block(key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\t// defer updates until all the DOM shuffling is done\n\t\t\tupdates.push(() => block.p(child_ctx, dirty));\n\t\t}\n\t\tnew_lookup.set(key, (new_blocks[i] = block));\n\t\tif (key in old_indexes) deltas.set(key, Math.abs(i - old_indexes[key]));\n\t}\n\tconst will_move = new Set();\n\tconst did_move = new Set();\n\t/** @returns {void} */\n\tfunction insert(block) {\n\t\ttransition_in(block, 1);\n\t\tblock.m(node, next);\n\t\tlookup.set(block.key, block);\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\twhile (o && n) {\n\t\tconst new_block = new_blocks[n - 1];\n\t\tconst old_block = old_blocks[o - 1];\n\t\tconst new_key = new_block.key;\n\t\tconst old_key = old_block.key;\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t} else if (!new_lookup.has(old_key)) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t} else if (!lookup.has(new_key) || will_move.has(new_key)) {\n\t\t\tinsert(new_block);\n\t\t} else if (did_move.has(old_key)) {\n\t\t\to--;\n\t\t} else if (deltas.get(new_key) > deltas.get(old_key)) {\n\t\t\tdid_move.add(new_key);\n\t\t\tinsert(new_block);\n\t\t} else {\n\t\t\twill_move.add(old_key);\n\t\t\to--;\n\t\t}\n\t}\n\twhile (o--) {\n\t\tconst old_block = old_blocks[o];\n\t\tif (!new_lookup.has(old_block.key)) destroy(old_block, lookup);\n\t}\n\twhile (n) insert(new_blocks[n - 1]);\n\trun_all(updates);\n\treturn new_blocks;\n}\n\n/** @returns {void} */\nexport function validate_each_keys(ctx, list, get_context, get_key) {\n\tconst keys = new Map();\n\tfor (let i = 0; i < list.length; i++) {\n\t\tconst key = get_key(get_context(ctx, list, i));\n\t\tif (keys.has(key)) {\n\t\t\tlet value = '';\n\t\t\ttry {\n\t\t\t\tvalue = `with value '${String(key)}' `;\n\t\t\t} catch (e) {\n\t\t\t\t// can't stringify\n\t\t\t}\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot have duplicate keys in a keyed each: Keys at index ${keys.get(\n\t\t\t\t\tkey\n\t\t\t\t)} and ${i} ${value}are duplicates`\n\t\t\t);\n\t\t}\n\t\tkeys.set(key, i);\n\t}\n}\n","/** @returns {{}} */\nexport function get_spread_update(levels, updates) {\n\tconst update = {};\n\tconst to_null_out = {};\n\tconst accounted_for = { $$scope: 1 };\n\tlet i = levels.length;\n\twhile (i--) {\n\t\tconst o = levels[i];\n\t\tconst n = updates[i];\n\t\tif (n) {\n\t\t\tfor (const key in o) {\n\t\t\t\tif (!(key in n)) to_null_out[key] = 1;\n\t\t\t}\n\t\t\tfor (const key in n) {\n\t\t\t\tif (!accounted_for[key]) {\n\t\t\t\t\tupdate[key] = n[key];\n\t\t\t\t\taccounted_for[key] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tlevels[i] = n;\n\t\t} else {\n\t\t\tfor (const key in o) {\n\t\t\t\taccounted_for[key] = 1;\n\t\t\t}\n\t\t}\n\t}\n\tfor (const key in to_null_out) {\n\t\tif (!(key in update)) update[key] = undefined;\n\t}\n\treturn update;\n}\n\nexport function get_spread_object(spread_props) {\n\treturn typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n","import {\n\tadd_render_callback,\n\tflush,\n\tflush_render_callbacks,\n\tschedule_update,\n\tdirty_components\n} from './scheduler.js';\nimport { current_component, set_current_component } from './lifecycle.js';\nimport { blank_object, is_empty, is_function, run, run_all, noop } from './utils.js';\nimport {\n\tchildren,\n\tdetach,\n\tstart_hydrating,\n\tend_hydrating,\n\tget_custom_elements_slots,\n\tinsert,\n\telement,\n\tattr\n} from './dom.js';\nimport { transition_in } from './transitions.js';\n\n/** @returns {void} */\nexport function bind(component, name, callback) {\n\tconst index = component.$$.props[name];\n\tif (index !== undefined) {\n\t\tcomponent.$$.bound[index] = callback;\n\t\tcallback(component.$$.ctx[index]);\n\t}\n}\n\n/** @returns {void} */\nexport function create_component(block) {\n\tblock && block.c();\n}\n\n/** @returns {void} */\nexport function claim_component(block, parent_nodes) {\n\tblock && block.l(parent_nodes);\n}\n\n/** @returns {void} */\nexport function mount_component(component, target, anchor) {\n\tconst { fragment, after_update } = component.$$;\n\tfragment && fragment.m(target, anchor);\n\t// onMount happens before the initial afterUpdate\n\tadd_render_callback(() => {\n\t\tconst new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n\t\t// if the component was destroyed immediately\n\t\t// it will update the `$$.on_destroy` reference to `null`.\n\t\t// the destructured on_destroy may still reference to the old array\n\t\tif (component.$$.on_destroy) {\n\t\t\tcomponent.$$.on_destroy.push(...new_on_destroy);\n\t\t} else {\n\t\t\t// Edge case - component was destroyed immediately,\n\t\t\t// most likely as a result of a binding initialising\n\t\t\trun_all(new_on_destroy);\n\t\t}\n\t\tcomponent.$$.on_mount = [];\n\t});\n\tafter_update.forEach(add_render_callback);\n}\n\n/** @returns {void} */\nexport function destroy_component(component, detaching) {\n\tconst $$ = component.$$;\n\tif ($$.fragment !== null) {\n\t\tflush_render_callbacks($$.after_update);\n\t\trun_all($$.on_destroy);\n\t\t$$.fragment && $$.fragment.d(detaching);\n\t\t// TODO null out other refs, including component.$$ (but need to\n\t\t// preserve final state?)\n\t\t$$.on_destroy = $$.fragment = null;\n\t\t$$.ctx = [];\n\t}\n}\n\n/** @returns {void} */\nfunction make_dirty(component, i) {\n\tif (component.$$.dirty[0] === -1) {\n\t\tdirty_components.push(component);\n\t\tschedule_update();\n\t\tcomponent.$$.dirty.fill(0);\n\t}\n\tcomponent.$$.dirty[(i / 31) | 0] |= 1 << i % 31;\n}\n\n// TODO: Document the other params\n/**\n * @param {SvelteComponent} component\n * @param {import('./public.js').ComponentConstructorOptions} options\n *\n * @param {import('./utils.js')['not_equal']} not_equal Used to compare props and state values.\n * @param {(target: Element | ShadowRoot) => void} [append_styles] Function that appends styles to the DOM when the component is first initialised.\n * This will be the `add_css` function from the compiled component.\n *\n * @returns {void}\n */\nexport function init(\n\tcomponent,\n\toptions,\n\tinstance,\n\tcreate_fragment,\n\tnot_equal,\n\tprops,\n\tappend_styles = null,\n\tdirty = [-1]\n) {\n\tconst parent_component = current_component;\n\tset_current_component(component);\n\t/** @type {import('./private.js').T$$} */\n\tconst $$ = (component.$$ = {\n\t\tfragment: null,\n\t\tctx: [],\n\t\t// state\n\t\tprops,\n\t\tupdate: noop,\n\t\tnot_equal,\n\t\tbound: blank_object(),\n\t\t// lifecycle\n\t\ton_mount: [],\n\t\ton_destroy: [],\n\t\ton_disconnect: [],\n\t\tbefore_update: [],\n\t\tafter_update: [],\n\t\tcontext: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n\t\t// everything else\n\t\tcallbacks: blank_object(),\n\t\tdirty,\n\t\tskip_bound: false,\n\t\troot: options.target || parent_component.$$.root\n\t});\n\tappend_styles && append_styles($$.root);\n\tlet ready = false;\n\t$$.ctx = instance\n\t\t? instance(component, options.props || {}, (i, ret, ...rest) => {\n\t\t\t\tconst value = rest.length ? rest[0] : ret;\n\t\t\t\tif ($$.ctx && not_equal($$.ctx[i], ($$.ctx[i] = value))) {\n\t\t\t\t\tif (!$$.skip_bound && $$.bound[i]) $$.bound[i](value);\n\t\t\t\t\tif (ready) make_dirty(component, i);\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t  })\n\t\t: [];\n\t$$.update();\n\tready = true;\n\trun_all($$.before_update);\n\t// `false` as a special case of no DOM component\n\t$$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n\tif (options.target) {\n\t\tif (options.hydrate) {\n\t\t\tstart_hydrating();\n\t\t\t// TODO: what is the correct type here?\n\t\t\t// @ts-expect-error\n\t\t\tconst nodes = children(options.target);\n\t\t\t$$.fragment && $$.fragment.l(nodes);\n\t\t\tnodes.forEach(detach);\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\t\t$$.fragment && $$.fragment.c();\n\t\t}\n\t\tif (options.intro) transition_in(component.$$.fragment);\n\t\tmount_component(component, options.target, options.anchor);\n\t\tend_hydrating();\n\t\tflush();\n\t}\n\tset_current_component(parent_component);\n}\n\nexport let SvelteElement;\n\nif (typeof HTMLElement === 'function') {\n\tSvelteElement = class extends HTMLElement {\n\t\t/** The Svelte component constructor */\n\t\t$$ctor;\n\t\t/** Slots */\n\t\t$$s;\n\t\t/** The Svelte component instance */\n\t\t$$c;\n\t\t/** Whether or not the custom element is connected */\n\t\t$$cn = false;\n\t\t/** Component props data */\n\t\t$$d = {};\n\t\t/** `true` if currently in the process of reflecting component props back to attributes */\n\t\t$$r = false;\n\t\t/** @type {Record<string, CustomElementPropDefinition>} Props definition (name, reflected, type etc) */\n\t\t$$p_d = {};\n\t\t/** @type {Record<string, Function[]>} Event listeners */\n\t\t$$l = {};\n\t\t/** @type {Map<Function, Function>} Event listener unsubscribe functions */\n\t\t$$l_u = new Map();\n\n\t\tconstructor($$componentCtor, $$slots, use_shadow_dom) {\n\t\t\tsuper();\n\t\t\tthis.$$ctor = $$componentCtor;\n\t\t\tthis.$$s = $$slots;\n\t\t\tif (use_shadow_dom) {\n\t\t\t\tthis.attachShadow({ mode: 'open' });\n\t\t\t}\n\t\t}\n\n\t\taddEventListener(type, listener, options) {\n\t\t\t// We can't determine upfront if the event is a custom event or not, so we have to\n\t\t\t// listen to both. If someone uses a custom event with the same name as a regular\n\t\t\t// browser event, this fires twice - we can't avoid that.\n\t\t\tthis.$$l[type] = this.$$l[type] || [];\n\t\t\tthis.$$l[type].push(listener);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t}\n\t\t\tsuper.addEventListener(type, listener, options);\n\t\t}\n\n\t\tremoveEventListener(type, listener, options) {\n\t\t\tsuper.removeEventListener(type, listener, options);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$l_u.get(listener);\n\t\t\t\tif (unsub) {\n\t\t\t\t\tunsub();\n\t\t\t\t\tthis.$$l_u.delete(listener);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tasync connectedCallback() {\n\t\t\tthis.$$cn = true;\n\t\t\tif (!this.$$c) {\n\t\t\t\t// We wait one tick to let possible child slot elements be created/mounted\n\t\t\t\tawait Promise.resolve();\n\t\t\t\tif (!this.$$cn || this.$$c) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfunction create_slot(name) {\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tlet node;\n\t\t\t\t\t\tconst obj = {\n\t\t\t\t\t\t\tc: function create() {\n\t\t\t\t\t\t\t\tnode = element('slot');\n\t\t\t\t\t\t\t\tif (name !== 'default') {\n\t\t\t\t\t\t\t\t\tattr(node, 'name', name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * @param {HTMLElement} target\n\t\t\t\t\t\t\t * @param {HTMLElement} [anchor]\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tm: function mount(target, anchor) {\n\t\t\t\t\t\t\t\tinsert(target, node, anchor);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\td: function destroy(detaching) {\n\t\t\t\t\t\t\t\tif (detaching) {\n\t\t\t\t\t\t\t\t\tdetach(node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn obj;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tconst $$slots = {};\n\t\t\t\tconst existing_slots = get_custom_elements_slots(this);\n\t\t\t\tfor (const name of this.$$s) {\n\t\t\t\t\tif (name in existing_slots) {\n\t\t\t\t\t\t$$slots[name] = [create_slot(name)];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const attribute of this.attributes) {\n\t\t\t\t\t// this.$$data takes precedence over this.attributes\n\t\t\t\t\tconst name = this.$$g_p(attribute.name);\n\t\t\t\t\tif (!(name in this.$$d)) {\n\t\t\t\t\t\tthis.$$d[name] = get_custom_element_value(name, attribute.value, this.$$p_d, 'toProp');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Port over props that were set programmatically before ce was initialized\n\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\tif (!(key in this.$$d) && this[key] !== undefined) {\n\t\t\t\t\t\tthis.$$d[key] = this[key]; // don't transform, these were set through JavaScript\n\t\t\t\t\t\tdelete this[key]; // remove the property that shadows the getter/setter\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$c = new this.$$ctor({\n\t\t\t\t\ttarget: this.shadowRoot || this,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...this.$$d,\n\t\t\t\t\t\t$$slots,\n\t\t\t\t\t\t$$scope: {\n\t\t\t\t\t\t\tctx: []\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Reflect component props as attributes\n\t\t\t\tconst reflect_attributes = () => {\n\t\t\t\t\tthis.$$r = true;\n\t\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\t\tthis.$$d[key] = this.$$c.$$.ctx[this.$$c.$$.props[key]];\n\t\t\t\t\t\tif (this.$$p_d[key].reflect) {\n\t\t\t\t\t\t\tconst attribute_value = get_custom_element_value(\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tthis.$$d[key],\n\t\t\t\t\t\t\t\tthis.$$p_d,\n\t\t\t\t\t\t\t\t'toAttribute'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (attribute_value == null) {\n\t\t\t\t\t\t\t\tthis.removeAttribute(this.$$p_d[key].attribute || key);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.setAttribute(this.$$p_d[key].attribute || key, attribute_value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.$$r = false;\n\t\t\t\t};\n\t\t\t\tthis.$$c.$$.after_update.push(reflect_attributes);\n\t\t\t\treflect_attributes(); // once initially because after_update is added too late for first render\n\n\t\t\t\tfor (const type in this.$$l) {\n\t\t\t\t\tfor (const listener of this.$$l[type]) {\n\t\t\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$l = {};\n\t\t\t}\n\t\t}\n\n\t\t// We don't need this when working within Svelte code, but for compatibility of people using this outside of Svelte\n\t\t// and setting attributes through setAttribute etc, this is helpful\n\t\tattributeChangedCallback(attr, _oldValue, newValue) {\n\t\t\tif (this.$$r) return;\n\t\t\tattr = this.$$g_p(attr);\n\t\t\tthis.$$d[attr] = get_custom_element_value(attr, newValue, this.$$p_d, 'toProp');\n\t\t\tthis.$$c?.$set({ [attr]: this.$$d[attr] });\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tthis.$$cn = false;\n\t\t\t// In a microtask, because this could be a move within the DOM\n\t\t\tPromise.resolve().then(() => {\n\t\t\t\tif (!this.$$cn && this.$$c) {\n\t\t\t\t\tthis.$$c.$destroy();\n\t\t\t\t\tthis.$$c = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$$g_p(attribute_name) {\n\t\t\treturn (\n\t\t\t\tObject.keys(this.$$p_d).find(\n\t\t\t\t\t(key) =>\n\t\t\t\t\t\tthis.$$p_d[key].attribute === attribute_name ||\n\t\t\t\t\t\t(!this.$$p_d[key].attribute && key.toLowerCase() === attribute_name)\n\t\t\t\t) || attribute_name\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * @param {string} prop\n * @param {any} value\n * @param {Record<string, CustomElementPropDefinition>} props_definition\n * @param {'toAttribute' | 'toProp'} [transform]\n */\nfunction get_custom_element_value(prop, value, props_definition, transform) {\n\tconst type = props_definition[prop]?.type;\n\tvalue = type === 'Boolean' && typeof value !== 'boolean' ? value != null : value;\n\tif (!transform || !props_definition[prop]) {\n\t\treturn value;\n\t} else if (transform === 'toAttribute') {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value == null ? null : JSON.stringify(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value ? '' : null;\n\t\t\tcase 'Number':\n\t\t\t\treturn value == null ? null : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t} else {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value && JSON.parse(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value; // conversion already handled above\n\t\t\tcase 'Number':\n\t\t\t\treturn value != null ? +value : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t}\n}\n\n/**\n * @internal\n *\n * Turn a Svelte component into a custom element.\n * @param {import('./public.js').ComponentType} Component  A Svelte component constructor\n * @param {Record<string, CustomElementPropDefinition>} props_definition  The props to observe\n * @param {string[]} slots  The slots to create\n * @param {string[]} accessors  Other accessors besides the ones for props the component has\n * @param {boolean} use_shadow_dom  Whether to use shadow DOM\n * @param {(ce: new () => HTMLElement) => new () => HTMLElement} [extend]\n */\nexport function create_custom_element(\n\tComponent,\n\tprops_definition,\n\tslots,\n\taccessors,\n\tuse_shadow_dom,\n\textend\n) {\n\tlet Class = class extends SvelteElement {\n\t\tconstructor() {\n\t\t\tsuper(Component, slots, use_shadow_dom);\n\t\t\tthis.$$p_d = props_definition;\n\t\t}\n\t\tstatic get observedAttributes() {\n\t\t\treturn Object.keys(props_definition).map((key) =>\n\t\t\t\t(props_definition[key].attribute || key).toLowerCase()\n\t\t\t);\n\t\t}\n\t};\n\tObject.keys(props_definition).forEach((prop) => {\n\t\tObject.defineProperty(Class.prototype, prop, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c && prop in this.$$c ? this.$$c[prop] : this.$$d[prop];\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tvalue = get_custom_element_value(prop, value, props_definition);\n\t\t\t\tthis.$$d[prop] = value;\n\t\t\t\tthis.$$c?.$set({ [prop]: value });\n\t\t\t}\n\t\t});\n\t});\n\taccessors.forEach((accessor) => {\n\t\tObject.defineProperty(Class.prototype, accessor, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c?.[accessor];\n\t\t\t}\n\t\t});\n\t});\n\tif (extend) {\n\t\t// @ts-expect-error - assigning here is fine\n\t\tClass = extend(Class);\n\t}\n\tComponent.element = /** @type {any} */ (Class);\n\treturn Class;\n}\n\n/**\n * Base class for Svelte components. Used when dev=false.\n *\n * @template {Record<string, any>} [Props=any]\n * @template {Record<string, any>} [Events=any]\n */\nexport class SvelteComponent {\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$ = undefined;\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$set = undefined;\n\n\t/** @returns {void} */\n\t$destroy() {\n\t\tdestroy_component(this, 1);\n\t\tthis.$destroy = noop;\n\t}\n\n\t/**\n\t * @template {Extract<keyof Events, string>} K\n\t * @param {K} type\n\t * @param {((e: Events[K]) => void) | null | undefined} callback\n\t * @returns {() => void}\n\t */\n\t$on(type, callback) {\n\t\tif (!is_function(callback)) {\n\t\t\treturn noop;\n\t\t}\n\t\tconst callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);\n\t\tcallbacks.push(callback);\n\t\treturn () => {\n\t\t\tconst index = callbacks.indexOf(callback);\n\t\t\tif (index !== -1) callbacks.splice(index, 1);\n\t\t};\n\t}\n\n\t/**\n\t * @param {Partial<Props>} props\n\t * @returns {void}\n\t */\n\t$set(props) {\n\t\tif (this.$$set && !is_empty(props)) {\n\t\t\tthis.$$.skip_bound = true;\n\t\t\tthis.$$set(props);\n\t\t\tthis.$$.skip_bound = false;\n\t\t}\n\t}\n}\n\n/**\n * @typedef {Object} CustomElementPropDefinition\n * @property {string} [attribute]\n * @property {boolean} [reflect]\n * @property {'String'|'Boolean'|'Number'|'Array'|'Object'} [type]\n */\n","// generated during release, do not modify\n\n/**\n * The current version, as set in package.json.\n *\n * https://svelte.dev/docs/svelte-compiler#svelte-version\n * @type {string}\n */\nexport const VERSION = '4.2.18';\nexport const PUBLIC_VERSION = '4';\n","import {\n\trun_all,\n\tsubscribe,\n\tnoop,\n\tsafe_not_equal,\n\tis_function,\n\tget_store_value\n} from '../internal/index.js';\n\nconst subscriber_queue = [];\n\n/**\n * Creates a `Readable` store that allows reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#readable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readable(value, start) {\n\treturn {\n\t\tsubscribe: writable(value, start).subscribe\n\t};\n}\n\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n *\n * https://svelte.dev/docs/svelte-store#writable\n * @template T\n * @param {T} [value] initial value\n * @param {import('./public.js').StartStopNotifier<T>} [start]\n * @returns {import('./public.js').Writable<T>}\n */\nexport function writable(value, start = noop) {\n\t/** @type {import('./public.js').Unsubscriber} */\n\tlet stop;\n\t/** @type {Set<import('./private.js').SubscribeInvalidateTuple<T>>} */\n\tconst subscribers = new Set();\n\t/** @param {T} new_value\n\t * @returns {void}\n\t */\n\tfunction set(new_value) {\n\t\tif (safe_not_equal(value, new_value)) {\n\t\t\tvalue = new_value;\n\t\t\tif (stop) {\n\t\t\t\t// store is ready\n\t\t\t\tconst run_queue = !subscriber_queue.length;\n\t\t\t\tfor (const subscriber of subscribers) {\n\t\t\t\t\tsubscriber[1]();\n\t\t\t\t\tsubscriber_queue.push(subscriber, value);\n\t\t\t\t}\n\t\t\t\tif (run_queue) {\n\t\t\t\t\tfor (let i = 0; i < subscriber_queue.length; i += 2) {\n\t\t\t\t\t\tsubscriber_queue[i][0](subscriber_queue[i + 1]);\n\t\t\t\t\t}\n\t\t\t\t\tsubscriber_queue.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * @param {import('./public.js').Updater<T>} fn\n\t * @returns {void}\n\t */\n\tfunction update(fn) {\n\t\tset(fn(value));\n\t}\n\n\t/**\n\t * @param {import('./public.js').Subscriber<T>} run\n\t * @param {import('./private.js').Invalidator<T>} [invalidate]\n\t * @returns {import('./public.js').Unsubscriber}\n\t */\n\tfunction subscribe(run, invalidate = noop) {\n\t\t/** @type {import('./private.js').SubscribeInvalidateTuple<T>} */\n\t\tconst subscriber = [run, invalidate];\n\t\tsubscribers.add(subscriber);\n\t\tif (subscribers.size === 1) {\n\t\t\tstop = start(set, update) || noop;\n\t\t}\n\t\trun(value);\n\t\treturn () => {\n\t\t\tsubscribers.delete(subscriber);\n\t\t\tif (subscribers.size === 0 && stop) {\n\t\t\t\tstop();\n\t\t\t\tstop = null;\n\t\t\t}\n\t\t};\n\t}\n\treturn { set, update, subscribe };\n}\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>, set: (value: T) => void, update: (fn: import('./public.js').Updater<T>) => void) => import('./public.js').Unsubscriber | void} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * Derived value store by synchronizing one or more readable stores and\n * applying an aggregation function over its input values.\n *\n * https://svelte.dev/docs/svelte-store#derived\n * @template {import('./private.js').Stores} S\n * @template T\n * @overload\n * @param {S} stores - input stores\n * @param {(values: import('./private.js').StoresValues<S>) => T} fn - function callback that aggregates the values\n * @param {T} [initial_value] - initial value\n * @returns {import('./public.js').Readable<T>}\n */\n\n/**\n * @template {import('./private.js').Stores} S\n * @template T\n * @param {S} stores\n * @param {Function} fn\n * @param {T} [initial_value]\n * @returns {import('./public.js').Readable<T>}\n */\nexport function derived(stores, fn, initial_value) {\n\tconst single = !Array.isArray(stores);\n\t/** @type {Array<import('./public.js').Readable<any>>} */\n\tconst stores_array = single ? [stores] : stores;\n\tif (!stores_array.every(Boolean)) {\n\t\tthrow new Error('derived() expects stores as input, got a falsy value');\n\t}\n\tconst auto = fn.length < 2;\n\treturn readable(initial_value, (set, update) => {\n\t\tlet started = false;\n\t\tconst values = [];\n\t\tlet pending = 0;\n\t\tlet cleanup = noop;\n\t\tconst sync = () => {\n\t\t\tif (pending) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tcleanup();\n\t\t\tconst result = fn(single ? values[0] : values, set, update);\n\t\t\tif (auto) {\n\t\t\t\tset(result);\n\t\t\t} else {\n\t\t\t\tcleanup = is_function(result) ? result : noop;\n\t\t\t}\n\t\t};\n\t\tconst unsubscribers = stores_array.map((store, i) =>\n\t\t\tsubscribe(\n\t\t\t\tstore,\n\t\t\t\t(value) => {\n\t\t\t\t\tvalues[i] = value;\n\t\t\t\t\tpending &= ~(1 << i);\n\t\t\t\t\tif (started) {\n\t\t\t\t\t\tsync();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tpending |= 1 << i;\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\t\tstarted = true;\n\t\tsync();\n\t\treturn function stop() {\n\t\t\trun_all(unsubscribers);\n\t\t\tcleanup();\n\t\t\t// We need to set this to false because callbacks can still happen despite having unsubscribed:\n\t\t\t// Callbacks might already be placed in the queue which doesn't know it should no longer\n\t\t\t// invoke this derived store.\n\t\t\tstarted = false;\n\t\t};\n\t});\n}\n\n/**\n * Takes a store and returns a new one derived from the old one that is readable.\n *\n * https://svelte.dev/docs/svelte-store#readonly\n * @template T\n * @param {import('./public.js').Readable<T>} store  - store to make readonly\n * @returns {import('./public.js').Readable<T>}\n */\nexport function readonly(store) {\n\treturn {\n\t\tsubscribe: store.subscribe.bind(store)\n\t};\n}\n\nexport { get_store_value as get };\n","import { derived, get } from 'svelte/store';\n\n/**\n * @external Store\n * @see [Svelte stores](https://svelte.dev/docs#component-format-script-4-prefix-stores-with-$-to-access-their-values-store-contract)\n */\n\n/**\n * Create a store similar to [Svelte's `derived`](https://svelte.dev/docs#run-time-svelte-store-writable),\n * but which has its own `set` and `update` methods and can send values back to the origin stores.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#default-export-writablederived)\n * \n * @param {Store|Store[]} origins One or more stores to derive from. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 1st parameter.\n * @param {!Function} derive The callback to determine the derived value. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 2nd parameter.\n * @param {!Function} reflect Called when the derived store gets a new value via its `set` or\n * `update` methods, and determines new values for the origin stores.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#new-parameter-reflect)\n * @param [initial] The new store's initial value. Same as\n * [`derived`](https://svelte.dev/docs#run-time-svelte-store-writable)'s 3rd parameter.\n * \n * @returns {Store} A writable store.\n */\nfunction writableDerived(origins, derive, reflect, initial) {\n\tvar childDerivedSetter, originValues, blockNextDerive = false;\n\tvar reflectOldValues = reflect.length >= 2;\n\tvar wrappedDerive = (got, set, update) => {\n\t\tchildDerivedSetter = set;\n\t\tif (reflectOldValues) {\n\t\t\toriginValues = got;\n\t\t}\n\t\tif (!blockNextDerive) {\n\t\t\tlet returned = derive(got, set, update);\n\t\t\tif (derive.length < 2) {\n\t\t\t\tset(returned);\n\t\t\t} else {\n\t\t\t\treturn returned;\n\t\t\t}\n\t\t}\n\t\tblockNextDerive = false;\n\t};\n\tvar childDerived = derived(origins, wrappedDerive, initial);\n\t\n\tvar singleOrigin = !Array.isArray(origins);\n\tfunction doReflect(reflecting) {\n\t\tvar setWith = reflect(reflecting, originValues);\n\t\tif (singleOrigin) {\n\t\t\tblockNextDerive = true;\n\t\t\torigins.set(setWith);\n\t\t} else {\n\t\t\tsetWith.forEach( (value, i) => {\n\t\t\t\tblockNextDerive = true;\n\t\t\t\torigins[i].set(value);\n\t\t\t} );\n\t\t}\n\t\tblockNextDerive = false;\n\t}\n\t\n\tvar tryingSet = false;\n\tfunction update(fn) {\n\t\tvar isUpdated, mutatedBySubscriptions, oldValue, newValue;\n\t\tif (tryingSet) {\n\t\t\tnewValue = fn( get(childDerived) );\n\t\t\tchildDerivedSetter(newValue);\n\t\t\treturn;\n\t\t}\n\t\tvar unsubscribe = childDerived.subscribe( (value) => {\n\t\t\tif (!tryingSet) {\n\t\t\t\toldValue = value;\n\t\t\t} else if (!isUpdated) {\n\t\t\t\tisUpdated = true;\n\t\t\t} else {\n\t\t\t\tmutatedBySubscriptions = true;\n\t\t\t}\n\t\t} );\n\t\tnewValue = fn(oldValue);\n\t\ttryingSet = true;\n\t\tchildDerivedSetter(newValue);\n\t\tunsubscribe();\n\t\ttryingSet = false;\n\t\tif (mutatedBySubscriptions) {\n\t\t\tnewValue = get(childDerived);\n\t\t}\n\t\tif (isUpdated) {\n\t\t\tdoReflect(newValue);\n\t\t}\n\t}\n\treturn {\n\t\tsubscribe: childDerived.subscribe,\n\t\tset(value) { update( () => value ); },\n\t\tupdate,\n\t};\n}\n\n/**\n * Create a store for a property value in an object contained in another store.\n * [Read more...](https://github.com/PixievoltNo1/svelte-writable-derived#named-export-propertystore)\n * \n * @param {Store} origin The store containing the object to get/set from.\n * @param {string|number|symbol|Array<string|number|symbol>} propName The property to get/set, or a path of\n * properties in nested objects.\n *\n * @returns {Store} A writable store.\n */\nfunction propertyStore(origin, propName) {\n\tif (!Array.isArray(propName)) {\n\t\treturn writableDerived(\n\t\t\torigin,\n\t\t\t(object) => object[propName],\n\t\t\t(reflecting, object) => {\n\t\t\t\tobject[propName] = reflecting;\n\t\t\t\treturn object;\n\t\t\t},\n\t\t);\n\t} else {\n\t\tlet props = propName.concat();\n\t\treturn writableDerived(\n\t\t\torigin,\n\t\t\t(value) => {\n\t\t\t\tfor (let i = 0; i < props.length; ++i) {\n\t\t\t\t\tvalue = value[ props[i] ];\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\t(reflecting, object) => {\n\t\t\t\tlet target = object;\n\t\t\t\tfor (let i = 0; i < props.length - 1; ++i) {\n\t\t\t\t\ttarget = target[ props[i] ];\n\t\t\t\t}\n\t\t\t\ttarget[ props[props.length - 1] ] = reflecting;\n\t\t\t\treturn object;\n\t\t\t},\n\t\t);\n\t}\n}\n\nexport { propertyStore, writableDerived };\n//# sourceMappingURL=index.js.map\n","function set(obj, key, val) {\n\tif (typeof val.value === 'object') val.value = klona(val.value);\n\tif (!val.enumerable || val.get || val.set || !val.configurable || !val.writable || key === '__proto__') {\n\t\tObject.defineProperty(obj, key, val);\n\t} else obj[key] = val.value;\n}\n\nfunction klona(x) {\n\tif (typeof x !== 'object') return x;\n\n\tvar i=0, k, list, tmp, str=Object.prototype.toString.call(x);\n\n\tif (str === '[object Object]') {\n\t\ttmp = Object.create(x.__proto__ || null);\n\t} else if (str === '[object Array]') {\n\t\ttmp = Array(x.length);\n\t} else if (str === '[object Set]') {\n\t\ttmp = new Set;\n\t\tx.forEach(function (val) {\n\t\t\ttmp.add(klona(val));\n\t\t});\n\t} else if (str === '[object Map]') {\n\t\ttmp = new Map;\n\t\tx.forEach(function (val, key) {\n\t\t\ttmp.set(klona(key), klona(val));\n\t\t});\n\t} else if (str === '[object Date]') {\n\t\ttmp = new Date(+x);\n\t} else if (str === '[object RegExp]') {\n\t\ttmp = new RegExp(x.source, x.flags);\n\t} else if (str === '[object DataView]') {\n\t\ttmp = new x.constructor( klona(x.buffer) );\n\t} else if (str === '[object ArrayBuffer]') {\n\t\ttmp = x.slice(0);\n\t} else if (str.slice(-6) === 'Array]') {\n\t\t// ArrayBuffer.isView(x)\n\t\t// ~> `new` bcuz `Buffer.slice` => ref\n\t\ttmp = new x.constructor(x);\n\t}\n\n\tif (tmp) {\n\t\tfor (list=Object.getOwnPropertySymbols(x); i < list.length; i++) {\n\t\t\tset(tmp, list[i], Object.getOwnPropertyDescriptor(x, list[i]));\n\t\t}\n\n\t\tfor (i=0, list=Object.getOwnPropertyNames(x); i < list.length; i++) {\n\t\t\tif (Object.hasOwnProperty.call(tmp, k=list[i]) && tmp[k] === x[k]) continue;\n\t\t\tset(tmp, k, Object.getOwnPropertyDescriptor(x, k));\n\t\t}\n\t}\n\n\treturn tmp || x;\n}\n\n/**\n * Provides common object manipulation utilities including depth traversal, obtaining accessors, safely setting values /\n * equality tests, and validation.\n */\nconst s_TAG_OBJECT = '[object Object]';\nconst s_TAG_MAP = '[object Map]';\nconst s_TAG_SET = '[object Set]';\nconst s_TAG_STRING = '[object String]';\n/**\n * Freezes all entries traversed that are objects including entries in arrays.\n *\n * @param {object | []}   data - An object or array.\n *\n * @param {Set<string>}   [skipFreezeKeys] - A Set of strings indicating keys of objects to not freeze.\n *\n * @returns {object | []} The frozen object.\n */\nfunction deepFreeze(data, skipFreezeKeys) {\n    /* c8 ignore next 1 */\n    if (typeof data !== 'object') {\n        throw new TypeError(`'data' is not an 'object'.`);\n    }\n    /* c8 ignore next 4 */\n    if (skipFreezeKeys !== void 0 && !(skipFreezeKeys instanceof Set)) {\n        throw new TypeError(`'skipFreezeKeys' is not an 'Set'.`);\n    }\n    return _deepFreeze(data, skipFreezeKeys);\n}\n/**\n * Recursively deep merges all source objects into the target object in place. Like `Object.assign` if you provide `{}`\n * as the target a copy is produced. If the target and source property are object literals they are merged.\n * Deleting keys is supported by specifying a property starting with `-=`.\n *\n * @param {object}      target - Target object.\n *\n * @param {...object}   sourceObj - One or more source objects.\n *\n * @returns {object}    Target object.\n */\nfunction deepMerge(target = {}, ...sourceObj) {\n    if (Object.prototype.toString.call(target) !== s_TAG_OBJECT) {\n        throw new TypeError(`deepMerge error: 'target' is not an 'object'.`);\n    }\n    for (let cntr = 0; cntr < sourceObj.length; cntr++) {\n        if (Object.prototype.toString.call(sourceObj[cntr]) !== s_TAG_OBJECT) {\n            throw new TypeError(`deepMerge error: 'sourceObj[${cntr}]' is not an 'object'.`);\n        }\n    }\n    return _deepMerge(target, ...sourceObj);\n}\n/**\n * Performs a naive depth traversal of an object / array. The data structure _must not_ have circular references.\n * The result of the callback function is used to modify in place the given data.\n *\n * @param {object | []}   data - An object or array.\n *\n * @param {(any) => any}  func - A callback function to process leaf values in children arrays or object members.\n *\n * @param {boolean}       modify - If true then the result of the callback function is used to modify in place\n *                                  the given data.\n *\n * @returns {*} The data object.\n */\nfunction depthTraverse(data, func, modify = false) {\n    /* c8 ignore next 1 */\n    if (typeof data !== 'object') {\n        throw new TypeError(`'data' is not an 'object'.`);\n    }\n    /* c8 ignore next 1 */\n    if (typeof func !== 'function') {\n        throw new TypeError(`'func' is not a 'function'.`);\n    }\n    return _depthTraverse(data, func, modify);\n}\n/**\n * Returns a list of accessor keys by traversing the given object.\n *\n * @param {object}   data - An object to traverse for accessor keys.\n *\n * @returns {string[]} Accessor list.\n */\nfunction getAccessorList(data) {\n    if (typeof data !== 'object') {\n        throw new TypeError(`getAccessorList error: 'data' is not an 'object'.`);\n    }\n    return _getAccessorList(data);\n}\n/**\n * Provides a method to determine if the passed in Svelte component has a getter & setter accessor.\n *\n * @param {object}   object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the getter and setter for accessor.\n */\nfunction hasAccessor(object, accessor) {\n    if (typeof object !== 'object' || object === null || object === void 0) {\n        return false;\n    }\n    // Check for instance accessor.\n    const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n    if (iDescriptor !== void 0 && iDescriptor.get !== void 0 && iDescriptor.set !== void 0) {\n        return true;\n    }\n    // Walk parent prototype chain. Check for descriptor at each prototype level.\n    for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o)) {\n        const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n        if (descriptor !== void 0 && descriptor.get !== void 0 && descriptor.set !== void 0) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Provides a method to determine if the passed in Svelte component has a getter accessor.\n *\n * @param {object}   object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the getter for accessor.\n */\nfunction hasGetter(object, accessor) {\n    if (typeof object !== 'object' || object === null || object === void 0) {\n        return false;\n    }\n    // Check for instance accessor.\n    const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n    if (iDescriptor !== void 0 && iDescriptor.get !== void 0) {\n        return true;\n    }\n    // Walk parent prototype chain. Check for descriptor at each prototype level.\n    for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o)) {\n        const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n        if (descriptor !== void 0 && descriptor.get !== void 0) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Returns whether the target is or has the given prototype walking up the prototype chain.\n *\n * @param {unknown}  target - Any target to test.\n *\n * @param {new (...args: any[]) => any} Prototype - Prototype function / class constructor to find.\n *\n * @returns {boolean} Target matches prototype.\n */\nfunction hasPrototype(target, Prototype) {\n    /* c8 ignore next */\n    if (typeof target !== 'function') {\n        return false;\n    }\n    if (target === Prototype) {\n        return true;\n    }\n    // Walk parent prototype chain. Check for descriptor at each prototype level.\n    for (let proto = Object.getPrototypeOf(target); proto; proto = Object.getPrototypeOf(proto)) {\n        if (proto === Prototype) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Provides a method to determine if the passed in Svelte component has a setter accessor.\n *\n * @param {object}   object - An object.\n *\n * @param {string}   accessor - Accessor to test.\n *\n * @returns {boolean} Whether the component has the setter for accessor.\n */\nfunction hasSetter(object, accessor) {\n    if (typeof object !== 'object' || object === null || object === void 0) {\n        return false;\n    }\n    // Check for instance accessor.\n    const iDescriptor = Object.getOwnPropertyDescriptor(object, accessor);\n    if (iDescriptor !== void 0 && iDescriptor.set !== void 0) {\n        return true;\n    }\n    // Walk parent prototype chain. Check for descriptor at each prototype level.\n    for (let o = Object.getPrototypeOf(object); o; o = Object.getPrototypeOf(o)) {\n        const descriptor = Object.getOwnPropertyDescriptor(o, accessor);\n        if (descriptor !== void 0 && descriptor.set !== void 0) {\n            return true;\n        }\n    }\n    return false;\n}\n/**\n * Tests for whether an object is async iterable.\n *\n * @param {unknown} value - Any value.\n *\n * @returns {boolean} Whether value is async iterable.\n */\nfunction isAsyncIterable(value) {\n    if (typeof value !== 'object' || value === null || value === void 0) {\n        return false;\n    }\n    return Symbol.asyncIterator in value;\n}\n/**\n * Tests for whether an object is iterable.\n *\n * @param {unknown} value - Any value.\n *\n * @returns {boolean} Whether object is iterable.\n */\nfunction isIterable(value) {\n    if (value === null || value === void 0 || typeof value !== 'object') {\n        return false;\n    }\n    return Symbol.iterator in value;\n}\n/**\n * Tests for whether object is not null and a typeof object.\n *\n * @param {unknown} value - Any value.\n *\n * @returns {boolean} Is it an object.\n */\nfunction isObject(value) {\n    return value !== null && typeof value === 'object' && !Array.isArray(value);\n}\n/**\n * Tests for whether the given value is a plain object.\n *\n * An object is plain if it is created by either: `{}`, `new Object()` or `Object.create(null)`.\n *\n * @param {unknown} value - Any value\n *\n * @returns {boolean} Is it a plain object.\n */\nfunction isPlainObject(value) {\n    if (Object.prototype.toString.call(value) !== s_TAG_OBJECT) {\n        return false;\n    }\n    const prototype = Object.getPrototypeOf(value);\n    return prototype === null || prototype === Object.prototype;\n}\n/**\n * Safely returns keys on an object or an empty array if not an object.\n *\n * @param {object} object - An object.\n *\n * @returns {string[]}  Object keys or empty array.\n */\nfunction objectKeys(object) {\n    return isObject(object) ? Object.keys(object) : [];\n}\n/**\n * Safely returns an objects size. Note for String objects unicode is not taken into consideration.\n *\n * @param {any} object - Any value, but size returned for object / Map / Set / arrays / strings.\n *\n * @returns {number} Size of object.\n */\nfunction objectSize(object) {\n    if (object === void 0 || object === null || typeof object !== 'object') {\n        return 0;\n    }\n    const tag = Object.prototype.toString.call(object);\n    if (tag === s_TAG_MAP || tag === s_TAG_SET) {\n        return object.size;\n    }\n    if (tag === s_TAG_STRING) {\n        return object.length;\n    }\n    return Object.keys(object).length;\n}\n/**\n * Provides a way to safely access an objects data / entries given an accessor string which describes the\n * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n * to walk.\n *\n * @param {object}   data - An object to access entry data.\n *\n * @param {string}   accessor - A string describing the entries to access with keys separated by `.`.\n *\n * @param {any}      [defaultValue] - (Optional) A default value to return if an entry for accessor is not found.\n *\n * @returns {object} The data object.\n */\nfunction safeAccess(data, accessor, defaultValue) {\n    if (typeof data !== 'object') {\n        return defaultValue;\n    }\n    if (typeof accessor !== 'string') {\n        return defaultValue;\n    }\n    const access = accessor.split('.');\n    // Walk through the given object by the accessor indexes.\n    for (let cntr = 0; cntr < access.length; cntr++) {\n        // If the next level of object access is undefined or null then return the empty string.\n        if (typeof data[access[cntr]] === 'undefined' || data[access[cntr]] === null) {\n            return defaultValue;\n        }\n        data = data[access[cntr]];\n    }\n    return data;\n}\n/**\n * Provides a way to safely batch set an objects data / entries given an array of accessor strings which describe the\n * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n * to walk. If value is an object the accessor will be used to access a target value from `value` which is\n * subsequently set to `data` by the given operation. If `value` is not an object it will be used as the target\n * value to set across all accessors.\n *\n * @param {object}   data - An object to access entry data.\n *\n * @param {string[]} accessors - A string describing the entries to access.\n *\n * @param {any}      value - A new value to set if an entry for accessor is found.\n *\n * @param {SafeSetOperation}   [operation='set'] - Operation to perform including: 'add', 'div', 'mult', 'set',\n *        'set-undefined', 'sub'.\n *\n * @param {any}      [defaultAccessValue=0] - A new value to set if an entry for accessor is found.\n *\n * @param {boolean}  [createMissing=true] - If true missing accessor entries will be created as objects automatically.\n */\nfunction safeBatchSet(data, accessors, value, operation = 'set', defaultAccessValue = 0, createMissing = true) {\n    if (typeof data !== 'object') {\n        throw new TypeError(`safeBatchSet Error: 'data' is not an 'object'.`);\n    }\n    if (!Array.isArray(accessors)) {\n        throw new TypeError(`safeBatchSet Error: 'accessors' is not an 'array'.`);\n    }\n    if (typeof value === 'object') {\n        accessors.forEach((accessor) => {\n            const targetValue = safeAccess(value, accessor, defaultAccessValue);\n            safeSet(data, accessor, targetValue, operation, createMissing);\n        });\n    }\n    else {\n        accessors.forEach((accessor) => {\n            safeSet(data, accessor, value, operation, createMissing);\n        });\n    }\n}\n/**\n * Compares a source object and values of entries against a target object. If the entries in the source object match\n * the target object then `true` is returned otherwise `false`. If either object is undefined or null then false\n * is returned.\n *\n * @param {object}   source - Source object.\n *\n * @param {object}   target - Target object.\n *\n * @returns {boolean} True if equal.\n */\nfunction safeEqual(source, target) {\n    if (typeof source === 'undefined' || source === null || typeof target === 'undefined' || target === null) {\n        return false;\n    }\n    const sourceAccessors = getAccessorList(source);\n    for (let cntr = 0; cntr < sourceAccessors.length; cntr++) {\n        const accessor = sourceAccessors[cntr];\n        const sourceObjectValue = safeAccess(source, accessor);\n        const targetObjectValue = safeAccess(target, accessor);\n        if (sourceObjectValue !== targetObjectValue) {\n            return false;\n        }\n    }\n    return true;\n}\n/**\n * Provides a way to safely set an objects data / entries given an accessor string which describes the\n * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n * to walk.\n *\n * @param {object}   data - An object to access entry data.\n *\n * @param {string}   accessor - A string describing the entries to access.\n *\n * @param {any}      value - A new value to set if an entry for accessor is found.\n *\n * @param {SafeSetOperation}   [operation='set'] - Operation to perform including: 'add', 'div', 'mult', 'set',\n *        'set-undefined', 'sub'.\n *\n * @param {boolean}  [createMissing=true] - If true missing accessor entries will be created as objects\n *        automatically.\n *\n * @returns {boolean} True if successful.\n */\nfunction safeSet(data, accessor, value, operation = 'set', createMissing = true) {\n    if (typeof data !== 'object') {\n        throw new TypeError(`safeSet Error: 'data' is not an 'object'.`);\n    }\n    if (typeof accessor !== 'string') {\n        throw new TypeError(`safeSet Error: 'accessor' is not a 'string'.`);\n    }\n    const access = accessor.split('.');\n    // Walk through the given object by the accessor indexes.\n    for (let cntr = 0; cntr < access.length; cntr++) {\n        // If data is an array perform validation that the accessor is a positive integer otherwise quit.\n        if (Array.isArray(data)) {\n            const number = (+access[cntr]);\n            if (!Number.isInteger(number) || number < 0) {\n                return false;\n            }\n        }\n        if (cntr === access.length - 1) {\n            switch (operation) {\n                case 'add':\n                    data[access[cntr]] += value;\n                    break;\n                case 'div':\n                    data[access[cntr]] /= value;\n                    break;\n                case 'mult':\n                    data[access[cntr]] *= value;\n                    break;\n                case 'set':\n                    data[access[cntr]] = value;\n                    break;\n                case 'set-undefined':\n                    if (typeof data[access[cntr]] === 'undefined') {\n                        data[access[cntr]] = value;\n                    }\n                    break;\n                case 'sub':\n                    data[access[cntr]] -= value;\n                    break;\n            }\n        }\n        else {\n            // If createMissing is true and the next level of object access is undefined then create a new object entry.\n            if (createMissing && typeof data[access[cntr]] === 'undefined') {\n                data[access[cntr]] = {};\n            }\n            // Abort if the next level is null or not an object and containing a value.\n            if (data[access[cntr]] === null || typeof data[access[cntr]] !== 'object') {\n                return false;\n            }\n            data = data[access[cntr]];\n        }\n    }\n    return true;\n}\n/**\n * Performs bulk setting of values to the given data object.\n *\n * @param {object}            data - The data object to set data.\n *\n * @param {Record<string, any>}  accessorValues - Object of accessor keys to values to set.\n *\n * @param {SafeSetOperation}  [operation='set'] - Operation to perform including: 'add', 'div', 'mult', 'set', 'sub';\n *        default (`set`).\n *\n * @param {boolean}           [createMissing=true] - If true missing accessor entries will be created as objects\n *        automatically.\n */\nfunction safeSetAll(data, accessorValues, operation = 'set', createMissing = true) {\n    if (typeof data !== 'object') {\n        throw new TypeError(`'data' is not an 'object'.`);\n    }\n    if (typeof accessorValues !== 'object') {\n        throw new TypeError(`'accessorValues' is not an 'object'.`);\n    }\n    for (const accessor of Object.keys(accessorValues)) {\n        if (!Object.prototype.hasOwnProperty.call(accessorValues, accessor)) {\n            continue;\n        }\n        safeSet(data, accessor, accessorValues[accessor], operation, createMissing);\n    }\n}\n/**\n * Performs bulk validation of data given an object, `validationData`, which describes all entries to test.\n *\n * @param {object}                           data - The data object to test.\n *\n * @param {Record<string, ValidationEntry>}  validationData - Key is the accessor / value is a validation entry.\n *\n * @param {string}                           [dataName='data'] - Optional name of data.\n *\n * @returns {boolean} True if validation passes otherwise an exception is thrown.\n */\nfunction validate(data, validationData = {}, dataName = 'data') {\n    if (typeof data !== 'object') {\n        throw new TypeError(`'${dataName}' is not an 'object'.`);\n    }\n    if (typeof validationData !== 'object') {\n        throw new TypeError(`'validationData' is not an 'object'.`);\n    }\n    let result;\n    for (const key of Object.keys(validationData)) {\n        if (!Object.prototype.hasOwnProperty.call(validationData, key)) {\n            continue;\n        }\n        const entry = validationData[key];\n        switch (entry.test) {\n            case 'array':\n                result = validateArray(data, key, entry, dataName);\n                break;\n            case 'entry':\n                result = validateEntry(data, key, entry, dataName);\n                break;\n            case 'entry|array':\n                result = validateEntryOrArray(data, key, entry, dataName);\n                break;\n        }\n    }\n    return result;\n}\n/**\n * Validates all array entries against potential type and expected tests.\n *\n * @param {object}            data - The data object to test.\n *\n * @param {string}            accessor - A string describing the entries to access.\n *\n * @param {ValidationEntry}   entry - Validation entry object\n *\n * @param {string}            [dataName='data'] - Optional name of data.\n *\n * @returns {boolean} True if validation passes otherwise an exception is thrown.\n */\nfunction validateArray(data, accessor, entry, dataName = 'data') {\n    const valEntry = Object.assign({ required: true, error: true }, entry);\n    const dataArray = safeAccess(data, accessor);\n    // A non-required entry is missing so return without validation.\n    if (!valEntry?.required && typeof dataArray === 'undefined') {\n        return true;\n    }\n    if (!Array.isArray(dataArray)) {\n        if (valEntry.error) {\n            throw _validateError(TypeError, `'${dataName}.${accessor}' is not an 'array'.`);\n        }\n        else {\n            return false;\n        }\n    }\n    if (typeof valEntry.type === 'string') {\n        for (let cntr = 0; cntr < dataArray.length; cntr++) {\n            if (!(typeof dataArray[cntr] === valEntry.type)) {\n                if (valEntry.error) {\n                    const dataEntryString = typeof dataArray[cntr] === 'object' ? JSON.stringify(dataArray[cntr]) :\n                        dataArray[cntr];\n                    throw _validateError(TypeError, `'${dataName}.${accessor}[${cntr}]': '${dataEntryString}' is not a '${valEntry.type}'.`);\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n    }\n    // If expected is a function then test all array entries against the test function. If expected is a Set then\n    // test all array entries for inclusion in the set. Otherwise, if expected is a string then test that all array\n    // entries as a `typeof` test against expected.\n    if (Array.isArray(valEntry.expected)) {\n        for (let cntr = 0; cntr < dataArray.length; cntr++) {\n            if (!valEntry.expected.includes(dataArray[cntr])) {\n                if (valEntry.error) {\n                    const dataEntryString = typeof dataArray[cntr] === 'object' ? JSON.stringify(dataArray[cntr]) :\n                        dataArray[cntr];\n                    throw _validateError(Error, `'${dataName}.${accessor}[${cntr}]': '${dataEntryString}' is not an expected value: ${JSON.stringify(valEntry.expected)}.`);\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n    }\n    else if (valEntry.expected instanceof Set) {\n        for (let cntr = 0; cntr < dataArray.length; cntr++) {\n            if (!valEntry.expected.has(dataArray[cntr])) {\n                if (valEntry.error) {\n                    const dataEntryString = typeof dataArray[cntr] === 'object' ? JSON.stringify(dataArray[cntr]) :\n                        dataArray[cntr];\n                    throw _validateError(Error, `'${dataName}.${accessor}[${cntr}]': '${dataEntryString}' is not an expected value: ${JSON.stringify(valEntry.expected)}.`);\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n    }\n    else if (typeof valEntry.expected === 'function') {\n        for (let cntr = 0; cntr < dataArray.length; cntr++) {\n            try {\n                const result = valEntry.expected(dataArray[cntr]);\n                if (typeof result === 'undefined' || !result) {\n                    throw new Error(valEntry.message);\n                }\n            }\n            catch (err) {\n                if (valEntry.error) {\n                    const dataEntryString = typeof dataArray[cntr] === 'object' ? JSON.stringify(dataArray[cntr]) :\n                        dataArray[cntr];\n                    throw _validateError(Error, `'${dataName}.${accessor}[${cntr}]': '${dataEntryString}' failed validation: ${err.message}.`);\n                }\n                else {\n                    return false;\n                }\n            }\n        }\n    }\n    return true;\n}\n/**\n * Validates data entry with a typeof check and potentially tests against the values in any given expected set.\n *\n * @param {object}            data - The object data to validate.\n *\n * @param {string}            accessor - A string describing the entries to access.\n *\n * @param {ValidationEntry}   entry - Validation entry.\n *\n * @param {string}            [dataName='data'] - Optional name of data.\n *\n * @returns {boolean} True if validation passes otherwise an exception is thrown.\n */\nfunction validateEntry(data, accessor, entry, dataName = 'data') {\n    const valEntry = Object.assign({ required: true, error: true }, entry);\n    const dataEntry = safeAccess(data, accessor);\n    // A non-required entry is missing so return without validation.\n    if (!valEntry.required && typeof dataEntry === 'undefined') {\n        return true;\n    }\n    if (valEntry.type && typeof dataEntry !== valEntry.type) {\n        if (valEntry.error) {\n            throw _validateError(TypeError, `'${dataName}.${accessor}' is not a '${valEntry.type}'.`);\n        }\n        else {\n            return false;\n        }\n    }\n    if ((valEntry.expected instanceof Set && !valEntry.expected.has(dataEntry)) ||\n        (Array.isArray(valEntry.expected) && !valEntry.expected.includes(dataEntry))) {\n        if (valEntry.error) {\n            const dataEntryString = typeof dataEntry === 'object' ? JSON.stringify(dataEntry) : dataEntry;\n            throw _validateError(Error, `'${dataName}.${accessor}': '${dataEntryString}' is not an expected value: ${JSON.stringify(valEntry.expected)}.`);\n        }\n        else {\n            return false;\n        }\n    }\n    else if (typeof valEntry.expected === 'function') {\n        try {\n            const result = valEntry.expected(dataEntry);\n            if (typeof result === 'undefined' || !result) {\n                throw new Error(valEntry.message);\n            }\n        }\n        catch (err) {\n            if (valEntry.error) {\n                const dataEntryString = typeof dataEntry === 'object' ? JSON.stringify(dataEntry) : dataEntry;\n                throw _validateError(Error, `'${dataName}.${accessor}': '${dataEntryString}' failed to validate: ${err.message}.`);\n            }\n            else {\n                return false;\n            }\n        }\n    }\n    return true;\n}\n/**\n * Dispatches validation of data entry to string or array validation depending on data entry type.\n *\n * @param {object}            data - The data object to test.\n *\n * @param {string}            accessor - A string describing the entries to access.\n *\n * @param {ValidationEntry}   [entry] - A validation entry.\n *\n * @param {string}            [dataName='data'] - Optional name of data.\n *\n * @returns {boolean} True if validation passes otherwise an exception is thrown.\n */\nfunction validateEntryOrArray(data, accessor, entry, dataName = 'data') {\n    const dataEntry = safeAccess(data, accessor);\n    let result;\n    if (Array.isArray(dataEntry)) {\n        result = validateArray(data, accessor, entry, dataName);\n    }\n    else {\n        result = validateEntry(data, accessor, entry, dataName);\n    }\n    return result;\n}\n// Module private ---------------------------------------------------------------------------------------------------\n/**\n * Private implementation of depth traversal.\n *\n * @param {any}         data - An object or array or any leaf.\n *\n * @param {Set<string>} [skipFreezeKeys] - An array of strings indicating keys of objects to not freeze.\n *\n * @returns {*} The frozen object.\n * @ignore\n * @private\n */\nfunction _deepFreeze(data, skipFreezeKeys) {\n    if (Array.isArray(data)) {\n        for (let cntr = 0; cntr < data.length; cntr++) {\n            _deepFreeze(data[cntr], skipFreezeKeys);\n        }\n    }\n    else if (isObject(data)) {\n        for (const key in data) {\n            if (Object.prototype.hasOwnProperty.call(data, key) && !skipFreezeKeys?.has?.(key)) {\n                _deepFreeze(data[key], skipFreezeKeys);\n            }\n        }\n    }\n    return Object.freeze(data);\n}\n/**\n * Internal implementation for `deepMerge`.\n *\n * @param {object}      target - Target object.\n *\n * @param {...object}   sourceObj - One or more source objects.\n *\n * @returns {object}    Target object.\n */\nfunction _deepMerge(target = {}, ...sourceObj) {\n    // Iterate and merge all source objects into target.\n    for (let cntr = 0; cntr < sourceObj.length; cntr++) {\n        const obj = sourceObj[cntr];\n        for (const prop in obj) {\n            if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n                // Handle the special property starting with '-=' to delete keys.\n                if (prop.startsWith('-=')) {\n                    delete target[prop.slice(2)];\n                    continue;\n                }\n                // If target already has prop and both target[prop] and obj[prop] are object literals then merge them\n                // otherwise assign obj[prop] to target[prop].\n                target[prop] = Object.prototype.hasOwnProperty.call(target, prop) && target[prop]?.constructor === Object &&\n                    obj[prop]?.constructor === Object ? _deepMerge({}, target[prop], obj[prop]) : obj[prop];\n            }\n        }\n    }\n    return target;\n}\n/**\n * Private implementation of depth traversal.\n *\n * @param {any}      data - An object, array, or any leaf value\n *\n * @param {Function} func - A callback function to process leaf values in children arrays or object members.\n *\n * @param {boolean}  modify - If true then the result of the callback function is used to modify in place the\n *        given data.\n *\n * @returns {*} The data object.\n * @ignore\n * @private\n */\nfunction _depthTraverse(data, func, modify = false) {\n    if (modify) {\n        if (Array.isArray(data)) {\n            for (let cntr = 0; cntr < data.length; cntr++) {\n                data[cntr] = _depthTraverse(data[cntr], func, modify);\n            }\n        }\n        else if (isObject(data)) {\n            for (const key in data) {\n                if (Object.prototype.hasOwnProperty.call(data, key)) {\n                    data[key] = _depthTraverse(data[key], func, modify);\n                }\n            }\n        }\n        else {\n            data = func(data);\n        }\n    }\n    else {\n        if (Array.isArray(data)) {\n            for (let cntr = 0; cntr < data.length; cntr++) {\n                _depthTraverse(data[cntr], func, modify);\n            }\n        }\n        else if (typeof data === 'object') {\n            for (const key in data) {\n                if (Object.prototype.hasOwnProperty.call(data, key)) {\n                    _depthTraverse(data[key], func, modify);\n                }\n            }\n        }\n        else {\n            func(data);\n        }\n    }\n    return data;\n}\n/**\n * Private implementation of `getAccessorList`.\n *\n * @param {object}   data - An object to traverse.\n *\n * @returns {string[]} Accessor list.\n * @ignore\n * @private\n */\nfunction _getAccessorList(data) {\n    const accessors = [];\n    for (const key in data) {\n        if (Object.prototype.hasOwnProperty.call(data, key)) {\n            if (typeof data[key] === 'object') {\n                const childKeys = _getAccessorList(data[key]);\n                childKeys.forEach((childKey) => {\n                    accessors.push(Array.isArray(childKey) ? `${key}.${childKey.join('.')}` : `${key}.${childKey}`);\n                });\n            }\n            else {\n                accessors.push(key);\n            }\n        }\n    }\n    return accessors;\n}\n/**\n * Creates a new error of type `clazz` adding the field `_objectValidateError` set to true.\n *\n * @param {Error}    clazz - Error class to instantiate.\n *\n * @param {string}   message - An error message.\n *\n * @returns {*} Error of the clazz.\n * @ignore\n * @private\n */\nfunction _validateError(clazz, message = void 0) {\n    const error = new clazz(message);\n    error._objectValidateError = true;\n    return error;\n}\n\nexport { deepFreeze, deepMerge, depthTraverse, getAccessorList, hasAccessor, hasGetter, hasPrototype, hasSetter, isAsyncIterable, isIterable, isObject, isPlainObject, klona, objectKeys, objectSize, safeAccess, safeBatchSet, safeEqual, safeSet, safeSetAll, validate, validateArray, validateEntry, validateEntryOrArray };\n//# sourceMappingURL=index.js.map\n","/**\n * Provides a basic test for a given variable to test if it has the shape of a readable store by having a `subscribe`\n * function.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ a `subscribe` function.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isReadableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Provides a basic test for a given variable to test if it has the shape of a writable store by having a `subscribe`\n * function and an `update` function.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ a `subscribe` function.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isUpdatableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function' && typeof store.update === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Provides a basic test for a given variable to test if it has the shape of a writable store by having a `subscribe`\n * `set`, and `update` functions.\n *\n * Note: functions are also objects, so test that the variable might be a function w/ `subscribe` & `set` functions.\n *\n * @param {*}  store - variable to test that might be a store.\n *\n * @returns {boolean} Whether the variable tested has the shape of a store.\n */\nfunction isWritableStore(store)\n{\n   if (store === null || store === void 0) { return false; }\n\n   switch (typeof store)\n   {\n      case 'function':\n      case 'object':\n         return typeof store.subscribe === 'function' && typeof store.set === 'function';\n   }\n\n   return false;\n}\n\n/**\n * Wraps a writable stores set method invoking a callback after the store is set. This allows hard coupled parent /\n * child relationships between stores to update directly without having to subscribe to the child store. This is a\n * particular powerful pattern when the `setCallback` is a debounced function that syncs a parent store and / or\n * serializes data.\n *\n * Note: Do consider carefully if this is an optimum solution; this is a quick implementation helper, but a better\n * solution is properly managing store relationships through subscription.\n *\n * @template T\n *\n * @param {import('svelte/store').Writable<T>} store - A store to wrap.\n *\n * @param {(store?: import('svelte/store').Writable<T>, value?: T) => void} setCallback - A callback to invoke after\n *        store set.\n *\n * @returns {import('svelte/store').Writable<T>} Wrapped store.\n */\nfunction storeCallback(store, setCallback)\n{\n   if (!isWritableStore(store)) { throw new TypeError(`'store' is not a writable store.`); }\n   if (typeof setCallback !== 'function') { throw new TypeError(`'setCallback' is not a function.`); }\n\n   /** @type {import('svelte/store').Writable<T>} */\n   return {\n      set: (value) =>\n      {\n         store.set(value);\n         setCallback(store, value);\n      },\n\n      subscribe: store.subscribe,\n\n      update: typeof store.update === 'function' ? store.update : void 0\n   };\n}\n\n/**\n * Subscribes to the given store with the update function provided and ignores the first automatic\n * update. All future updates are dispatched to the update function.\n *\n * @param {import('svelte/store').Readable | import('svelte/store').Writable} store -\n *  Store to subscribe to...\n *\n * @param {import('svelte/store').Updater} update - function to receive future updates.\n *\n * @returns {import('svelte/store').Unsubscriber} Store unsubscribe function.\n */\nfunction subscribeIgnoreFirst(store, update)\n{\n   let firedFirst = false;\n\n   return store.subscribe((value) =>\n   {\n      if (!firedFirst)\n      {\n         firedFirst = true;\n      }\n      else\n      {\n         update(value);\n      }\n   });\n}\n\n/**\n * Subscribes to the given store with two update functions provided. The first function is invoked on the initial\n * subscription. All future updates are dispatched to the update function.\n *\n * @param {import('svelte/store').Readable | import('svelte/store').Writable} store -\n *  Store to subscribe to...\n *\n * @param {import('svelte/store').Updater} first - Function to receive first update.\n *\n * @param {import('svelte/store').Updater} update - Function to receive future updates.\n *\n * @returns {import('svelte/store').Unsubscriber} Store unsubscribe function.\n */\nfunction subscribeFirstRest(store, first, update)\n{\n   let firedFirst = false;\n\n   return store.subscribe((value) =>\n   {\n      if (!firedFirst)\n      {\n         firedFirst = true;\n         first(value);\n      }\n      else\n      {\n         update(value);\n      }\n   });\n}\n\nexport { isReadableStore, isUpdatableStore, isWritableStore, storeCallback, subscribeFirstRest, subscribeIgnoreFirst };\n//# sourceMappingURL=index.js.map\n","/*\nAdapted from https://github.com/mattdesl\nDistributed under MIT License https://github.com/mattdesl/eases/blob/master/LICENSE.md\n*/\nexport { identity as linear } from '../internal/index.js';\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function backInOut(t) {\n\tconst s = 1.70158 * 1.525;\n\tif ((t *= 2) < 1) return 0.5 * (t * t * ((s + 1) * t - s));\n\treturn 0.5 * ((t -= 2) * t * ((s + 1) * t + s) + 2);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function backIn(t) {\n\tconst s = 1.70158;\n\treturn t * t * ((s + 1) * t - s);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function backOut(t) {\n\tconst s = 1.70158;\n\treturn --t * t * ((s + 1) * t + s) + 1;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function bounceOut(t) {\n\tconst a = 4.0 / 11.0;\n\tconst b = 8.0 / 11.0;\n\tconst c = 9.0 / 10.0;\n\tconst ca = 4356.0 / 361.0;\n\tconst cb = 35442.0 / 1805.0;\n\tconst cc = 16061.0 / 1805.0;\n\tconst t2 = t * t;\n\treturn t < a\n\t\t? 7.5625 * t2\n\t\t: t < b\n\t\t? 9.075 * t2 - 9.9 * t + 3.4\n\t\t: t < c\n\t\t? ca * t2 - cb * t + cc\n\t\t: 10.8 * t * t - 20.52 * t + 10.72;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function bounceInOut(t) {\n\treturn t < 0.5 ? 0.5 * (1.0 - bounceOut(1.0 - t * 2.0)) : 0.5 * bounceOut(t * 2.0 - 1.0) + 0.5;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function bounceIn(t) {\n\treturn 1.0 - bounceOut(1.0 - t);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function circInOut(t) {\n\tif ((t *= 2) < 1) return -0.5 * (Math.sqrt(1 - t * t) - 1);\n\treturn 0.5 * (Math.sqrt(1 - (t -= 2) * t) + 1);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function circIn(t) {\n\treturn 1.0 - Math.sqrt(1.0 - t * t);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function circOut(t) {\n\treturn Math.sqrt(1 - --t * t);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function cubicInOut(t) {\n\treturn t < 0.5 ? 4.0 * t * t * t : 0.5 * Math.pow(2.0 * t - 2.0, 3.0) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function cubicIn(t) {\n\treturn t * t * t;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function cubicOut(t) {\n\tconst f = t - 1.0;\n\treturn f * f * f + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function elasticInOut(t) {\n\treturn t < 0.5\n\t\t? 0.5 * Math.sin(((+13.0 * Math.PI) / 2) * 2.0 * t) * Math.pow(2.0, 10.0 * (2.0 * t - 1.0))\n\t\t: 0.5 *\n\t\t\t\tMath.sin(((-13.0 * Math.PI) / 2) * (2.0 * t - 1.0 + 1.0)) *\n\t\t\t\tMath.pow(2.0, -10.0 * (2.0 * t - 1.0)) +\n\t\t\t\t1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function elasticIn(t) {\n\treturn Math.sin((13.0 * t * Math.PI) / 2) * Math.pow(2.0, 10.0 * (t - 1.0));\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function elasticOut(t) {\n\treturn Math.sin((-13.0 * (t + 1.0) * Math.PI) / 2) * Math.pow(2.0, -10.0 * t) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function expoInOut(t) {\n\treturn t === 0.0 || t === 1.0\n\t\t? t\n\t\t: t < 0.5\n\t\t? +0.5 * Math.pow(2.0, 20.0 * t - 10.0)\n\t\t: -0.5 * Math.pow(2.0, 10.0 - t * 20.0) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function expoIn(t) {\n\treturn t === 0.0 ? t : Math.pow(2.0, 10.0 * (t - 1.0));\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function expoOut(t) {\n\treturn t === 1.0 ? t : 1.0 - Math.pow(2.0, -10.0 * t);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quadInOut(t) {\n\tt /= 0.5;\n\tif (t < 1) return 0.5 * t * t;\n\tt--;\n\treturn -0.5 * (t * (t - 2) - 1);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quadIn(t) {\n\treturn t * t;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quadOut(t) {\n\treturn -t * (t - 2.0);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quartInOut(t) {\n\treturn t < 0.5 ? +8.0 * Math.pow(t, 4.0) : -8.0 * Math.pow(t - 1.0, 4.0) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quartIn(t) {\n\treturn Math.pow(t, 4.0);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quartOut(t) {\n\treturn Math.pow(t - 1.0, 3.0) * (1.0 - t) + 1.0;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quintInOut(t) {\n\tif ((t *= 2) < 1) return 0.5 * t * t * t * t * t;\n\treturn 0.5 * ((t -= 2) * t * t * t * t + 2);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quintIn(t) {\n\treturn t * t * t * t * t;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function quintOut(t) {\n\treturn --t * t * t * t * t + 1;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function sineInOut(t) {\n\treturn -0.5 * (Math.cos(Math.PI * t) - 1);\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function sineIn(t) {\n\tconst v = Math.cos(t * Math.PI * 0.5);\n\tif (Math.abs(v) < 1e-14) return 1;\n\telse return 1 - v;\n}\n\n/**\n * https://svelte.dev/docs/svelte-easing\n * @param {number} t\n * @returns {number}\n */\nexport function sineOut(t) {\n\treturn Math.sin((t * Math.PI) / 2);\n}\n","/**\n * Performs linear interpolation between a start & end value by given amount between 0 - 1 inclusive.\n *\n * @param {number}   start - Start value.\n *\n * @param {number}   end - End value.\n *\n * @param {number}   amount - Current amount between 0 - 1 inclusive.\n *\n * @returns {number} Linear interpolated value between start & end.\n */\nfunction lerp(start, end, amount)\n{\n   return (1 - amount) * start + amount * end;\n}\n\nexport { lerp };\n//# sourceMappingURL=index.js.map\n","import { isObject, isIterable } from '@typhonjs-fvtt/runtime/util/object';\n\nfunction isSpace(character) {\n    return character == \" \" || character == \"\\n\" || character == \"\\r\" || character == \"\\t\";\n}\nfunction isQuote(character) {\n    return character == '\"' || character == \"'\";\n}\nconst TAG_START = \"<\";\nconst TAG_END = \">\";\nconst ENCODED_TAG_START = \"&lt;\";\nconst ENCODED_TAG_END = \"&gt;\";\nclass InPlaintextState {\n    constructor(options) {\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == TAG_START) {\n            transition(new InTagNameState(this.options));\n            return \"\";\n        }\n        else if (character == TAG_END && this.options.encodePlaintextTagDelimiters) {\n            return ENCODED_TAG_END;\n        }\n        return character;\n    }\n}\nclass InTagNameState {\n    constructor(options) {\n        this.options = options;\n        this.nameBuffer = \"\";\n        this.isClosingTag = false;\n    }\n    consume(character, transition) {\n        if (this.nameBuffer.length == 0) {\n            if (isSpace(character)) {\n                transition(new InPlaintextState(this.options));\n                return ((this.options.encodePlaintextTagDelimiters ? ENCODED_TAG_START : \"<\") +\n                    character);\n            }\n            if (character == \"/\") {\n                this.isClosingTag = true;\n                return \"\";\n            }\n        }\n        if (isSpace(character)) {\n            if (this.isNameBufferAnAllowedTag()) {\n                transition(new InTagState(0 /* TagMode.Allowed */, this.options));\n                return TAG_START + (this.isClosingTag ? \"/\" : \"\") + this.nameBuffer + character;\n            }\n            else {\n                transition(new InTagState(1 /* TagMode.Disallowed */, this.options));\n                return this.options.tagReplacementText;\n            }\n        }\n        if (character == TAG_START) {\n            this.nameBuffer += ENCODED_TAG_START;\n            return \"\";\n        }\n        if (character == TAG_END) {\n            transition(new InPlaintextState(this.options));\n            if (this.isNameBufferAnAllowedTag()) {\n                return TAG_START + (this.isClosingTag ? \"/\" : \"\") + this.nameBuffer + character;\n            }\n            else {\n                return this.options.tagReplacementText;\n            }\n        }\n        if (character == \"-\" && this.nameBuffer == \"!-\") {\n            transition(new InCommentState(this.options));\n            return \"\";\n        }\n        this.nameBuffer += character;\n        return \"\";\n    }\n    isNameBufferAnAllowedTag() {\n        const tagName = this.nameBuffer.toLowerCase();\n        if (this.options.allowedTags) {\n            return this.options.allowedTags.has(tagName);\n        }\n        else if (this.options.disallowedTags) {\n            return !this.options.disallowedTags.has(tagName);\n        }\n        else {\n            return false;\n        }\n    }\n}\nclass InTagState {\n    constructor(mode, options) {\n        this.mode = mode;\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == TAG_END) {\n            transition(new InPlaintextState(this.options));\n        }\n        else if (isQuote(character)) {\n            transition(new InQuotedStringInTagState(this.mode, character, this.options));\n        }\n        if (this.mode == 1 /* TagMode.Disallowed */) {\n            return \"\";\n        }\n        if (character == TAG_START) {\n            return ENCODED_TAG_START;\n        }\n        else {\n            return character;\n        }\n    }\n}\nclass InQuotedStringInTagState {\n    constructor(mode, quoteCharacter, options) {\n        this.mode = mode;\n        this.quoteCharacter = quoteCharacter;\n        this.options = options;\n    }\n    consume(character, transition) {\n        if (character == this.quoteCharacter) {\n            transition(new InTagState(this.mode, this.options));\n        }\n        if (this.mode == 1 /* TagMode.Disallowed */) {\n            return \"\";\n        }\n        if (character == TAG_START) {\n            return ENCODED_TAG_START;\n        }\n        else if (character == TAG_END) {\n            return ENCODED_TAG_END;\n        }\n        else {\n            return character;\n        }\n    }\n}\nclass InCommentState {\n    constructor(options) {\n        this.options = options;\n        this.consecutiveHyphens = 0;\n    }\n    consume(character, transition) {\n        if (character == \">\" && this.consecutiveHyphens >= 2) {\n            transition(new InPlaintextState(this.options));\n        }\n        else if (character == \"-\") {\n            this.consecutiveHyphens++;\n        }\n        else {\n            this.consecutiveHyphens = 0;\n        }\n        return \"\";\n    }\n}\n\nconst DefaultStateMachineOptions = {\n    tagReplacementText: \"\",\n    encodePlaintextTagDelimiters: true,\n};\nclass StateMachine {\n    constructor(partialOptions = {}) {\n        this.state = new InPlaintextState(Object.assign(Object.assign({}, DefaultStateMachineOptions), partialOptions));\n        this.transitionFunction = ((next) => {\n            this.state = next;\n        }).bind(this);\n    }\n    consume(text) {\n        let outputBuffer = \"\";\n        for (const character of text) {\n            outputBuffer += this.state.consume(character, this.transitionFunction);\n        }\n        return outputBuffer;\n    }\n}\nfunction striptags(text, options = {}) {\n    return new StateMachine(options).consume(text);\n}\n\n/**\n * Provides several helpful utility methods for accessibility and keyboard navigation.\n */\nclass A11yHelper\n{\n   /**\n    * Apply focus to the HTMLElement targets in a given A11yFocusSource data object. An iterable list `options.focusEl`\n    * can contain HTMLElements or selector strings. If multiple focus targets are provided in a list then the first\n    * valid target found will be focused. If focus target is a string then a lookup via `document.querySelector` is\n    * performed. In this case you should provide a unique selector for the desired focus target.\n    *\n    * Note: The body of this method is postponed to the next clock tick to allow any changes in the DOM to occur that\n    * might alter focus targets before applying.\n    *\n    * @param {A11yFocusSource|{ focusSource: A11yFocusSource }}   options - The focus options instance to apply.\n    */\n   static applyFocusSource(options)\n   {\n      if (!isObject(options)) { return; }\n\n      // Handle the case of receiving an object with embedded `focusSource`.\n      const focusOpts = isObject(options?.focusSource) ? options.focusSource : options;\n\n      setTimeout(() =>\n      {\n         const debug = typeof focusOpts.debug === 'boolean' ? focusOpts.debug : false;\n\n         if (isIterable(focusOpts.focusEl))\n         {\n            if (debug)\n            {\n               console.debug(`A11yHelper.applyFocusSource debug - Attempting to apply focus target: `, focusOpts.focusEl);\n            }\n\n            for (const target of focusOpts.focusEl)\n            {\n               if (target instanceof HTMLElement && target.isConnected)\n               {\n                  target.focus();\n                  if (debug)\n                  {\n                     console.debug(`A11yHelper.applyFocusSource debug - Applied focus to target: `, target);\n                  }\n                  break;\n               }\n               else if (typeof target === 'string')\n               {\n                  const element = document.querySelector(target);\n                  if (element instanceof HTMLElement && element.isConnected)\n                  {\n                     element.focus();\n                     if (debug)\n                     {\n                        console.debug(`A11yHelper.applyFocusSource debug - Applied focus to target: `, element);\n                     }\n                     break;\n                  }\n                  else if (debug)\n                  {\n                     console.debug(`A11yHelper.applyFocusSource debug - Could not query selector: `, target);\n                  }\n               }\n            }\n         }\n         else if (debug)\n         {\n            console.debug(`A11yHelper.applyFocusSource debug - No focus targets defined.`);\n         }\n      }, 0);\n   }\n\n   /**\n    * Returns first focusable element within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] - Optional element to start query.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>} [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @returns {HTMLElement} First focusable child element\n    */\n   static getFirstFocusableElement(element = document, options)\n   {\n      const focusableElements = this.getFocusableElements(element, options);\n\n      return focusableElements.length > 0 ? focusableElements[0] : void 0;\n   }\n\n   /**\n    * Returns all focusable elements within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] Optional element to start query.\n    *\n    * @param {object}            [options] - Optional parameters.\n    *\n    * @param {boolean}           [options.anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @param {Iterable<string>}  [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>}  [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @param {string}            [options.selectors] - Custom list of focusable selectors for `querySelectorAll`.\n    *\n    * @returns {Array<HTMLElement>} Child keyboard focusable\n    */\n   static getFocusableElements(element = document, { anchorHref = true, ignoreClasses, ignoreElements, selectors } = {})\n   {\n      if (!(element instanceof HTMLElement) && !(element instanceof Document))\n      {\n         throw new TypeError(`'element' is not a HTMLElement or Document instance.`);\n      }\n\n      if (typeof anchorHref !== 'boolean')\n      {\n         throw new TypeError(`'anchorHref' is not a boolean.`);\n      }\n\n      if (ignoreClasses !== void 0 && !isIterable(ignoreClasses))\n      {\n         throw new TypeError(`'ignoreClasses' is not an iterable list.`);\n      }\n\n      if (ignoreElements !== void 0 && !(ignoreElements instanceof Set))\n      {\n         throw new TypeError(`'ignoreElements' is not a Set.`);\n      }\n\n      if (selectors !== void 0 && typeof selectors !== 'string')\n      {\n         throw new TypeError(`'selectors' is not a string.`);\n      }\n\n      const selectorQuery = selectors ?? this.#getFocusableSelectors(anchorHref);\n\n      const allElements = [...element.querySelectorAll(selectorQuery)];\n\n      if (ignoreElements && ignoreClasses)\n      {\n         return allElements.filter((el) =>\n         {\n            let hasIgnoreClass = false;\n            for (const ignoreClass of ignoreClasses)\n            {\n               if (el.classList.contains(ignoreClass))\n               {\n                  hasIgnoreClass = true;\n                  break;\n               }\n            }\n\n            return !hasIgnoreClass && !ignoreElements.has(el) && el.style.display !== 'none' &&\n             el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') && !el.hasAttribute('inert') &&\n              el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else if (ignoreClasses)\n      {\n         return allElements.filter((el) =>\n         {\n            let hasIgnoreClass = false;\n            for (const ignoreClass of ignoreClasses)\n            {\n               if (el.classList.contains(ignoreClass))\n               {\n                  hasIgnoreClass = true;\n                  break;\n               }\n            }\n\n            return !hasIgnoreClass && el.style.display !== 'none' && el.style.visibility !== 'hidden' &&\n             !el.hasAttribute('disabled') && !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else if (ignoreElements)\n      {\n         return allElements.filter((el) =>\n         {\n            return !ignoreElements.has(el) && el.style.display !== 'none' && el.style.visibility !== 'hidden' &&\n             !el.hasAttribute('disabled') && !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n      else\n      {\n         return allElements.filter((el) =>\n         {\n            return el.style.display !== 'none' && el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') &&\n             !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n         });\n      }\n   }\n\n   /**\n    * Returns the default focusable selectors query.\n    *\n    * @param {boolean}  [anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @returns {string} Focusable selectors for `querySelectorAll`.\n    */\n   static #getFocusableSelectors(anchorHref = true)\n   {\n      return `button, [contenteditable=\"\"], [contenteditable=\"true\"], details summary:not([tabindex=\"-1\"]), embed, a${\n       anchorHref ? '[href]' : ''}, iframe, object, input:not([type=hidden]), select, textarea, ` +\n        `[tabindex]:not([tabindex=\"-1\"])`;\n   }\n\n   /**\n    * Gets a A11yFocusSource object from the given DOM event allowing for optional X / Y screen space overrides.\n    * Browsers (Firefox / Chrome) forwards a mouse event for the context menu keyboard button. Provides detection of\n    * when the context menu event is from the keyboard. Firefox as of (1/23) does not provide the correct screen space\n    * coordinates, so for keyboard context menu presses coordinates are generated from the centroid point of the\n    * element.\n    *\n    * A default fallback element or selector string may be provided to provide the focus target. If the event comes from\n    * the keyboard however the source focused element is inserted as the target with the fallback value appended to the\n    * list of focus targets. When A11yFocusSource is applied by {@link A11yHelper.applyFocusSource} the target focus\n    * list is iterated through until a connected target is found and focus applied.\n    *\n    * @param {object} options - Options\n    *\n    * @param {KeyboardEvent|MouseEvent}   [options.event] - The source DOM event.\n    *\n    * @param {boolean} [options.debug] - When true {@link A11yHelper.applyFocusSource} logs focus target data.\n    *\n    * @param {HTMLElement|string} [options.focusEl] - A specific HTMLElement or selector string as the focus target.\n    *\n    * @param {number}   [options.x] - Used when an event isn't provided; integer of event source in screen space.\n    *\n    * @param {number}   [options.y] - Used when an event isn't provided; integer of event source in screen space.\n    *\n    * @returns {A11yFocusSource} A A11yFocusSource object.\n    *\n    * @see https://bugzilla.mozilla.org/show_bug.cgi?id=1426671\n    * @see https://bugzilla.mozilla.org/show_bug.cgi?id=314314\n    *\n    * TODO: Evaluate / test against touch input devices.\n    */\n   static getFocusSource({ event, x, y, focusEl, debug = false })\n   {\n      if (focusEl !== void 0 && !(focusEl instanceof HTMLElement) && typeof focusEl !== 'string')\n      {\n         throw new TypeError(\n          `A11yHelper.getFocusSource error: 'focusEl' is not a HTMLElement or string.`);\n      }\n\n      if (debug !== void 0 && typeof debug !== 'boolean')\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'debug' is not a boolean.`);\n      }\n\n      // Handle the case when no event is provided and x, y, or focusEl is explicitly defined.\n      if (event === void 0)\n      {\n         if (typeof x !== 'number')\n         {\n            throw new TypeError(`A11yHelper.getFocusSource error: 'event' not defined and 'x' is not a number.`);\n         }\n\n         if (typeof y !== 'number')\n         {\n            throw new TypeError(`A11yHelper.getFocusSource error: 'event' not defined and 'y' is not a number.`);\n         }\n\n         return {\n            debug,\n            focusEl: focusEl !== void 0 ? [focusEl] : void 0,\n            x,\n            y,\n         };\n      }\n\n      if (!(event instanceof KeyboardEvent) && !(event instanceof MouseEvent))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'event' is not a KeyboardEvent or MouseEvent.`);\n      }\n\n      if (x !== void 0 && !Number.isInteger(x))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'x' is not a number.`);\n      }\n\n      if (y !== void 0 && !Number.isInteger(y))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'y' is not a number.`);\n      }\n\n      /** @type {HTMLElement} */\n      const targetEl = event.target;\n\n      if (!(targetEl instanceof HTMLElement))\n      {\n         throw new TypeError(`A11yHelper.getFocusSource error: 'event.target' is not an HTMLElement.`);\n      }\n\n      const result = { debug };\n\n      if (event instanceof MouseEvent)\n      {\n         // Firefox currently (1/23) does not correctly determine the location of a keyboard originated\n         // context menu location, so calculate position from middle of the event target.\n         // Firefox fires a mouse event for the context menu key.\n         if (event?.button !== 2 && event.type === 'contextmenu')\n         {\n            const rect = targetEl.getBoundingClientRect();\n            result.x = x ?? rect.left + (rect.width / 2);\n            result.y = y ?? rect.top + (rect.height / 2);\n            result.focusEl = focusEl !== void 0 ? [targetEl, focusEl] : [targetEl];\n            result.source = 'keyboard';\n         }\n         else\n         {\n            result.x = x ?? event.pageX;\n            result.y = y ?? event.pageY;\n            result.focusEl = focusEl !== void 0 ? [focusEl] : void 0;\n         }\n      }\n      else\n      {\n         const rect = targetEl.getBoundingClientRect();\n         result.x = x ?? rect.left + (rect.width / 2);\n         result.y = y ?? rect.top + (rect.height / 2);\n         result.focusEl = focusEl !== void 0 ? [targetEl, focusEl] : [targetEl];\n         result.source = 'keyboard';\n      }\n\n      return result;\n   }\n\n   /**\n    * Returns first focusable element within a specified element.\n    *\n    * @param {HTMLElement|Document} [element=document] - Optional element to start query.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @param {Set<HTMLElement>} [options.ignoreElements] - Set of elements to ignore.\n    *\n    * @returns {HTMLElement} First focusable child element\n    */\n   static getLastFocusableElement(element = document, options)\n   {\n      const focusableElements = this.getFocusableElements(element, options);\n\n      return focusableElements.length > 0 ? focusableElements[focusableElements.length - 1] : void 0;\n   }\n\n   /**\n    * Tests if the given element is focusable.\n    *\n    * @param {HTMLElement} [el] - Element to test.\n    *\n    * @param {object} [options] - Optional parameters.\n    *\n    * @param {boolean} [options.anchorHref=true] - When true anchors must have an HREF.\n    *\n    * @param {Iterable<string>} [options.ignoreClasses] - Iterable list of classes to ignore elements.\n    *\n    * @returns {boolean} Element is focusable.\n    */\n   static isFocusable(el, { anchorHref = true, ignoreClasses } = {})\n   {\n      if (el === void 0 || el === null || !(el instanceof HTMLElement) || el?.hidden || !el?.isConnected)\n      {\n         return false;\n      }\n\n      if (typeof anchorHref !== 'boolean')\n      {\n         throw new TypeError(`'anchorHref' is not a boolean.`);\n      }\n\n      if (ignoreClasses !== void 0 && !isIterable(ignoreClasses))\n      {\n         throw new TypeError(`'ignoreClasses' is not an iterable list.`);\n      }\n\n      const contenteditableAttr = el.getAttribute('contenteditable');\n      const contenteditableFocusable = typeof contenteditableAttr === 'string' &&\n       (contenteditableAttr === '' || contenteditableAttr === 'true');\n\n      const tabindexAttr = el.getAttribute('tabindex');\n      const tabindexFocusable = typeof tabindexAttr === 'string' && tabindexAttr !== '-1';\n\n      const isAnchor = el instanceof HTMLAnchorElement;\n\n      if (contenteditableFocusable || tabindexFocusable || isAnchor || el instanceof HTMLButtonElement ||\n       el instanceof HTMLDetailsElement || el instanceof HTMLEmbedElement || el instanceof HTMLIFrameElement ||\n        el instanceof HTMLInputElement || el instanceof HTMLObjectElement || el instanceof HTMLSelectElement ||\n         el instanceof HTMLTextAreaElement)\n      {\n         if (isAnchor && anchorHref && typeof el.getAttribute('href') !== 'string')\n         {\n            return false;\n         }\n\n         return el.style.display !== 'none' && el.style.visibility !== 'hidden' && !el.hasAttribute('disabled') &&\n          !el.hasAttribute('inert') && el.getAttribute('aria-hidden') !== 'true';\n      }\n\n      return false;\n   }\n\n   /**\n    * Convenience method to check if the given data is a valid focus source.\n    *\n    * @param {HTMLElement|string}   data - Either an HTMLElement or selector string.\n    *\n    * @returns {boolean} Is valid focus source.\n    */\n   static isFocusSource(data)\n   {\n      return data instanceof HTMLElement || typeof data === 'string';\n   }\n}\n\n/**\n * @typedef {object} A11yFocusSource Provides essential data to return focus to an HTMLElement after a series of UI\n * actions like working with context menus and modal dialogs.\n *\n * @property {boolean} [debug] When true logs to console the actions taken in {@link A11yHelper.applyFocusSource}.\n *\n * @property {Iterable<HTMLElement|string>} [focusEl] List of targets to attempt to focus.\n *\n * @property {string} [source] The source of the event: 'keyboard' for instance.\n *\n * @property {number} [x] Potential X coordinate of initial event.\n *\n * @property {number} [y] Potential Y coordinate of initial event.\n */\n\n/**\n * Provides utility methods for checking browser capabilities.\n *\n * @see https://kilianvalkhof.com/2021/web/detecting-media-query-support-in-css-and-javascript/\n * TODO: perhaps add support for various standard media query checks for level 4 & 5.\n */\nclass BrowserSupports\n{\n   /**\n    * Check for container query support.\n    *\n    * @returns {boolean} True if container queries supported.\n    */\n   static get containerQueries()\n   {\n      return 'container' in document.documentElement.style;\n   }\n}\n\n/**\n * Provides access to the Clipboard API for reading / writing text strings. This requires a secure context.\n *\n * Note: `writeText` will attempt to use the older `execCommand` if available when `navigator.clipboard` is not\n * available.\n */\nclass ClipboardAccess\n{\n   /**\n    * Uses `navigator.clipboard` if available to read text from the clipboard.\n    *\n    * Note: Always returns `undefined` when `navigator.clipboard` is not available or the clipboard contains the\n    * empty string.\n    *\n    * @returns {Promise<string|undefined>} The current clipboard text or undefined.\n    */\n   static async readText()\n   {\n      let result;\n\n      if (globalThis?.navigator?.clipboard)\n      {\n         try\n         {\n            result = await globalThis.navigator.clipboard.readText();\n         }\n         catch (err) { /**/ }\n      }\n\n      return result === '' ? void 0 : result;\n   }\n\n   /**\n    * Uses `navigator.clipboard` if available then falls back to `document.execCommand('copy')` if available to copy\n    * the given text to the clipboard.\n    *\n    * @param {string}   text - Text to copy to the browser clipboard.\n    *\n    * @returns {Promise<boolean>} Copy successful.\n    */\n   static async writeText(text)\n   {\n      if (typeof text !== 'string')\n      {\n         throw new TypeError(`ClipboardAccess.writeText error: 'text' is not a string.`);\n      }\n\n      let success = false;\n\n      if (globalThis?.navigator?.clipboard)\n      {\n         try\n         {\n            await globalThis.navigator.clipboard.writeText(text);\n            success = true;\n         }\n         catch (err) { /**/ }\n      }\n      else if (globalThis?.document?.execCommand instanceof Function)\n      {\n         const textArea = globalThis.document.createElement('textarea');\n\n         // Place in the top-left corner of screen regardless of scroll position.\n         textArea.style.position = 'fixed';\n         textArea.style.top = '0';\n         textArea.style.left = '0';\n\n         // Ensure it has a small width and height. Setting to 1px / 1em\n         // doesn't work as this gives a negative w/h on some browsers.\n         textArea.style.width = '2em';\n         textArea.style.height = '2em';\n\n         // We don't need padding, reducing the size if it does flash render.\n         textArea.style.padding = '0';\n\n         // Clean up any borders.\n         textArea.style.border = 'none';\n         textArea.style.outline = 'none';\n         textArea.style.boxShadow = 'none';\n\n         // Avoid flash of the white box if rendered for any reason.\n         textArea.style.background = 'transparent';\n\n         textArea.value = text;\n\n         globalThis.document.body.appendChild(textArea);\n         textArea.focus();\n         textArea.select();\n\n         try\n         {\n            success = document.execCommand('copy');\n         }\n         catch (err) { /**/ }\n\n         document.body.removeChild(textArea);\n      }\n\n      return success;\n   }\n}\n\n/**\n * Recursive function that finds the closest parent stacking context.\n * See also https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context\n *\n * Original author: Kerry Liu / https://github.com/gwwar\n *\n * @see https://github.com/gwwar/z-context/blob/master/content-script.js\n * @see https://github.com/gwwar/z-context/blob/master/LICENSE\n *\n * @param {Element} node -\n *\n * @returns {StackingContext} The closest parent stacking context\n */\nfunction getStackingContext(node)\n{\n   // the root element (HTML).\n   if (!node || node.nodeName === 'HTML')\n   {\n      return { node: document.documentElement, reason: 'root' };\n   }\n\n   // handle shadow root elements.\n   if (node.nodeName === '#document-fragment')\n   {\n      return getStackingContext(node.host);\n   }\n\n   const computedStyle = globalThis.getComputedStyle(node);\n\n   // position: fixed or sticky.\n   if (computedStyle.position === 'fixed' || computedStyle.position === 'sticky')\n   {\n      return { node, reason: `position: ${computedStyle.position}` };\n   }\n\n   // positioned (absolutely or relatively) with a z-index value other than \"auto\".\n   if (computedStyle.zIndex !== 'auto' && computedStyle.position !== 'static')\n   {\n      return { node, reason: `position: ${computedStyle.position}; z-index: ${computedStyle.zIndex}` };\n   }\n\n   // elements with an opacity value less than 1.\n   if (computedStyle.opacity !== '1')\n   {\n      return { node, reason: `opacity: ${computedStyle.opacity}` };\n   }\n\n   // elements with a transform value other than \"none\".\n   if (computedStyle.transform !== 'none')\n   {\n      return { node, reason: `transform: ${computedStyle.transform}` };\n   }\n\n   // elements with a mix-blend-mode value other than \"normal\".\n   if (computedStyle.mixBlendMode !== 'normal')\n   {\n      return { node, reason: `mixBlendMode: ${computedStyle.mixBlendMode}` };\n   }\n\n   // elements with a filter value other than \"none\".\n   if (computedStyle.filter !== 'none')\n   {\n      return { node, reason: `filter: ${computedStyle.filter}` };\n   }\n\n   // elements with a perspective value other than \"none\".\n   if (computedStyle.perspective !== 'none')\n   {\n      return { node, reason: `perspective: ${computedStyle.perspective}` };\n   }\n\n   // elements with a clip-path value other than \"none\".\n   if (computedStyle.clipPath !== 'none')\n   {\n      return { node, reason: `clip-path: ${computedStyle.clipPath} ` };\n   }\n\n   // elements with a mask value other than \"none\".\n   const mask = computedStyle.mask || computedStyle.webkitMask;\n   if (mask !== 'none' && mask !== undefined)\n   {\n      return { node, reason: `mask:  ${mask}` };\n   }\n\n   // elements with a mask-image value other than \"none\".\n   const maskImage = computedStyle.maskImage || computedStyle.webkitMaskImage;\n   if (maskImage !== 'none' && maskImage !== undefined)\n   {\n      return { node, reason: `mask-image: ${maskImage}` };\n   }\n\n   // elements with a mask-border value other than \"none\".\n   const maskBorder = computedStyle.maskBorder || computedStyle.webkitMaskBorder;\n   if (maskBorder !== 'none' && maskBorder !== undefined)\n   {\n      return { node, reason: `mask-border: ${maskBorder}` };\n   }\n\n   // elements with isolation set to \"isolate\".\n   if (computedStyle.isolation === 'isolate')\n   {\n      return { node, reason: `isolation: ${computedStyle.isolation}` };\n   }\n\n   // transform or opacity in will-change even if you don't specify values for these attributes directly.\n   if (computedStyle.willChange === 'transform' || computedStyle.willChange === 'opacity')\n   {\n      return { node, reason: `willChange: ${computedStyle.willChange}` };\n   }\n\n   // elements with -webkit-overflow-scrolling set to \"touch\".\n   if (computedStyle.webkitOverflowScrolling === 'touch')\n   {\n      return { node, reason: '-webkit-overflow-scrolling: touch' };\n   }\n\n   // an item with a z-index value other than \"auto\".\n   if (computedStyle.zIndex !== 'auto')\n   {\n      const parentStyle = globalThis.getComputedStyle(node.parentNode);\n      // with a flex|inline-flex parent.\n      if (parentStyle.display === 'flex' || parentStyle.display === 'inline-flex')\n      {\n         return { node, reason: `flex-item; z-index: ${computedStyle.zIndex}` };\n         // with a grid parent.\n      }\n      else if (parentStyle.grid !== 'none / none / none / row / auto / auto')\n      {\n         return { node, reason: `child of grid container; z-index: ${computedStyle.zIndex}` };\n      }\n   }\n\n   // contain with a value of layout, or paint, or a composite value that includes either of them\n   const contain = computedStyle.contain;\n   if (['layout', 'paint', 'strict', 'content'].indexOf(contain) > -1 ||\n    contain.indexOf('paint') > -1 ||\n    contain.indexOf('layout') > -1\n   )\n   {\n      return { node, reason: `contain: ${contain}` };\n   }\n\n   return getStackingContext(node.parentNode);\n}\n\n/**\n * @typedef {object} StackingContext\n *\n * @property {Element} node - A DOM Element.\n *\n * @property {string}  reason - Reason for why a stacking context was created.\n */\n\n/**\n * Provides resources for parsing style strings.\n */\nclass StyleParse\n{\n   static #regexPixels = /(\\d+)\\s*px/;\n\n   /**\n    * Parses a pixel string / computed styles. Ex. `100px` returns `100`.\n    *\n    * @param {string}   value - Value to parse.\n    *\n    * @returns {number|undefined} The integer component of a pixel string.\n    */\n   static pixels(value)\n   {\n      if (typeof value !== 'string') { return void 0; }\n\n      const isPixels = this.#regexPixels.test(value);\n      const number = parseInt(value);\n\n      return isPixels && Number.isFinite(number) ? number : void 0;\n   }\n}\n\n/**\n * Provides a managed dynamic style sheet / element useful in configuring global CSS variables. When creating an\n * instance of TJSStyleManager you must provide a \"document key\" / string for the style element added. The style element\n * can be accessed via `document[docKey]`.\n *\n * Instances of TJSStyleManager can also be versioned by supplying a positive integer greater than or equal to `1` via\n * the 'version' option. This version number is assigned to the associated style element. When a TJSStyleManager\n * instance is created and there is an existing instance with a version that is lower than the current instance all CSS\n * rules are removed letting the higher version to take precedence. This isn't a perfect system and requires thoughtful\n * construction of CSS variables exposed, but allows multiple independently compiled TRL packages to load the latest\n * CSS variables. It is recommended to always set `overwrite` option of {@link TJSStyleManager.setProperty} and\n * {@link TJSStyleManager.setProperties} to `false` when loading initial values.\n */\nclass TJSStyleManager\n{\n   /** @type {CSSStyleRule} */\n   #cssRule;\n\n   /** @type {string} */\n   #docKey;\n\n   /** @type {string} */\n   #selector;\n\n   /** @type {HTMLStyleElement} */\n   #styleElement;\n\n   /** @type {number} */\n   #version;\n\n   /**\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.docKey - Required key providing a link to a specific style sheet element.\n    *\n    * @param {string}   [opts.selector=:root] - Selector element.\n    *\n    * @param {Document} [opts.document] - Target document to load styles into.\n    *\n    * @param {number}   [opts.version] - An integer representing the version / level of styles being managed.\n    */\n   constructor({ docKey, selector = ':root', document = globalThis.document, version } = {})\n   {\n      if (typeof docKey !== 'string') { throw new TypeError(`StyleManager error: 'docKey' is not a string.`); }\n\n      // TODO: Verify 'document' type from Popout FVTT module. For some reason the popout document trips this\n      //  unintentionally.\n      // if (!(document instanceof Document))\n      // {\n      //    throw new TypeError(`TJSStyleManager error: 'document' is not an instance of Document.`);\n      // }\n\n      if (typeof selector !== 'string') { throw new TypeError(`StyleManager error: 'selector' is not a string.`); }\n\n      if (version !== void 0 && !Number.isSafeInteger(version) && version < 1)\n      {\n         throw new TypeError(`StyleManager error: 'version' is defined and is not a positive integer >= 1.`);\n      }\n\n      this.#selector = selector;\n      this.#docKey = docKey;\n      this.#version = version;\n\n      if (document[this.#docKey] === void 0)\n      {\n         this.#styleElement = document.createElement('style');\n\n         document.head.append(this.#styleElement);\n\n         // Set initial style manager version if any supplied.\n         this.#styleElement._STYLE_MANAGER_VERSION = version;\n\n         this.#styleElement.sheet.insertRule(`${selector} {}`, 0);\n\n         this.#cssRule = this.#styleElement.sheet.cssRules[0];\n\n         document[docKey] = this.#styleElement;\n      }\n      else\n      {\n         this.#styleElement = document[docKey];\n         this.#cssRule = this.#styleElement.sheet.cssRules[0];\n\n         if (version)\n         {\n            const existingVersion = this.#styleElement._STYLE_MANAGER_VERSION ?? 0;\n\n            // Remove all existing CSS rules / text if version is greater than existing version.\n            if (version > existingVersion)\n            {\n               this.#cssRule.style.cssText = '';\n            }\n         }\n      }\n   }\n\n   /**\n    * @returns {string} Provides an accessor to get the `cssText` for the style sheet.\n    */\n   get cssText()\n   {\n      return this.#cssRule.style.cssText;\n   }\n\n   /**\n    * @returns {number} Returns the version of this instance.\n    */\n   get version()\n   {\n      return this.#version;\n   }\n\n   /**\n    * Provides a copy constructor to duplicate an existing TJSStyleManager instance into a new document.\n    *\n    * Note: This is used to support the `PopOut` module.\n    *\n    * @param {Document} [document] Target browser document to clone into.\n    *\n    * @returns {TJSStyleManager} New style manager instance.\n    */\n   clone(document = globalThis.document)\n   {\n      const newStyleManager = new TJSStyleManager({\n         selector: this.#selector,\n         docKey: this.#docKey,\n         document,\n         version: this.#version\n      });\n\n      newStyleManager.#cssRule.style.cssText = this.#cssRule.style.cssText;\n\n      return newStyleManager;\n   }\n\n   get()\n   {\n      const cssText = this.#cssRule.style.cssText;\n\n      const result = {};\n\n      if (cssText !== '')\n      {\n         for (const entry of cssText.split(';'))\n         {\n            if (entry !== '')\n            {\n               const values = entry.split(':');\n               result[values[0].trim()] = values[1];\n            }\n         }\n      }\n\n      return result;\n   }\n\n   /**\n    * Gets a particular CSS variable.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @returns {string} Returns CSS variable value.\n    */\n   getProperty(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      return this.#cssRule.style.getPropertyValue(key);\n   }\n\n   /**\n    * Set rules by property / value; useful for CSS variables.\n    *\n    * @param {{ [key: string]: string }}  rules - An object with property / value string pairs to load.\n    *\n    * @param {boolean}                 [overwrite=true] - When true overwrites any existing values.\n    */\n   setProperties(rules, overwrite = true)\n   {\n      if (!isObject(rules)) { throw new TypeError(`StyleManager error: 'rules' is not an object.`); }\n\n      if (typeof overwrite !== 'boolean') { throw new TypeError(`StyleManager error: 'overwrite' is not a boolean.`); }\n\n      if (overwrite)\n      {\n         for (const [key, value] of Object.entries(rules))\n         {\n            this.#cssRule.style.setProperty(key, value);\n         }\n      }\n      else\n      {\n         // Only set property keys for entries that don't have an existing rule set.\n         for (const [key, value] of Object.entries(rules))\n         {\n            if (this.#cssRule.style.getPropertyValue(key) === '')\n            {\n               this.#cssRule.style.setProperty(key, value);\n            }\n         }\n      }\n   }\n\n   /**\n    * Sets a particular property.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @param {string}   value - CSS variable value.\n    *\n    * @param {boolean}  [overwrite=true] - Overwrite any existing value.\n    */\n   setProperty(key, value, overwrite = true)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      if (typeof value !== 'string') { throw new TypeError(`StyleManager error: 'value' is not a string.`); }\n\n      if (typeof overwrite !== 'boolean') { throw new TypeError(`StyleManager error: 'overwrite' is not a boolean.`); }\n\n      if (overwrite)\n      {\n         this.#cssRule.style.setProperty(key, value);\n      }\n      else\n      {\n         if (this.#cssRule.style.getPropertyValue(key) === '')\n         {\n            this.#cssRule.style.setProperty(key, value);\n         }\n      }\n   }\n\n   /**\n    * Removes the property keys specified. If `keys` is an iterable list then all property keys in the list are removed.\n    *\n    * @param {Iterable<string>} keys - The property keys to remove.\n    */\n   removeProperties(keys)\n   {\n      if (!isIterable(keys)) { throw new TypeError(`StyleManager error: 'keys' is not an iterable list.`); }\n\n      for (const key of keys)\n      {\n         if (typeof key === 'string') { this.#cssRule.style.removeProperty(key); }\n      }\n   }\n\n   /**\n    * Removes a particular CSS variable.\n    *\n    * @param {string}   key - CSS variable property key.\n    *\n    * @returns {string} CSS variable value when removed.\n    */\n   removeProperty(key)\n   {\n      if (typeof key !== 'string') { throw new TypeError(`StyleManager error: 'key' is not a string.`); }\n\n      return this.#cssRule.style.removeProperty(key);\n   }\n}\n\nexport { A11yHelper, BrowserSupports, ClipboardAccess, StyleParse, TJSStyleManager, getStackingContext, striptags };\n//# sourceMappingURL=index.js.map\n","const EPSILON = 0.000001;\n\nconst IDENTITY_2X2 = new Float32Array([\n    1, 0,\n    0, 1\n]);\n/**\n * A 2x2 Matrix\n */\nclass Mat2 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat2}.\n     */\n    static BYTE_LENGTH = 4 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 4:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 4);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v,\n                        v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 4);\n                }\n                break;\n            default:\n                super(IDENTITY_2X2);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat2.str(this);`\n     */\n    get str() {\n        return Mat2.str(this);\n    }\n    //===================\n    // Instance methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat2} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat2.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_2X2);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat2} against another one\n     * Equivalent to `Mat2.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat2.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat2.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Transpose this {@link Mat2}\n     * Equivalent to `Mat2.transpose(this, this);`\n     *\n     * @returns `this`\n     */\n    transpose() {\n        return Mat2.transpose(this, this);\n    }\n    /**\n     * Inverts this {@link Mat2}\n     * Equivalent to `Mat4.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Mat2.invert(this, this);\n    }\n    /**\n     * Scales this {@link Mat2} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat2.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat2.scale(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat2} by the given angle around the given axis\n     * Equivalent to `Mat2.rotate(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    rotate(rad) {\n        return Mat2.rotate(this, this, rad);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat2}\n     * @category Static\n     *\n     * @returns A new {@link Mat2}\n     */\n    static create() {\n        return new Mat2();\n    }\n    /**\n     * Creates a new {@link Mat2} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat2}\n     */\n    static clone(a) {\n        return new Mat2(a);\n    }\n    /**\n     * Copy the values from one {@link Mat2} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Create a new {@link Mat2} with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat2}\n     */\n    static fromValues(...values) {\n        return new Mat2(...values);\n    }\n    /**\n     * Set the components of a {@link Mat2} to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        return out;\n    }\n    /**\n     * Set a {@link Mat2} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        return out;\n    }\n    /**\n     * Transpose the values of a {@link Mat2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static transpose(out, a) {\n        // If we are transposing ourselves we can skip a few steps but have to cache\n        // some values\n        if (out === a) {\n            let a1 = a[1];\n            out[1] = a[2];\n            out[2] = a1;\n        }\n        else {\n            out[0] = a[0];\n            out[1] = a[2];\n            out[2] = a[1];\n            out[3] = a[3];\n        }\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        // Calculate the determinant\n        let det = a0 * a3 - a2 * a1;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = a3 * det;\n        out[1] = -a1 * det;\n        out[2] = -a2 * det;\n        out[3] = a0 * det;\n        return out;\n    }\n    /**\n     * Calculates the adjugate of a {@link Mat2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static adjoint(out, a) {\n        // Caching this value is necessary if out == a\n        const a0 = a[0];\n        out[0] = a[3];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = a0;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat2}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        return a[0] * a[3] - a[2] * a[1];\n    }\n    /**\n     * Adds two {@link Mat2}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat2.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Mat2}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        out[0] = a0 * b0 + a2 * b1;\n        out[1] = a1 * b0 + a3 * b1;\n        out[2] = a0 * b2 + a2 * b3;\n        out[3] = a1 * b2 + a3 * b3;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat2.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Rotates a {@link Mat2} by the given angle\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotate(out, a, rad) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = a0 * c + a2 * s;\n        out[1] = a1 * c + a3 * s;\n        out[2] = a0 * -s + a2 * c;\n        out[3] = a1 * -s + a3 * c;\n        return out;\n    }\n    /**\n     * Scales the {@link Mat2} by the dimensions in the given {@link Vec2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec2} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const v0 = v[0];\n        const v1 = v[1];\n        out[0] = a0 * v0;\n        out[1] = a1 * v0;\n        out[2] = a2 * v1;\n        out[3] = a3 * v1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat2} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat2.identity(dest);\n     *     mat2.rotate(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - {@link Mat2} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = c;\n        out[1] = s;\n        out[2] = -s;\n        out[3] = c;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat2} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     mat2.identity(dest);\n     *     mat2.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat2} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = v[1];\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat2}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3]);\n    }\n    /**\n     * Multiply each element of a {@link Mat2} by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        return out;\n    }\n    /**\n     * Adds two {@link Mat2}'s after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        return out;\n    }\n    /**\n     * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\n     * @category Static\n     *\n     * @param L - the lower triangular matrix\n     * @param D - the diagonal matrix\n     * @param U - the upper triangular matrix\n     * @param a - the input matrix to factorize\n     */\n    static LDU(L, D, U, a) {\n        L[2] = a[2] / a[0];\n        U[0] = a[0];\n        U[1] = a[1];\n        U[3] = a[3] - L[2] * U[1];\n        return [L, D, U];\n    }\n    /**\n     * Returns whether or not two {@link Mat2}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3]);\n    }\n    /**\n     * Returns whether or not two {@link Mat2}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat2}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat2(${a.join(', ')})`;\n    }\n}\n// Instance method alias assignments\nMat2.prototype.mul = Mat2.prototype.multiply;\n// Static method alias assignments\nMat2.mul = Mat2.multiply;\nMat2.sub = Mat2.subtract;\n\nconst IDENTITY_2X3 = new Float32Array([\n    1, 0,\n    0, 1,\n    0, 0,\n]);\n/**\n * A 2x3 Matrix\n */\nclass Mat2d extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat2d}.\n     */\n    static BYTE_LENGTH = 6 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 6:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 6);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v,\n                        v, v,\n                        v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 6);\n                }\n                break;\n            default:\n                super(IDENTITY_2X3);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat2d.str(this);`\n     */\n    get str() {\n        return Mat2d.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat2d} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat2d.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_2X3);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat2d} against another one\n     * Equivalent to `Mat2d.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat2d.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat2d.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Translate this {@link Mat2d} by the given vector\n     * Equivalent to `Mat2d.translate(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to translate by\n     * @returns `this`\n     */\n    translate(v) {\n        return Mat2d.translate(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat2d} by the given angle around the given axis\n     * Equivalent to `Mat2d.rotate(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    rotate(rad) {\n        return Mat2d.rotate(this, this, rad);\n    }\n    /**\n     * Scales this {@link Mat2d} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat2d.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat2d.scale(this, this, v);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat2d}\n     * @category Static\n     *\n     * @returns A new {@link Mat2d}\n     */\n    static create() {\n        return new Mat2d();\n    }\n    /**\n     * Creates a new {@link Mat2d} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat2d}\n     */\n    static clone(a) {\n        return new Mat2d(a);\n    }\n    /**\n     * Copy the values from one {@link Mat2d} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        return out;\n    }\n    /**\n     * Create a new {@link Mat2d} with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat2d}\n     */\n    static fromValues(...values) {\n        return new Mat2d(...values);\n    }\n    /**\n     * Set the components of a {@link Mat2d} to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        out[4] = values[4];\n        out[5] = values[5];\n        return out;\n    }\n    /**\n     * Set a {@link Mat2d} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        out[4] = 0;\n        out[5] = 0;\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat2d}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const aa = a[0];\n        const ab = a[1];\n        const ac = a[2];\n        const ad = a[3];\n        const atx = a[4];\n        const aty = a[5];\n        let det = aa * ad - ab * ac;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = ad * det;\n        out[1] = -ab * det;\n        out[2] = -ac * det;\n        out[3] = aa * det;\n        out[4] = (ac * aty - ad * atx) * det;\n        out[5] = (ab * atx - aa * aty) * det;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat2d}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        return a[0] * a[3] - a[1] * a[2];\n    }\n    /**\n     * Adds two {@link Mat2d}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        out[4] = a[4] - b[4];\n        out[5] = a[5] - b[5];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat2d.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Mat2d}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        out[0] = a0 * b0 + a2 * b1;\n        out[1] = a1 * b0 + a3 * b1;\n        out[2] = a0 * b2 + a2 * b3;\n        out[3] = a1 * b2 + a3 * b3;\n        out[4] = a0 * b4 + a2 * b5 + a4;\n        out[5] = a1 * b4 + a3 * b5 + a5;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat2d.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Translate a {@link Mat2d} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const v0 = v[0];\n        const v1 = v[1];\n        out[0] = a0;\n        out[1] = a1;\n        out[2] = a2;\n        out[3] = a3;\n        out[4] = a0 * v0 + a2 * v1 + a4;\n        out[5] = a1 * v0 + a3 * v1 + a5;\n        return out;\n    }\n    /**\n     * Rotates a {@link Mat2d} by the given angle\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotate(out, a, rad) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = a0 * c + a2 * s;\n        out[1] = a1 * c + a3 * s;\n        out[2] = a0 * -s + a2 * c;\n        out[3] = a1 * -s + a3 * c;\n        out[4] = a4;\n        out[5] = a5;\n        return out;\n    }\n    /**\n     * Scales the {@link Mat2d} by the dimensions in the given {@link Vec2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec2} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const v0 = v[0];\n        const v1 = v[1];\n        out[0] = a0 * v0;\n        out[1] = a1 * v0;\n        out[2] = a2 * v1;\n        out[3] = a3 * v1;\n        out[4] = a4;\n        out[5] = a5;\n        return out;\n    }\n    // TODO: Got to fromRotation\n    /**\n     * Creates a {@link Mat2d} from a vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     Mat2d.identity(dest);\n     *     Mat2d.translate(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat2d} receiving operation result\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, v) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        out[4] = v[0];\n        out[5] = v[1];\n        return out;\n    }\n    /**\n     * Creates a {@link Mat2d} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     Mat2d.identity(dest);\n     *     Mat2d.rotate(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - {@link Mat2d} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = c;\n        out[1] = s;\n        out[2] = -s;\n        out[3] = c;\n        out[4] = 0;\n        out[5] = 0;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat2d} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     Mat2d.identity(dest);\n     *     Mat2d.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat2d} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = v[1];\n        out[4] = 0;\n        out[5] = 0;\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat2d}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] + a[1] * a[1] + a[2] * a[2] + a[3] * a[3] + a[4] * a[4] + a[5] * a[5] + 1);\n    }\n    /**\n     * Multiply each element of a {@link Mat2d} by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        return out;\n    }\n    /**\n     * Adds two {@link Mat2d}'s after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        out[4] = a[4] + b[4] * scale;\n        out[5] = a[5] + b[5] * scale;\n        return out;\n    }\n    /**\n     * Returns whether or not two {@link Mat2d}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5]);\n    }\n    /**\n     * Returns whether or not two {@link Mat2d}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1, Math.abs(a5), Math.abs(b5)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat2d}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat2d(${a.join(', ')})`;\n    }\n}\n// Static method alias assignments\nMat2d.mul = Mat2d.multiply;\nMat2d.sub = Mat2d.subtract;\n\nconst IDENTITY_3X3 = new Float32Array([\n    1, 0, 0,\n    0, 1, 0,\n    0, 0, 1,\n]);\n/**\n * A 3x3 Matrix\n */\nclass Mat3 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat3}.\n     */\n    static BYTE_LENGTH = 9 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat3}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 9:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 9);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v, v,\n                        v, v, v,\n                        v, v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 9);\n                }\n                break;\n            default:\n                super(IDENTITY_3X3);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat3.str(this);`\n     */\n    get str() {\n        return Mat3.str(this);\n    }\n    //===================\n    // Instance methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat3} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat3.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_3X3);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat3} against another one\n     * Equivalent to `Mat3.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat3.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat3.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Transpose this {@link Mat3}\n     * Equivalent to `Mat3.transpose(this, this);`\n     *\n     * @returns `this`\n     */\n    transpose() {\n        return Mat3.transpose(this, this);\n    }\n    /**\n     * Inverts this {@link Mat3}\n     * Equivalent to `Mat4.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Mat3.invert(this, this);\n    }\n    /**\n     * Translate this {@link Mat3} by the given vector\n     * Equivalent to `Mat3.translate(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to translate by\n     * @returns `this`\n     */\n    translate(v) {\n        return Mat3.translate(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat3} by the given angle around the given axis\n     * Equivalent to `Mat3.rotate(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    rotate(rad) {\n        return Mat3.rotate(this, this, rad);\n    }\n    /**\n     * Scales this {@link Mat3} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat3.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec2} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat3.scale(this, this, v);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat3}\n     * @category Static\n     *\n     * @returns A new {@link Mat3}\n     */\n    static create() {\n        return new Mat3();\n    }\n    /**\n     * Creates a new {@link Mat3} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat3}\n     */\n    static clone(a) {\n        return new Mat3(a);\n    }\n    /**\n     * Copy the values from one {@link Mat3} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        out[8] = a[8];\n        return out;\n    }\n    /**\n     * Create a new {@link Mat3} with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat3}\n     */\n    static fromValues(...values) {\n        return new Mat3(...values);\n    }\n    /**\n     * Set the components of a {@link Mat3} to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        out[4] = values[4];\n        out[5] = values[5];\n        out[6] = values[6];\n        out[7] = values[7];\n        out[8] = values[8];\n        return out;\n    }\n    /**\n     * Set a {@link Mat3} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 1;\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Transpose the values of a {@link Mat3}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static transpose(out, a) {\n        // If we are transposing ourselves we can skip a few steps but have to cache some values\n        if (out === a) {\n            const a01 = a[1], a02 = a[2], a12 = a[5];\n            out[1] = a[3];\n            out[2] = a[6];\n            out[3] = a01;\n            out[5] = a[7];\n            out[6] = a02;\n            out[7] = a12;\n        }\n        else {\n            out[0] = a[0];\n            out[1] = a[3];\n            out[2] = a[6];\n            out[3] = a[1];\n            out[4] = a[4];\n            out[5] = a[7];\n            out[6] = a[2];\n            out[7] = a[5];\n            out[8] = a[8];\n        }\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat3}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2];\n        const a10 = a[3], a11 = a[4], a12 = a[5];\n        const a20 = a[6], a21 = a[7], a22 = a[8];\n        const b01 = a22 * a11 - a12 * a21;\n        const b11 = -a22 * a10 + a12 * a20;\n        const b21 = a21 * a10 - a11 * a20;\n        // Calculate the determinant\n        let det = a00 * b01 + a01 * b11 + a02 * b21;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = b01 * det;\n        out[1] = (-a22 * a01 + a02 * a21) * det;\n        out[2] = (a12 * a01 - a02 * a11) * det;\n        out[3] = b11 * det;\n        out[4] = (a22 * a00 - a02 * a20) * det;\n        out[5] = (-a12 * a00 + a02 * a10) * det;\n        out[6] = b21 * det;\n        out[7] = (-a21 * a00 + a01 * a20) * det;\n        out[8] = (a11 * a00 - a01 * a10) * det;\n        return out;\n    }\n    /**\n     * Calculates the adjugate of a {@link Mat3}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static adjoint(out, a) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        out[0] = a11 * a22 - a12 * a21;\n        out[1] = a02 * a21 - a01 * a22;\n        out[2] = a01 * a12 - a02 * a11;\n        out[3] = a12 * a20 - a10 * a22;\n        out[4] = a00 * a22 - a02 * a20;\n        out[5] = a02 * a10 - a00 * a12;\n        out[6] = a10 * a21 - a11 * a20;\n        out[7] = a01 * a20 - a00 * a21;\n        out[8] = a00 * a11 - a01 * a10;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat3}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        return (a00 * (a22 * a11 - a12 * a21) +\n            a01 * (-a22 * a10 + a12 * a20) +\n            a02 * (a21 * a10 - a11 * a20));\n    }\n    /**\n     * Adds two {@link Mat3}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        out[6] = a[6] + b[6];\n        out[7] = a[7] + b[7];\n        out[8] = a[8] + b[8];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        out[4] = a[4] - b[4];\n        out[5] = a[5] - b[5];\n        out[6] = a[6] - b[6];\n        out[7] = a[7] - b[7];\n        out[8] = a[8] - b[8];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat3.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Mat3}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        let b0 = b[0];\n        let b1 = b[1];\n        let b2 = b[2];\n        out[0] = b0 * a00 + b1 * a10 + b2 * a20;\n        out[1] = b0 * a01 + b1 * a11 + b2 * a21;\n        out[2] = b0 * a02 + b1 * a12 + b2 * a22;\n        b0 = b[3];\n        b1 = b[4];\n        b2 = b[5];\n        out[3] = b0 * a00 + b1 * a10 + b2 * a20;\n        out[4] = b0 * a01 + b1 * a11 + b2 * a21;\n        out[5] = b0 * a02 + b1 * a12 + b2 * a22;\n        b0 = b[6];\n        b1 = b[7];\n        b2 = b[8];\n        out[6] = b0 * a00 + b1 * a10 + b2 * a20;\n        out[7] = b0 * a01 + b1 * a11 + b2 * a21;\n        out[8] = b0 * a02 + b1 * a12 + b2 * a22;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat3.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Translate a {@link Mat3} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        const x = v[0];\n        const y = v[1];\n        out[0] = a00;\n        out[1] = a01;\n        out[2] = a02;\n        out[3] = a10;\n        out[4] = a11;\n        out[5] = a12;\n        out[6] = x * a00 + y * a10 + a20;\n        out[7] = x * a01 + y * a11 + a21;\n        out[8] = x * a02 + y * a12 + a22;\n        return out;\n    }\n    /**\n     * Rotates a {@link Mat3} by the given angle\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotate(out, a, rad) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a10 = a[3];\n        const a11 = a[4];\n        const a12 = a[5];\n        const a20 = a[6];\n        const a21 = a[7];\n        const a22 = a[8];\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = c * a00 + s * a10;\n        out[1] = c * a01 + s * a11;\n        out[2] = c * a02 + s * a12;\n        out[3] = c * a10 - s * a00;\n        out[4] = c * a11 - s * a01;\n        out[5] = c * a12 - s * a02;\n        out[6] = a20;\n        out[7] = a21;\n        out[8] = a22;\n        return out;\n    }\n    /**\n     * Scales the {@link Mat3} by the dimensions in the given {@link Vec2}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec2} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const x = v[0];\n        const y = v[1];\n        out[0] = x * a[0];\n        out[1] = x * a[1];\n        out[2] = x * a[2];\n        out[3] = y * a[3];\n        out[4] = y * a[4];\n        out[5] = y * a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        out[8] = a[8];\n        return out;\n    }\n    /**\n     * Creates a {@link Mat3} from a vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.translate(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat3} receiving operation result\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, v) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 1;\n        out[5] = 0;\n        out[6] = v[0];\n        out[7] = v[1];\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat3} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.rotate(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - {@link Mat3} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        out[0] = c;\n        out[1] = s;\n        out[2] = 0;\n        out[3] = -s;\n        out[4] = c;\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat3} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     mat3.identity(dest);\n     *     mat3.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat3} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = v[1];\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Copies the upper-left 3x3 values of a {@link Mat2d} into the given\n     * {@link Mat3}.\n     * @category Static\n     *\n     * @param out - the receiving 3x3 matrix\n     * @param a - the source 2x3 matrix\n     * @returns `out`\n     */\n    static fromMat2d(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = 0;\n        out[3] = a[2];\n        out[4] = a[3];\n        out[5] = 0;\n        out[6] = a[4];\n        out[7] = a[5];\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Calculates a {@link Mat3} from the given quaternion\n     *\n     * @param out - {@link Mat3} receiving operation result\n     * @param q - {@link Quat} to create matrix from\n     * @returns `out`\n     */\n    static fromQuat(out, q) {\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const yx = y * x2;\n        const yy = y * y2;\n        const zx = z * x2;\n        const zy = z * y2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        out[0] = 1 - yy - zz;\n        out[3] = yx - wz;\n        out[6] = zx + wy;\n        out[1] = yx + wz;\n        out[4] = 1 - xx - zz;\n        out[7] = zy - wx;\n        out[2] = zx - wy;\n        out[5] = zy + wx;\n        out[8] = 1 - xx - yy;\n        return out;\n    }\n    /**\n     * Copies the upper-left 3x3 values of a {@link Mat4} into the given\n     * {@link Mat3}.\n     * @category Static\n     *\n     * @param out - the receiving 3x3 matrix\n     * @param a - the source 4x4 matrix\n     * @returns `out`\n     */\n    static fromMat4(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[4];\n        out[4] = a[5];\n        out[5] = a[6];\n        out[6] = a[8];\n        out[7] = a[9];\n        out[8] = a[10];\n        return out;\n    }\n    /**\n     * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n     * @category Static\n     *\n     * @param {mat3} out mat3 receiving operation result\n     * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\n     * @returns `out`\n     */\n    static normalFromMat4(out, a) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        const a30 = a[12];\n        const a31 = a[13];\n        const a32 = a[14];\n        const a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n        out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n        out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n        out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n        out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n        out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n        out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n        out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n        out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n        return out;\n    }\n    /**\n     * Generates a 2D projection matrix with the given bounds\n     * @category Static\n     *\n     * @param out mat3 frustum matrix will be written into\n     * @param width Width of your gl context\n     * @param height Height of gl context\n     * @returns `out`\n     */\n    static projection(out, width, height) {\n        out[0] = 2 / width;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = -2 / height;\n        out[5] = 0;\n        out[6] = -1;\n        out[7] = 1;\n        out[8] = 1;\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat3}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] +\n            a[1] * a[1] +\n            a[2] * a[2] +\n            a[3] * a[3] +\n            a[4] * a[4] +\n            a[5] * a[5] +\n            a[6] * a[6] +\n            a[7] * a[7] +\n            a[8] * a[8]);\n    }\n    /**\n     * Multiply each element of a {@link Mat3} by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        out[6] = a[6] * b;\n        out[7] = a[7] * b;\n        out[8] = a[8] * b;\n        return out;\n    }\n    /**\n     * Adds two {@link Mat3}'s after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        out[4] = a[4] + b[4] * scale;\n        out[5] = a[5] + b[5] * scale;\n        out[6] = a[6] + b[6] * scale;\n        out[7] = a[7] + b[7] * scale;\n        out[8] = a[8] + b[8] * scale;\n        return out;\n    }\n    /**\n     * Returns whether or not two {@link Mat3}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[7] === b[7] &&\n            a[8] === b[8]);\n    }\n    /**\n     * Returns whether or not two {@link Mat3}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const a6 = a[6];\n        const a7 = a[7];\n        const a8 = a[8];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        const b6 = b[6];\n        const b7 = b[7];\n        const b8 = b[8];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= EPSILON * Math.max(1, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= EPSILON * Math.max(1, Math.abs(a7), Math.abs(b7)) &&\n            Math.abs(a8 - b8) <= EPSILON * Math.max(1, Math.abs(a8), Math.abs(b8)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat3}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat3(${a.join(', ')})`;\n    }\n}\n// Instance method alias assignments\nMat3.prototype.mul = Mat3.prototype.multiply;\n// Static method alias assignments\nMat3.mul = Mat3.multiply;\nMat3.sub = Mat3.subtract;\n\nconst IDENTITY_4X4 = new Float32Array([\n    1, 0, 0, 0,\n    0, 1, 0, 0,\n    0, 0, 1, 0,\n    0, 0, 0, 1,\n]);\n/**\n * A 4x4 Matrix\n */\nclass Mat4 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Mat4}.\n     */\n    static BYTE_LENGTH = 16 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Mat4}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 16:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 16);\n                break;\n            case 1:\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([\n                        v, v, v, v,\n                        v, v, v, v,\n                        v, v, v, v,\n                        v, v, v, v\n                    ]);\n                }\n                else {\n                    super(v, 0, 16);\n                }\n                break;\n            default:\n                super(IDENTITY_4X4);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Mat4.str(this);`\n     */\n    get str() {\n        return Mat4.str(this);\n    }\n    //===================\n    // Instance methods\n    //===================\n    /**\n     * Copy the values from another {@link Mat4} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity matrix\n     * Equivalent to Mat4.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this.set(IDENTITY_4X4);\n        return this;\n    }\n    /**\n     * Multiplies this {@link Mat4} against another one\n     * Equivalent to `Mat4.multiply(this, this, b);`\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `this`\n     */\n    multiply(b) {\n        return Mat4.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Mat4.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Transpose this {@link Mat4}\n     * Equivalent to `Mat4.transpose(this, this);`\n     *\n     * @returns `this`\n     */\n    transpose() {\n        return Mat4.transpose(this, this);\n    }\n    /**\n     * Inverts this {@link Mat4}\n     * Equivalent to `Mat4.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Mat4.invert(this, this);\n    }\n    /**\n     * Translate this {@link Mat4} by the given vector\n     * Equivalent to `Mat4.translate(this, this, v);`\n     *\n     * @param v - The {@link Vec3} to translate by\n     * @returns `this`\n     */\n    translate(v) {\n        return Mat4.translate(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the given axis\n     * Equivalent to `Mat4.rotate(this, this, rad, axis);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out`\n     */\n    rotate(rad, axis) {\n        return Mat4.rotate(this, this, rad, axis);\n    }\n    /**\n     * Scales this {@link Mat4} by the dimensions in the given vec3 not using vectorization\n     * Equivalent to `Mat4.scale(this, this, v);`\n     *\n     * @param v - The {@link Vec3} to scale the matrix by\n     * @returns `this`\n     */\n    scale(v) {\n        return Mat4.scale(this, this, v);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the X axis\n     * Equivalent to `Mat4.rotateX(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateX(rad) {\n        return Mat4.rotateX(this, this, rad);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the Y axis\n     * Equivalent to `Mat4.rotateY(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateY(rad) {\n        return Mat4.rotateY(this, this, rad);\n    }\n    /**\n     * Rotates this {@link Mat4} by the given angle around the Z axis\n     * Equivalent to `Mat4.rotateZ(this, this, rad);`\n     *\n     * @param rad - the angle to rotate the matrix by\n     * @returns `this`\n     */\n    rotateZ(rad) {\n        return Mat4.rotateZ(this, this, rad);\n    }\n    /**\n     * Generates a perspective projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * Equivalent to `Mat4.perspectiveNO(this, fovy, aspect, near, far);`\n     *\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `this`\n     */\n    perspectiveNO(fovy, aspect, near, far) {\n        return Mat4.perspectiveNO(this, fovy, aspect, near, far);\n    }\n    /**\n     * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * Equivalent to `Mat4.perspectiveZO(this, fovy, aspect, near, far);`\n     *\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `this`\n     */\n    perspectiveZO(fovy, aspect, near, far) {\n        return Mat4.perspectiveZO(this, fovy, aspect, near, far);\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Equivalent to `Mat4.orthoNO(this, left, right, bottom, top, near, far);`\n     *\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `this`\n     */\n    orthoNO(left, right, bottom, top, near, far) {\n        return Mat4.orthoNO(this, left, right, bottom, top, near, far);\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Equivalent to `Mat4.orthoZO(this, left, right, bottom, top, near, far);`\n     *\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `this`\n     */\n    orthoZO(left, right, bottom, top, near, far) {\n        return Mat4.orthoZO(this, left, right, bottom, top, near, far);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, identity {@link Mat4}\n     * @category Static\n     *\n     * @returns A new {@link Mat4}\n     */\n    static create() {\n        return new Mat4();\n    }\n    /**\n     * Creates a new {@link Mat4} initialized with values from an existing matrix\n     * @category Static\n     *\n     * @param a - Matrix to clone\n     * @returns A new {@link Mat4}\n     */\n    static clone(a) {\n        return new Mat4(a);\n    }\n    /**\n     * Copy the values from one {@link Mat4} to another\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - Matrix to copy\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        out[8] = a[8];\n        out[9] = a[9];\n        out[10] = a[10];\n        out[11] = a[11];\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n        return out;\n    }\n    /**\n     * Create a new mat4 with the given values\n     * @category Static\n     *\n     * @param values - Matrix components\n     * @returns A new {@link Mat4}\n     */\n    static fromValues(...values) {\n        return new Mat4(...values);\n    }\n    /**\n     * Set the components of a mat4 to the given values\n     * @category Static\n     *\n     * @param out - The receiving matrix\n     * @param values - Matrix components\n     * @returns `out`\n     */\n    static set(out, ...values) {\n        out[0] = values[0];\n        out[1] = values[1];\n        out[2] = values[2];\n        out[3] = values[3];\n        out[4] = values[4];\n        out[5] = values[5];\n        out[6] = values[6];\n        out[7] = values[7];\n        out[8] = values[8];\n        out[9] = values[9];\n        out[10] = values[10];\n        out[11] = values[11];\n        out[12] = values[12];\n        out[13] = values[13];\n        out[14] = values[14];\n        out[15] = values[15];\n        return out;\n    }\n    /**\n     * Set a {@link Mat4} to the identity matrix\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Transpose the values of a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static transpose(out, a) {\n        // If we are transposing ourselves we can skip a few steps but have to cache some values\n        if (out === a) {\n            const a01 = a[1], a02 = a[2], a03 = a[3];\n            const a12 = a[6], a13 = a[7];\n            const a23 = a[11];\n            out[1] = a[4];\n            out[2] = a[8];\n            out[3] = a[12];\n            out[4] = a01;\n            out[6] = a[9];\n            out[7] = a[13];\n            out[8] = a02;\n            out[9] = a12;\n            out[11] = a[14];\n            out[12] = a03;\n            out[13] = a13;\n            out[14] = a23;\n        }\n        else {\n            out[0] = a[0];\n            out[1] = a[4];\n            out[2] = a[8];\n            out[3] = a[12];\n            out[4] = a[1];\n            out[5] = a[5];\n            out[6] = a[9];\n            out[7] = a[13];\n            out[8] = a[2];\n            out[9] = a[6];\n            out[10] = a[10];\n            out[11] = a[14];\n            out[12] = a[3];\n            out[13] = a[7];\n            out[14] = a[11];\n            out[15] = a[15];\n        }\n        return out;\n    }\n    /**\n     * Inverts a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        // Calculate the determinant\n        let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n        if (!det) {\n            return null;\n        }\n        det = 1.0 / det;\n        out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n        out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n        out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n        out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n        out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n        out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n        out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n        out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n        out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n        out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n        out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n        out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n        out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n        out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n        out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n        out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n        return out;\n    }\n    /**\n     * Calculates the adjugate of a {@link Mat4}\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the source matrix\n     * @returns `out`\n     */\n    static adjoint(out, a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b00 = a00 * a11 - a01 * a10;\n        const b01 = a00 * a12 - a02 * a10;\n        const b02 = a00 * a13 - a03 * a10;\n        const b03 = a01 * a12 - a02 * a11;\n        const b04 = a01 * a13 - a03 * a11;\n        const b05 = a02 * a13 - a03 * a12;\n        const b06 = a20 * a31 - a21 * a30;\n        const b07 = a20 * a32 - a22 * a30;\n        const b08 = a20 * a33 - a23 * a30;\n        const b09 = a21 * a32 - a22 * a31;\n        const b10 = a21 * a33 - a23 * a31;\n        const b11 = a22 * a33 - a23 * a32;\n        out[0] = a11 * b11 - a12 * b10 + a13 * b09;\n        out[1] = a02 * b10 - a01 * b11 - a03 * b09;\n        out[2] = a31 * b05 - a32 * b04 + a33 * b03;\n        out[3] = a22 * b04 - a21 * b05 - a23 * b03;\n        out[4] = a12 * b08 - a10 * b11 - a13 * b07;\n        out[5] = a00 * b11 - a02 * b08 + a03 * b07;\n        out[6] = a32 * b02 - a30 * b05 - a33 * b01;\n        out[7] = a20 * b05 - a22 * b02 + a23 * b01;\n        out[8] = a10 * b10 - a11 * b08 + a13 * b06;\n        out[9] = a01 * b08 - a00 * b10 - a03 * b06;\n        out[10] = a30 * b04 - a31 * b02 + a33 * b00;\n        out[11] = a21 * b02 - a20 * b04 - a23 * b00;\n        out[12] = a11 * b07 - a10 * b09 - a12 * b06;\n        out[13] = a00 * b09 - a01 * b07 + a02 * b06;\n        out[14] = a31 * b01 - a30 * b03 - a32 * b00;\n        out[15] = a20 * b03 - a21 * b01 + a22 * b00;\n        return out;\n    }\n    /**\n     * Calculates the determinant of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - the source matrix\n     * @returns determinant of a\n     */\n    static determinant(a) {\n        const a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\n        const a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\n        const a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\n        const a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\n        const b0 = a00 * a11 - a01 * a10;\n        const b1 = a00 * a12 - a02 * a10;\n        const b2 = a01 * a12 - a02 * a11;\n        const b3 = a20 * a31 - a21 * a30;\n        const b4 = a20 * a32 - a22 * a30;\n        const b5 = a21 * a32 - a22 * a31;\n        const b6 = a00 * b5 - a01 * b4 + a02 * b3;\n        const b7 = a10 * b5 - a11 * b4 + a12 * b3;\n        const b8 = a20 * b2 - a21 * b1 + a22 * b0;\n        const b9 = a30 * b2 - a31 * b1 + a32 * b0;\n        // Calculate the determinant\n        return a13 * b6 - a03 * b7 + a33 * b8 - a23 * b9;\n    }\n    /**\n     * Multiplies two {@link Mat4}s\n     * @category Static\n     *\n     * @param out - The receiving Matrix\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        const a30 = a[12];\n        const a31 = a[13];\n        const a32 = a[14];\n        const a33 = a[15];\n        // Cache only the current line of the second matrix\n        let b0 = b[0];\n        let b1 = b[1];\n        let b2 = b[2];\n        let b3 = b[3];\n        out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[4];\n        b1 = b[5];\n        b2 = b[6];\n        b3 = b[7];\n        out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[8];\n        b1 = b[9];\n        b2 = b[10];\n        b3 = b[11];\n        out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        b0 = b[12];\n        b1 = b[13];\n        b2 = b[14];\n        b3 = b[15];\n        out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n        out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n        out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n        out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Translate a {@link Mat4} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        if (a === out) {\n            out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n            out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n            out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n            out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n        }\n        else {\n            const a00 = a[0];\n            const a01 = a[1];\n            const a02 = a[2];\n            const a03 = a[3];\n            const a10 = a[4];\n            const a11 = a[5];\n            const a12 = a[6];\n            const a13 = a[7];\n            const a20 = a[8];\n            const a21 = a[9];\n            const a22 = a[10];\n            const a23 = a[11];\n            out[0] = a00;\n            out[1] = a01;\n            out[2] = a02;\n            out[3] = a03;\n            out[4] = a10;\n            out[5] = a11;\n            out[6] = a12;\n            out[7] = a13;\n            out[8] = a20;\n            out[9] = a21;\n            out[10] = a22;\n            out[11] = a23;\n            out[12] = a00 * x + a10 * y + a20 * z + a[12];\n            out[13] = a01 * x + a11 * y + a21 * z + a[13];\n            out[14] = a02 * x + a12 * y + a22 * z + a[14];\n            out[15] = a03 * x + a13 * y + a23 * z + a[15];\n        }\n        return out;\n    }\n    /**\n     * Scales the {@link Mat4} by the dimensions in the given {@link Vec3} not using vectorization\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param v - the {@link Vec3} to scale the matrix by\n     * @returns `out`\n     **/\n    static scale(out, a, v) {\n        const x = v[0];\n        const y = v[1];\n        const z = v[2];\n        out[0] = a[0] * x;\n        out[1] = a[1] * x;\n        out[2] = a[2] * x;\n        out[3] = a[3] * x;\n        out[4] = a[4] * y;\n        out[5] = a[5] * y;\n        out[6] = a[6] * y;\n        out[7] = a[7] * y;\n        out[8] = a[8] * z;\n        out[9] = a[9] * z;\n        out[10] = a[10] * z;\n        out[11] = a[11] * z;\n        out[12] = a[12];\n        out[13] = a[13];\n        out[14] = a[14];\n        out[15] = a[15];\n        return out;\n    }\n    /**\n     * Rotates a {@link Mat4} by the given angle around the given axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out`\n     */\n    static rotate(out, a, rad, axis) {\n        let x = axis[0];\n        let y = axis[1];\n        let z = axis[2];\n        let len = Math.sqrt(x * x + y * y + z * z);\n        if (len < EPSILON) {\n            return null;\n        }\n        len = 1 / len;\n        x *= len;\n        y *= len;\n        z *= len;\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        const t = 1 - c;\n        const a00 = a[0];\n        const a01 = a[1];\n        const a02 = a[2];\n        const a03 = a[3];\n        const a10 = a[4];\n        const a11 = a[5];\n        const a12 = a[6];\n        const a13 = a[7];\n        const a20 = a[8];\n        const a21 = a[9];\n        const a22 = a[10];\n        const a23 = a[11];\n        // Construct the elements of the rotation matrix\n        const b00 = x * x * t + c;\n        const b01 = y * x * t + z * s;\n        const b02 = z * x * t - y * s;\n        const b10 = x * y * t - z * s;\n        const b11 = y * y * t + c;\n        const b12 = z * y * t + x * s;\n        const b20 = x * z * t + y * s;\n        const b21 = y * z * t - x * s;\n        const b22 = z * z * t + c;\n        // Perform rotation-specific matrix multiplication\n        out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n        out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n        out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n        out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n        out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n        out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n        out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n        out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n        out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n        out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n        out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n        out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged last row\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the X axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateX(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a10 = a[4];\n        let a11 = a[5];\n        let a12 = a[6];\n        let a13 = a[7];\n        let a20 = a[8];\n        let a21 = a[9];\n        let a22 = a[10];\n        let a23 = a[11];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged rows\n            out[0] = a[0];\n            out[1] = a[1];\n            out[2] = a[2];\n            out[3] = a[3];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[4] = a10 * c + a20 * s;\n        out[5] = a11 * c + a21 * s;\n        out[6] = a12 * c + a22 * s;\n        out[7] = a13 * c + a23 * s;\n        out[8] = a20 * c - a10 * s;\n        out[9] = a21 * c - a11 * s;\n        out[10] = a22 * c - a12 * s;\n        out[11] = a23 * c - a13 * s;\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the Y axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateY(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a00 = a[0];\n        let a01 = a[1];\n        let a02 = a[2];\n        let a03 = a[3];\n        let a20 = a[8];\n        let a21 = a[9];\n        let a22 = a[10];\n        let a23 = a[11];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged rows\n            out[4] = a[4];\n            out[5] = a[5];\n            out[6] = a[6];\n            out[7] = a[7];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[0] = a00 * c - a20 * s;\n        out[1] = a01 * c - a21 * s;\n        out[2] = a02 * c - a22 * s;\n        out[3] = a03 * c - a23 * s;\n        out[8] = a00 * s + a20 * c;\n        out[9] = a01 * s + a21 * c;\n        out[10] = a02 * s + a22 * c;\n        out[11] = a03 * s + a23 * c;\n        return out;\n    }\n    /**\n     * Rotates a matrix by the given angle around the Z axis\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to rotate\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static rotateZ(out, a, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        let a00 = a[0];\n        let a01 = a[1];\n        let a02 = a[2];\n        let a03 = a[3];\n        let a10 = a[4];\n        let a11 = a[5];\n        let a12 = a[6];\n        let a13 = a[7];\n        if (a !== out) {\n            // If the source and destination differ, copy the unchanged last row\n            out[8] = a[8];\n            out[9] = a[9];\n            out[10] = a[10];\n            out[11] = a[11];\n            out[12] = a[12];\n            out[13] = a[13];\n            out[14] = a[14];\n            out[15] = a[15];\n        }\n        // Perform axis-specific matrix multiplication\n        out[0] = a00 * c + a10 * s;\n        out[1] = a01 * c + a11 * s;\n        out[2] = a02 * c + a12 * s;\n        out[3] = a03 * c + a13 * s;\n        out[4] = a10 * c - a00 * s;\n        out[5] = a11 * c - a01 * s;\n        out[6] = a12 * c - a02 * s;\n        out[7] = a13 * c - a03 * s;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, v) {\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a vector scaling\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.scale(dest, dest, vec);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param v - Scaling vector\n     * @returns `out`\n     */\n    static fromScaling(out, v) {\n        out[0] = v[0];\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = v[1];\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = v[2];\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a {@link Mat4} from a given angle around a given axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotate(dest, dest, rad, axis);\n     * @category Static\n     *\n     * @param out - {@link Mat4} receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @param axis - the axis to rotate around\n     * @returns `out`\n     */\n    static fromRotation(out, rad, axis) {\n        let x = axis[0];\n        let y = axis[1];\n        let z = axis[2];\n        let len = Math.sqrt(x * x + y * y + z * z);\n        if (len < EPSILON) {\n            return null;\n        }\n        len = 1 / len;\n        x *= len;\n        y *= len;\n        z *= len;\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        const t = 1 - c;\n        // Perform rotation-specific matrix multiplication\n        out[0] = x * x * t + c;\n        out[1] = y * x * t + z * s;\n        out[2] = z * x * t - y * s;\n        out[3] = 0;\n        out[4] = x * y * t - z * s;\n        out[5] = y * y * t + c;\n        out[6] = z * y * t + x * s;\n        out[7] = 0;\n        out[8] = x * z * t + y * s;\n        out[9] = y * z * t - x * s;\n        out[10] = z * z * t + c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the X axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateX(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromXRotation(out, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = 1;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = c;\n        out[6] = s;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = -s;\n        out[10] = c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the Y axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateY(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromYRotation(out, rad) {\n        let s = Math.sin(rad);\n        let c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = c;\n        out[1] = 0;\n        out[2] = -s;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = 1;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = s;\n        out[9] = 0;\n        out[10] = c;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from the given angle around the Z axis\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.rotateZ(dest, dest, rad);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param rad - the angle to rotate the matrix by\n     * @returns `out`\n     */\n    static fromZRotation(out, rad) {\n        const s = Math.sin(rad);\n        const c = Math.cos(rad);\n        // Perform axis-specific matrix multiplication\n        out[0] = c;\n        out[1] = s;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = -s;\n        out[5] = c;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 1;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation and vector translation\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @returns `out`\n     */\n    static fromRotationTranslation(out, q, v) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        out[0] = 1 - (yy + zz);\n        out[1] = xy + wz;\n        out[2] = xz - wy;\n        out[3] = 0;\n        out[4] = xy - wz;\n        out[5] = 1 - (xx + zz);\n        out[6] = yz + wx;\n        out[7] = 0;\n        out[8] = xz + wy;\n        out[9] = yz - wx;\n        out[10] = 1 - (xx + yy);\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Sets a {@link Mat4} from a {@link Quat2}.\n     * @category Static\n     *\n     * @param out - Matrix\n     * @param a - Dual Quaternion\n     * @returns `out`\n     */\n    static fromQuat2(out, a) {\n        let translation = [0, 0, 0];\n        const bx = -a[0];\n        const by = -a[1];\n        const bz = -a[2];\n        const bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        let magnitude = bx * bx + by * by + bz * bz + bw * bw;\n        //Only scale if it makes sense\n        if (magnitude > 0) {\n            translation[0] = ((ax * bw + aw * bx + ay * bz - az * by) * 2) / magnitude;\n            translation[1] = ((ay * bw + aw * by + az * bx - ax * bz) * 2) / magnitude;\n            translation[2] = ((az * bw + aw * bz + ax * by - ay * bx) * 2) / magnitude;\n        }\n        else {\n            translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n            translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n            translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n        }\n        Mat4.fromRotationTranslation(out, a, translation);\n        return out;\n    }\n    /**\n     * Returns the translation vector component of a transformation\n     * matrix. If a matrix is built with fromRotationTranslation,\n     * the returned vector will be the same as the translation vector\n     * originally supplied.\n     * @category Static\n     *\n     * @param  {vec3} out Vector to receive translation component\n     * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n     * @return {vec3} out\n     */\n    static getTranslation(out, mat) {\n        out[0] = mat[12];\n        out[1] = mat[13];\n        out[2] = mat[14];\n        return out;\n    }\n    /**\n     * Returns the scaling factor component of a transformation\n     * matrix. If a matrix is built with fromRotationTranslationScale\n     * with a normalized Quaternion paramter, the returned vector will be\n     * the same as the scaling vector\n     * originally supplied.\n     * @category Static\n     *\n     * @param  {vec3} out Vector to receive scaling factor component\n     * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n     * @return {vec3} out\n     */\n    static getScaling(out, mat) {\n        const m11 = mat[0];\n        const m12 = mat[1];\n        const m13 = mat[2];\n        const m21 = mat[4];\n        const m22 = mat[5];\n        const m23 = mat[6];\n        const m31 = mat[8];\n        const m32 = mat[9];\n        const m33 = mat[10];\n        out[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n        out[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n        out[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n        return out;\n    }\n    /**\n     * Returns a quaternion representing the rotational component\n     * of a transformation matrix. If a matrix is built with\n     * fromRotationTranslation, the returned quaternion will be the\n     * same as the quaternion originally supplied.\n     * @category Static\n     *\n     * @param out - Quaternion to receive the rotation component\n     * @param mat - Matrix to be decomposed (input)\n     * @return `out`\n     */\n    static getRotation(out, mat) {\n        Mat4.getScaling(tmpVec3$1, mat);\n        const is1 = 1 / tmpVec3$1[0];\n        const is2 = 1 / tmpVec3$1[1];\n        const is3 = 1 / tmpVec3$1[2];\n        const sm11 = mat[0] * is1;\n        const sm12 = mat[1] * is2;\n        const sm13 = mat[2] * is3;\n        const sm21 = mat[4] * is1;\n        const sm22 = mat[5] * is2;\n        const sm23 = mat[6] * is3;\n        const sm31 = mat[8] * is1;\n        const sm32 = mat[9] * is2;\n        const sm33 = mat[10] * is3;\n        const trace = sm11 + sm22 + sm33;\n        let S = 0;\n        if (trace > 0) {\n            S = Math.sqrt(trace + 1.0) * 2;\n            out[3] = 0.25 * S;\n            out[0] = (sm23 - sm32) / S;\n            out[1] = (sm31 - sm13) / S;\n            out[2] = (sm12 - sm21) / S;\n        }\n        else if (sm11 > sm22 && sm11 > sm33) {\n            S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n            out[3] = (sm23 - sm32) / S;\n            out[0] = 0.25 * S;\n            out[1] = (sm12 + sm21) / S;\n            out[2] = (sm31 + sm13) / S;\n        }\n        else if (sm22 > sm33) {\n            S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n            out[3] = (sm31 - sm13) / S;\n            out[0] = (sm12 + sm21) / S;\n            out[1] = 0.25 * S;\n            out[2] = (sm23 + sm32) / S;\n        }\n        else {\n            S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n            out[3] = (sm12 - sm21) / S;\n            out[0] = (sm31 + sm13) / S;\n            out[1] = (sm23 + sm32) / S;\n            out[2] = 0.25 * S;\n        }\n        return out;\n    }\n    /**\n     * Decomposes a transformation matrix into its rotation, translation\n     * and scale components. Returns only the rotation component\n     * @category Static\n     *\n     * @param out_r - Quaternion to receive the rotation component\n     * @param out_t - Vector to receive the translation vector\n     * @param out_s - Vector to receive the scaling factor\n     * @param mat - Matrix to be decomposed (input)\n     * @returns `out_r`\n     */\n    static decompose(out_r, out_t, out_s, mat) {\n        out_t[0] = mat[12];\n        out_t[1] = mat[13];\n        out_t[2] = mat[14];\n        const m11 = mat[0];\n        const m12 = mat[1];\n        const m13 = mat[2];\n        const m21 = mat[4];\n        const m22 = mat[5];\n        const m23 = mat[6];\n        const m31 = mat[8];\n        const m32 = mat[9];\n        const m33 = mat[10];\n        out_s[0] = Math.sqrt(m11 * m11 + m12 * m12 + m13 * m13);\n        out_s[1] = Math.sqrt(m21 * m21 + m22 * m22 + m23 * m23);\n        out_s[2] = Math.sqrt(m31 * m31 + m32 * m32 + m33 * m33);\n        const is1 = 1 / out_s[0];\n        const is2 = 1 / out_s[1];\n        const is3 = 1 / out_s[2];\n        const sm11 = m11 * is1;\n        const sm12 = m12 * is2;\n        const sm13 = m13 * is3;\n        const sm21 = m21 * is1;\n        const sm22 = m22 * is2;\n        const sm23 = m23 * is3;\n        const sm31 = m31 * is1;\n        const sm32 = m32 * is2;\n        const sm33 = m33 * is3;\n        const trace = sm11 + sm22 + sm33;\n        let S = 0;\n        if (trace > 0) {\n            S = Math.sqrt(trace + 1.0) * 2;\n            out_r[3] = 0.25 * S;\n            out_r[0] = (sm23 - sm32) / S;\n            out_r[1] = (sm31 - sm13) / S;\n            out_r[2] = (sm12 - sm21) / S;\n        }\n        else if (sm11 > sm22 && sm11 > sm33) {\n            S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n            out_r[3] = (sm23 - sm32) / S;\n            out_r[0] = 0.25 * S;\n            out_r[1] = (sm12 + sm21) / S;\n            out_r[2] = (sm31 + sm13) / S;\n        }\n        else if (sm22 > sm33) {\n            S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n            out_r[3] = (sm31 - sm13) / S;\n            out_r[0] = (sm12 + sm21) / S;\n            out_r[1] = 0.25 * S;\n            out_r[2] = (sm23 + sm32) / S;\n        }\n        else {\n            S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n            out_r[3] = (sm12 - sm21) / S;\n            out_r[0] = (sm31 + sm13) / S;\n            out_r[1] = (sm23 + sm32) / S;\n            out_r[2] = 0.25 * S;\n        }\n        return out_r;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation, vector translation and vector scale\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     *     mat4.scale(dest, scale);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @param s - Scaling vector\n     * @returns `out`\n     */\n    static fromRotationTranslationScale(out, q, v, s) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        const sx = s[0];\n        const sy = s[1];\n        const sz = s[2];\n        out[0] = (1 - (yy + zz)) * sx;\n        out[1] = (xy + wz) * sx;\n        out[2] = (xz - wy) * sx;\n        out[3] = 0;\n        out[4] = (xy - wz) * sy;\n        out[5] = (1 - (xx + zz)) * sy;\n        out[6] = (yz + wx) * sy;\n        out[7] = 0;\n        out[8] = (xz + wy) * sz;\n        out[9] = (yz - wx) * sz;\n        out[10] = (1 - (xx + yy)) * sz;\n        out[11] = 0;\n        out[12] = v[0];\n        out[13] = v[1];\n        out[14] = v[2];\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n     * This is equivalent to (but much faster than):\n     *\n     *     mat4.identity(dest);\n     *     mat4.translate(dest, vec);\n     *     mat4.translate(dest, origin);\n     *     let quatMat = mat4.create();\n     *     quat4.toMat4(quat, quatMat);\n     *     mat4.multiply(dest, quatMat);\n     *     mat4.scale(dest, scale)\n     *     mat4.translate(dest, negativeOrigin);\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Rotation quaternion\n     * @param v - Translation vector\n     * @param s - Scaling vector\n     * @param o - The origin vector around which to scale and rotate\n     * @returns `out`\n     */\n    static fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n        // Quaternion math\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const xy = x * y2;\n        const xz = x * z2;\n        const yy = y * y2;\n        const yz = y * z2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        const sx = s[0];\n        const sy = s[1];\n        const sz = s[2];\n        const ox = o[0];\n        const oy = o[1];\n        const oz = o[2];\n        const out0 = (1 - (yy + zz)) * sx;\n        const out1 = (xy + wz) * sx;\n        const out2 = (xz - wy) * sx;\n        const out4 = (xy - wz) * sy;\n        const out5 = (1 - (xx + zz)) * sy;\n        const out6 = (yz + wx) * sy;\n        const out8 = (xz + wy) * sz;\n        const out9 = (yz - wx) * sz;\n        const out10 = (1 - (xx + yy)) * sz;\n        out[0] = out0;\n        out[1] = out1;\n        out[2] = out2;\n        out[3] = 0;\n        out[4] = out4;\n        out[5] = out5;\n        out[6] = out6;\n        out[7] = 0;\n        out[8] = out8;\n        out[9] = out9;\n        out[10] = out10;\n        out[11] = 0;\n        out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n        out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n        out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Calculates a 4x4 matrix from the given quaternion\n     * @category Static\n     *\n     * @param out - mat4 receiving operation result\n     * @param q - Quaternion to create matrix from\n     * @returns `out`\n     */\n    static fromQuat(out, q) {\n        const x = q[0];\n        const y = q[1];\n        const z = q[2];\n        const w = q[3];\n        const x2 = x + x;\n        const y2 = y + y;\n        const z2 = z + z;\n        const xx = x * x2;\n        const yx = y * x2;\n        const yy = y * y2;\n        const zx = z * x2;\n        const zy = z * y2;\n        const zz = z * z2;\n        const wx = w * x2;\n        const wy = w * y2;\n        const wz = w * z2;\n        out[0] = 1 - yy - zz;\n        out[1] = yx + wz;\n        out[2] = zx - wy;\n        out[3] = 0;\n        out[4] = yx - wz;\n        out[5] = 1 - xx - zz;\n        out[6] = zy + wx;\n        out[7] = 0;\n        out[8] = zx + wy;\n        out[9] = zy - wx;\n        out[10] = 1 - xx - yy;\n        out[11] = 0;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = 0;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a frustum matrix with the given bounds\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     */\n    static frustum(out, left, right, bottom, top, near, far) {\n        const rl = 1 / (right - left);\n        const tb = 1 / (top - bottom);\n        const nf = 1 / (near - far);\n        out[0] = near * 2 * rl;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = near * 2 * tb;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = (right + left) * rl;\n        out[9] = (top + bottom) * tb;\n        out[10] = (far + near) * nf;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[14] = far * near * 2 * nf;\n        out[15] = 0;\n        return out;\n    }\n    /**\n     * Generates a perspective projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `out`\n     */\n    static perspectiveNO(out, fovy, aspect, near, far) {\n        const f = 1.0 / Math.tan(fovy / 2);\n        out[0] = f / aspect;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = f;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[15] = 0;\n        if (far != null && far !== Infinity) {\n            const nf = 1 / (near - far);\n            out[10] = (far + near) * nf;\n            out[14] = 2 * far * near * nf;\n        }\n        else {\n            out[10] = -1;\n            out[14] = -2 * near;\n        }\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.perspectiveNO}\n     * @category Static\n     * @deprecated Use {@link Mat4.perspectiveNO} or {@link Mat4.perspectiveZO} explicitly\n     */\n    static perspective(out, fovy, aspect, near, far) { return out; }\n    /**\n     * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * Passing null/undefined/no value for far will generate infinite projection matrix.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fovy - Vertical field of view in radians\n     * @param aspect - Aspect ratio. typically viewport width/height\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum, can be null or Infinity\n     * @returns `out`\n     */\n    static perspectiveZO(out, fovy, aspect, near, far) {\n        const f = 1.0 / Math.tan(fovy / 2);\n        out[0] = f / aspect;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = f;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[11] = -1;\n        out[12] = 0;\n        out[13] = 0;\n        out[15] = 0;\n        if (far != null && far !== Infinity) {\n            const nf = 1 / (near - far);\n            out[10] = far * nf;\n            out[14] = far * near * nf;\n        }\n        else {\n            out[10] = -1;\n            out[14] = -near;\n        }\n        return out;\n    }\n    /**\n     * Generates a perspective projection matrix with the given field of view.\n     * This is primarily useful for generating projection matrices to be used\n     * with the still experiemental WebVR API.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param fov - Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     * @deprecated\n     */\n    static perspectiveFromFieldOfView(out, fov, near, far) {\n        const upTan = Math.tan((fov.upDegrees * Math.PI) / 180.0);\n        const downTan = Math.tan((fov.downDegrees * Math.PI) / 180.0);\n        const leftTan = Math.tan((fov.leftDegrees * Math.PI) / 180.0);\n        const rightTan = Math.tan((fov.rightDegrees * Math.PI) / 180.0);\n        const xScale = 2.0 / (leftTan + rightTan);\n        const yScale = 2.0 / (upTan + downTan);\n        out[0] = xScale;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        out[3] = 0.0;\n        out[4] = 0.0;\n        out[5] = yScale;\n        out[6] = 0.0;\n        out[7] = 0.0;\n        out[8] = -((leftTan - rightTan) * xScale * 0.5);\n        out[9] = (upTan - downTan) * yScale * 0.5;\n        out[10] = far / (near - far);\n        out[11] = -1.0;\n        out[12] = 0.0;\n        out[13] = 0.0;\n        out[14] = (far * near) / (near - far);\n        out[15] = 0.0;\n        return out;\n    }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n     * which matches WebGL/OpenGL's clip volume.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     */\n    static orthoNO(out, left, right, bottom, top, near, far) {\n        const lr = 1 / (left - right);\n        const bt = 1 / (bottom - top);\n        const nf = 1 / (near - far);\n        out[0] = -2 * lr;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = -2 * bt;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = 2 * nf;\n        out[11] = 0;\n        out[12] = (left + right) * lr;\n        out[13] = (top + bottom) * bt;\n        out[14] = (far + near) * nf;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.orthoNO}\n     * @category Static\n     * @deprecated Use {@link Mat4.orthoNO} or {@link Mat4.orthoZO} explicitly\n     */\n    static ortho(out, left, right, bottom, top, near, far) { return out; }\n    /**\n     * Generates a orthogonal projection matrix with the given bounds.\n     * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n     * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param left - Left bound of the frustum\n     * @param right - Right bound of the frustum\n     * @param bottom - Bottom bound of the frustum\n     * @param top - Top bound of the frustum\n     * @param near - Near bound of the frustum\n     * @param far - Far bound of the frustum\n     * @returns `out`\n     */\n    static orthoZO(out, left, right, bottom, top, near, far) {\n        const lr = 1 / (left - right);\n        const bt = 1 / (bottom - top);\n        const nf = 1 / (near - far);\n        out[0] = -2 * lr;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 0;\n        out[4] = 0;\n        out[5] = -2 * bt;\n        out[6] = 0;\n        out[7] = 0;\n        out[8] = 0;\n        out[9] = 0;\n        out[10] = nf;\n        out[11] = 0;\n        out[12] = (left + right) * lr;\n        out[13] = (top + bottom) * bt;\n        out[14] = near * nf;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a look-at matrix with the given eye position, focal point, and up axis.\n     * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param eye - Position of the viewer\n     * @param center - Point the viewer is looking at\n     * @param up - vec3 pointing up\n     * @returns `out`\n     */\n    static lookAt(out, eye, center, up) {\n        const eyex = eye[0];\n        const eyey = eye[1];\n        const eyez = eye[2];\n        const upx = up[0];\n        const upy = up[1];\n        const upz = up[2];\n        const centerx = center[0];\n        const centery = center[1];\n        const centerz = center[2];\n        if (Math.abs(eyex - centerx) < EPSILON &&\n            Math.abs(eyey - centery) < EPSILON &&\n            Math.abs(eyez - centerz) < EPSILON) {\n            return Mat4.identity(out);\n        }\n        let z0 = eyex - centerx;\n        let z1 = eyey - centery;\n        let z2 = eyez - centerz;\n        let len = 1 / Math.sqrt(z0 * z0 + z1 * z1 + z2 * z2);\n        z0 *= len;\n        z1 *= len;\n        z2 *= len;\n        let x0 = upy * z2 - upz * z1;\n        let x1 = upz * z0 - upx * z2;\n        let x2 = upx * z1 - upy * z0;\n        len = Math.sqrt(x0 * x0 + x1 * x1 + x2 * x2);\n        if (!len) {\n            x0 = 0;\n            x1 = 0;\n            x2 = 0;\n        }\n        else {\n            len = 1 / len;\n            x0 *= len;\n            x1 *= len;\n            x2 *= len;\n        }\n        let y0 = z1 * x2 - z2 * x1;\n        let y1 = z2 * x0 - z0 * x2;\n        let y2 = z0 * x1 - z1 * x0;\n        len = Math.sqrt(y0 * y0 + y1 * y1 + y2 * y2);\n        if (!len) {\n            y0 = 0;\n            y1 = 0;\n            y2 = 0;\n        }\n        else {\n            len = 1 / len;\n            y0 *= len;\n            y1 *= len;\n            y2 *= len;\n        }\n        out[0] = x0;\n        out[1] = y0;\n        out[2] = z0;\n        out[3] = 0;\n        out[4] = x1;\n        out[5] = y1;\n        out[6] = z1;\n        out[7] = 0;\n        out[8] = x2;\n        out[9] = y2;\n        out[10] = z2;\n        out[11] = 0;\n        out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n        out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n        out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Generates a matrix that makes something look at something else.\n     * @category Static\n     *\n     * @param out - mat4 frustum matrix will be written into\n     * @param eye - Position of the viewer\n     * @param target - Point the viewer is looking at\n     * @param up - vec3 pointing up\n     * @returns `out`\n     */\n    static targetTo(out, eye, target, up) {\n        const eyex = eye[0];\n        const eyey = eye[1];\n        const eyez = eye[2];\n        const upx = up[0];\n        const upy = up[1];\n        const upz = up[2];\n        let z0 = eyex - target[0];\n        let z1 = eyey - target[1];\n        let z2 = eyez - target[2];\n        let len = z0 * z0 + z1 * z1 + z2 * z2;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            z0 *= len;\n            z1 *= len;\n            z2 *= len;\n        }\n        let x0 = upy * z2 - upz * z1;\n        let x1 = upz * z0 - upx * z2;\n        let x2 = upx * z1 - upy * z0;\n        len = x0 * x0 + x1 * x1 + x2 * x2;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n            x0 *= len;\n            x1 *= len;\n            x2 *= len;\n        }\n        out[0] = x0;\n        out[1] = x1;\n        out[2] = x2;\n        out[3] = 0;\n        out[4] = z1 * x2 - z2 * x1;\n        out[5] = z2 * x0 - z0 * x2;\n        out[6] = z0 * x1 - z1 * x0;\n        out[7] = 0;\n        out[8] = z0;\n        out[9] = z1;\n        out[10] = z2;\n        out[11] = 0;\n        out[12] = eyex;\n        out[13] = eyey;\n        out[14] = eyez;\n        out[15] = 1;\n        return out;\n    }\n    /**\n     * Returns Frobenius norm of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - the matrix to calculate Frobenius norm of\n     * @returns Frobenius norm\n     */\n    static frob(a) {\n        return Math.sqrt(a[0] * a[0] +\n            a[1] * a[1] +\n            a[2] * a[2] +\n            a[3] * a[3] +\n            a[4] * a[4] +\n            a[5] * a[5] +\n            a[6] * a[6] +\n            a[7] * a[7] +\n            a[8] * a[8] +\n            a[9] * a[9] +\n            a[10] * a[10] +\n            a[11] * a[11] +\n            a[12] * a[12] +\n            a[13] * a[13] +\n            a[14] * a[14] +\n            a[15] * a[15]);\n    }\n    /**\n     * Adds two {@link Mat4}'s\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        out[6] = a[6] + b[6];\n        out[7] = a[7] + b[7];\n        out[8] = a[8] + b[8];\n        out[9] = a[9] + b[9];\n        out[10] = a[10] + b[10];\n        out[11] = a[11] + b[11];\n        out[12] = a[12] + b[12];\n        out[13] = a[13] + b[13];\n        out[14] = a[14] + b[14];\n        out[15] = a[15] + b[15];\n        return out;\n    }\n    /**\n     * Subtracts matrix b from matrix a\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        out[4] = a[4] - b[4];\n        out[5] = a[5] - b[5];\n        out[6] = a[6] - b[6];\n        out[7] = a[7] - b[7];\n        out[8] = a[8] - b[8];\n        out[9] = a[9] - b[9];\n        out[10] = a[10] - b[10];\n        out[11] = a[11] - b[11];\n        out[12] = a[12] - b[12];\n        out[13] = a[13] - b[13];\n        out[14] = a[14] - b[14];\n        out[15] = a[15] - b[15];\n        return out;\n    }\n    /**\n     * Alias for {@link Mat4.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiply each element of the matrix by a scalar.\n     * @category Static\n     *\n     * @param out - the receiving matrix\n     * @param a - the matrix to scale\n     * @param b - amount to scale the matrix's elements by\n     * @returns `out`\n     */\n    static multiplyScalar(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        out[6] = a[6] * b;\n        out[7] = a[7] * b;\n        out[8] = a[8] * b;\n        out[9] = a[9] * b;\n        out[10] = a[10] * b;\n        out[11] = a[11] * b;\n        out[12] = a[12] * b;\n        out[13] = a[13] * b;\n        out[14] = a[14] * b;\n        out[15] = a[15] * b;\n        return out;\n    }\n    /**\n     * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b's elements by before adding\n     * @returns `out`\n     */\n    static multiplyScalarAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        out[4] = a[4] + b[4] * scale;\n        out[5] = a[5] + b[5] * scale;\n        out[6] = a[6] + b[6] * scale;\n        out[7] = a[7] + b[7] * scale;\n        out[8] = a[8] + b[8] * scale;\n        out[9] = a[9] + b[9] * scale;\n        out[10] = a[10] + b[10] * scale;\n        out[11] = a[11] + b[11] * scale;\n        out[12] = a[12] + b[12] * scale;\n        out[13] = a[13] + b[13] * scale;\n        out[14] = a[14] + b[14] * scale;\n        out[15] = a[15] + b[15] * scale;\n        return out;\n    }\n    /**\n     * Returns whether or not two {@link Mat4}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[7] === b[7] &&\n            a[8] === b[8] &&\n            a[9] === b[9] &&\n            a[10] === b[10] &&\n            a[11] === b[11] &&\n            a[12] === b[12] &&\n            a[13] === b[13] &&\n            a[14] === b[14] &&\n            a[15] === b[15]);\n    }\n    /**\n     * Returns whether or not two {@link Mat4}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first matrix.\n     * @param b - The second matrix.\n     * @returns True if the matrices are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const a6 = a[6];\n        const a7 = a[7];\n        const a8 = a[8];\n        const a9 = a[9];\n        const a10 = a[10];\n        const a11 = a[11];\n        const a12 = a[12];\n        const a13 = a[13];\n        const a14 = a[14];\n        const a15 = a[15];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        const b6 = b[6];\n        const b7 = b[7];\n        const b8 = b[8];\n        const b9 = b[9];\n        const b10 = b[10];\n        const b11 = b[11];\n        const b12 = b[12];\n        const b13 = b[13];\n        const b14 = b[14];\n        const b15 = b[15];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= EPSILON * Math.max(1, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= EPSILON * Math.max(1, Math.abs(a7), Math.abs(b7)) &&\n            Math.abs(a8 - b8) <= EPSILON * Math.max(1, Math.abs(a8), Math.abs(b8)) &&\n            Math.abs(a9 - b9) <= EPSILON * Math.max(1, Math.abs(a9), Math.abs(b9)) &&\n            Math.abs(a10 - b10) <= EPSILON * Math.max(1, Math.abs(a10), Math.abs(b10)) &&\n            Math.abs(a11 - b11) <= EPSILON * Math.max(1, Math.abs(a11), Math.abs(b11)) &&\n            Math.abs(a12 - b12) <= EPSILON * Math.max(1, Math.abs(a12), Math.abs(b12)) &&\n            Math.abs(a13 - b13) <= EPSILON * Math.max(1, Math.abs(a13), Math.abs(b13)) &&\n            Math.abs(a14 - b14) <= EPSILON * Math.max(1, Math.abs(a14), Math.abs(b14)) &&\n            Math.abs(a15 - b15) <= EPSILON * Math.max(1, Math.abs(a15), Math.abs(b15)));\n    }\n    /**\n     * Returns a string representation of a {@link Mat4}\n     * @category Static\n     *\n     * @param a - matrix to represent as a string\n     * @returns string representation of the matrix\n     */\n    static str(a) {\n        return `Mat4(${a.join(', ')})`;\n    }\n}\n// Temporary variables to prevent repeated allocations in the algorithms above.\nconst tmpVec3$1 = [0, 0, 0];\n// Instance method alias assignments\nMat4.prototype.mul = Mat4.prototype.multiply;\n// Static method alias assignments\nMat4.sub = Mat4.subtract;\nMat4.mul = Mat4.multiply;\nMat4.perspective = Mat4.perspectiveNO;\nMat4.ortho = Mat4.orthoNO;\n\n/**\n * 3 Dimensional Vector\n */\nclass Vec3 extends Float32Array {\n    /**\n    * The number of bytes in a {@link Vec3}.\n    */\n    static BYTE_LENGTH = 3 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n    * Create a {@link Vec3}.\n    */\n    constructor(...values) {\n        switch (values.length) {\n            case 3:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 3);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v]);\n                }\n                else {\n                    super(v, 0, 3);\n                }\n                break;\n            }\n            default:\n                super(3);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    /**\n     * The z component of the vector. Equivalent to `this[2];`\n     * @category Vector components\n     */\n    get z() { return this[2]; }\n    set z(value) { this[2] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The b component of the vector. Equivalent to `this[2];`\n     * @category Color components\n     */\n    get b() { return this[2]; }\n    set b(value) { this[2] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec3.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * `Float32Array` to mean the number of elements in the array.\n     */\n    get magnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * The squared magnitude (length) of `this`.\n     * Equivalent to `Vec3.squaredMagnitude(this);`\n     */\n    get squaredMagnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredMagnitude}\n     */\n    get sqrMag() { return this.squaredMagnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec3.str(this);`\n     */\n    get str() {\n        return Vec3.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec3} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    /**\n     * Adds a {@link Vec3} to `this`.\n     * Equivalent to `Vec3.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        this[2] += b[2];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec3} from `this`.\n     * Equivalent to `Vec3.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        this[2] -= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec3}.\n     * Equivalent to `Vec3.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        this[2] *= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec3}.\n     * Equivalent to `Vec3.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        this[2] /= b[2];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec3.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec3.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        this[2] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec3.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        this[2] += b[2] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec3} and `this`.\n     * Equivalent to `Vec3.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec3.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec3.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec3} and `this`.\n     * Equivalent to `Vec3.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec3.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec3.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec3.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        this[2] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec3.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        this[2] = 1.0 / this[2];\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec3}.\n     * Equivalent to `Vec3.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1] + this[2] * b[2];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec3.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec3.normalize(this, this);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, empty vec3\n     * @category Static\n     *\n     * @returns a new 3D vector\n     */\n    static create() {\n        return new Vec3();\n    }\n    /**\n     * Creates a new vec3 initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - vector to clone\n     * @returns a new 3D vector\n     */\n    static clone(a) {\n        return new Vec3(a);\n    }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec3}\n     * @category Static\n     *\n     * @param a - Vector to calculate magnitude of\n     * @returns Magnitude of a\n     */\n    static magnitude(a) {\n        let x = a[0];\n        let y = a[1];\n        let z = a[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec3.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     *\n     * @param a - vector to calculate length of\n     * @returns length of a\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec3.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec3.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Creates a new vec3 initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @returns a new 3D vector\n     */\n    static fromValues(x, y, z) {\n        return new Vec3(x, y, z);\n    }\n    /**\n     * Copy the values from one vec3 to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        return out;\n    }\n    /**\n     * Set the components of a vec3 to the given values\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @returns `out`\n     */\n    static set(out, x, y, z) {\n        out[0] = x;\n        out[1] = y;\n        out[2] = z;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec3}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return [0, 0, 0]; }\n    ;\n    /**\n     * Multiplies two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        out[2] = a[2] * b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return [0, 0, 0]; }\n    /**\n     * Divides two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        out[2] = a[2] / b[2];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec3.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return [0, 0, 0]; }\n    ;\n    /**\n     * Math.ceil the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        out[2] = Math.ceil(a[2]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        out[2] = Math.floor(a[2]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        out[2] = Math.min(a[2], b[2]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        out[2] = Math.max(a[2], b[2]);\n        return out;\n    }\n    /**\n     * symmetric round the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to round\n     * @returns `out`\n     */\n    /*static round(out: Vec3Like, a: Readonly<Vec3Like>): Vec3Like {\n      out[0] = glMatrix.round(a[0]);\n      out[1] = glMatrix.round(a[1]);\n      out[2] = glMatrix.round(a[2]);\n      return out;\n    }*/\n    /**\n     * Scales a vec3 by a scalar number\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param scale - amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, scale) {\n        out[0] = a[0] * scale;\n        out[1] = a[1] * scale;\n        out[2] = a[2] * scale;\n        return out;\n    }\n    /**\n     * Adds two vec3's after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns distance between a and b\n     */\n    static distance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        return Math.sqrt(x * x + y * y + z * z);\n    }\n    /**\n     * Alias for {@link Vec3.distance}\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns squared distance between a and b\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredDistance}\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the squared length of a vec3\n     * @category Static\n     *\n     * @param a - vector to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        return x * x + y * y + z * z;\n    }\n    /**\n     * Alias for {@link Vec3.squaredLength}\n     */\n    static sqrLen(a, b) { return 0; }\n    /**\n     * Negates the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        out[2] = 1.0 / a[2];\n        return out;\n    }\n    /**\n     * Normalize a vec3\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        let len = x * x + y * y + z * z;\n        if (len > 0) {\n            //TODO: evaluate use of glm_invsqrt here?\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        out[2] = a[2] * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two vec3's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n    }\n    /**\n     * Computes the cross product of two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static cross(out, a, b) {\n        const ax = a[0], ay = a[1], az = a[2];\n        const bx = b[0], by = b[1], bz = b[2];\n        out[0] = ay * bz - az * by;\n        out[1] = az * bx - ax * bz;\n        out[2] = ax * by - ay * bx;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        out[2] = az + t * (b[2] - az);\n        return out;\n    }\n    /**\n     * Performs a spherical linear interpolation between two vec3's\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static slerp(out, a, b, t) {\n        const angle = Math.acos(Math.min(Math.max(Vec3.dot(a, b), -1), 1));\n        const sinTotal = Math.sin(angle);\n        const ratioA = Math.sin((1 - t) * angle) / sinTotal;\n        const ratioB = Math.sin(t * angle) / sinTotal;\n        out[0] = ratioA * a[0] + ratioB * b[0];\n        out[1] = ratioA * a[1] + ratioB * b[1];\n        out[2] = ratioA * a[2] + ratioB * b[2];\n        return out;\n    }\n    /**\n     * Performs a hermite interpolation with two control points\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param c - the third operand\n     * @param d - the fourth operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static hermite(out, a, b, c, d, t) {\n        const factorTimes2 = t * t;\n        const factor1 = factorTimes2 * (2 * t - 3) + 1;\n        const factor2 = factorTimes2 * (t - 2) + t;\n        const factor3 = factorTimes2 * (t - 1);\n        const factor4 = factorTimes2 * (3 - 2 * t);\n        out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n        out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n        out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n        return out;\n    }\n    /**\n     * Performs a bezier interpolation with two control points\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param c - the third operand\n     * @param d - the fourth operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static bezier(out, a, b, c, d, t) {\n        const inverseFactor = 1 - t;\n        const inverseFactorTimesTwo = inverseFactor * inverseFactor;\n        const factorTimes2 = t * t;\n        const factor1 = inverseFactorTimesTwo * inverseFactor;\n        const factor2 = 3 * t * inverseFactorTimesTwo;\n        const factor3 = 3 * factorTimes2 * inverseFactor;\n        const factor4 = factorTimes2 * t;\n        out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n        out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n        out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n        return out;\n    }\n    /**\n     * Generates a random vector with the given scale\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param {Number} [scale] Length of the resulting vector. If omitted, a unit vector will be returned\n     * @returns `out`\n     */\n    /*static random(out: Vec3Like, scale) {\n      scale = scale === undefined ? 1.0 : scale;\n  \n      let r = glMatrix.RANDOM() * 2.0 * Math.PI;\n      let z = glMatrix.RANDOM() * 2.0 - 1.0;\n      let zScale = Math.sqrt(1.0 - z * z) * scale;\n  \n      out[0] = Math.cos(r) * zScale;\n      out[1] = Math.sin(r) * zScale;\n      out[2] = z * scale;\n      return out;\n    }*/\n    /**\n     * Transforms the vec3 with a mat4.\n     * 4th vector component is implicitly '1'\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0], y = a[1], z = a[2];\n        const w = (m[3] * x + m[7] * y + m[11] * z + m[15]) || 1.0;\n        out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n        out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n        out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n        return out;\n    }\n    /**\n     * Transforms the vec3 with a mat3.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - the 3x3 matrix to transform with\n     * @returns `out`\n     */\n    static transformMat3(out, a, m) {\n        let x = a[0], y = a[1], z = a[2];\n        out[0] = x * m[0] + y * m[3] + z * m[6];\n        out[1] = x * m[1] + y * m[4] + z * m[7];\n        out[2] = x * m[2] + y * m[5] + z * m[8];\n        return out;\n    }\n    /**\n     * Transforms the vec3 with a quat\n     * Can also be used for dual quaternions. (Multiply it with the real part)\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param q - quaternion to transform with\n     * @returns `out`\n     */\n    static transformQuat(out, a, q) {\n        // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const w2 = q[3] * 2;\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        // var qvec = [qx, qy, qz];\n        // var uv = vec3.cross([], qvec, a);\n        const uvx = (qy * z - qz * y);\n        const uvy = (qz * x - qx * z);\n        const uvz = (qx * y - qy * x);\n        // var uuv = vec3.cross([], qvec, uv);\n        // vec3.scale(uuv, uuv, 2);\n        const uuvx = (qy * uvz - qz * uvy) * 2;\n        const uuvy = (qz * uvx - qx * uvz) * 2;\n        const uuvz = (qx * uvy - qy * uvx) * 2;\n        // vec3.scale(uv, uv, 2 * w);\n        // return vec3.add(out, a, vec3.add(out, uv, uuv));\n        out[0] = x + (uvx * w2) + uuvx;\n        out[1] = y + (uvy * w2) + uuvy;\n        out[2] = z + (uvz * w2) + uuvz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the x-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateX(out, a, b, rad) {\n        const by = b[1];\n        const bz = b[2];\n        //Translate point to the origin\n        const py = a[1] - by;\n        const pz = a[2] - bz;\n        //perform rotation\n        //translate to correct position\n        out[0] = a[0];\n        out[1] = (py * Math.cos(rad) - pz * Math.sin(rad)) + by;\n        out[2] = (py * Math.sin(rad) + pz * Math.cos(rad)) + bz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the y-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateY(out, a, b, rad) {\n        const bx = b[0];\n        const bz = b[2];\n        //Translate point to the origin\n        const px = a[0] - bx;\n        const pz = a[2] - bz;\n        //perform rotation\n        //translate to correct position\n        out[0] = (pz * Math.sin(rad) + px * Math.cos(rad)) + bx;\n        out[1] = a[1];\n        out[2] = (pz * Math.cos(rad) - px * Math.sin(rad)) + bz;\n        return out;\n    }\n    /**\n     * Rotate a 3D vector around the z-axis\n     * @param out - The receiving vec3\n     * @param a - The vec3 point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotateZ(out, a, b, rad) {\n        const bx = b[0];\n        const by = b[1];\n        //Translate point to the origin\n        const px = a[0] - bx;\n        const py = a[1] - by;\n        //perform rotation\n        //translate to correct position\n        out[0] = (px * Math.cos(rad) - py * Math.sin(rad)) + bx;\n        out[1] = (px * Math.sin(rad) + py * Math.cos(rad)) + by;\n        out[2] = b[2];\n        return out;\n    }\n    /**\n     * Get the angle between two 3D vectors\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns The angle in radians\n     */\n    static angle(a, b) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const bx = b[0];\n        const by = b[1];\n        const bz = b[2];\n        const mag = Math.sqrt((ax * ax + ay * ay + az * az) * (bx * bx + by * by + bz * bz));\n        const cosine = mag && Vec3.dot(a, b) / mag;\n        return Math.acos(Math.min(Math.max(cosine, -1), 1));\n    }\n    /**\n     * Set the components of a vec3 to zero\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        return out;\n    }\n    /**\n     * Returns a string representation of a vector\n     * @category Static\n     *\n     * @param a - vector to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Vec3(${a.join(', ')})`;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)));\n    }\n}\n// Instance method alias assignments\nVec3.prototype.sub = Vec3.prototype.subtract;\nVec3.prototype.mul = Vec3.prototype.multiply;\nVec3.prototype.div = Vec3.prototype.divide;\nVec3.prototype.dist = Vec3.prototype.distance;\nVec3.prototype.sqrDist = Vec3.prototype.squaredDistance;\n// Static method alias assignments\nVec3.sub = Vec3.subtract;\nVec3.mul = Vec3.multiply;\nVec3.div = Vec3.divide;\nVec3.dist = Vec3.distance;\nVec3.sqrDist = Vec3.squaredDistance;\nVec3.sqrLen = Vec3.squaredLength;\nVec3.mag = Vec3.magnitude;\nVec3.length = Vec3.magnitude;\nVec3.len = Vec3.magnitude;\n\n/**\n * 4 Dimensional Vector\n */\nclass Vec4 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Vec4}.\n     */\n    static BYTE_LENGTH = 4 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Vec4}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 4:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 4);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v, v]);\n                }\n                else {\n                    super(v, 0, 4);\n                }\n                break;\n            }\n            default:\n                super(4);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    /**\n     * The z component of the vector. Equivalent to `this[2];`\n     * @category Vector components\n     */\n    get z() { return this[2]; }\n    set z(value) { this[2] = value; }\n    /**\n     * The w component of the vector. Equivalent to `this[3];`\n     * @category Vector components\n     */\n    get w() { return this[3]; }\n    set w(value) { this[3] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The b component of the vector. Equivalent to `this[2];`\n     * @category Color components\n     */\n    get b() { return this[2]; }\n    set b(value) { this[2] = value; }\n    /**\n     * The a component of the vector. Equivalent to `this[3];`\n     * @category Color components\n     */\n    get a() { return this[3]; }\n    set a(value) { this[3] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec4.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * `Float32Array` to mean the number of elements in the array.\n     */\n    get magnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        const w = this[3];\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec4.str(this);`\n     */\n    get str() {\n        return Vec4.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec4} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        super.set(a);\n        return this;\n    }\n    /**\n     * Adds a {@link Vec4} to `this`.\n     * Equivalent to `Vec4.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        this[2] += b[2];\n        this[3] += b[3];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec4} from `this`.\n     * Equivalent to `Vec4.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        this[2] -= b[2];\n        this[3] -= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec4}.\n     * Equivalent to `Vec4.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        this[2] *= b[2];\n        this[3] *= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec4}.\n     * Equivalent to `Vec4.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        this[2] /= b[2];\n        this[3] /= b[3];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec4.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec4.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        this[2] *= b;\n        this[3] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec4.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        this[2] += b[2] * scale;\n        this[3] += b[3] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec4} and `this`.\n     * Equivalent to `Vec4.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec4.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec4.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec4} and `this`.\n     * Equivalent to `Vec4.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec4.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec4.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec4.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        this[2] *= -1;\n        this[3] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec4.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        this[2] = 1.0 / this[2];\n        this[3] = 1.0 / this[3];\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec4}.\n     * Equivalent to `Vec4.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1] + this[2] * b[2] + this[3] * b[3];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec4.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec4.normalize(this, this);\n    }\n    //===================\n    // Static methods\n    //===================\n    /**\n     * Creates a new, empty {@link Vec4}\n     * @category Static\n     *\n     * @returns a new 4D vector\n     */\n    static create() {\n        return new Vec4();\n    }\n    /**\n     * Creates a new {@link Vec4} initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - vector to clone\n     * @returns a new 4D vector\n     */\n    static clone(a) {\n        return new Vec4(a);\n    }\n    /**\n     * Creates a new {@link Vec4} initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns a new 4D vector\n     */\n    static fromValues(x, y, z, w) {\n        return new Vec4(x, y, z, w);\n    }\n    /**\n     * Copy the values from one {@link Vec4} to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec4} to the given values\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns `out`\n     */\n    static set(out, x, y, z, w) {\n        out[0] = x;\n        out[1] = y;\n        out[2] = z;\n        out[3] = w;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec4}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        out[2] = a[2] - b[2];\n        out[3] = a[3] - b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return out; }\n    /**\n     * Multiplies two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        out[2] = a[2] * b[2];\n        out[3] = a[3] * b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Divides two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        out[2] = a[2] / b[2];\n        out[3] = a[3] / b[3];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec4.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return out; }\n    /**\n     * Math.ceil the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        out[2] = Math.ceil(a[2]);\n        out[3] = Math.ceil(a[3]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        out[2] = Math.floor(a[2]);\n        out[3] = Math.floor(a[3]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        out[2] = Math.min(a[2], b[2]);\n        out[3] = Math.min(a[3], b[3]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        out[2] = Math.max(a[2], b[2]);\n        out[3] = Math.max(a[3], b[3]);\n        return out;\n    }\n    /**\n     * Math.round the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to round\n     * @returns `out`\n     */\n    static round(out, a) {\n        out[0] = Math.round(a[0]);\n        out[1] = Math.round(a[1]);\n        out[2] = Math.round(a[2]);\n        out[3] = Math.round(a[3]);\n        return out;\n    }\n    /**\n     * Scales a {@link Vec4} by a scalar number\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param scale - amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, scale) {\n        out[0] = a[0] * scale;\n        out[1] = a[1] * scale;\n        out[2] = a[2] * scale;\n        out[3] = a[3] * scale;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec4}'s after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param scale - the amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        out[2] = a[2] + b[2] * scale;\n        out[3] = a[3] + b[3] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns distance between a and b\n     */\n    static distance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        const w = b[3] - a[3];\n        return Math.hypot(x, y, z, w);\n    }\n    /**\n     * Alias for {@link Vec4.distance}\n     * @category Static\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns squared distance between a and b\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        const z = b[2] - a[2];\n        const w = b[3] - a[3];\n        return x * x + y * y + z * z + w * w;\n    }\n    /**\n     * Alias for {@link Vec4.squaredDistance}\n     * @category Static\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to calculate length of\n     * @returns length of `a`\n     */\n    static magnitude(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec4.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec4.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec4.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        return x * x + y * y + z * z + w * w;\n    }\n    /**\n     * Alias for {@link Vec4.squaredLength}\n     * @category Static\n     */\n    static sqrLen(a) { return 0; }\n    /**\n     * Negates the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = -a[3];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        out[2] = 1.0 / a[2];\n        out[3] = 1.0 / a[3];\n        return out;\n    }\n    /**\n     * Normalize a {@link Vec4}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        let len = x * x + y * y + z * z + w * w;\n        if (len > 0) {\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = x * len;\n        out[1] = y * len;\n        out[2] = z * len;\n        out[3] = w * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two {@link Vec4}'s\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n    }\n    /**\n     * Returns the cross-product of three vectors in a 4-dimensional space\n     * @category Static\n     *\n     * @param out the receiving vector\n     * @param u - the first vector\n     * @param v - the second vector\n     * @param w - the third vector\n     * @returns result\n     */\n    static cross(out, u, v, w) {\n        const a = v[0] * w[1] - v[1] * w[0];\n        const b = v[0] * w[2] - v[2] * w[0];\n        const c = v[0] * w[3] - v[3] * w[0];\n        const d = v[1] * w[2] - v[2] * w[1];\n        const e = v[1] * w[3] - v[3] * w[1];\n        const f = v[2] * w[3] - v[3] * w[2];\n        const g = u[0];\n        const h = u[1];\n        const i = u[2];\n        const j = u[3];\n        out[0] = h * f - i * e + j * d;\n        out[1] = -(g * f) + i * c - j * b;\n        out[2] = g * e - h * c + j * a;\n        out[3] = -(g * d) + h * b - i * a;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two {@link Vec4}'s\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        out[2] = az + t * (b[2] - az);\n        out[3] = aw + t * (b[3] - aw);\n        return out;\n    }\n    /**\n     * Generates a random vector with the given scale\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param [scale] - Length of the resulting vector. If ommitted, a unit vector will be returned\n     * @returns `out`\n     */\n    /*static random(out: Vec4Like, scale): Vec4Like {\n      scale = scale || 1.0;\n  \n      // Marsaglia, George. Choosing a Point from the Surface of a\n      // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n      // http://projecteuclid.org/euclid.aoms/1177692644;\n      var v1, v2, v3, v4;\n      var s1, s2;\n      do {\n        v1 = glMatrix.RANDOM() * 2 - 1;\n        v2 = glMatrix.RANDOM() * 2 - 1;\n        s1 = v1 * v1 + v2 * v2;\n      } while (s1 >= 1);\n      do {\n        v3 = glMatrix.RANDOM() * 2 - 1;\n        v4 = glMatrix.RANDOM() * 2 - 1;\n        s2 = v3 * v3 + v4 * v4;\n      } while (s2 >= 1);\n  \n      var d = Math.sqrt((1 - s1) / s2);\n      out[0] = scale * v1;\n      out[1] = scale * v2;\n      out[2] = scale * v3 * d;\n      out[3] = scale * v4 * d;\n      return out;\n    }*/\n    /**\n     * Transforms the {@link Vec4} with a {@link Mat4}.\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param m - matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const w = a[3];\n        out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n        out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n        out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n        out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec4} with a {@link Quat}\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to transform\n     * @param q - quaternion to transform with\n     * @returns `out`\n     */\n    static transformQuat(out, a, q) {\n        const x = a[0];\n        const y = a[1];\n        const z = a[2];\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        // calculate quat * vec\n        const ix = qw * x + qy * z - qz * y;\n        const iy = qw * y + qz * x - qx * z;\n        const iz = qw * z + qx * y - qy * x;\n        const iw = -qx * x - qy * y - qz * z;\n        // calculate result * inverse quat\n        out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n        out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n        out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec4} to zero\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        out[2] = 0.0;\n        out[3] = 0.0;\n        return out;\n    }\n    /**\n     * Returns a string representation of a {@link Vec4}\n     * @category Static\n     *\n     * @param a - vector to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Vec4(${a.join(', ')})`;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)));\n    }\n}\n// Instance method alias assignments\nVec4.prototype.sub = Vec4.prototype.subtract;\nVec4.prototype.mul = Vec4.prototype.multiply;\nVec4.prototype.div = Vec4.prototype.divide;\nVec4.prototype.dist = Vec4.prototype.distance;\nVec4.prototype.sqrDist = Vec4.prototype.squaredDistance;\n// Static method alias assignments\nVec4.sub = Vec4.subtract;\nVec4.mul = Vec4.multiply;\nVec4.div = Vec4.divide;\nVec4.dist = Vec4.distance;\nVec4.sqrDist = Vec4.squaredDistance;\nVec4.sqrLen = Vec4.squaredLength;\nVec4.mag = Vec4.magnitude;\nVec4.length = Vec4.magnitude;\nVec4.len = Vec4.magnitude;\n\n/**\n * Quaternion\n */\nclass Quat extends Float32Array {\n    /**\n     * The number of bytes in a {@link Quat}.\n     */\n    static BYTE_LENGTH = 4 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Quat}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 4:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 4);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v, v]);\n                }\n                else {\n                    super(v, 0, 4);\n                }\n                break;\n            }\n            default:\n                super(4);\n                this[3] = 1;\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the quaternion. Equivalent to `this[0];`\n     * @category Quaternion components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the quaternion. Equivalent to `this[1];`\n     * @category Quaternion components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    /**\n     * The z component of the quaternion. Equivalent to `this[2];`\n     * @category Quaternion components\n     */\n    get z() { return this[2]; }\n    set z(value) { this[2] = value; }\n    /**\n     * The w component of the quaternion. Equivalent to `this[3];`\n     * @category Quaternion components\n     */\n    get w() { return this[3]; }\n    set w(value) { this[3] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Quat.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * `Float32Array` to mean the number of elements in the array.\n     */\n    get magnitude() {\n        const x = this[0];\n        const y = this[1];\n        const z = this[2];\n        const w = this[3];\n        return Math.sqrt(x * x + y * y + z * z + w * w);\n    }\n    /**\n     * Alias for {@link Quat.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Quat.str(this);`\n     */\n    get str() {\n        return Quat.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Quat} into `this`.\n     *\n     * @param a the source quaternion\n     * @returns `this`\n     */\n    copy(a) {\n        super.set(a);\n        return this;\n    }\n    /**\n     * Set `this` to the identity quaternion\n     * Equivalent to Quat.identity(this)\n     *\n     * @returns `this`\n     */\n    identity() {\n        this[0] = 0;\n        this[1] = 0;\n        this[2] = 0;\n        this[3] = 1;\n        return this;\n    }\n    /**\n     * Multiplies `this` by a {@link Quat}.\n     * Equivalent to `Quat.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        return Quat.multiply(this, this, b);\n    }\n    /**\n     * Alias for {@link Quat.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Rotates `this` by the given angle about the X axis\n     * Equivalent to `Quat.rotateX(this, this, rad);`\n     *\n     * @param rad - angle (in radians) to rotate\n     * @returns `this`\n     */\n    rotateX(rad) {\n        return Quat.rotateX(this, this, rad);\n    }\n    /**\n     * Rotates `this` by the given angle about the Y axis\n     * Equivalent to `Quat.rotateY(this, this, rad);`\n     *\n     * @param rad - angle (in radians) to rotate\n     * @returns `this`\n     */\n    rotateY(rad) {\n        return Quat.rotateY(this, this, rad);\n    }\n    /**\n     * Rotates `this` by the given angle about the Z axis\n     * Equivalent to `Quat.rotateZ(this, this, rad);`\n     *\n     * @param rad - angle (in radians) to rotate\n     * @returns `this`\n     */\n    rotateZ(rad) {\n        return Quat.rotateZ(this, this, rad);\n    }\n    /**\n     * Inverts `this`\n     * Equivalent to `Quat.invert(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        return Quat.invert(this, this);\n    }\n    /**\n     * Scales `this` by a scalar number\n     * Equivalent to `Quat.scale(this, this, scale);`\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param scale - amount to scale the vector by\n     * @returns `this`\n     */\n    scale(scale) {\n        this[0] *= scale;\n        this[1] *= scale;\n        this[2] *= scale;\n        this[3] *= scale;\n        return this;\n    }\n    /**\n     * Calculates the dot product of `this` and another {@link Quat}\n     * Equivalent to `Quat.dot(this, b);`\n     *\n     * @param b - the second operand\n     * @returns dot product of `this` and b\n     */\n    dot(b) {\n        return Quat.dot(this, b);\n    }\n    //===================\n    // Static methods\n    //===================\n    /**\n     * Creates a new identity quat\n     * @category Static\n     *\n     * @returns a new quaternion\n     */\n    static create() {\n        return new Quat();\n    }\n    /**\n     * Set a quat to the identity quaternion\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 0;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        return out;\n    }\n    /**\n     * Sets a quat from the given angle and rotation axis,\n     * then returns it.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param axis - the axis around which to rotate\n     * @param rad - the angle in radians\n     * @returns `out`\n     **/\n    static setAxisAngle(out, axis, rad) {\n        rad = rad * 0.5;\n        const s = Math.sin(rad);\n        out[0] = s * axis[0];\n        out[1] = s * axis[1];\n        out[2] = s * axis[2];\n        out[3] = Math.cos(rad);\n        return out;\n    }\n    /**\n     * Gets the rotation axis and angle for a given\n     *  quaternion. If a quaternion is created with\n     *  setAxisAngle, this method will return the same\n     *  values as providied in the original parameter list\n     *  OR functionally equivalent values.\n     * Example: The quaternion formed by axis [0, 0, 1] and\n     *  angle -90 is the same as the quaternion formed by\n     *  [0, 0, 1] and 270. This method favors the latter.\n     * @category Static\n     *\n     * @param out_axis - Vector receiving the axis of rotation\n     * @param q - Quaternion to be decomposed\n     * @return Angle, in radians, of the rotation\n     */\n    static getAxisAngle(out_axis, q) {\n        const rad = Math.acos(q[3]) * 2.0;\n        const s = Math.sin(rad / 2.0);\n        if (s > EPSILON) {\n            out_axis[0] = q[0] / s;\n            out_axis[1] = q[1] / s;\n            out_axis[2] = q[2] / s;\n        }\n        else {\n            // If s is zero, return any axis (no rotation - axis does not matter)\n            out_axis[0] = 1;\n            out_axis[1] = 0;\n            out_axis[2] = 0;\n        }\n        return rad;\n    }\n    /**\n     * Gets the angular distance between two unit quaternions\n     * @category Static\n     *\n     * @param  {ReadonlyQuat} a     Origin unit quaternion\n     * @param  {ReadonlyQuat} b     Destination unit quaternion\n     * @return {Number}     Angle, in radians, between the two quaternions\n     */\n    static getAngle(a, b) {\n        const dotproduct = Quat.dot(a, b);\n        return Math.acos(2 * dotproduct * dotproduct - 1);\n    }\n    /**\n     * Multiplies two quat's\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const bx = b[0];\n        const by = b[1];\n        const bz = b[2];\n        const bw = b[3];\n        out[0] = ax * bw + aw * bx + ay * bz - az * by;\n        out[1] = ay * bw + aw * by + az * bx - ax * bz;\n        out[2] = az * bw + aw * bz + ax * by - ay * bx;\n        out[3] = aw * bw - ax * bx - ay * by - az * bz;\n        return out;\n    }\n    /**\n     * Rotates a quaternion by the given angle about the X axis\n     * @category Static\n     *\n     * @param out - quat receiving operation result\n     * @param a - quat to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateX(out, a, rad) {\n        rad *= 0.5;\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const bx = Math.sin(rad);\n        const bw = Math.cos(rad);\n        out[0] = ax * bw + aw * bx;\n        out[1] = ay * bw + az * bx;\n        out[2] = az * bw - ay * bx;\n        out[3] = aw * bw - ax * bx;\n        return out;\n    }\n    /**\n     * Rotates a quaternion by the given angle about the Y axis\n     * @category Static\n     *\n     * @param out - quat receiving operation result\n     * @param a - quat to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateY(out, a, rad) {\n        rad *= 0.5;\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const by = Math.sin(rad);\n        const bw = Math.cos(rad);\n        out[0] = ax * bw - az * by;\n        out[1] = ay * bw + aw * by;\n        out[2] = az * bw + ax * by;\n        out[3] = aw * bw - ay * by;\n        return out;\n    }\n    /**\n     * Rotates a quaternion by the given angle about the Z axis\n     * @category Static\n     *\n     * @param out - quat receiving operation result\n     * @param a - quat to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateZ(out, a, rad) {\n        rad *= 0.5;\n        const ax = a[0];\n        const ay = a[1];\n        const az = a[2];\n        const aw = a[3];\n        const bz = Math.sin(rad);\n        const bw = Math.cos(rad);\n        out[0] = ax * bw + ay * bz;\n        out[1] = ay * bw - ax * bz;\n        out[2] = az * bw + aw * bz;\n        out[3] = aw * bw - az * bz;\n        return out;\n    }\n    /**\n     * Calculates the W component of a quat from the X, Y, and Z components.\n     * Assumes that quaternion is 1 unit in length.\n     * Any existing W component will be ignored.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate W component of\n     * @returns `out`\n     */\n    static calculateW(out, a) {\n        const x = a[0], y = a[1], z = a[2];\n        out[0] = x;\n        out[1] = y;\n        out[2] = z;\n        out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n        return out;\n    }\n    /**\n     * Calculate the exponential of a unit quaternion.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate the exponential of\n     * @returns `out`\n     */\n    static exp(out, a) {\n        const x = a[0], y = a[1], z = a[2], w = a[3];\n        const r = Math.sqrt(x * x + y * y + z * z);\n        const et = Math.exp(w);\n        const s = r > 0 ? (et * Math.sin(r)) / r : 0;\n        out[0] = x * s;\n        out[1] = y * s;\n        out[2] = z * s;\n        out[3] = et * Math.cos(r);\n        return out;\n    }\n    /**\n     * Calculate the natural logarithm of a unit quaternion.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate the exponential of\n     * @returns `out`\n     */\n    static ln(out, a) {\n        const x = a[0], y = a[1], z = a[2], w = a[3];\n        const r = Math.sqrt(x * x + y * y + z * z);\n        const t = r > 0 ? Math.atan2(r, w) / r : 0;\n        out[0] = x * t;\n        out[1] = y * t;\n        out[2] = z * t;\n        out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n        return out;\n    }\n    /**\n     * Calculate the scalar power of a unit quaternion.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate the exponential of\n     * @param b - amount to scale the quaternion by\n     * @returns `out`\n     */\n    static pow(out, a, b) {\n        Quat.ln(out, a);\n        Quat.scale(out, out, b);\n        Quat.exp(out, out);\n        return out;\n    }\n    /**\n     * Performs a spherical linear interpolation between two quat\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static slerp(out, a, b, t) {\n        // benchmarks:\n        //    http://jsperf.com/quaternion-slerp-implementations\n        const ax = a[0], ay = a[1], az = a[2], aw = a[3];\n        let bx = b[0], by = b[1], bz = b[2], bw = b[3];\n        let scale0;\n        let scale1;\n        // calc cosine\n        let cosom = ax * bx + ay * by + az * bz + aw * bw;\n        // adjust signs (if necessary)\n        if (cosom < 0.0) {\n            cosom = -cosom;\n            bx = -bx;\n            by = -by;\n            bz = -bz;\n            bw = -bw;\n        }\n        // calculate coefficients\n        if (1.0 - cosom > EPSILON) {\n            // standard case (slerp)\n            const omega = Math.acos(cosom);\n            const sinom = Math.sin(omega);\n            scale0 = Math.sin((1.0 - t) * omega) / sinom;\n            scale1 = Math.sin(t * omega) / sinom;\n        }\n        else {\n            // \"from\" and \"to\" quaternions are very close\n            //  ... so we can do a linear interpolation\n            scale0 = 1.0 - t;\n            scale1 = t;\n        }\n        // calculate final values\n        out[0] = scale0 * ax + scale1 * bx;\n        out[1] = scale0 * ay + scale1 * by;\n        out[2] = scale0 * az + scale1 * bz;\n        out[3] = scale0 * aw + scale1 * bw;\n        return out;\n    }\n    /**\n     * Generates a random unit quaternion\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @returns `out`\n     */\n    /*static random(out: QuatLike): QuatLike {\n      // Implementation of http://planning.cs.uiuc.edu/node198.html\n      // TODO: Calling random 3 times is probably not the fastest solution\n      let u1 = glMatrix.RANDOM();\n      let u2 = glMatrix.RANDOM();\n      let u3 = glMatrix.RANDOM();\n  \n      let sqrt1MinusU1 = Math.sqrt(1 - u1);\n      let sqrtU1 = Math.sqrt(u1);\n  \n      out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n      out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n      out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n      out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n      return out;\n    }*/\n    /**\n     * Calculates the inverse of a quat\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate inverse of\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\n        const dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n        const invDot = dot ? 1.0 / dot : 0;\n        // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n        out[0] = -a0 * invDot;\n        out[1] = -a1 * invDot;\n        out[2] = -a2 * invDot;\n        out[3] = a3 * invDot;\n        return out;\n    }\n    /**\n     * Calculates the conjugate of a quat\n     * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quat to calculate conjugate of\n     * @returns `out`\n     */\n    static conjugate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Creates a quaternion from the given 3x3 rotation matrix.\n     *\n     * NOTE: The resultant quaternion is not normalized, so you should be sure\n     * to renormalize the quaternion yourself where necessary.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param m - rotation matrix\n     * @returns `out`\n     */\n    static fromMat3(out, m) {\n        // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n        // article \"Quaternion Calculus and Fast Animation\".\n        const fTrace = m[0] + m[4] + m[8];\n        let fRoot;\n        if (fTrace > 0.0) {\n            // |w| > 1/2, may as well choose w > 1/2\n            fRoot = Math.sqrt(fTrace + 1.0); // 2w\n            out[3] = 0.5 * fRoot;\n            fRoot = 0.5 / fRoot; // 1/(4w)\n            out[0] = (m[5] - m[7]) * fRoot;\n            out[1] = (m[6] - m[2]) * fRoot;\n            out[2] = (m[1] - m[3]) * fRoot;\n        }\n        else {\n            // |w| <= 1/2\n            let i = 0;\n            if (m[4] > m[0])\n                i = 1;\n            if (m[8] > m[i * 3 + i])\n                i = 2;\n            let j = (i + 1) % 3;\n            let k = (i + 2) % 3;\n            fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n            out[i] = 0.5 * fRoot;\n            fRoot = 0.5 / fRoot;\n            out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n            out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n            out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n        }\n        return out;\n    }\n    /**\n     * Creates a quaternion from the given euler angle x, y, z.\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param x - Angle to rotate around X axis in degrees.\n     * @param y - Angle to rotate around Y axis in degrees.\n     * @param z - Angle to rotate around Z axis in degrees.\n     * @returns `out`\n     */\n    static fromEuler(out, x, y, z) {\n        let halfToRad = (0.5 * Math.PI) / 180.0;\n        x *= halfToRad;\n        y *= halfToRad;\n        z *= halfToRad;\n        let sx = Math.sin(x);\n        let cx = Math.cos(x);\n        let sy = Math.sin(y);\n        let cy = Math.cos(y);\n        let sz = Math.sin(z);\n        let cz = Math.cos(z);\n        out[0] = sx * cy * cz - cx * sy * sz;\n        out[1] = cx * sy * cz + sx * cy * sz;\n        out[2] = cx * cy * sz - sx * sy * cz;\n        out[3] = cx * cy * cz + sx * sy * sz;\n        return out;\n    }\n    /**\n     * Returns a string representation of a quatenion\n     * @category Static\n     *\n     * @param a - vector to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Quat(${a.join(', ')})`;\n    }\n    /**\n     * Creates a new quat initialized with values from an existing quaternion\n     * @category Static\n     *\n     * @param a - quaternion to clone\n     * @returns a new quaternion\n     */\n    static clone(a) {\n        return new Quat(a);\n    }\n    /**\n     * Creates a new quat initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns a new quaternion\n     */\n    static fromValues(x, y, z, w) {\n        return new Quat(x, y, z, w);\n    }\n    /**\n     * Copy the values from one quat to another\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the source quaternion\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Quat} to the given values\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param x - X component\n     * @param y - Y component\n     * @param z - Z component\n     * @param w - W component\n     * @returns `out`\n     */\n    static set(out, x, y, z, w) { return out; }\n    /**\n     * Adds two {@link Quat}'s\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) { return out; }\n    /**\n     * Alias for {@link Quat.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Scales a quat by a scalar number\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - the vector to scale\n     * @param b - amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, scale) {\n        out[0] = a[0] * scale;\n        out[1] = a[1] * scale;\n        out[2] = a[2] * scale;\n        out[3] = a[3] * scale;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two quat's\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n    }\n    /**\n     * Performs a linear interpolation between two quat's\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) { return out; }\n    /**\n     * Calculates the magnitude (length) of a {@link Quat}\n     * @category Static\n     *\n     * @param a - quaternion to calculate length of\n     * @returns length of `a`\n     */\n    static magnitude(a) { return 0; }\n    /**\n     * Alias for {@link Quat.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Quat.magnitude}\n     * @category Static\n     * @deprecated Use {@link Quat.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Quat.magnitude}\n     * @category Static\n     * @deprecated Use {@link Quat.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Quat}\n     * @category Static\n     *\n     * @param a - quaternion to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) { return 0; }\n    /**\n     * Alias for {@link Quat.squaredLength}\n     * @category Static\n     */\n    static sqrLen(a) { return 0; }\n    /**\n     * Normalize a {@link Quat}\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - quaternion to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) { return out; }\n    /**\n     * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first quaternion.\n     * @param b - The second quaternion.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static exactEquals(a, b) { return false; }\n    /**\n     * Returns whether or not the quaternions have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns True if the vectors are equal, false otherwise.\n     */\n    static equals(a, b) { return false; }\n    /**\n     * Sets a quaternion to represent the shortest rotation from one\n     * vector to another.\n     *\n     * Both vectors are assumed to be unit length.\n     * @category Static\n     *\n     * @param out - the receiving quaternion.\n     * @param a - the initial vector\n     * @param b - the destination vector\n     * @returns `out`\n     */\n    static rotationTo(out, a, b) {\n        let dot = Vec3.dot(a, b);\n        if (dot < -0.999999) {\n            Vec3.cross(tmpVec3, xUnitVec3, a);\n            if (Vec3.len(tmpVec3) < 0.000001)\n                Vec3.cross(tmpVec3, yUnitVec3, a);\n            Vec3.normalize(tmpVec3, tmpVec3);\n            Quat.setAxisAngle(out, tmpVec3, Math.PI);\n            return out;\n        }\n        else if (dot > 0.999999) {\n            out[0] = 0;\n            out[1] = 0;\n            out[2] = 0;\n            out[3] = 1;\n            return out;\n        }\n        else {\n            Vec3.cross(tmpVec3, a, b);\n            out[0] = tmpVec3[0];\n            out[1] = tmpVec3[1];\n            out[2] = tmpVec3[2];\n            out[3] = 1 + dot;\n            return Quat.normalize(out, out);\n        }\n    }\n    /**\n     * Performs a spherical linear interpolation with two control points\n     * @category Static\n     *\n     * @param out - the receiving quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param c - the third operand\n     * @param d - the fourth operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static sqlerp(out, a, b, c, d, t) {\n        Quat.slerp(temp1, a, d, t);\n        Quat.slerp(temp2, b, c, t);\n        Quat.slerp(out, temp1, temp2, 2 * t * (1 - t));\n        return out;\n    }\n    /**\n     * Sets the specified quaternion with values corresponding to the given\n     * axes. Each axis is a vec3 and is expected to be unit length and\n     * perpendicular to all other specified axes.\n     * @category Static\n     *\n     * @param out - The receiving quaternion\n     * @param view - the vector representing the viewing direction\n     * @param right - the vector representing the local \"right\" direction\n     * @param up - the vector representing the local \"up\" direction\n     * @returns `out`\n     */\n    static setAxes(out, view, right, up) {\n        tempMat3[0] = right[0];\n        tempMat3[3] = right[1];\n        tempMat3[6] = right[2];\n        tempMat3[1] = up[0];\n        tempMat3[4] = up[1];\n        tempMat3[7] = up[2];\n        tempMat3[2] = -view[0];\n        tempMat3[5] = -view[1];\n        tempMat3[8] = -view[2];\n        return Quat.normalize(out, Quat.fromMat3(out, tempMat3));\n    }\n}\n// Temporary variables to prevent repeated allocations in the algorithms above.\nconst temp1 = [0, 0, 0, 0];\nconst temp2 = [0, 0, 0, 0];\nconst tempMat3 = [0, 0, 0, 0, 0, 0, 0, 0, 0];\nconst tmpVec3 = [0, 0, 0];\nconst xUnitVec3 = [1, 0, 0];\nconst yUnitVec3 = [0, 1, 0];\n// Methods which re-use the Vec4 implementation\nQuat.set = Vec4.set;\nQuat.add = Vec4.add;\nQuat.lerp = Vec4.lerp;\nQuat.normalize = Vec4.normalize;\nQuat.squaredLength = Vec4.squaredLength;\nQuat.sqrLen = Vec4.squaredLength;\nQuat.exactEquals = Vec4.exactEquals;\nQuat.equals = Vec4.equals;\nQuat.magnitude = Vec4.magnitude;\n// Instance method alias assignments\nQuat.prototype.mul = Quat.prototype.multiply;\n// Static method alias assignments\nQuat.mul = Quat.multiply;\nQuat.mag = Quat.magnitude;\nQuat.length = Quat.magnitude;\nQuat.len = Quat.magnitude;\n\n/**\n * Dual Quaternion\n */\nclass Quat2 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Quat}.\n     */\n    static BYTE_LENGTH = 8 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Quat2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 8:\n                super(values);\n                break;\n            case 2:\n                super(values[0], values[1], 8);\n                break;\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v, v, v, v, v, v, v]);\n                }\n                else {\n                    super(v, 0, 8);\n                }\n                break;\n            }\n            default:\n                super(8);\n                this[3] = 1;\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    /**\n     * A string representation of `this`\n     * Equivalent to `Quat2.str(this);`\n     */\n    get str() {\n        return Quat2.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Quat2} into `this`.\n     *\n     * @param a the source dual quaternion\n     * @returns `this`\n     */\n    copy(a) {\n        super.set(a);\n        return this;\n    }\n    //===================\n    // Static methods\n    //===================\n    /**\n     * Creates a new identity {@link Quat2}\n     * @category Static\n     *\n     * @returns a new dual quaternion [real -> rotation, dual -> translation]\n     */\n    static create() {\n        return new Quat2();\n    }\n    /**\n     * Creates a {@link Quat2} quat initialized with values from an existing quaternion\n     * @category Static\n     *\n     * @param a - dual quaternion to clone\n     * @returns a new dual quaternion\n     */\n    static clone(a) {\n        return new Quat2(a);\n    }\n    /**\n     * Creates a new {@link Quat2}  initialized with the given values\n     * @category Static\n     *\n     * @param x1 - 1st X component\n     * @param y1 - 1st Y component\n     * @param z1 - 1st Z component\n     * @param w1 - 1st W component\n     * @param x2 - 2nd X component\n     * @param y2 - 2nd Y component\n     * @param z2 - 2nd Z component\n     * @param w2 - 2nd W component\n     * @returns a new dual quaternion\n     */\n    static fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\n        return new Quat2(x1, y1, z1, w1, x2, y2, z2, w2);\n    }\n    /**\n     * Creates a new {@link Quat2} from the given values (quat and translation)\n     * @category Static\n     *\n     * @param x1 - X component (rotation)\n     * @param y1 - Y component (rotation)\n     * @param z1 - Z component (rotation)\n     * @param w1 - W component (rotation)\n     * @param x2 - X component (translation)\n     * @param y2 - Y component (translation)\n     * @param z2 - Z component (translation)\n     * @returns a new dual quaternion\n     */\n    static fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\n        const ax = x2 * 0.5;\n        const ay = y2 * 0.5;\n        const az = z2 * 0.5;\n        return new Quat2(x1, y1, z1, w1, ax * w1 + ay * z1 - az * y1, ay * w1 + az * x1 - ax * z1, az * w1 + ax * y1 - ay * x1, -ax * x1 - ay * y1 - az * z1);\n    }\n    /**\n     * Sets a {@link Quat2} from a quaternion and a translation\n     * @category Static\n     *\n     * @param out - dual quaternion receiving operation result\n     * @param q - a normalized quaternion\n     * @param t - translation vector\n     * @returns `out`\n     */\n    static fromRotationTranslation(out, q, t) {\n        const ax = t[0] * 0.5;\n        const ay = t[1] * 0.5;\n        const az = t[2] * 0.5;\n        const bx = q[0];\n        const by = q[1];\n        const bz = q[2];\n        const bw = q[3];\n        out[0] = bx;\n        out[1] = by;\n        out[2] = bz;\n        out[3] = bw;\n        out[4] = ax * bw + ay * bz - az * by;\n        out[5] = ay * bw + az * bx - ax * bz;\n        out[6] = az * bw + ax * by - ay * bx;\n        out[7] = -ax * bx - ay * by - az * bz;\n        return out;\n    }\n    /**\n     * Sets a {@link Quat2} from a translation\n     * @category Static\n     *\n     * @param out - dual quaternion receiving operation result\n     * @param t - translation vector\n     * @returns `out`\n     */\n    static fromTranslation(out, t) {\n        out[0] = 0;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        out[4] = t[0] * 0.5;\n        out[5] = t[1] * 0.5;\n        out[6] = t[2] * 0.5;\n        out[7] = 0;\n        return out;\n    }\n    /**\n     * Sets a {@link Quat2} from a quaternion\n     * @category Static\n     *\n     * @param out - dual quaternion receiving operation result\n     * @param q - a normalized quaternion\n     * @returns `out`\n     */\n    static fromRotation(out, q) {\n        out[0] = q[0];\n        out[1] = q[1];\n        out[2] = q[2];\n        out[3] = q[3];\n        out[4] = 0;\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        return out;\n    }\n    /**\n     * Sets a {@link Quat2} from a quaternion\n     * @category Static\n     *\n     * @param out - dual quaternion receiving operation result\n     * @param a - the matrix\n     * @returns `out`\n     */\n    static fromMat4(out, a) {\n        Mat4.getRotation(tempQuat, a);\n        Mat4.getTranslation(tempVec3, a);\n        return Quat2.fromRotationTranslation(out, tempQuat, tempVec3);\n    }\n    /**\n     * Copy the values from one {@link Quat2} to another\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the source dual quaternion\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        out[4] = a[4];\n        out[5] = a[5];\n        out[6] = a[6];\n        out[7] = a[7];\n        return out;\n    }\n    /**\n     * Set a {@link Quat2} to the identity dual quaternion\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @returns `out`\n     */\n    static identity(out) {\n        out[0] = 0;\n        out[1] = 0;\n        out[2] = 0;\n        out[3] = 1;\n        out[4] = 0;\n        out[5] = 0;\n        out[6] = 0;\n        out[7] = 0;\n        return out;\n    }\n    /**\n     * Set the components of a {@link Quat2} to the given values\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param x1 - 1st X component\n     * @param y1 - 1st Y component\n     * @param z1 - 1st Z component\n     * @param w1 - 1st W component\n     * @param x2 - 2nd X component\n     * @param y2 - 2nd Y component\n     * @param z2 - 2nd Z component\n     * @param w2 - 2nd W component\n     * @returns `out`\n     */\n    static set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\n        out[0] = x1;\n        out[1] = y1;\n        out[2] = z1;\n        out[3] = w1;\n        out[4] = x2;\n        out[5] = y2;\n        out[6] = z2;\n        out[7] = w2;\n        return out;\n    }\n    /**\n     * Gets the real part of a dual quat\n     * @category Static\n     *\n     * @param out - real part\n     * @param a - Dual Quaternion\n     * @return `out`\n     */\n    static getReal(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    ;\n    /**\n     * Gets the dual part of a dual quat\n     * @category Static\n     *\n     * @param out - dual part\n     * @param a - Dual Quaternion\n     * @return `out`\n     */\n    static getDual(out, a) {\n        out[0] = a[4];\n        out[1] = a[5];\n        out[2] = a[6];\n        out[3] = a[7];\n        return out;\n    }\n    /**\n     * Set the real component of a {@link Quat2} to the given quaternion\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - a quaternion representing the real part\n     * @return `out`\n     */\n    static setReal(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        out[2] = a[2];\n        out[3] = a[3];\n        return out;\n    }\n    ;\n    /**\n     * Set the dual component of a {@link Quat2} to the given quaternion\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - a quaternion representing the dual part\n     * @return `out`\n     */\n    static setDual(out, a) {\n        out[4] = a[0];\n        out[5] = a[1];\n        out[6] = a[2];\n        out[7] = a[3];\n        return out;\n    }\n    /**\n     * Gets the translation of a normalized {@link Quat2}\n     * @category Static\n     *\n     * @param out - the receiving translation vector\n     * @param a - Dual Quaternion to be decomposed\n     * @return `out`\n     */\n    static getTranslation(out, a) {\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        const bx = -a[0];\n        const by = -a[1];\n        const bz = -a[2];\n        const bw = a[3];\n        out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n        out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n        out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n        return out;\n    }\n    /**\n     * Translates a {@link Quat2} by the given vector\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to translate\n     * @param v - vector to translate by\n     * @returns `out`\n     */\n    static translate(out, a, v) {\n        const ax1 = a[0];\n        const ay1 = a[1];\n        const az1 = a[2];\n        const aw1 = a[3];\n        const bx1 = v[0] * 0.5;\n        const by1 = v[1] * 0.5;\n        const bz1 = v[2] * 0.5;\n        const ax2 = a[4];\n        const ay2 = a[5];\n        const az2 = a[6];\n        const aw2 = a[7];\n        out[0] = ax1;\n        out[1] = ay1;\n        out[2] = az1;\n        out[3] = aw1;\n        out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\n        out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\n        out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\n        out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} around the X axis\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateX(out, a, rad) {\n        let bx = -a[0];\n        let by = -a[1];\n        let bz = -a[2];\n        let bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        const ax1 = ax * bw + aw * bx + ay * bz - az * by;\n        const ay1 = ay * bw + aw * by + az * bx - ax * bz;\n        const az1 = az * bw + aw * bz + ax * by - ay * bx;\n        const aw1 = aw * bw - ax * bx - ay * by - az * bz;\n        Quat.rotateX(out, a, rad);\n        bx = out[0];\n        by = out[1];\n        bz = out[2];\n        bw = out[3];\n        out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n        out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n        out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n        out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} around the Y axis\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateY(out, a, rad) {\n        let bx = -a[0];\n        let by = -a[1];\n        let bz = -a[2];\n        let bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        const ax1 = ax * bw + aw * bx + ay * bz - az * by;\n        const ay1 = ay * bw + aw * by + az * bx - ax * bz;\n        const az1 = az * bw + aw * bz + ax * by - ay * bx;\n        const aw1 = aw * bw - ax * bx - ay * by - az * bz;\n        Quat.rotateY(out, a, rad);\n        bx = out[0];\n        by = out[1];\n        bz = out[2];\n        bw = out[3];\n        out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n        out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n        out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n        out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} around the Z axis\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param rad - angle (in radians) to rotate\n     * @returns `out`\n     */\n    static rotateZ(out, a, rad) {\n        let bx = -a[0];\n        let by = -a[1];\n        let bz = -a[2];\n        let bw = a[3];\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        const ax1 = ax * bw + aw * bx + ay * bz - az * by;\n        const ay1 = ay * bw + aw * by + az * bx - ax * bz;\n        const az1 = az * bw + aw * bz + ax * by - ay * bx;\n        const aw1 = aw * bw - ax * bx - ay * by - az * bz;\n        Quat.rotateZ(out, a, rad);\n        bx = out[0];\n        by = out[1];\n        bz = out[2];\n        bw = out[3];\n        out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n        out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n        out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n        out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} by a given quaternion (a * q)\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param q - quaternion to rotate by\n     * @returns `out`\n     */\n    static rotateByQuatAppend(out, a, q) {\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        let ax = a[0];\n        let ay = a[1];\n        let az = a[2];\n        let aw = a[3];\n        out[0] = ax * qw + aw * qx + ay * qz - az * qy;\n        out[1] = ay * qw + aw * qy + az * qx - ax * qz;\n        out[2] = az * qw + aw * qz + ax * qy - ay * qx;\n        out[3] = aw * qw - ax * qx - ay * qy - az * qz;\n        ax = a[4];\n        ay = a[5];\n        az = a[6];\n        aw = a[7];\n        out[4] = ax * qw + aw * qx + ay * qz - az * qy;\n        out[5] = ay * qw + aw * qy + az * qx - ax * qz;\n        out[6] = az * qw + aw * qz + ax * qy - ay * qx;\n        out[7] = aw * qw - ax * qx - ay * qy - az * qz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} by a given quaternion (q * a)\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param q - quaternion to rotate by\n     * @param a - the dual quaternion to rotate\n     * @returns `out`\n     */\n    static rotateByQuatPrepend(out, q, a) {\n        const qx = q[0];\n        const qy = q[1];\n        const qz = q[2];\n        const qw = q[3];\n        let bx = a[0];\n        let by = a[1];\n        let bz = a[2];\n        let bw = a[3];\n        out[0] = qx * bw + qw * bx + qy * bz - qz * by;\n        out[1] = qy * bw + qw * by + qz * bx - qx * bz;\n        out[2] = qz * bw + qw * bz + qx * by - qy * bx;\n        out[3] = qw * bw - qx * bx - qy * by - qz * bz;\n        bx = a[4];\n        by = a[5];\n        bz = a[6];\n        bw = a[7];\n        out[4] = qx * bw + qw * bx + qy * bz - qz * by;\n        out[5] = qy * bw + qw * by + qz * bx - qx * bz;\n        out[6] = qz * bw + qw * bz + qx * by - qy * bx;\n        out[7] = qw * bw - qx * bx - qy * by - qz * bz;\n        return out;\n    }\n    /**\n     * Rotates a {@link Quat2} around a given axis. Does the normalization automatically\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the dual quaternion to rotate\n     * @param axis - the axis to rotate around\n     * @param rad - how far the rotation should be\n     * @returns `out`\n     */\n    static rotateAroundAxis(out, a, axis, rad) {\n        //Special case for rad = 0\n        if (Math.abs(rad) < EPSILON) {\n            return Quat2.copy(out, a);\n        }\n        const axisLength = Math.sqrt(axis[0] * axis[0] + axis[1] * axis[1] + axis[2] * axis[2]);\n        rad = rad * 0.5;\n        const s = Math.sin(rad);\n        const bx = (s * axis[0]) / axisLength;\n        const by = (s * axis[1]) / axisLength;\n        const bz = (s * axis[2]) / axisLength;\n        const bw = Math.cos(rad);\n        const ax1 = a[0];\n        const ay1 = a[1];\n        const az1 = a[2];\n        const aw1 = a[3];\n        out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\n        out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\n        out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\n        out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\n        const ax = a[4];\n        const ay = a[5];\n        const az = a[6];\n        const aw = a[7];\n        out[4] = ax * bw + aw * bx + ay * bz - az * by;\n        out[5] = ay * bw + aw * by + az * bx - ax * bz;\n        out[6] = az * bw + aw * bz + ax * by - ay * bx;\n        out[7] = aw * bw - ax * bx - ay * by - az * bz;\n        return out;\n    }\n    /**\n     * Adds two {@link Quat2}s\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        out[2] = a[2] + b[2];\n        out[3] = a[3] + b[3];\n        out[4] = a[4] + b[4];\n        out[5] = a[5] + b[5];\n        out[6] = a[6] + b[6];\n        out[7] = a[7] + b[7];\n        return out;\n    }\n    /**\n     * Multiplies two {@link Quat2}s\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns {quat2} out\n     */\n    static multiply(out, a, b) {\n        const ax0 = a[0];\n        const ay0 = a[1];\n        const az0 = a[2];\n        const aw0 = a[3];\n        const bx1 = b[4];\n        const by1 = b[5];\n        const bz1 = b[6];\n        const bw1 = b[7];\n        const ax1 = a[4];\n        const ay1 = a[5];\n        const az1 = a[6];\n        const aw1 = a[7];\n        const bx0 = b[0];\n        const by0 = b[1];\n        const bz0 = b[2];\n        const bw0 = b[3];\n        out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\n        out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\n        out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\n        out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\n        out[4] =\n            ax0 * bw1 +\n                aw0 * bx1 +\n                ay0 * bz1 -\n                az0 * by1 +\n                ax1 * bw0 +\n                aw1 * bx0 +\n                ay1 * bz0 -\n                az1 * by0;\n        out[5] =\n            ay0 * bw1 +\n                aw0 * by1 +\n                az0 * bx1 -\n                ax0 * bz1 +\n                ay1 * bw0 +\n                aw1 * by0 +\n                az1 * bx0 -\n                ax1 * bz0;\n        out[6] =\n            az0 * bw1 +\n                aw0 * bz1 +\n                ax0 * by1 -\n                ay0 * bx1 +\n                az1 * bw0 +\n                aw1 * bz0 +\n                ax1 * by0 -\n                ay1 * bx0;\n        out[7] =\n            aw0 * bw1 -\n                ax0 * bx1 -\n                ay0 * by1 -\n                az0 * bz1 +\n                aw1 * bw0 -\n                ax1 * bx0 -\n                ay1 * by0 -\n                az1 * bz0;\n        return out;\n    }\n    /**\n     * Alias for {@link Quat2.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return out; }\n    /**\n     * Scales a {@link Quat2} by a scalar value\n     * @category Static\n     *\n     * @param out - the receiving dual quaterion\n     * @param a - the dual quaternion to scale\n     * @param b - scalar value to scale the dual quaterion by\n     * @returns `out`\n     */\n    static scale(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        out[2] = a[2] * b;\n        out[3] = a[3] * b;\n        out[4] = a[4] * b;\n        out[5] = a[5] * b;\n        out[6] = a[6] * b;\n        out[7] = a[7] * b;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two {@link Quat2}s (The dot product of the real parts)\n     * @category Static\n     *\n     * @param a - the first operand\n     * @param b - the second operand\n     * @returns dot product of a and b\n     */\n    static dot(a, b) { return 0; }\n    /**\n     * Performs a linear interpolation between two {@link Quat2}s\n     * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when `t = 0.5`)\n     * @category Static\n     *\n     * @param out - the receiving dual quat\n     * @param a - the first operand\n     * @param b - the second operand\n     * @param t - interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const mt = 1 - t;\n        if (Quat2.dot(a, b) < 0)\n            t = -t;\n        out[0] = a[0] * mt + b[0] * t;\n        out[1] = a[1] * mt + b[1] * t;\n        out[2] = a[2] * mt + b[2] * t;\n        out[3] = a[3] * mt + b[3] * t;\n        out[4] = a[4] * mt + b[4] * t;\n        out[5] = a[5] * mt + b[5] * t;\n        out[6] = a[6] * mt + b[6] * t;\n        out[7] = a[7] * mt + b[7] * t;\n        return out;\n    }\n    /**\n     * Calculates the inverse of a {@link Quat2}. If they are normalized, conjugate is cheaper\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - dual quat to calculate inverse of\n     * @returns `out`\n     */\n    static invert(out, a) {\n        const sqlen = Quat2.squaredLength(a);\n        out[0] = -a[0] / sqlen;\n        out[1] = -a[1] / sqlen;\n        out[2] = -a[2] / sqlen;\n        out[3] = a[3] / sqlen;\n        out[4] = -a[4] / sqlen;\n        out[5] = -a[5] / sqlen;\n        out[6] = -a[6] / sqlen;\n        out[7] = a[7] / sqlen;\n        return out;\n    }\n    /**\n     * Calculates the conjugate of a {@link Quat2}\n     * If the dual quaternion is normalized, this function is faster than {@link Quat2.invert} and produces the same result.\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - dual quaternion to calculate conjugate of\n     * @returns `out`\n     */\n    static conjugate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        out[2] = -a[2];\n        out[3] = a[3];\n        out[4] = -a[4];\n        out[5] = -a[5];\n        out[6] = -a[6];\n        out[7] = a[7];\n        return out;\n    }\n    /**\n     * Calculates the magnitude (length) of a {@link Quat2}\n     * @category Static\n     *\n     * @param a - dual quaternion to calculate length of\n     * @returns length of `a`\n     */\n    static magnitude(a) { return 0; }\n    /**\n     * Alias for {@link Quat2.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Quat2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Quat2.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Quat2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Quat2.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Quat2}\n     * @category Static\n     *\n     * @param a - dual quaternion to calculate squared length of\n     * @returns squared length of a\n     */\n    static squaredLength(a) { return 0; }\n    /**\n     * Alias for {@link Quat2.squaredLength}\n     * @category Static\n     */\n    static sqrLen(a) { return 0; }\n    /**\n     * Normalize a {@link Quat2}\n     * @category Static\n     *\n     * @param out - the receiving dual quaternion\n     * @param a - dual quaternion to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        let magnitude = Quat2.squaredLength(a);\n        if (magnitude > 0) {\n            magnitude = Math.sqrt(magnitude);\n            const a0 = a[0] / magnitude;\n            const a1 = a[1] / magnitude;\n            const a2 = a[2] / magnitude;\n            const a3 = a[3] / magnitude;\n            const b0 = a[4];\n            const b1 = a[5];\n            const b2 = a[6];\n            const b3 = a[7];\n            const a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;\n            out[0] = a0;\n            out[1] = a1;\n            out[2] = a2;\n            out[3] = a3;\n            out[4] = (b0 - a0 * a_dot_b) / magnitude;\n            out[5] = (b1 - a1 * a_dot_b) / magnitude;\n            out[6] = (b2 - a2 * a_dot_b) / magnitude;\n            out[7] = (b3 - a3 * a_dot_b) / magnitude;\n        }\n        return out;\n    }\n    /**\n     * Returns a string representation of a {@link Quat2}\n     * @category Static\n     *\n     * @param a - dual quaternion to represent as a string\n     * @returns string representation of the vector\n     */\n    static str(a) {\n        return `Quat2(${a.join(', ')})`;\n    }\n    /**\n     * Returns whether or not the {@link Quat2}s have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first dual quaternion.\n     * @param b - The second dual quaternion.\n     * @returns True if the dual quaternions are equal, false otherwise.\n     */\n    static exactEquals(a, b) {\n        return (a[0] === b[0] &&\n            a[1] === b[1] &&\n            a[2] === b[2] &&\n            a[3] === b[3] &&\n            a[4] === b[4] &&\n            a[5] === b[5] &&\n            a[6] === b[6] &&\n            a[7] === b[7]);\n    }\n    /**\n     * Returns whether or not the {@link Quat2}s have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first dual quaternion.\n     * @param b - The second dual quaternion.\n     * @returns True if the dual quaternions are equal, false otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const a2 = a[2];\n        const a3 = a[3];\n        const a4 = a[4];\n        const a5 = a[5];\n        const a6 = a[6];\n        const a7 = a[7];\n        const b0 = b[0];\n        const b1 = b[1];\n        const b2 = b[2];\n        const b3 = b[3];\n        const b4 = b[4];\n        const b5 = b[5];\n        const b6 = b[6];\n        const b7 = b[7];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\n            Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\n            Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\n            Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\n            Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\n            Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\n            Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)));\n    }\n}\n// Temporary variables to prevent repeated allocations in the algorithms above.\nconst tempQuat = [0, 0, 0, 0];\nconst tempVec3 = [0, 0, 0];\n// Methods which re-use the Quat implementation\n// @ts-ignore\nQuat2.dot = Quat.dot;\n// @ts-ignore\nQuat2.squaredLength = Quat.squaredLength;\n// @ts-ignore\nQuat2.sqrLen = Quat.squaredLength;\n// @ts-ignore\nQuat2.mag = Quat.magnitude;\n// @ts-ignore\nQuat2.length = Quat.magnitude;\n// @ts-ignore\nQuat2.len = Quat.magnitude;\n// Static method alias assignments\nQuat2.mul = Quat2.multiply;\n\n/**\n * 2 Dimensional Vector\n */\nclass Vec2 extends Float32Array {\n    /**\n     * The number of bytes in a {@link Vec2}.\n     */\n    static BYTE_LENGTH = 2 * Float32Array.BYTES_PER_ELEMENT;\n    /**\n     * Create a {@link Vec2}.\n     */\n    constructor(...values) {\n        switch (values.length) {\n            case 2: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, values[1]]);\n                }\n                else {\n                    super(v, values[1], 2);\n                }\n                break;\n            }\n            case 1: {\n                const v = values[0];\n                if (typeof v === 'number') {\n                    super([v, v]);\n                }\n                else {\n                    super(v, 0, 2);\n                }\n                break;\n            }\n            default:\n                super(2);\n                break;\n        }\n    }\n    //============\n    // Attributes\n    //============\n    // Getters and setters to make component access read better.\n    // These are likely to be a little bit slower than direct array access.\n    /**\n     * The x component of the vector. Equivalent to `this[0];`\n     * @category Vector components\n     */\n    get x() { return this[0]; }\n    set x(value) { this[0] = value; }\n    /**\n     * The y component of the vector. Equivalent to `this[1];`\n     * @category Vector components\n     */\n    get y() { return this[1]; }\n    set y(value) { this[1] = value; }\n    // Alternate set of getters and setters in case this is being used to define\n    // a color.\n    /**\n     * The r component of the vector. Equivalent to `this[0];`\n     * @category Color components\n     */\n    get r() { return this[0]; }\n    set r(value) { this[0] = value; }\n    /**\n     * The g component of the vector. Equivalent to `this[1];`\n     * @category Color components\n     */\n    get g() { return this[1]; }\n    set g(value) { this[1] = value; }\n    /**\n     * The magnitude (length) of this.\n     * Equivalent to `Vec2.magnitude(this);`\n     *\n     * Magnitude is used because the `length` attribute is already defined by\n     * `Float32Array` to mean the number of elements in the array.\n     */\n    get magnitude() {\n        return Math.hypot(this[0], this[1]);\n    }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     */\n    get mag() { return this.magnitude; }\n    /**\n     * The squared magnitude (length) of `this`.\n     * Equivalent to `Vec2.squaredMagnitude(this);`\n     */\n    get squaredMagnitude() {\n        const x = this[0];\n        const y = this[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.squaredMagnitude}\n     */\n    get sqrMag() { return this.squaredMagnitude; }\n    /**\n     * A string representation of `this`\n     * Equivalent to `Vec2.str(this);`\n     */\n    get str() {\n        return Vec2.str(this);\n    }\n    //===================\n    // Instances methods\n    //===================\n    /**\n     * Copy the values from another {@link Vec2} into `this`.\n     *\n     * @param a the source vector\n     * @returns `this`\n     */\n    copy(a) {\n        this.set(a);\n        return this;\n    }\n    // Instead of zero(), use a.fill(0) for instances;\n    /**\n     * Adds a {@link Vec2} to `this`.\n     * Equivalent to `Vec2.add(this, this, b);`\n     *\n     * @param b - The vector to add to `this`\n     * @returns `this`\n     */\n    add(b) {\n        this[0] += b[0];\n        this[1] += b[1];\n        return this;\n    }\n    /**\n     * Subtracts a {@link Vec2} from `this`.\n     * Equivalent to `Vec2.subtract(this, this, b);`\n     *\n     * @param b - The vector to subtract from `this`\n     * @returns `this`\n     */\n    subtract(b) {\n        this[0] -= b[0];\n        this[1] -= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.subtract}\n     */\n    sub(b) { return this; }\n    /**\n     * Multiplies `this` by a {@link Vec2}.\n     * Equivalent to `Vec2.multiply(this, this, b);`\n     *\n     * @param b - The vector to multiply `this` by\n     * @returns `this`\n     */\n    multiply(b) {\n        this[0] *= b[0];\n        this[1] *= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.multiply}\n     */\n    mul(b) { return this; }\n    /**\n     * Divides `this` by a {@link Vec2}.\n     * Equivalent to `Vec2.divide(this, this, b);`\n     *\n     * @param b - The vector to divide `this` by\n     * @returns {Vec2} `this`\n     */\n    divide(b) {\n        this[0] /= b[0];\n        this[1] /= b[1];\n        return this;\n    }\n    /**\n     * Alias for {@link Vec2.divide}\n     */\n    div(b) { return this; }\n    /**\n     * Scales `this` by a scalar number.\n     * Equivalent to `Vec2.scale(this, this, b);`\n     *\n     * @param b - Amount to scale `this` by\n     * @returns `this`\n     */\n    scale(b) {\n        this[0] *= b;\n        this[1] *= b;\n        return this;\n    }\n    /**\n     * Calculates `this` scaled by a scalar value then adds the result to `this`.\n     * Equivalent to `Vec2.scaleAndAdd(this, this, b, scale);`\n     *\n     * @param b - The vector to add to `this`\n     * @param scale - The amount to scale `b` by before adding\n     * @returns `this`\n     */\n    scaleAndAdd(b, scale) {\n        this[0] += b[0] * scale;\n        this[1] += b[1] * scale;\n        return this;\n    }\n    /**\n     * Calculates the euclidian distance between another {@link Vec2} and `this`.\n     * Equivalent to `Vec2.distance(this, b);`\n     *\n     * @param b - The vector to calculate the distance to\n     * @returns Distance between `this` and `b`\n     */\n    distance(b) {\n        return Vec2.distance(this, b);\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     */\n    dist(b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between another {@link Vec2} and `this`.\n     * Equivalent to `Vec2.squaredDistance(this, b);`\n     *\n     * @param b The vector to calculate the squared distance to\n     * @returns Squared distance between `this` and `b`\n     */\n    squaredDistance(b) {\n        return Vec2.squaredDistance(this, b);\n    }\n    /**\n     * Alias for {@link Vec2.squaredDistance}\n     */\n    sqrDist(b) { return 0; }\n    /**\n     * Negates the components of `this`.\n     * Equivalent to `Vec2.negate(this, this);`\n     *\n     * @returns `this`\n     */\n    negate() {\n        this[0] *= -1;\n        this[1] *= -1;\n        return this;\n    }\n    /**\n     * Inverts the components of `this`.\n     * Equivalent to `Vec2.inverse(this, this);`\n     *\n     * @returns `this`\n     */\n    invert() {\n        this[0] = 1.0 / this[0];\n        this[1] = 1.0 / this[1];\n        return this;\n    }\n    /**\n     * Calculates the dot product of this and another {@link Vec2}.\n     * Equivalent to `Vec2.dot(this, b);`\n     *\n     * @param b - The second operand\n     * @returns Dot product of `this` and `b`\n     */\n    dot(b) {\n        return this[0] * b[0] + this[1] * b[1];\n    }\n    /**\n     * Normalize `this`.\n     * Equivalent to `Vec2.normalize(this, this);`\n     *\n     * @returns `this`\n     */\n    normalize() {\n        return Vec2.normalize(this, this);\n    }\n    //================\n    // Static methods\n    //================\n    /**\n     * Creates a new, empty {@link Vec2}\n     * @category Static\n     *\n     * @returns A new 2D vector\n     */\n    static create() {\n        return new Vec2();\n    }\n    /**\n     * Creates a new {@link Vec2} initialized with values from an existing vector\n     * @category Static\n     *\n     * @param a - Vector to clone\n     * @returns A new 2D vector\n     */\n    static clone(a) {\n        return new Vec2(a);\n    }\n    /**\n     * Creates a new {@link Vec2} initialized with the given values\n     * @category Static\n     *\n     * @param x - X component\n     * @param y - Y component\n     * @returns A new 2D vector\n     */\n    static fromValues(x, y) {\n        return new Vec2(x, y);\n    }\n    /**\n     * Copy the values from one {@link Vec2} to another\n     * @category Static\n     *\n     * @param out - the receiving vector\n     * @param a - The source vector\n     * @returns `out`\n     */\n    static copy(out, a) {\n        out[0] = a[0];\n        out[1] = a[1];\n        return out;\n    }\n    /**\n     * Set the components of a {@link Vec2} to the given values\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param x - X component\n     * @param y - Y component\n     * @returns `out`\n     */\n    static set(out, x, y) {\n        out[0] = x;\n        out[1] = y;\n        return out;\n    }\n    /**\n     * Adds two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static add(out, a, b) {\n        out[0] = a[0] + b[0];\n        out[1] = a[1] + b[1];\n        return out;\n    }\n    /**\n     * Subtracts vector b from vector a\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static subtract(out, a, b) {\n        out[0] = a[0] - b[0];\n        out[1] = a[1] - b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.subtract}\n     * @category Static\n     */\n    static sub(out, a, b) { return [0, 0]; }\n    /**\n     * Multiplies two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static multiply(out, a, b) {\n        out[0] = a[0] * b[0];\n        out[1] = a[1] * b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.multiply}\n     * @category Static\n     */\n    static mul(out, a, b) { return [0, 0]; }\n    /**\n     * Divides two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static divide(out, a, b) {\n        out[0] = a[0] / b[0];\n        out[1] = a[1] / b[1];\n        return out;\n    }\n    /**\n     * Alias for {@link Vec2.divide}\n     * @category Static\n     */\n    static div(out, a, b) { return [0, 0]; }\n    /**\n     * Math.ceil the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to ceil\n     * @returns `out`\n     */\n    static ceil(out, a) {\n        out[0] = Math.ceil(a[0]);\n        out[1] = Math.ceil(a[1]);\n        return out;\n    }\n    /**\n     * Math.floor the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to floor\n     * @returns `out`\n     */\n    static floor(out, a) {\n        out[0] = Math.floor(a[0]);\n        out[1] = Math.floor(a[1]);\n        return out;\n    }\n    /**\n     * Returns the minimum of two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static min(out, a, b) {\n        out[0] = Math.min(a[0], b[0]);\n        out[1] = Math.min(a[1], b[1]);\n        return out;\n    }\n    /**\n     * Returns the maximum of two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static max(out, a, b) {\n        out[0] = Math.max(a[0], b[0]);\n        out[1] = Math.max(a[1], b[1]);\n        return out;\n    }\n    /**\n     * Math.round the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to round\n     * @returns `out`\n     */\n    static round(out, a) {\n        out[0] = Math.round(a[0]);\n        out[1] = Math.round(a[1]);\n        return out;\n    }\n    /**\n     * Scales a {@link Vec2} by a scalar number\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to scale\n     * @param b - Amount to scale the vector by\n     * @returns `out`\n     */\n    static scale(out, a, b) {\n        out[0] = a[0] * b;\n        out[1] = a[1] * b;\n        return out;\n    }\n    /**\n     * Adds two Vec2's after scaling the second operand by a scalar value\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @param scale - The amount to scale b by before adding\n     * @returns `out`\n     */\n    static scaleAndAdd(out, a, b, scale) {\n        out[0] = a[0] + b[0] * scale;\n        out[1] = a[1] + b[1] * scale;\n        return out;\n    }\n    /**\n     * Calculates the euclidian distance between two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns distance between `a` and `b`\n     */\n    static distance(a, b) {\n        return Math.hypot(b[0] - a[0], b[1] - a[1]);\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     * @category Static\n     */\n    static dist(a, b) { return 0; }\n    /**\n     * Calculates the squared euclidian distance between two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns Squared distance between `a` and `b`\n     */\n    static squaredDistance(a, b) {\n        const x = b[0] - a[0];\n        const y = b[1] - a[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.distance}\n     * @category Static\n     */\n    static sqrDist(a, b) { return 0; }\n    /**\n     * Calculates the magnitude (length) of a {@link Vec2}\n     * @category Static\n     *\n     * @param a - Vector to calculate magnitude of\n     * @returns Magnitude of a\n     */\n    static magnitude(a) {\n        let x = a[0];\n        let y = a[1];\n        return Math.sqrt(x * x + y * y);\n    }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     */\n    static mag(a) { return 0; }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec2.magnitude} to avoid conflicts with builtin `length` methods/attribs\n     *\n     * @param a - vector to calculate length of\n     * @returns length of a\n     */\n    // @ts-ignore: Length conflicts with Function.length\n    static length(a) { return 0; }\n    /**\n     * Alias for {@link Vec2.magnitude}\n     * @category Static\n     * @deprecated Use {@link Vec2.mag}\n     */\n    static len(a) { return 0; }\n    /**\n     * Calculates the squared length of a {@link Vec2}\n     * @category Static\n     *\n     * @param a - Vector to calculate squared length of\n     * @returns Squared length of a\n     */\n    static squaredLength(a) {\n        const x = a[0];\n        const y = a[1];\n        return x * x + y * y;\n    }\n    /**\n     * Alias for {@link Vec2.squaredLength}\n     */\n    static sqrLen(a, b) { return 0; }\n    /**\n     * Negates the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to negate\n     * @returns `out`\n     */\n    static negate(out, a) {\n        out[0] = -a[0];\n        out[1] = -a[1];\n        return out;\n    }\n    /**\n     * Returns the inverse of the components of a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to invert\n     * @returns `out`\n     */\n    static inverse(out, a) {\n        out[0] = 1.0 / a[0];\n        out[1] = 1.0 / a[1];\n        return out;\n    }\n    /**\n     * Normalize a {@link Vec2}\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - Vector to normalize\n     * @returns `out`\n     */\n    static normalize(out, a) {\n        const x = a[0];\n        const y = a[1];\n        let len = x * x + y * y;\n        if (len > 0) {\n            //TODO: evaluate use of glm_invsqrt here?\n            len = 1 / Math.sqrt(len);\n        }\n        out[0] = a[0] * len;\n        out[1] = a[1] * len;\n        return out;\n    }\n    /**\n     * Calculates the dot product of two {@link Vec2}s\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns Dot product of `a` and `b`\n     */\n    static dot(a, b) {\n        return a[0] * b[0] + a[1] * b[1];\n    }\n    /**\n     * Computes the cross product of two {@link Vec2}s\n     * Note that the cross product must by definition produce a 3D vector.\n     * For this reason there is also not instance equivalent for this function.\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns `out`\n     */\n    static cross(out, a, b) {\n        const z = a[0] * b[1] - a[1] * b[0];\n        out[0] = out[1] = 0;\n        out[2] = z;\n        return out;\n    }\n    /**\n     * Performs a linear interpolation between two {@link Vec2}s\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @param a - The first operand\n     * @param b - The second operand\n     * @param t - Interpolation amount, in the range [0-1], between the two inputs\n     * @returns `out`\n     */\n    static lerp(out, a, b, t) {\n        const ax = a[0];\n        const ay = a[1];\n        out[0] = ax + t * (b[0] - ax);\n        out[1] = ay + t * (b[1] - ay);\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat2}\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat2(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[2] * y;\n        out[1] = m[1] * x + m[3] * y;\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat2d}\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat2d(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[2] * y + m[4];\n        out[1] = m[1] * x + m[3] * y + m[5];\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat3}\n     * 3rd vector component is implicitly '1'\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat3(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[3] * y + m[6];\n        out[1] = m[1] * x + m[4] * y + m[7];\n        return out;\n    }\n    /**\n     * Transforms the {@link Vec2} with a {@link Mat4}\n     * 3rd vector component is implicitly '0'\n     * 4th vector component is implicitly '1'\n     *\n     * @param out - The receiving vector\n     * @param a - The vector to transform\n     * @param m - Matrix to transform with\n     * @returns `out`\n     */\n    static transformMat4(out, a, m) {\n        const x = a[0];\n        const y = a[1];\n        out[0] = m[0] * x + m[4] * y + m[12];\n        out[1] = m[1] * x + m[5] * y + m[13];\n        return out;\n    }\n    /**\n     * Rotate a 2D vector\n     * @category Static\n     *\n     * @param out - The receiving {@link Vec2}\n     * @param a - The {@link Vec2} point to rotate\n     * @param b - The origin of the rotation\n     * @param rad - The angle of rotation in radians\n     * @returns `out`\n     */\n    static rotate(out, a, b, rad) {\n        //Translate point to the origin\n        const p0 = a[0] - b[0];\n        const p1 = a[1] - b[1];\n        const sinC = Math.sin(rad);\n        const cosC = Math.cos(rad);\n        //perform rotation and translate to correct position\n        out[0] = p0 * cosC - p1 * sinC + b[0];\n        out[1] = p0 * sinC + p1 * cosC + b[1];\n        return out;\n    }\n    /**\n     * Get the angle between two 2D vectors\n     * @category Static\n     *\n     * @param a - The first operand\n     * @param b - The second operand\n     * @returns The angle in radians\n     */\n    static angle(a, b) {\n        const x1 = a[0];\n        const y1 = a[1];\n        const x2 = b[0];\n        const y2 = b[1];\n        // mag is the product of the magnitudes of a and b\n        const mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2);\n        // mag &&.. short circuits if mag == 0\n        const cosine = mag && (x1 * x2 + y1 * y2) / mag;\n        // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n        return Math.acos(Math.min(Math.max(cosine, -1), 1));\n    }\n    /**\n     * Set the components of a {@link Vec2} to zero\n     * @category Static\n     *\n     * @param out - The receiving vector\n     * @returns `out`\n     */\n    static zero(out) {\n        out[0] = 0.0;\n        out[1] = 0.0;\n        return out;\n    }\n    /**\n     * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns `true` if the vectors components are ===, `false` otherwise.\n     */\n    static exactEquals(a, b) {\n        return a[0] === b[0] && a[1] === b[1];\n    }\n    /**\n     * Returns whether or not the vectors have approximately the same elements in the same position.\n     * @category Static\n     *\n     * @param a - The first vector.\n     * @param b - The second vector.\n     * @returns `true` if the vectors are approximately equal, `false` otherwise.\n     */\n    static equals(a, b) {\n        const a0 = a[0];\n        const a1 = a[1];\n        const b0 = b[0];\n        const b1 = b[1];\n        return (Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\n            Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)));\n    }\n    /**\n     * Returns a string representation of a vector\n     * @category Static\n     *\n     * @param a - Vector to represent as a string\n     * @returns String representation of the vector\n     */\n    static str(a) {\n        return `Vec2(${a.join(', ')})`;\n    }\n}\n// Instance method alias assignments\nVec2.prototype.sub = Vec2.prototype.subtract;\nVec2.prototype.mul = Vec2.prototype.multiply;\nVec2.prototype.div = Vec2.prototype.divide;\nVec2.prototype.dist = Vec2.prototype.distance;\nVec2.prototype.sqrDist = Vec2.prototype.squaredDistance;\n// Static method alias assignments\nVec2.sub = Vec2.subtract;\nVec2.mul = Vec2.multiply;\nVec2.div = Vec2.divide;\nVec2.dist = Vec2.distance;\nVec2.sqrDist = Vec2.squaredDistance;\nVec2.sqrLen = Vec2.squaredLength;\nVec2.mag = Vec2.magnitude;\nVec2.length = Vec2.magnitude;\nVec2.len = Vec2.magnitude;\n\n// The contents of the following section are autogenerated by scripts/gen-swizzle.js and should\n// not be modified by hand.\n// [Swizzle Autogen]\nconst VEC2_SWIZZLES = ['xx', 'xy', 'yx', 'yy', 'xxx', 'xxy', 'xyx', 'xyy', 'yxx', 'yxy', 'yyx', 'yyy', 'xxxx', 'xxxy', 'xxyx', 'xxyy', 'xyxx', 'xyxy', 'xyyx', 'xyyy', 'yxxx', 'yxxy', 'yxyx', 'yxyy', 'yyxx', 'yyxy', 'yyyx', 'yyyy', 'rr', 'rg', 'gr', 'gg', 'rrr', 'rrg', 'rgr', 'rgg', 'grr', 'grg', 'ggr', 'ggg', 'rrrr', 'rrrg', 'rrgr', 'rrgg', 'rgrr', 'rgrg', 'rggr', 'rggg', 'grrr', 'grrg', 'grgr', 'grgg', 'ggrr', 'ggrg', 'gggr', 'gggg'];\nconst VEC3_SWIZZLES = ['xz', 'yz', 'zx', 'zy', 'zz', 'xxz', 'xyz', 'xzx', 'xzy', 'xzz', 'yxz', 'yyz', 'yzx', 'yzy', 'yzz', 'zxx', 'zxy', 'zxz', 'zyx', 'zyy', 'zyz', 'zzx', 'zzy', 'zzz', 'xxxz', 'xxyz', 'xxzx', 'xxzy', 'xxzz', 'xyxz', 'xyyz', 'xyzx', 'xyzy', 'xyzz', 'xzxx', 'xzxy', 'xzxz', 'xzyx', 'xzyy', 'xzyz', 'xzzx', 'xzzy', 'xzzz', 'yxxz', 'yxyz', 'yxzx', 'yxzy', 'yxzz', 'yyxz', 'yyyz', 'yyzx', 'yyzy', 'yyzz', 'yzxx', 'yzxy', 'yzxz', 'yzyx', 'yzyy', 'yzyz', 'yzzx', 'yzzy', 'yzzz', 'zxxx', 'zxxy', 'zxxz', 'zxyx', 'zxyy', 'zxyz', 'zxzx', 'zxzy', 'zxzz', 'zyxx', 'zyxy', 'zyxz', 'zyyx', 'zyyy', 'zyyz', 'zyzx', 'zyzy', 'zyzz', 'zzxx', 'zzxy', 'zzxz', 'zzyx', 'zzyy', 'zzyz', 'zzzx', 'zzzy', 'zzzz', 'rb', 'gb', 'br', 'bg', 'bb', 'rrb', 'rgb', 'rbr', 'rbg', 'rbb', 'grb', 'ggb', 'gbr', 'gbg', 'gbb', 'brr', 'brg', 'brb', 'bgr', 'bgg', 'bgb', 'bbr', 'bbg', 'bbb', 'rrrb', 'rrgb', 'rrbr', 'rrbg', 'rrbb', 'rgrb', 'rggb', 'rgbr', 'rgbg', 'rgbb', 'rbrr', 'rbrg', 'rbrb', 'rbgr', 'rbgg', 'rbgb', 'rbbr', 'rbbg', 'rbbb', 'grrb', 'grgb', 'grbr', 'grbg', 'grbb', 'ggrb', 'gggb', 'ggbr', 'ggbg', 'ggbb', 'gbrr', 'gbrg', 'gbrb', 'gbgr', 'gbgg', 'gbgb', 'gbbr', 'gbbg', 'gbbb', 'brrr', 'brrg', 'brrb', 'brgr', 'brgg', 'brgb', 'brbr', 'brbg', 'brbb', 'bgrr', 'bgrg', 'bgrb', 'bggr', 'bggg', 'bggb', 'bgbr', 'bgbg', 'bgbb', 'bbrr', 'bbrg', 'bbrb', 'bbgr', 'bbgg', 'bbgb', 'bbbr', 'bbbg', 'bbbb'];\nconst VEC4_SWIZZLES = ['xw', 'yw', 'zw', 'wx', 'wy', 'wz', 'ww', 'xxw', 'xyw', 'xzw', 'xwx', 'xwy', 'xwz', 'xww', 'yxw', 'yyw', 'yzw', 'ywx', 'ywy', 'ywz', 'yww', 'zxw', 'zyw', 'zzw', 'zwx', 'zwy', 'zwz', 'zww', 'wxx', 'wxy', 'wxz', 'wxw', 'wyx', 'wyy', 'wyz', 'wyw', 'wzx', 'wzy', 'wzz', 'wzw', 'wwx', 'wwy', 'wwz', 'www', 'xxxw', 'xxyw', 'xxzw', 'xxwx', 'xxwy', 'xxwz', 'xxww', 'xyxw', 'xyyw', 'xyzw', 'xywx', 'xywy', 'xywz', 'xyww', 'xzxw', 'xzyw', 'xzzw', 'xzwx', 'xzwy', 'xzwz', 'xzww', 'xwxx', 'xwxy', 'xwxz', 'xwxw', 'xwyx', 'xwyy', 'xwyz', 'xwyw', 'xwzx', 'xwzy', 'xwzz', 'xwzw', 'xwwx', 'xwwy', 'xwwz', 'xwww', 'yxxw', 'yxyw', 'yxzw', 'yxwx', 'yxwy', 'yxwz', 'yxww', 'yyxw', 'yyyw', 'yyzw', 'yywx', 'yywy', 'yywz', 'yyww', 'yzxw', 'yzyw', 'yzzw', 'yzwx', 'yzwy', 'yzwz', 'yzww', 'ywxx', 'ywxy', 'ywxz', 'ywxw', 'ywyx', 'ywyy', 'ywyz', 'ywyw', 'ywzx', 'ywzy', 'ywzz', 'ywzw', 'ywwx', 'ywwy', 'ywwz', 'ywww', 'zxxw', 'zxyw', 'zxzw', 'zxwx', 'zxwy', 'zxwz', 'zxww', 'zyxw', 'zyyw', 'zyzw', 'zywx', 'zywy', 'zywz', 'zyww', 'zzxw', 'zzyw', 'zzzw', 'zzwx', 'zzwy', 'zzwz', 'zzww', 'zwxx', 'zwxy', 'zwxz', 'zwxw', 'zwyx', 'zwyy', 'zwyz', 'zwyw', 'zwzx', 'zwzy', 'zwzz', 'zwzw', 'zwwx', 'zwwy', 'zwwz', 'zwww', 'wxxx', 'wxxy', 'wxxz', 'wxxw', 'wxyx', 'wxyy', 'wxyz', 'wxyw', 'wxzx', 'wxzy', 'wxzz', 'wxzw', 'wxwx', 'wxwy', 'wxwz', 'wxww', 'wyxx', 'wyxy', 'wyxz', 'wyxw', 'wyyx', 'wyyy', 'wyyz', 'wyyw', 'wyzx', 'wyzy', 'wyzz', 'wyzw', 'wywx', 'wywy', 'wywz', 'wyww', 'wzxx', 'wzxy', 'wzxz', 'wzxw', 'wzyx', 'wzyy', 'wzyz', 'wzyw', 'wzzx', 'wzzy', 'wzzz', 'wzzw', 'wzwx', 'wzwy', 'wzwz', 'wzww', 'wwxx', 'wwxy', 'wwxz', 'wwxw', 'wwyx', 'wwyy', 'wwyz', 'wwyw', 'wwzx', 'wwzy', 'wwzz', 'wwzw', 'wwwx', 'wwwy', 'wwwz', 'wwww', 'ra', 'ga', 'ba', 'ar', 'ag', 'ab', 'aa', 'rra', 'rga', 'rba', 'rar', 'rag', 'rab', 'raa', 'gra', 'gga', 'gba', 'gar', 'gag', 'gab', 'gaa', 'bra', 'bga', 'bba', 'bar', 'bag', 'bab', 'baa', 'arr', 'arg', 'arb', 'ara', 'agr', 'agg', 'agb', 'aga', 'abr', 'abg', 'abb', 'aba', 'aar', 'aag', 'aab', 'aaa', 'rrra', 'rrga', 'rrba', 'rrar', 'rrag', 'rrab', 'rraa', 'rgra', 'rgga', 'rgba', 'rgar', 'rgag', 'rgab', 'rgaa', 'rbra', 'rbga', 'rbba', 'rbar', 'rbag', 'rbab', 'rbaa', 'rarr', 'rarg', 'rarb', 'rara', 'ragr', 'ragg', 'ragb', 'raga', 'rabr', 'rabg', 'rabb', 'raba', 'raar', 'raag', 'raab', 'raaa', 'grra', 'grga', 'grba', 'grar', 'grag', 'grab', 'graa', 'ggra', 'ggga', 'ggba', 'ggar', 'ggag', 'ggab', 'ggaa', 'gbra', 'gbga', 'gbba', 'gbar', 'gbag', 'gbab', 'gbaa', 'garr', 'garg', 'garb', 'gara', 'gagr', 'gagg', 'gagb', 'gaga', 'gabr', 'gabg', 'gabb', 'gaba', 'gaar', 'gaag', 'gaab', 'gaaa', 'brra', 'brga', 'brba', 'brar', 'brag', 'brab', 'braa', 'bgra', 'bgga', 'bgba', 'bgar', 'bgag', 'bgab', 'bgaa', 'bbra', 'bbga', 'bbba', 'bbar', 'bbag', 'bbab', 'bbaa', 'barr', 'barg', 'barb', 'bara', 'bagr', 'bagg', 'bagb', 'baga', 'babr', 'babg', 'babb', 'baba', 'baar', 'baag', 'baab', 'baaa', 'arrr', 'arrg', 'arrb', 'arra', 'argr', 'argg', 'argb', 'arga', 'arbr', 'arbg', 'arbb', 'arba', 'arar', 'arag', 'arab', 'araa', 'agrr', 'agrg', 'agrb', 'agra', 'aggr', 'aggg', 'aggb', 'agga', 'agbr', 'agbg', 'agbb', 'agba', 'agar', 'agag', 'agab', 'agaa', 'abrr', 'abrg', 'abrb', 'abra', 'abgr', 'abgg', 'abgb', 'abga', 'abbr', 'abbg', 'abbb', 'abba', 'abar', 'abag', 'abab', 'abaa', 'aarr', 'aarg', 'aarb', 'aara', 'aagr', 'aagg', 'aagb', 'aaga', 'aabr', 'aabg', 'aabb', 'aaba', 'aaar', 'aaag', 'aaab', 'aaaa'];\n// [/Swizzle Autogen]\nconst SWIZZLE_INDEX = {\n    x: 0, r: 0,\n    y: 1, g: 1,\n    z: 2, b: 2,\n    w: 3, a: 3,\n};\nfunction getSwizzleImpl(swizzle) {\n    switch (swizzle.length) {\n        case 2:\n            return function () { return new Vec2(this[SWIZZLE_INDEX[swizzle[0]]], this[SWIZZLE_INDEX[swizzle[1]]]); };\n        case 3:\n            return function () { return new Vec3(this[SWIZZLE_INDEX[swizzle[0]]], this[SWIZZLE_INDEX[swizzle[1]]], this[SWIZZLE_INDEX[swizzle[2]]]); };\n        case 4:\n            return function () { return new Vec4(this[SWIZZLE_INDEX[swizzle[0]]], this[SWIZZLE_INDEX[swizzle[1]]], this[SWIZZLE_INDEX[swizzle[2]]], this[SWIZZLE_INDEX[swizzle[3]]]); };\n    }\n}\nlet swizzlesEnabled = false;\n/**\n * Enables Swizzle operations on {@link Vec2}, {@link Vec3}, and {@link Vec4} types.\n *\n * Swizzle operations are performed by using the `.` operator in conjunction with any combination\n * of between two to four component names, either from the set `xyzw` or `rgbw` (though not intermixed).\n * They return a new vector with the same number of components as specified in the swizzle attribute.\n *\n * @example\n * ```js\n * import { Vec3, EnableSwizzles } from 'gl-matrix';\n *\n * EnableSwizzles();\n *\n * let v = new Vec3(0, 1, 2);\n *\n * v.yx // returns new Vec2(1, 0);\n * v.xzy // returns new Vec3(0, 2, 1);\n * v.zyxz // returns new Vec4(2, 1, 0, 2);\n *\n * v.rgb // returns new Vec3(0, 1, 2);\n * v.rbg // returns new Vec3(0, 2, 1);\n * v.gg // returns new Vec2(1, 1);\n * ```\n */\nfunction EnableSwizzles() {\n    if (swizzlesEnabled) {\n        return;\n    }\n    for (const swizzle of VEC2_SWIZZLES) {\n        const impl = getSwizzleImpl(swizzle);\n        Object.defineProperty(Vec2.prototype, swizzle, {\n            get: impl\n        });\n        Object.defineProperty(Vec3.prototype, swizzle, {\n            get: impl\n        });\n        Object.defineProperty(Vec4.prototype, swizzle, {\n            get: impl\n        });\n    }\n    for (const swizzle of VEC3_SWIZZLES) {\n        const impl = getSwizzleImpl(swizzle);\n        Object.defineProperty(Vec3.prototype, swizzle, {\n            get: impl\n        });\n        Object.defineProperty(Vec4.prototype, swizzle, {\n            get: impl\n        });\n    }\n    for (const swizzle of VEC4_SWIZZLES) {\n        const impl = getSwizzleImpl(swizzle);\n        Object.defineProperty(Vec4.prototype, swizzle, {\n            get: impl\n        });\n    }\n    swizzlesEnabled = true;\n}\n\nexport { EnableSwizzles, Mat2, Mat2d, Mat3, Mat4, Quat, Quat2, Vec2, Vec3, Vec4 };\n//# sourceMappingURL=index.js.map\n","/**\n * Awaits `requestAnimationFrame` calls by the counter specified. This allows asynchronous applications for direct /\n * inline style modification amongst other direct animation techniques.\n *\n * @param {number}   [cntr=1] - A positive integer greater than 0 for amount of requestAnimationFrames to wait.\n *\n * @returns {Promise<number>} Returns current time equivalent to `performance.now()`.\n */\nasync function nextAnimationFrame(cntr = 1)\n{\n   if (!Number.isInteger(cntr) || cntr < 1)\n   {\n      throw new TypeError(`nextAnimationFrame error: 'cntr' must be a positive integer greater than 0.`);\n   }\n\n   let currentTime = performance.now();\n   for (;--cntr >= 0;)\n   {\n      currentTime = await new Promise((resolve) => requestAnimationFrame(resolve));\n   }\n\n   return currentTime;\n}\n\nexport { nextAnimationFrame };\n//# sourceMappingURL=index.js.map\n","/**\n * Clamps a value between min / max values.\n *\n * @param {number}   value - Value to clamp.\n *\n * @param {number}   min - Minimum value.\n *\n * @param {number}   max - Maximum value.\n *\n * @returns {number} Clamped value.\n */\nfunction clamp(value = 0, min = 0, max = 0)\n{\n   return Math.min(Math.max(value, min), max);\n}\n\n/**\n * Converts the given number from degrees to radians.\n *\n * @param {number}   deg - Degree number to convert\n *\n * @returns {number} Degree as radians.\n */\nfunction degToRad(deg)\n{\n   return deg * (Math.PI / 180.0);\n}\n\n/**\n * Converts the given number from radians to degrees.\n *\n * @param {number}   rad - Radian number to convert.\n *\n * @returns {number} Degree as radians.\n */\nfunction radToDeg(rad)\n{\n   return rad * (180.0 / Math.PI);\n}\n\nexport { clamp, degToRad, radToDeg };\n//# sourceMappingURL=index.js.map\n","import { propertyStore } from '@typhonjs-fvtt/runtime/svelte/store/writable-derived';\nimport { isObject, isPlainObject, isIterable, hasSetter } from '@typhonjs-fvtt/runtime/util/object';\nimport { subscribeIgnoreFirst } from '@typhonjs-fvtt/runtime/util/store';\nimport { cubicOut, linear } from 'svelte/easing';\nimport { lerp } from '@typhonjs-fvtt/runtime/math/interpolate';\nimport { writable } from 'svelte/store';\nimport { StyleParse } from '@typhonjs-fvtt/runtime/util/browser';\nimport { Mat4, Vec3 } from '@typhonjs-fvtt/runtime/math/gl-matrix';\nimport { nextAnimationFrame } from '@typhonjs-fvtt/runtime/util/animate';\nimport { degToRad, clamp } from '@typhonjs-fvtt/runtime/math/util';\n\n/**\n * Provides a TJSBasicAnimation implementation for TJSPosition animation.\n */\nclass AnimationControl\n{\n   /** @type {object} */\n   #animationData;\n\n   /** @type {Promise<void>} */\n   #finishedPromise;\n\n   #willFinish;\n\n   /**\n    * Defines a static empty / void animation control.\n    *\n    * @type {AnimationControl}\n    */\n   static #voidControl = new AnimationControl(null);\n\n   /**\n    * Provides a static void / undefined AnimationControl that is automatically resolved.\n    *\n    * @returns {AnimationControl} Void AnimationControl\n    */\n   static get voidControl() { return this.#voidControl; }\n\n   /**\n    * @param {object|null} [animationData] - Animation data from {@link AnimationAPI}.\n    *\n    * @param {boolean}     [willFinish] - Promise that tracks animation finished state.\n    */\n   constructor(animationData, willFinish = false)\n   {\n      this.#animationData = animationData;\n      this.#willFinish = willFinish;\n\n      // Set this control to animation data.\n      if (isObject(animationData)) { animationData.control = this; }\n   }\n\n   /**\n    * Get a promise that resolves when animation is finished.\n    *\n    * @returns {Promise<void>}\n    */\n   get finished()\n   {\n      if (!(this.#finishedPromise instanceof Promise))\n      {\n         this.#finishedPromise = this.#willFinish ? new Promise((resolve) => this.#animationData.resolve = resolve) :\n          Promise.resolve();\n      }\n\n      return this.#finishedPromise;\n   }\n\n   /**\n    * Returns whether this animation is currently active / animating.\n    *\n    * Note: a delayed animation may not be started / active yet. Use {@link AnimationControl.isFinished} to determine\n    * if an animation is actually finished.\n    *\n    * @returns {boolean} Animation active state.\n    */\n   get isActive() { return this.#animationData.active; }\n\n   /**\n    * Returns whether this animation is completely finished.\n    *\n    * @returns {boolean} Animation finished state.\n    */\n   get isFinished() { return this.#animationData.finished; }\n\n   /**\n    * Cancels the animation.\n    */\n   cancel()\n   {\n      const animationData = this.#animationData;\n\n      if (animationData === null || animationData === void 0) { return; }\n\n      // Set cancelled state to true and this animation data instance will be removed from AnimationManager on next\n      // update.\n      animationData.cancelled = true;\n   }\n}\n\n/**\n * Provides animation management and scheduling allowing all TJSPosition instances to utilize one micro-task.\n */\nclass AnimationManager\n{\n   /**\n    * @type {object[]}\n    */\n   static activeList = [];\n\n   /**\n    * @type {object[]}\n    */\n   static newList = [];\n\n   /**\n    * @type {number}\n    */\n   static current;\n\n   /**\n    * Add animation data.\n    *\n    * @param {object}   data -\n    */\n   static add(data)\n   {\n      const now = performance.now();\n\n      // Offset start time by delta between last rAF time. This allows continuous tween cycles to appear naturally as\n      // starting from the instant they are added to the AnimationManager. This is what makes `draggable` smooth when\n      // easing is enabled.\n      data.start = now + (AnimationManager.current - now);\n\n      AnimationManager.newList.push(data);\n   }\n\n   /**\n    * Manage all animation\n    */\n   static animate()\n   {\n      const current = AnimationManager.current = performance.now();\n\n      // Early out of the rAF callback when there are no current animations.\n      if (AnimationManager.activeList.length === 0 && AnimationManager.newList.length === 0)\n      {\n         globalThis.requestAnimationFrame(AnimationManager.animate);\n         return;\n      }\n\n      if (AnimationManager.newList.length)\n      {\n         // Process new data\n         for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n         {\n            const data = AnimationManager.newList[cntr];\n\n            // If animation instance has been cancelled before start then remove it from new list and cleanup.\n            if (data.cancelled)\n            {\n               AnimationManager.newList.splice(cntr, 1);\n               data.cleanup(data);\n            }\n\n            // If data is active then process it now. Delayed animations start with `active` false.\n            if (data.active)\n            {\n               // Remove from new list and add to active list.\n               AnimationManager.newList.splice(cntr, 1);\n               AnimationManager.activeList.push(data);\n            }\n         }\n      }\n\n      // Process active animations.\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n\n         // Remove any animations that have been canceled.\n         // Ensure that the element is still connected otherwise remove it from active list and continue.\n         if (data.cancelled || (data.el !== void 0 && !data.el.isConnected))\n         {\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cleanup(data);\n            continue;\n         }\n\n         data.current = current - data.start;\n\n         // Remove this animation instance if current animating time exceeds duration.\n         if (data.current >= data.duration)\n         {\n            // Prepare final update with end position data.\n            for (let dataCntr = data.keys.length; --dataCntr >= 0;)\n            {\n               const key = data.keys[dataCntr];\n               data.newData[key] = data.destination[key];\n            }\n\n            data.position.set(data.newData);\n\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cleanup(data);\n\n            continue;\n         }\n\n         // Apply easing to create an eased time.\n         const easedTime = data.ease(data.current / data.duration);\n\n         for (let dataCntr = data.keys.length; --dataCntr >= 0;)\n         {\n            const key = data.keys[dataCntr];\n            data.newData[key] = data.interpolate(data.initial[key], data.destination[key], easedTime);\n         }\n\n         data.position.set(data.newData);\n      }\n\n      globalThis.requestAnimationFrame(AnimationManager.animate);\n   }\n\n   /**\n    * Cancels all animations for given TJSPosition instance.\n    *\n    * @param {import('../').TJSPosition} position - TJSPosition instance.\n    */\n   static cancel(position)\n   {\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         if (data.position === position)\n         {\n            AnimationManager.activeList.splice(cntr, 1);\n            data.cancelled = true;\n            data.cleanup(data);\n         }\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         if (data.position === position)\n         {\n            AnimationManager.newList.splice(cntr, 1);\n            data.cancelled = true;\n            data.cleanup(data);\n         }\n      }\n   }\n\n   /**\n    * Cancels all active and delayed animations.\n    */\n   static cancelAll()\n   {\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         data.cancelled = true;\n         data.cleanup(data);\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         data.cancelled = true;\n         data.cleanup(data);\n      }\n\n      AnimationManager.activeList.length = 0;\n      AnimationManager.newList.length = 0;\n   }\n\n   /**\n    * Gets all {@link AnimationControl} instances for a given TJSPosition instance.\n    *\n    * @param {import('../index.js').TJSPosition} position - TJSPosition instance.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation[]} All scheduled AnimationControl instances for the\n    *          given TJSPosition instance.\n    */\n   static getScheduled(position)\n   {\n      const results = [];\n\n      for (let cntr = AnimationManager.activeList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.activeList[cntr];\n         if (data.position === position)\n         {\n            results.push(data.control);\n         }\n      }\n\n      for (let cntr = AnimationManager.newList.length; --cntr >= 0;)\n      {\n         const data = AnimationManager.newList[cntr];\n         if (data.position === position)\n         {\n            results.push(data.control);\n         }\n      }\n\n      return results;\n   }\n}\n\n// Start animation manager immediately. It constantly is running in background.\nAnimationManager.animate();\n\n/**\n * Stores the TJSPositionData properties that can be animated.\n *\n * @type {Set<string>}\n */\nconst animateKeys = new Set([\n   // Main keys\n   'left', 'top', 'maxWidth', 'maxHeight', 'minWidth', 'minHeight', 'width', 'height',\n   'rotateX', 'rotateY', 'rotateZ', 'scale', 'translateX', 'translateY', 'translateZ', 'zIndex',\n\n   // Aliases\n   'rotation'\n]);\n\n/**\n * Defines the keys of TJSPositionData that are transform keys.\n *\n * @type {string[]}\n */\nconst transformKeys = ['rotateX', 'rotateY', 'rotateZ', 'scale', 'translateX', 'translateY', 'translateZ'];\n\nObject.freeze(transformKeys);\n\n/**\n * Parses a relative value string in the form of '+=', '-=', or '*=' and float / numeric value. IE '+=0.2'.\n *\n * @type {RegExp}\n */\nconst relativeRegex = /^([-+*])=(-?[\\d]*\\.?[\\d]+)$/;\n\n/**\n * Provides numeric defaults for all parameters. This is used by {@link TJSPosition.get} to optionally\n * provide numeric defaults.\n *\n * @type {{rotation: number, scale: number, minWidth: null, minHeight: null, translateZ: number, top: number, left: number, maxHeight: null, translateY: number, translateX: number, width: number, transformOrigin: null, rotateX: number, rotateY: number, height: number, maxWidth: null, zIndex: null, rotateZ: number}}\n */\nconst numericDefaults = {\n   // Other keys\n   height: 0,\n   left: 0,\n   maxHeight: null,\n   maxWidth: null,\n   minHeight: null,\n   minWidth: null,\n   top: 0,\n   transformOrigin: null,\n   width: 0,\n   zIndex: null,\n\n   rotateX: 0,\n   rotateY: 0,\n   rotateZ: 0,\n   scale: 1,\n   translateX: 0,\n   translateY: 0,\n   translateZ: 0,\n\n   rotation: 0\n};\n\nObject.freeze(numericDefaults);\n\n/**\n * Sets numeric defaults for a {@link TJSPositionData} like object.\n *\n * @param {object}   data - A TJSPositionData like object.\n */\nfunction setNumericDefaults(data)\n{\n   // Transform keys\n   if (data.rotateX === null) { data.rotateX = 0; }\n   if (data.rotateY === null) { data.rotateY = 0; }\n   if (data.rotateZ === null) { data.rotateZ = 0; }\n   if (data.translateX === null) { data.translateX = 0; }\n   if (data.translateY === null) { data.translateY = 0; }\n   if (data.translateZ === null) { data.translateZ = 0; }\n   if (data.scale === null) { data.scale = 1; }\n\n   // Aliases\n   if (data.rotation === null) { data.rotation = 0; }\n}\n\n/**\n * Defines bitwise keys for transforms used in {@link TJSTransforms.getMat4}.\n *\n * @type {object}\n */\nconst transformKeysBitwise = {\n   rotateX: 1,\n   rotateY: 2,\n   rotateZ: 4,\n   scale: 8,\n   translateX: 16,\n   translateY: 32,\n   translateZ: 64\n};\n\nObject.freeze(transformKeysBitwise);\n\n/**\n * Defines the default transform origin.\n *\n * @type {string}\n */\nconst transformOriginDefault = 'top left';\n\n/**\n * Defines the valid transform origins.\n *\n * @type {string[]}\n */\nconst transformOrigins = ['top left', 'top center', 'top right', 'center left', 'center', 'center right', 'bottom left',\n 'bottom center', 'bottom right'];\n\nObject.freeze(transformOrigins);\n\n/**\n * Converts any relative string values for animatable keys to actual updates performed against current data.\n *\n * @param {import('./').TJSPositionDataExtended}    positionData - position data.\n *\n * @param {import('./').TJSPosition | import('./').TJSPositionData}   position - The source position instance.\n */\nfunction convertRelative(positionData, position)\n{\n   for (const key in positionData)\n   {\n      // Key is animatable / numeric.\n      if (animateKeys.has(key))\n      {\n         const value = positionData[key];\n\n         if (typeof value !== 'string') { continue; }\n\n         // Ignore 'auto' and 'inherit' string values.\n         if (value === 'auto' || value === 'inherit') { continue; }\n\n         const regexResults = relativeRegex.exec(value);\n\n         if (!regexResults)\n         {\n            throw new Error(\n             `convertRelative error: malformed relative key (${key}) with value (${value})`);\n         }\n\n         const current = position[key];\n\n         switch (regexResults[1])\n         {\n            case '-':\n               positionData[key] = current - parseFloat(regexResults[2]);\n               break;\n\n            case '+':\n               positionData[key] = current + parseFloat(regexResults[2]);\n               break;\n\n            case '*':\n               positionData[key] = current * parseFloat(regexResults[2]);\n               break;\n         }\n      }\n   }\n}\n\nclass AnimationAPI\n{\n   /** @type {import('../').TJSPositionData} */\n   #data;\n\n   /** @type {import('../').TJSPosition} */\n   #position;\n\n   /**\n    * Tracks the number of animation control instances that are active.\n    *\n    * @type {number}\n    */\n   #instanceCount = 0;\n\n   /**\n    * Provides a bound function to pass as data to AnimationManager to invoke `AnimationAPI.#cleanupInstance`.\n    *\n    * @type {Function}\n    */\n   #cleanup;\n\n   /**\n    * @param {import('../index.js').TJSPosition}       position -\n    *\n    * @param {import('../index.js').TJSPositionData}   data -\n    */\n   constructor(position, data)\n   {\n      this.#position = position;\n      this.#data = data;\n\n      this.#cleanup = this.#cleanupInstance.bind(this);\n   }\n\n   /**\n    * Returns whether there are scheduled animations whether active or delayed for this TJSPosition.\n    *\n    * @returns {boolean} Are there active animation instances.\n    */\n   get isScheduled()\n   {\n      return this.#instanceCount > 0;\n   }\n\n   /**\n    * Adds / schedules an animation w/ the AnimationManager. This contains the final steps common to all tweens.\n    *\n    * @param {object}      initial -\n    *\n    * @param {object}      destination -\n    *\n    * @param {number}      duration -\n    *\n    * @param {HTMLElement} el -\n    *\n    * @param {number}      delay -\n    *\n    * @param {Function}    ease -\n    *\n    * @param {Function}    interpolate -\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation} The associated animation control.\n    */\n   #addAnimation(initial, destination, duration, el, delay, ease, interpolate)\n   {\n      // Set initial data for transform values that are often null by default.\n      setNumericDefaults(initial);\n      setNumericDefaults(destination);\n\n      // Reject all initial data that is not a number.\n      for (const key in initial)\n      {\n         if (!Number.isFinite(initial[key])) { delete initial[key]; }\n      }\n\n      const keys = Object.keys(initial);\n      const newData = Object.assign({ immediateElementUpdate: true }, initial);\n\n      // Nothing to animate, so return now.\n      if (keys.length === 0) { return AnimationControl.voidControl; }\n\n      const animationData = {\n         active: true,\n         cleanup: this.#cleanup,\n         cancelled: false,\n         control: void 0,\n         current: 0,\n         destination,\n         duration: duration * 1000, // Internally the AnimationManager works in ms.\n         ease,\n         el,\n         finished: false,\n         initial,\n         interpolate,\n         keys,\n         newData,\n         position: this.#position,\n         resolve: void 0,\n         start: void 0\n      };\n\n      if (delay > 0)\n      {\n         animationData.active = false;\n\n         // Delay w/ setTimeout and schedule w/ AnimationManager if not already canceled\n         setTimeout(() =>\n         {\n            if (!animationData.cancelled)\n            {\n               animationData.active = true;\n\n               const now = performance.now();\n\n               // Offset start time by delta between last rAF time. This allows a delayed tween to start from the\n               // precise delayed time.\n               animationData.start = now + (AnimationManager.current - now);\n            }\n         }, delay * 1000);\n      }\n\n      // Schedule immediately w/ AnimationManager\n      this.#instanceCount++;\n      AnimationManager.add(animationData);\n\n      // Create animation control\n      return new AnimationControl(animationData, true);\n   }\n\n   /**\n    * Cancels all animation instances for this TJSPosition instance.\n    */\n   cancel()\n   {\n      AnimationManager.cancel(this.#position);\n   }\n\n   /**\n    * Cleans up an animation instance.\n    *\n    * @param {object}   data - Animation data for an animation instance.\n    */\n   #cleanupInstance(data)\n   {\n      this.#instanceCount--;\n\n      data.active = false;\n      data.finished = true;\n\n      if (typeof data.resolve === 'function') { data.resolve(data.cancelled); }\n   }\n\n   /**\n    * Returns all currently scheduled AnimationControl instances for this TJSPosition instance.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation[]} All currently scheduled animation controls for\n    *          this TJSPosition instance.\n    */\n   getScheduled()\n   {\n      return AnimationManager.getScheduled(this.#position);\n   }\n\n   /**\n    * Provides a tween from given position data to the current position.\n    *\n    * @param {import('../index.js').TJSPositionDataExtended} fromData - The starting position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation}  A control object that can cancel animation and\n    *          provides a `finished` Promise.\n    */\n   from(fromData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(fromData))\n      {\n         throw new TypeError(`AnimationAPI.from error: 'fromData' is not an object.`);\n      }\n\n      const position = this.#position;\n      const parent = position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.from error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.from error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.from error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.from error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in fromData)\n      {\n         if (data[key] !== void 0 && fromData[key] !== data[key])\n         {\n            initial[key] = fromData[key];\n            destination[key] = data[key];\n         }\n      }\n\n      convertRelative(initial, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Provides a tween from given position data to the current position.\n    *\n    * @param {import('../index.js').TJSPositionDataExtended} fromData - The starting position.\n    *\n    * @param {import('../index.js').TJSPositionDataExtended} toData - The ending position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation}  A control object that can cancel animation and\n    *          provides a `finished` Promise.\n    */\n   fromTo(fromData, toData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(fromData))\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'fromData' is not an object.`);\n      }\n\n      if (!isObject(toData))\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'toData' is not an object.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.fromTo error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in fromData)\n      {\n         if (toData[key] === void 0)\n         {\n            console.warn(\n             `AnimationAPI.fromTo warning: key ('${key}') from 'fromData' missing in 'toData'; skipping this key.`);\n            continue;\n         }\n\n         if (data[key] !== void 0)\n         {\n            initial[key] = fromData[key];\n            destination[key] = toData[key];\n         }\n      }\n\n      convertRelative(initial, data);\n      convertRelative(destination, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Provides a tween to given position data from the current position.\n    *\n    * @param {import('../index.js').TJSPositionDataExtended} toData - The destination position.\n    *\n    * @param {object}         [opts] - Optional parameters.\n    *\n    * @param {number}         [opts.delay=0] - Delay in seconds before animation starts.\n    *\n    * @param {number}         [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}       [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}       [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation}  A control object that can cancel animation and\n    *          provides a `finished` Promise.\n    */\n   to(toData, { delay = 0, duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isObject(toData))\n      {\n         throw new TypeError(`AnimationAPI.to error: 'toData' is not an object.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return AnimationControl.voidControl;\n      }\n\n      // Cache any target element allowing AnimationManager to stop animation if it becomes disconnected from DOM.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      if (!Number.isFinite(delay) || delay < 0)\n      {\n         throw new TypeError(`AnimationAPI.to error: 'delay' is not a positive number.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.to error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.to error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.to error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key in toData)\n      {\n         if (data[key] !== void 0 && toData[key] !== data[key])\n         {\n            destination[key] = toData[key];\n            initial[key] = data[key];\n         }\n      }\n\n      convertRelative(destination, data);\n\n      return this.#addAnimation(initial, destination, duration, el, delay, ease, interpolate);\n   }\n\n   /**\n    * Returns a function that provides an optimized way to constantly update a to-tween.\n    *\n    * @param {Iterable<string>}  keys - The keys for quickTo.\n    *\n    * @param {object}            [opts] - Optional parameters.\n    *\n    * @param {number}            [opts.duration=1] - Duration in seconds.\n    *\n    * @param {Function}          [opts.ease=cubicOut] - Easing function.\n    *\n    * @param {Function}          [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('../index.js').quickToCallback} quick-to tween function.\n    */\n   quickTo(keys, { duration = 1, ease = cubicOut, interpolate = lerp } = {})\n   {\n      if (!isIterable(keys))\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'keys' is not an iterable list.`);\n      }\n\n      const parent = this.#position.parent;\n\n      // Early out if the application is not positionable.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         throw new Error(`AnimationAPI.quickTo error: 'parent' is not positionable.`);\n      }\n\n      if (!Number.isFinite(duration) || duration < 0)\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'duration' is not a positive number.`);\n      }\n\n      if (typeof ease !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'ease' is not a function.`);\n      }\n\n      if (typeof interpolate !== 'function')\n      {\n         throw new TypeError(`AnimationAPI.quickTo error: 'interpolate' is not a function.`);\n      }\n\n      const initial = {};\n      const destination = {};\n\n      const data = this.#data;\n\n      // Set initial data if the key / data is defined and the end position is not equal to current data.\n      for (const key of keys)\n      {\n         if (typeof key !== 'string')\n         {\n            throw new TypeError(`AnimationAPI.quickTo error: key is not a string.`);\n         }\n\n         if (!animateKeys.has(key))\n         {\n            throw new Error(`AnimationAPI.quickTo error: key ('${key}') is not animatable.`);\n         }\n\n         if (data[key] !== void 0)\n         {\n            destination[key] = data[key];\n            initial[key] = data[key];\n         }\n      }\n\n      const keysArray = [...keys];\n\n      Object.freeze(keysArray);\n\n      const newData = Object.assign({ immediateElementUpdate: true }, initial);\n\n      const animationData = {\n         active: true,\n         cleanup: this.#cleanup,\n         cancelled: false,\n         control: void 0,\n         current: 0,\n         destination,\n         duration: duration * 1000, // Internally the AnimationManager works in ms.\n         ease,\n         el: void 0,\n         finished: true, // Note: start in finished state to add to AnimationManager on first callback.\n         initial,\n         interpolate,\n         keys,\n         newData,\n         position: this.#position,\n         resolve: void 0,\n         start: void 0\n      };\n\n      const quickToCB = (...args) =>\n      {\n         const argsLength = args.length;\n\n         if (argsLength === 0) { return; }\n\n         for (let cntr = keysArray.length; --cntr >= 0;)\n         {\n            const key = keysArray[cntr];\n            if (data[key] !== void 0) { initial[key] = data[key]; }\n         }\n\n         // Handle case where the first arg is an object. Update all quickTo keys from data contained in the object.\n         if (isObject(args[0]))\n         {\n            const objData = args[0];\n\n            for (const key in objData)\n            {\n               if (destination[key] !== void 0) { destination[key] = objData[key]; }\n            }\n         }\n         else // Assign each variable argument to the key specified in the initial `keys` array above.\n         {\n            for (let cntr = 0; cntr < argsLength && cntr < keysArray.length; cntr++)\n            {\n               const key = keysArray[cntr];\n               if (destination[key] !== void 0) { destination[key] = args[cntr]; }\n            }\n         }\n\n         convertRelative(destination, data);\n\n         // Set initial data for transform values that are often null by default.\n         setNumericDefaults(initial);\n         setNumericDefaults(destination);\n\n         // Set target element to animation data to track if it is removed from the DOM hence ending the animation.\n         const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n         animationData.el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n         // Reschedule the quickTo animation with AnimationManager as it is finished.\n         if (animationData.finished)\n         {\n            animationData.finished = false;\n            animationData.active = true;\n            animationData.current = 0;\n\n            this.#instanceCount++;\n            AnimationManager.add(animationData);\n         }\n         else // QuickTo animation is currently scheduled w/ AnimationManager so reset start and current time.\n         {\n            const now = performance.now();\n\n            // Offset start time by delta between last rAF time. This allows a delayed tween to start from the\n            // precise delayed time.\n            animationData.start = now + (AnimationManager.current - now);\n            animationData.current = 0;\n         }\n      };\n\n      quickToCB.keys = keysArray;\n\n      /**\n       * Sets options of quickTo tween.\n       *\n       * @param {object}            [opts] - Optional parameters.\n       *\n       * @param {number}            [opts.duration] - Duration in seconds.\n       *\n       * @param {Function}          [opts.ease] - Easing function.\n       *\n       * @param {Function}          [opts.interpolate] - Interpolation function.\n       *\n       * @returns {import('../').quickToCallback} The quickTo callback.\n       */\n      quickToCB.options = ({ duration, ease, interpolate } = {}) => // eslint-disable-line no-shadow\n      {\n         if (duration !== void 0 && (!Number.isFinite(duration) || duration < 0))\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'duration' is not a positive number.`);\n         }\n\n         if (ease !== void 0 && typeof ease !== 'function')\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'ease' is not a function.`);\n         }\n\n         if (interpolate !== void 0 && typeof interpolate !== 'function')\n         {\n            throw new TypeError(`AnimationAPI.quickTo.options error: 'interpolate' is not a function.`);\n         }\n\n         if (duration >= 0) { animationData.duration = duration * 1000; }\n         if (ease) { animationData.ease = ease; }\n         if (interpolate) { animationData.interpolate = interpolate; }\n\n         return quickToCB;\n      };\n\n      return quickToCB;\n   }\n}\n\n/**\n * Provides a TJSBasicAnimation implementation for a TJSPosition animation for a group of TJSPosition instances.\n */\nclass AnimationGroupControl\n{\n   /** @type {import('./AnimationControl').AnimationControl[]} */\n   #animationControls;\n\n   /** @type {Promise<Awaited<unknown>[]>} */\n   #finishedPromise;\n\n   /**\n    * Defines a static empty / void animation control.\n    *\n    * @type {AnimationGroupControl}\n    */\n   static #voidControl = new AnimationGroupControl(null);\n\n   /**\n    * Provides a static void / undefined AnimationGroupControl that is automatically resolved.\n    *\n    * @returns {AnimationGroupControl} Void AnimationGroupControl\n    */\n   static get voidControl() { return this.#voidControl; }\n\n   /**\n    * @param {import('./AnimationControl').AnimationControl[]} animationControls - An array of AnimationControl\n    *        instances.\n    */\n   constructor(animationControls)\n   {\n      this.#animationControls = animationControls;\n   }\n\n   /**\n    * Get a promise that resolves when all animations are finished.\n    *\n    * @returns {Promise<Awaited<unknown>[]>|Promise<void>} Finished Promise for all animations.\n    */\n   get finished()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return Promise.resolve(); }\n\n      if (!(this.#finishedPromise instanceof Promise))\n      {\n         const promises = [];\n         for (let cntr = animationControls.length; --cntr >= 0;)\n         {\n            promises.push(animationControls[cntr].finished);\n         }\n\n         this.#finishedPromise = Promise.all(promises);\n      }\n\n      return this.#finishedPromise;\n   }\n\n   /**\n    * Returns whether there are active animation instances for this group.\n    *\n    * Note: a delayed animation may not be started / active yet. Use {@link AnimationGroupControl.isFinished} to\n    * determine if all animations in the group are finished.\n    *\n    * @returns {boolean} Are there active animation instances.\n    */\n   get isActive()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return false; }\n\n      for (let cntr = animationControls.length; --cntr >= 0;)\n      {\n         if (animationControls[cntr].isActive) { return true; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Returns whether all animations in the group are finished.\n    *\n    * @returns {boolean} Are all animation instances finished.\n    */\n   get isFinished()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return true; }\n\n      for (let cntr = animationControls.length; --cntr >= 0;)\n      {\n         if (!animationControls[cntr].isFinished) { return false; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Cancels the all animations.\n    */\n   cancel()\n   {\n      const animationControls = this.#animationControls;\n\n      if (animationControls === null || animationControls === void 0) { return; }\n\n      for (let cntr = this.#animationControls.length; --cntr >= 0;)\n      {\n         this.#animationControls[cntr].cancel();\n      }\n   }\n}\n\n/**\n * Provides a public API for grouping multiple {@link TJSPosition} animations together with the\n * AnimationManager.\n *\n * Note: To remove cyclic dependencies as this class provides the TJSPosition static / group Animation API `instanceof`\n * checks are not done against TJSPosition. Instead, a check for the animate property being an instanceof\n * {@link AnimationAPI} is performed in {@link AnimationGroupAPI.#isPosition}.\n *\n * @see AnimationAPI\n */\nclass AnimationGroupAPI\n{\n   /**\n    * Checks of the given object is a TJSPosition instance by checking for AnimationAPI.\n    *\n    * @param {*}  object - Any data.\n    *\n    * @returns {boolean} Is TJSPosition.\n    */\n   static #isPosition(object)\n   {\n      return isObject(object) && object.animate instanceof AnimationAPI;\n   }\n\n   /**\n    * Cancels any animation for given TJSPosition data.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    */\n   static cancel(position)\n   {\n      if (isIterable(position))\n      {\n         let index = -1;\n\n         for (const entry of position)\n         {\n            index++;\n\n            const actualPosition = this.#isPosition(entry) ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.cancel warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            AnimationManager.cancel(actualPosition);\n         }\n      }\n      else\n      {\n         const actualPosition = this.#isPosition(position) ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.cancel warning: No Position instance found.`);\n            return;\n         }\n\n         AnimationManager.cancel(actualPosition);\n      }\n   }\n\n   /**\n    * Cancels all TJSPosition animation.\n    */\n   static cancelAll() { AnimationManager.cancelAll(); }\n\n   /**\n    * Gets all animation controls for the given position data.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @returns {{ position: import('../').TJSPosition, data: object | void, controls: import('./AnimationControl').AnimationControl[]}[]} Results array.\n    */\n   static getScheduled(position)\n   {\n      const results = [];\n\n      if (isIterable(position))\n      {\n         let index = -1;\n\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.getScheduled warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            const controls = AnimationManager.getScheduled(actualPosition);\n\n            results.push({ position: actualPosition, data: isPosition ? void 0 : entry, controls });\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.getScheduled warning: No Position instance found.`);\n            return results;\n         }\n\n         const controls = AnimationManager.getScheduled(actualPosition);\n\n         results.push({ position: actualPosition, data: isPosition ? void 0 : position, controls });\n      }\n\n      return results;\n   }\n\n   /**\n    * Provides the `from` animation tween for one or more TJSPosition instances as a group.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @param {object|Function}   fromData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation} Basic animation control.\n    */\n   static from(position, fromData, options)\n   {\n      if (!isObject(fromData) && typeof fromData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.from error: 'fromData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.from error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {import('./AnimationControl').AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasDataCallback = typeof fromData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasDataCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualFromData = fromData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.from warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasDataCallback)\n            {\n               actualFromData = fromData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualFromData === null || actualFromData === void 0) { continue; }\n\n               if (!isObject(actualFromData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.from error: fromData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(`AnimationGroupAPI.from error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.from(actualFromData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.from warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasDataCallback)\n         {\n            actualFromData = fromData(callbackOptions);\n\n            if (!isObject(actualFromData))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.from error: fromData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (!isObject(actualOptions))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.from error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.from(actualFromData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `fromTo` animation tween for one or more TJSPosition instances as a group.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @param {object|Function}   fromData -\n    *\n    * @param {object|Function}   toData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation} Basic animation control.\n    */\n   static fromTo(position, fromData, toData, options)\n   {\n      if (!isObject(fromData) && typeof fromData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'fromData' is not an object or function.`);\n      }\n\n      if (!isObject(toData) && typeof toData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'toData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.fromTo error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {import('./AnimationControl').AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasFromCallback = typeof fromData === 'function';\n      const hasToCallback = typeof toData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasFromCallback || hasToCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualFromData = fromData;\n      let actualToData = toData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.fromTo warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasFromCallback)\n            {\n               actualFromData = fromData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualFromData === null || actualFromData === void 0) { continue; }\n\n               if (!isObject(actualFromData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: fromData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasToCallback)\n            {\n               actualToData = toData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualToData === null || actualToData === void 0) { continue; }\n\n               if (!isObject(actualToData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: toData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(`AnimationGroupAPI.fromTo error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.fromTo(actualFromData, actualToData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.fromTo warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasFromCallback)\n         {\n            actualFromData = fromData(callbackOptions);\n\n            if (!isObject(actualFromData))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: fromData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasToCallback)\n         {\n            actualToData = toData(callbackOptions);\n\n            if (!isObject(actualToData))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: toData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (!isObject(actualOptions))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.fromTo error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.fromTo(actualFromData, actualToData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `to` animation tween for one or more TJSPosition instances as a group.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @param {object|Function}   toData -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {import('#runtime/util/animate').TJSBasicAnimation} Basic animation control.\n    */\n   static to(position, toData, options)\n   {\n      if (!isObject(toData) && typeof toData !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.to error: 'toData' is not an object or function.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.to error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {import('./AnimationControl').AnimationControl[]}\n       */\n      const animationControls = [];\n\n      let index = -1;\n      let callbackOptions;\n\n      const hasDataCallback = typeof toData === 'function';\n      const hasOptionCallback = typeof options === 'function';\n      const hasCallback = hasDataCallback || hasOptionCallback;\n\n      if (hasCallback) { callbackOptions = { index, position: void 0, data: void 0 }; }\n\n      let actualToData = toData;\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.to warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            if (hasCallback)\n            {\n               callbackOptions.index = index;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : entry;\n            }\n\n            if (hasDataCallback)\n            {\n               actualToData = toData(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualToData === null || actualToData === void 0) { continue; }\n\n               if (!isObject(actualToData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.to error: toData callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(`AnimationGroupAPI.to error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            animationControls.push(actualPosition.animate.to(actualToData, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.to warning: No Position instance found.`);\n            return AnimationGroupControl.voidControl;\n         }\n\n         if (hasCallback)\n         {\n            callbackOptions.index = 0;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : position;\n         }\n\n         if (hasDataCallback)\n         {\n            actualToData = toData(callbackOptions);\n\n            if (!isObject(actualToData))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.to error: toData callback function failed to return an object.`);\n            }\n         }\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (!isObject(actualOptions))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.to error: options callback function failed to return an object.`);\n            }\n         }\n\n         animationControls.push(actualPosition.animate.to(actualToData, actualOptions));\n      }\n\n      return new AnimationGroupControl(animationControls);\n   }\n\n   /**\n    * Provides the `to` animation tween for one or more TJSPosition instances as a group.\n    *\n    * @param {import('../').TJSPosition | {position: import('../').TJSPosition} | Iterable<import('../').TJSPosition> | Iterable<{position: import('../').TJSPosition}>} position -\n    *\n    * @param {Iterable<string>}  keys -\n    *\n    * @param {object|Function}   options -\n    *\n    * @returns {import('../').quickToCallback} Basic animation control.\n    */\n   static quickTo(position, keys, options)\n   {\n      if (!isIterable(keys))\n      {\n         throw new TypeError(`AnimationGroupAPI.quickTo error: 'keys' is not an iterable list.`);\n      }\n\n      if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n      {\n         throw new TypeError(`AnimationGroupAPI.quickTo error: 'options' is not an object or function.`);\n      }\n\n      /**\n       * @type {import('../').quickToCallback[]}\n       */\n      const quickToCallbacks = [];\n\n      let index = -1;\n\n      const hasOptionCallback = typeof options === 'function';\n\n      const callbackOptions = { index, position: void 0, data: void 0 };\n\n      let actualOptions = options;\n\n      if (isIterable(position))\n      {\n         for (const entry of position)\n         {\n            index++;\n\n            const isPosition = this.#isPosition(entry);\n            const actualPosition = isPosition ? entry : entry.position;\n\n            if (!this.#isPosition(actualPosition))\n            {\n               console.warn(`AnimationGroupAPI.quickTo warning: No Position instance found at index: ${index}.`);\n               continue;\n            }\n\n            callbackOptions.index = index;\n            callbackOptions.position = position;\n            callbackOptions.data = isPosition ? void 0 : entry;\n\n            if (hasOptionCallback)\n            {\n               actualOptions = options(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (actualOptions === null || actualOptions === void 0) { continue; }\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(`AnimationGroupAPI.quickTo error: options callback function iteration(${\n                   index}) failed to return an object.`);\n               }\n            }\n\n            quickToCallbacks.push(actualPosition.animate.quickTo(keys, actualOptions));\n         }\n      }\n      else\n      {\n         const isPosition = this.#isPosition(position);\n         const actualPosition = isPosition ? position : position.position;\n\n         if (!this.#isPosition(actualPosition))\n         {\n            console.warn(`AnimationGroupAPI.quickTo warning: No Position instance found.`);\n            return () => null;\n         }\n\n         callbackOptions.index = 0;\n         callbackOptions.position = position;\n         callbackOptions.data = isPosition ? void 0 : position;\n\n         if (hasOptionCallback)\n         {\n            actualOptions = options(callbackOptions);\n\n            if (!isObject(actualOptions))\n            {\n               throw new TypeError(\n                `AnimationGroupAPI.quickTo error: options callback function failed to return an object.`);\n            }\n         }\n\n         quickToCallbacks.push(actualPosition.animate.quickTo(keys, actualOptions));\n      }\n\n      const keysArray = [...keys];\n\n      Object.freeze(keysArray);\n\n      const quickToCB = (...args) =>\n      {\n         const argsLength = args.length;\n\n         if (argsLength === 0) { return; }\n\n         if (typeof args[0] === 'function')\n         {\n            const dataCallback = args[0];\n\n            index = -1;\n            let cntr = 0;\n\n            if (isIterable(position))\n            {\n               for (const entry of position)\n               {\n                  index++;\n\n                  const isPosition = this.#isPosition(entry);\n                  const actualPosition = isPosition ? entry : entry.position;\n\n                  if (!this.#isPosition(actualPosition)) { continue; }\n\n                  callbackOptions.index = index;\n                  callbackOptions.position = position;\n                  callbackOptions.data = isPosition ? void 0 : entry;\n\n                  const toData = dataCallback(callbackOptions);\n\n                  // Returned data from callback is null / undefined, so skip this position instance.\n                  if (toData === null || toData === void 0) { continue; }\n\n                  /**\n                   * @type {boolean}\n                   */\n                  const toDataIterable = isIterable(toData);\n\n                  if (!Number.isFinite(toData) && !toDataIterable && !isObject(toData))\n                  {\n                     throw new TypeError(`AnimationGroupAPI.quickTo error: toData callback function iteration(${\n                      index}) failed to return a finite number, iterable list, or object.`);\n                  }\n\n                  if (toDataIterable)\n                  {\n                     quickToCallbacks[cntr++](...toData);\n                  }\n                  else\n                  {\n                     quickToCallbacks[cntr++](toData);\n                  }\n               }\n            }\n            else\n            {\n               const isPosition = this.#isPosition(position);\n               const actualPosition = isPosition ? position : position.position;\n\n               if (!this.#isPosition(actualPosition)) { return; }\n\n               callbackOptions.index = 0;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : position;\n\n               const toData = dataCallback(callbackOptions);\n\n               // Returned data from callback is null / undefined, so skip this position instance.\n               if (toData === null || toData === void 0) { return; }\n\n               const toDataIterable = isIterable(toData);\n\n               if (!Number.isFinite(toData) && !toDataIterable && !isObject(toData))\n               {\n                  throw new TypeError(`AnimationGroupAPI.quickTo error: toData callback function iteration(${\n                   index}) failed to return a finite number, iterable list, or object.`);\n               }\n\n               if (toDataIterable)\n               {\n                  quickToCallbacks[cntr++](...toData);\n               }\n               else\n               {\n                  quickToCallbacks[cntr++](toData);\n               }\n            }\n         }\n         else\n         {\n            for (let cntr = quickToCallbacks.length; --cntr >= 0;)\n            {\n               quickToCallbacks[cntr](...args);\n            }\n         }\n      };\n\n      quickToCB.keys = keysArray;\n\n      /**\n       * Sets options of quickTo tween.\n       *\n       * @param {object|Function}   [options] - Optional parameters.\n       *\n       * @param {number}            [options.duration] - Duration in seconds.\n       *\n       * @param {Function}          [options.ease] - Easing function.\n       *\n       * @param {Function}          [options.interpolate] - Interpolation function.\n       *\n       * @returns {import('../').quickToCallback} The quickTo callback.\n       */\n      quickToCB.options = (options) => // eslint-disable-line no-shadow\n      {\n         if (options !== void 0 && !isObject(options) && typeof options !== 'function')\n         {\n            throw new TypeError(`AnimationGroupAPI.quickTo error: 'options' is not an object or function.`);\n         }\n\n         // Set options object for each quickTo callback.\n         if (isObject(options))\n         {\n            for (let cntr = quickToCallbacks.length; --cntr >= 0;) { quickToCallbacks[cntr].options(options); }\n         }\n         else if (typeof options === 'function')\n         {\n            if (isIterable(position))\n            {\n               index = -1;\n               let cntr = 0;\n\n               for (const entry of position)\n               {\n                  index++;\n\n                  const isPosition = this.#isPosition(entry);\n                  const actualPosition = isPosition ? entry : entry.position;\n\n                  if (!this.#isPosition(actualPosition))\n                  {\n                     console.warn(\n                      `AnimationGroupAPI.quickTo.options warning: No Position instance found at index: ${index}.`);\n                     continue;\n                  }\n\n                  callbackOptions.index = index;\n                  callbackOptions.position = position;\n                  callbackOptions.data = isPosition ? void 0 : entry;\n\n                  actualOptions = options(callbackOptions);\n\n                  // Returned data from callback is null / undefined, so skip this position instance.\n                  if (actualOptions === null || actualOptions === void 0) { continue; }\n\n                  if (!isObject(actualOptions))\n                  {\n                     throw new TypeError(\n                      `AnimationGroupAPI.quickTo.options error: options callback function iteration(${\n                       index}) failed to return an object.`);\n                  }\n\n                  quickToCallbacks[cntr++].options(actualOptions);\n               }\n            }\n            else\n            {\n               const isPosition = this.#isPosition(position);\n               const actualPosition = isPosition ? position : position.position;\n\n               if (!this.#isPosition(actualPosition))\n               {\n                  console.warn(`AnimationGroupAPI.quickTo.options warning: No Position instance found.`);\n                  return quickToCB;\n               }\n\n               callbackOptions.index = 0;\n               callbackOptions.position = position;\n               callbackOptions.data = isPosition ? void 0 : position;\n\n               actualOptions = options(callbackOptions);\n\n               if (!isObject(actualOptions))\n               {\n                  throw new TypeError(\n                   `AnimationGroupAPI.quickTo error: options callback function failed to return an object.`);\n               }\n\n               quickToCallbacks[0].options(actualOptions);\n            }\n         }\n\n         return quickToCB;\n      };\n\n      return quickToCB;\n   }\n}\n\n/**\n * Provides a {@link TJSPositionInitialHelper} implementation to center to element being positioned.\n */\nclass Centered\n{\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   /**\n    * @param {object}      [options] - Initial options.\n    *\n    * @param {HTMLElement} [options.element] - Target element.\n    *\n    * @param {boolean}     [options.lock=false] - Lock parameters from being set.\n    *\n    * @param {number}      [options.width] - Manual width.\n    *\n    * @param {number}      [options.height] - Manual height.\n    */\n   constructor({ element, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   /**\n    * @returns {HTMLElement|undefined|null} Target element.\n    */\n   get element() { return this.#element; }\n\n   /**\n    * @returns {number} Get manual height.\n    */\n   get height() { return this.#height; }\n\n   /**\n    * @returns {number} Get manual width.\n    */\n   get width() { return this.#width; }\n\n   /**\n    * @param {HTMLElement|undefined|null} element - Set target element.\n    */\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0  || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   /**\n    * @param {number}   height - Set manual height.\n    */\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * @param {number}   width - Set manual width.\n    */\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Set manual width & height.\n    *\n    * @param {number}   width - New manual width.\n    *\n    * @param {number}   height - New manual height.\n    */\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Get the left constraint based on any manual target values or the browser inner width.\n    *\n    * @param {number}   width - Target width.\n    *\n    * @returns {number} Calculated left constraint.\n    */\n   getLeft(width)\n   {\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n\n      return (boundsWidth - width) / 2;\n   }\n\n   /**\n    * Get the top constraint based on any manual target values or the browser inner height.\n    *\n    * @param {number}   height - Target height.\n    *\n    * @returns {number} Calculated top constraint.\n    */\n   getTop(height)\n   {\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      return (boundsHeight - height) / 2;\n   }\n}\n\nclass PositionChangeSet\n{\n   constructor()\n   {\n      this.left = false;\n      this.top = false;\n      this.width = false;\n      this.height = false;\n      this.maxHeight = false;\n      this.maxWidth = false;\n      this.minHeight = false;\n      this.minWidth = false;\n      this.zIndex = false;\n      this.transform = false;\n      this.transformOrigin = false;\n   }\n\n   hasChange()\n   {\n      return this.left || this.top || this.width || this.height || this.maxHeight || this.maxWidth || this.minHeight ||\n       this.minWidth || this.zIndex || this.transform || this.transformOrigin;\n   }\n\n   set(value)\n   {\n      this.left = value;\n      this.top = value;\n      this.width = value;\n      this.height = value;\n      this.maxHeight = value;\n      this.maxWidth = value;\n      this.minHeight = value;\n      this.minWidth = value;\n      this.zIndex = value;\n      this.transform = value;\n      this.transformOrigin = value;\n   }\n}\n\n/**\n * Defines stored positional data.\n */\nclass TJSPositionData\n{\n   constructor({ height = null, left = null, maxHeight = null, maxWidth = null, minHeight = null, minWidth = null,\n    rotateX = null, rotateY = null, rotateZ = null, scale = null, translateX = null, translateY = null,\n     translateZ = null, top = null, transformOrigin = null, width = null, zIndex = null } = {})\n   {\n      /**\n       * @type {number|'auto'|'inherit'|null}\n       */\n      this.height = height;\n\n      /**\n       * @type {number|null}\n       */\n      this.left = left;\n\n      /**\n       * @type {number|null}\n       */\n      this.maxHeight = maxHeight;\n\n      /**\n       * @type {number|null}\n       */\n      this.maxWidth = maxWidth;\n\n      /**\n       * @type {number|null}\n       */\n      this.minHeight = minHeight;\n\n      /**\n       * @type {number|null}\n       */\n      this.minWidth = minWidth;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateX = rotateX;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateY = rotateY;\n\n      /**\n       * @type {number|null}\n       */\n      this.rotateZ = rotateZ;\n\n      /**\n       * @type {number|null}\n       */\n      this.scale = scale;\n\n      /**\n       * @type {number|null}\n       */\n      this.top = top;\n\n      /**\n       * @type {string|null}\n       */\n      this.transformOrigin = transformOrigin;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateX = translateX;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateY = translateY;\n\n      /**\n       * @type {number|null}\n       */\n      this.translateZ = translateZ;\n\n      /**\n       * @type {number|'auto'|'inherit'|null}\n       */\n      this.width = width;\n\n      /**\n       * @type {number|null}\n       */\n      this.zIndex = zIndex;\n\n      Object.seal(this);\n   }\n\n   /**\n    * Copies given data to this instance.\n    *\n    * @param {TJSPositionData}   data - Copy from this instance.\n    *\n    * @returns {TJSPositionData} This instance.\n    */\n   copy(data)\n   {\n      this.height = data.height;\n      this.left = data.left;\n      this.maxHeight = data.maxHeight;\n      this.maxWidth = data.maxWidth;\n      this.minHeight = data.minHeight;\n      this.minWidth = data.minWidth;\n      this.rotateX = data.rotateX;\n      this.rotateY = data.rotateY;\n      this.rotateZ = data.rotateZ;\n      this.scale = data.scale;\n      this.top = data.top;\n      this.transformOrigin = data.transformOrigin;\n      this.translateX = data.translateX;\n      this.translateY = data.translateY;\n      this.translateZ = data.translateZ;\n      this.width = data.width;\n      this.zIndex = data.zIndex;\n\n      return this;\n   }\n}\n\nclass PositionStateAPI\n{\n   /** @type {import('./TJSPositionData').TJSPositionData} */\n   #data;\n\n   /**\n    * @type {Map<string, import('./').TJSPositionDataExtended>}\n    */\n   #dataSaved = new Map();\n\n   /** @type {import('./').TJSPosition} */\n   #position;\n\n   /** @type {import('./transform').TJSTransforms} */\n   #transforms;\n\n   constructor(position, data, transforms)\n   {\n      this.#position = position;\n      this.#data = data;\n      this.#transforms = transforms;\n   }\n\n   /**\n    * Returns any stored save state by name.\n    *\n    * @param {object}   options - Options\n    *\n    * @param {string}   options.name - Saved data set name.\n    *\n    * @returns {import('./').TJSPositionDataExtended} The saved data set.\n    */\n   get({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - getSave error: 'name' is not a string.`); }\n\n      return this.#dataSaved.get(name);\n   }\n\n   /**\n    * Returns any associated default data.\n    *\n    * @returns {import('./').TJSPositionDataExtended} Associated default data.\n    */\n   getDefault()\n   {\n      return this.#dataSaved.get('#defaultData');\n   }\n\n   /**\n    * Removes and returns any position state by name.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - Name to remove and retrieve.\n    *\n    * @returns {import('./').TJSPositionDataExtended} Saved position data.\n    */\n   remove({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - remove: 'name' is not a string.`); }\n\n      const data = this.#dataSaved.get(name);\n      this.#dataSaved.delete(name);\n\n      return data;\n   }\n\n   /**\n    * Resets data to default values and invokes set.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.keepZIndex=false] - When true keeps current z-index.\n    *\n    * @param {boolean}  [opts.invokeSet=true] - When true invokes set method.\n    *\n    * @returns {boolean} Operation successful.\n    */\n   reset({ keepZIndex = false, invokeSet = true } = {})\n   {\n      const defaultData = this.#dataSaved.get('#defaultData');\n\n      // Quit early if there is no saved default data.\n      if (!isObject(defaultData)) { return false; }\n\n      // Cancel all animations for TJSPosition if there are currently any scheduled.\n      if (this.#position.animate.isScheduled)\n      {\n         this.#position.animate.cancel();\n      }\n\n      const zIndex = this.#position.zIndex;\n\n      const data = Object.assign({}, defaultData);\n\n      if (keepZIndex) { data.zIndex = zIndex; }\n\n      // Reset the transform data.\n      this.#transforms.reset(data);\n\n      // If current minimized invoke `maximize`.\n      if (this.#position.parent?.reactive?.minimized)\n      {\n         this.#position.parent?.maximize?.({ animate: false, duration: 0 });\n      }\n\n      // Note next clock tick scheduling.\n      if (invokeSet) { setTimeout(() => this.#position.set(data), 0); }\n\n      return true;\n   }\n\n   /**\n    * Restores a saved positional state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n-   * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to}\n    * allows specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * @param {object}            params - Parameters\n    *\n    * @param {string}            params.name - Saved data set name.\n    *\n    * @param {boolean}           [params.remove=false] - Remove data set.\n    *\n    * @param {Iterable<string>}  [params.properties] - Specific properties to set / animate.\n    *\n    * @param {boolean}           [params.silent] - Set position data directly; no store or style updates.\n    *\n    * @param {boolean}           [params.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [params.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [params.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [params.ease=linear] - Easing function.\n    *\n    * @param {Function}          [params.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {import('./').TJSPositionDataExtended | Promise<import('./').TJSPositionDataExtended>} Saved position\n    *          data.\n    */\n   restore({ name, remove = false, properties, silent = false, async = false, animateTo = false, duration = 0.1,\n    ease = linear, interpolate = lerp })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - restore error: 'name' is not a string.`); }\n\n      const dataSaved = this.#dataSaved.get(name);\n\n      if (dataSaved)\n      {\n         if (remove) { this.#dataSaved.delete(name); }\n\n         let data = dataSaved;\n\n         if (isIterable(properties))\n         {\n            data = {};\n            for (const property of properties) { data[property] = dataSaved[property]; }\n         }\n\n         // Update data directly with no store or inline style updates.\n         if (silent)\n         {\n            for (const property in data) { this.#data[property] = data[property]; }\n            return dataSaved;\n         }\n         else if (animateTo)  // Animate to saved data.\n         {\n            // Provide special handling to potentially change transform origin as this parameter is not animated.\n            if (data.transformOrigin !== this.#position.transformOrigin)\n            {\n               this.#position.transformOrigin = data.transformOrigin;\n            }\n\n            // Return a Promise with saved data that resolves after animation ends.\n            if (async)\n            {\n               return this.#position.animate.to(data, { duration, ease, interpolate }).finished.then(() => dataSaved);\n            }\n            else  // Animate synchronously.\n            {\n               this.#position.animate.to(data, { duration, ease, interpolate });\n            }\n         }\n         else\n         {\n            // Default options is to set data for an immediate update.\n            this.#position.set(data);\n         }\n      }\n\n      return dataSaved;\n   }\n\n   /**\n    * Saves current position state with the opportunity to add extra data to the saved state.\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.name - name to index this saved data.\n    *\n    * @param {...*}     [opts.extra] - Extra data to add to saved data.\n    *\n    * @returns {import('./').TJSPositionData} Current position data\n    */\n   save({ name, ...extra })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - save error: 'name' is not a string.`); }\n\n      const data = this.#position.get(extra);\n\n      this.#dataSaved.set(name, data);\n\n      return data;\n   }\n\n   /**\n    * Directly sets a position state.\n    *\n    * @param {object}   opts - Options.\n    *\n    * @param {string}   opts.name - name to index this saved data.\n    *\n    * @param {...*}     [opts.data] - TJSPosition data to set.\n    */\n   set({ name, ...data })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`Position - set error: 'name' is not a string.`); }\n\n      this.#dataSaved.set(name, data);\n   }\n}\n\nclass StyleCache\n{\n   constructor()\n   {\n      /** @type {HTMLElement|undefined} */\n      this.el = void 0;\n\n      /** @type {CSSStyleDeclaration} */\n      this.computed = void 0;\n\n      /** @type {number|undefined} */\n      this.marginLeft = void 0;\n\n      /** @type {number|undefined} */\n      this.marginTop = void 0;\n\n      /** @type {number|undefined} */\n      this.maxHeight = void 0;\n\n      /** @type {number|undefined} */\n      this.maxWidth = void 0;\n\n      /** @type {number|undefined} */\n      this.minHeight = void 0;\n\n      /** @type {number|undefined} */\n      this.minWidth = void 0;\n\n      /** @type {boolean} */\n      this.hasWillChange = false;\n\n      /**\n       * @type {import('./').ResizeObserverData}\n       */\n      this.resizeObserved = {\n         contentHeight: void 0,\n         contentWidth: void 0,\n         offsetHeight: void 0,\n         offsetWidth: void 0\n      };\n\n      /**\n       * Provides a writable store to track offset & content width / height from an associated `resizeObserver` action.\n       *\n       * @type {import('svelte/store').Writable<import('./').ResizeObserverData>}\n       */\n      const storeResizeObserved = writable(this.resizeObserved);\n\n      this.stores = {\n         element: writable(this.el),\n         resizeContentHeight: propertyStore(storeResizeObserved, 'contentHeight'),\n         resizeContentWidth: propertyStore(storeResizeObserved, 'contentWidth'),\n         resizeObserved: storeResizeObserved,\n         resizeOffsetHeight: propertyStore(storeResizeObserved, 'offsetHeight'),\n         resizeOffsetWidth: propertyStore(storeResizeObserved, 'offsetWidth')\n      };\n   }\n\n   /**\n    * Returns the cached offsetHeight from any attached `resizeObserver` action otherwise gets the offsetHeight from\n    * the element directly. The more optimized path is using `resizeObserver` as getting it from the element\n    * directly is more expensive and alters the execution order of an animation frame.\n    *\n    * @returns {number} The element offsetHeight.\n    */\n   get offsetHeight()\n   {\n      if (this.el instanceof HTMLElement)\n      {\n         return this.resizeObserved.offsetHeight !== void 0 ? this.resizeObserved.offsetHeight : this.el.offsetHeight;\n      }\n\n      throw new Error(`StyleCache - get offsetHeight error: no element assigned.`);\n   }\n\n   /**\n    * Returns the cached offsetWidth from any attached `resizeObserver` action otherwise gets the offsetWidth from\n    * the element directly. The more optimized path is using `resizeObserver` as getting it from the element\n    * directly is more expensive and alters the execution order of an animation frame.\n    *\n    * @returns {number} The element offsetHeight.\n    */\n   get offsetWidth()\n   {\n      if (this.el instanceof HTMLElement)\n      {\n         return this.resizeObserved.offsetWidth !== void 0 ? this.resizeObserved.offsetWidth : this.el.offsetWidth;\n      }\n\n      throw new Error(`StyleCache - get offsetWidth error: no element assigned.`);\n   }\n\n   /**\n    * @param {HTMLElement} el -\n    *\n    * @returns {boolean} Does element match cached element.\n    */\n   hasData(el) { return this.el === el; }\n\n   /**\n    * Resets the style cache.\n    */\n   reset()\n   {\n      // Remove will-change inline style from previous element if it is still connected.\n      if (this.el instanceof HTMLElement && this.el.isConnected && !this.hasWillChange)\n      {\n         this.el.style.willChange = null;\n      }\n\n      this.el = void 0;\n      this.computed = void 0;\n      this.marginLeft = void 0;\n      this.marginTop = void 0;\n      this.maxHeight = void 0;\n      this.maxWidth = void 0;\n      this.minHeight = void 0;\n      this.minWidth = void 0;\n\n      this.hasWillChange = false;\n\n      // Silently reset `resizedObserved`; With proper usage the `resizeObserver` action issues an update on removal.\n      this.resizeObserved.contentHeight = void 0;\n      this.resizeObserved.contentWidth = void 0;\n      this.resizeObserved.offsetHeight = void 0;\n      this.resizeObserved.offsetWidth = void 0;\n\n      // Reset the tracked element this TJSPosition instance is modifying.\n      this.stores.element.set(void 0);\n   }\n\n   /**\n    * Updates the style cache with new data from the given element.\n    *\n    * @param {HTMLElement} el - An HTML element.\n    */\n   update(el)\n   {\n      this.el = el;\n\n      this.computed = globalThis.getComputedStyle(el);\n\n      this.marginLeft = StyleParse.pixels(el.style.marginLeft) ?? StyleParse.pixels(this.computed.marginLeft);\n      this.marginTop = StyleParse.pixels(el.style.marginTop) ?? StyleParse.pixels(this.computed.marginTop);\n      this.maxHeight = StyleParse.pixels(el.style.maxHeight) ?? StyleParse.pixels(this.computed.maxHeight);\n      this.maxWidth = StyleParse.pixels(el.style.maxWidth) ?? StyleParse.pixels(this.computed.maxWidth);\n\n      // Note that the computed styles for below will always be 0px / 0 when no style is active.\n      this.minHeight = StyleParse.pixels(el.style.minHeight) ?? StyleParse.pixels(this.computed.minHeight);\n      this.minWidth = StyleParse.pixels(el.style.minWidth) ?? StyleParse.pixels(this.computed.minWidth);\n\n      // Tracks if there already is a will-change property on the inline or computed styles.\n      const willChange = el.style.willChange !== '' ? el.style.willChange : this.computed.willChange;\n\n      this.hasWillChange = willChange !== '' && willChange !== 'auto';\n\n      // Update the tracked element this TJSPosition instance is modifying.\n      this.stores.element.set(el);\n   }\n}\n\n/**\n * Provides the output data for {@link TJSTransforms.getData}.\n */\nclass TJSTransformData\n{\n   constructor()\n   {\n      Object.seal(this);\n   }\n\n   /**\n    * Stores the calculated bounding rectangle.\n    *\n    * @type {DOMRect}\n    */\n   #boundingRect = new DOMRect();\n\n   /**\n    * Stores the individual transformed corner points of the window in screen space clockwise from:\n    * top left -> top right -> bottom right -> bottom left.\n    *\n    * @type {import('#runtime/math/gl-matrix').Vec3[]}\n    */\n   #corners = [Vec3.create(), Vec3.create(), Vec3.create(), Vec3.create()];\n\n   /**\n    * Stores the current gl-matrix Mat4 data.\n    *\n    * @type {import('#runtime/math/gl-matrix').Mat4}\n    */\n   #mat4 = Mat4.create();\n\n   /**\n    * Stores the pre & post origin translations to apply to matrix transforms.\n    *\n    * @type {import('#runtime/math/gl-matrix').Mat4[]}\n    */\n   #originTranslations = [Mat4.create(), Mat4.create()];\n\n   /**\n    * @returns {DOMRect} The bounding rectangle.\n    */\n   get boundingRect() { return this.#boundingRect; }\n\n   /**\n    * @returns {import('#runtime/math/gl-matrix').Vec3[]} The transformed corner points as Vec3 in screen space.\n    */\n   get corners() { return this.#corners; }\n\n   /**\n    * @returns {string} Returns the CSS style string for the transform matrix.\n    */\n   get css() { return `matrix3d(${this.mat4.join(',')})`; }\n\n   /**\n    * @returns {import('#runtime/math/gl-matrix').Mat4} The transform matrix.\n    */\n   get mat4() { return this.#mat4; }\n\n   /**\n    * @returns {import('#runtime/math/gl-matrix').Mat4[]} The pre / post translation matrices for origin translation.\n    */\n   get originTranslations() { return this.#originTranslations; }\n}\n\n/** @type {number[]} */\nconst s_SCALE_VECTOR = [1, 1, 1];\n\n/** @type {number[]} */\nconst s_TRANSLATE_VECTOR = [0, 0, 0];\n\n/** @type {import('#runtime/math/gl-matrix').Mat4} */\nconst s_MAT4_RESULT = Mat4.create();\n\n/** @type {import('#runtime/math/gl-matrix').Mat4} */\nconst s_MAT4_TEMP = Mat4.create();\n\n/** @type {import('#runtime/math/gl-matrix').Vec3} */\nconst s_VEC3_TEMP = Vec3.create();\n\nclass TJSTransforms\n{\n   /**\n    * Stores the transform keys in the order added.\n    *\n    * @type {string[]}\n    */\n   #orderList = [];\n\n   constructor()\n   {\n      this._data = {};\n   }\n\n   /**\n    * @returns {boolean} Whether there are active transforms in local data.\n    */\n   get isActive() { return this.#orderList.length > 0; }\n\n   /**\n    * @returns {number|undefined} Any local rotateX data.\n    */\n   get rotateX() { return this._data.rotateX; }\n\n   /**\n    * @returns {number|undefined} Any local rotateY data.\n    */\n   get rotateY() { return this._data.rotateY; }\n\n   /**\n    * @returns {number|undefined} Any local rotateZ data.\n    */\n   get rotateZ() { return this._data.rotateZ; }\n\n   /**\n    * @returns {number|undefined} Any local rotateZ scale.\n    */\n   get scale() { return this._data.scale; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateX() { return this._data.translateX; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateY() { return this._data.translateY; }\n\n   /**\n    * @returns {number|undefined} Any local translateZ data.\n    */\n   get translateZ() { return this._data.translateZ; }\n\n   /**\n    * Sets the local rotateX data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateX(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateX === void 0) { this.#orderList.push('rotateX'); }\n\n         this._data.rotateX = value;\n      }\n      else\n      {\n         if (this._data.rotateX !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateX');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateX;\n      }\n   }\n\n   /**\n    * Sets the local rotateY data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateY(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateY === void 0) { this.#orderList.push('rotateY'); }\n\n         this._data.rotateY = value;\n      }\n      else\n      {\n         if (this._data.rotateY !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateY');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateY;\n      }\n   }\n\n   /**\n    * Sets the local rotateZ data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set rotateZ(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.rotateZ === void 0) { this.#orderList.push('rotateZ'); }\n\n         this._data.rotateZ = value;\n      }\n\n      else\n      {\n         if (this._data.rotateZ !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'rotateZ');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.rotateZ;\n      }\n   }\n\n   /**\n    * Sets the local scale data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set scale(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.scale === void 0) { this.#orderList.push('scale'); }\n\n         this._data.scale = value;\n      }\n      else\n      {\n         if (this._data.scale !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'scale');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.scale;\n      }\n   }\n\n   /**\n    * Sets the local translateX data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateX(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateX === void 0) { this.#orderList.push('translateX'); }\n\n         this._data.translateX = value;\n      }\n\n      else\n      {\n         if (this._data.translateX !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateX');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateX;\n      }\n   }\n\n   /**\n    * Sets the local translateY data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateY(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateY === void 0) { this.#orderList.push('translateY'); }\n\n         this._data.translateY = value;\n      }\n\n      else\n      {\n         if (this._data.translateY !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateY');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateY;\n      }\n   }\n\n   /**\n    * Sets the local translateZ data if the value is a finite number otherwise removes the local data.\n    *\n    * @param {number|null|undefined}   value - A value to set.\n    */\n   set translateZ(value)\n   {\n      if (Number.isFinite(value))\n      {\n         if (this._data.translateZ === void 0) { this.#orderList.push('translateZ'); }\n\n         this._data.translateZ = value;\n      }\n\n      else\n      {\n         if (this._data.translateZ !== void 0)\n         {\n            const index = this.#orderList.findIndex((entry) => entry === 'translateZ');\n            if (index >= 0) { this.#orderList.splice(index, 1); }\n         }\n\n         delete this._data.translateZ;\n      }\n   }\n\n   /**\n    * Returns the matrix3d CSS transform for the given position / transform data.\n    *\n    * @param {object} [data] - Optional position data otherwise use local stored transform data.\n    *\n    * @returns {string} The CSS matrix3d string.\n    */\n   getCSS(data = this._data)\n   {\n      return `matrix3d(${this.getMat4(data, s_MAT4_RESULT).join(',')})`;\n   }\n\n   /**\n    * Returns the matrix3d CSS transform for the given position / transform data.\n    *\n    * @param {object} [data] - Optional position data otherwise use local stored transform data.\n    *\n    * @returns {string} The CSS matrix3d string.\n    */\n   getCSSOrtho(data = this._data)\n   {\n      return `matrix3d(${this.getMat4Ortho(data, s_MAT4_RESULT).join(',')})`;\n   }\n\n   /**\n    * Collects all data including a bounding rect, transform matrix, and points array of the given\n    * {@link TJSPositionData} instance with the applied local transform data.\n    *\n    * @param {import('../').TJSPositionData} position - The position data to process.\n    *\n    * @param {TJSTransformData} [output] - Optional TJSTransformData output instance.\n    *\n    * @param {object} [validationData] - Optional validation data for adjustment parameters.\n    *\n    * @returns {TJSTransformData} The output TJSTransformData instance.\n    */\n   getData(position, output = new TJSTransformData(), validationData = {})\n   {\n      const valWidth = validationData.width ?? 0;\n      const valHeight = validationData.height ?? 0;\n      const valOffsetTop = validationData.offsetTop ?? validationData.marginTop ?? 0;\n      const valOffsetLeft = validationData.offsetLeft ?? validationData.offsetLeft ?? 0;\n\n      position.top += valOffsetTop;\n      position.left += valOffsetLeft;\n\n      const width = Number.isFinite(position.width) ? position.width : valWidth;\n      const height = Number.isFinite(position.height) ? position.height : valHeight;\n\n      const rect = output.corners;\n\n      if (this.hasTransform(position))\n      {\n         rect[0][0] = rect[0][1] = rect[0][2] = 0;\n         rect[1][0] = width;\n         rect[1][1] = rect[1][2] = 0;\n         rect[2][0] = width;\n         rect[2][1] = height;\n         rect[2][2] = 0;\n         rect[3][0] = 0;\n         rect[3][1] = height;\n         rect[3][2] = 0;\n\n         const matrix = this.getMat4(position, output.mat4);\n\n         const translate = s_GET_ORIGIN_TRANSLATION(position.transformOrigin, width, height, output.originTranslations);\n\n         if (transformOriginDefault === position.transformOrigin)\n         {\n            Vec3.transformMat4(rect[0], rect[0], matrix);\n            Vec3.transformMat4(rect[1], rect[1], matrix);\n            Vec3.transformMat4(rect[2], rect[2], matrix);\n            Vec3.transformMat4(rect[3], rect[3], matrix);\n         }\n         else\n         {\n            Vec3.transformMat4(rect[0], rect[0], translate[0]);\n            Vec3.transformMat4(rect[0], rect[0], matrix);\n            Vec3.transformMat4(rect[0], rect[0], translate[1]);\n\n            Vec3.transformMat4(rect[1], rect[1], translate[0]);\n            Vec3.transformMat4(rect[1], rect[1], matrix);\n            Vec3.transformMat4(rect[1], rect[1], translate[1]);\n\n            Vec3.transformMat4(rect[2], rect[2], translate[0]);\n            Vec3.transformMat4(rect[2], rect[2], matrix);\n            Vec3.transformMat4(rect[2], rect[2], translate[1]);\n\n            Vec3.transformMat4(rect[3], rect[3], translate[0]);\n            Vec3.transformMat4(rect[3], rect[3], matrix);\n            Vec3.transformMat4(rect[3], rect[3], translate[1]);\n         }\n\n         rect[0][0] = position.left + rect[0][0];\n         rect[0][1] = position.top + rect[0][1];\n         rect[1][0] = position.left + rect[1][0];\n         rect[1][1] = position.top + rect[1][1];\n         rect[2][0] = position.left + rect[2][0];\n         rect[2][1] = position.top + rect[2][1];\n         rect[3][0] = position.left + rect[3][0];\n         rect[3][1] = position.top + rect[3][1];\n      }\n      else\n      {\n         rect[0][0] = position.left;\n         rect[0][1] = position.top;\n         rect[1][0] = position.left + width;\n         rect[1][1] = position.top;\n         rect[2][0] = position.left + width;\n         rect[2][1] = position.top + height;\n         rect[3][0] = position.left;\n         rect[3][1] = position.top + height;\n\n         Mat4.identity(output.mat4);\n      }\n\n      let maxX = Number.MIN_SAFE_INTEGER;\n      let maxY = Number.MIN_SAFE_INTEGER;\n      let minX = Number.MAX_SAFE_INTEGER;\n      let minY = Number.MAX_SAFE_INTEGER;\n\n      for (let cntr = 4; --cntr >= 0;)\n      {\n         if (rect[cntr][0] > maxX) { maxX = rect[cntr][0]; }\n         if (rect[cntr][0] < minX) { minX = rect[cntr][0]; }\n         if (rect[cntr][1] > maxY) { maxY = rect[cntr][1]; }\n         if (rect[cntr][1] < minY) { minY = rect[cntr][1]; }\n      }\n\n      const boundingRect = output.boundingRect;\n      boundingRect.x = minX;\n      boundingRect.y = minY;\n      boundingRect.width = maxX - minX;\n      boundingRect.height = maxY - minY;\n\n      position.top -= valOffsetTop;\n      position.left -= valOffsetLeft;\n\n      return output;\n   }\n\n   /**\n    * Creates a transform matrix based on local data applied in order it was added.\n    *\n    * If no data object is provided then the source is the local transform data. If another data object is supplied\n    * then the stored local transform order is applied then all remaining transform keys are applied. This allows the\n    * construction of a transform matrix in advance of setting local data and is useful in collision detection.\n    *\n    * @param {object}   [data] - TJSPositionData instance or local transform data.\n    *\n    * @param {import('#runtime/math/gl-matrix').Mat4}  [output] - The output mat4 instance.\n    *\n    * @returns {import('#runtime/math/gl-matrix').Mat4} Transform matrix.\n    */\n   getMat4(data = this._data, output = Mat4.create())\n   {\n      const matrix = Mat4.identity(output);\n\n      // Bitwise tracks applied transform keys from local transform data.\n      let seenKeys = 0;\n\n      const orderList = this.#orderList;\n\n      // First apply ordered transforms from local transform data.\n      for (let cntr = 0; cntr < orderList.length; cntr++)\n      {\n         const key = orderList[cntr];\n\n         switch (key)\n         {\n            case 'rotateX':\n               seenKeys |= transformKeysBitwise.rotateX;\n               Mat4.multiply(matrix, matrix, Mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateY':\n               seenKeys |= transformKeysBitwise.rotateY;\n               Mat4.multiply(matrix, matrix, Mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateZ':\n               seenKeys |= transformKeysBitwise.rotateZ;\n               Mat4.multiply(matrix, matrix, Mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'scale':\n               seenKeys |= transformKeysBitwise.scale;\n               s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data[key];\n               Mat4.multiply(matrix, matrix, Mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n               break;\n\n            case 'translateX':\n               seenKeys |= transformKeysBitwise.translateX;\n               s_TRANSLATE_VECTOR[0] = data.translateX;\n               s_TRANSLATE_VECTOR[1] = 0;\n               s_TRANSLATE_VECTOR[2] = 0;\n               Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n\n            case 'translateY':\n               seenKeys |= transformKeysBitwise.translateY;\n               s_TRANSLATE_VECTOR[0] = 0;\n               s_TRANSLATE_VECTOR[1] = data.translateY;\n               s_TRANSLATE_VECTOR[2] = 0;\n               Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n\n            case 'translateZ':\n               seenKeys |= transformKeysBitwise.translateZ;\n               s_TRANSLATE_VECTOR[0] = 0;\n               s_TRANSLATE_VECTOR[1] = 0;\n               s_TRANSLATE_VECTOR[2] = data.translateZ;\n               Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n               break;\n         }\n      }\n\n      // Now apply any new keys not set in local transform data that have not been applied yet.\n      if (data !== this._data)\n      {\n         for (let cntr = 0; cntr < transformKeys.length; cntr++)\n         {\n            const key = transformKeys[cntr];\n\n            // Reject bad / no data or if the key has already been applied.\n            if (data[key] === null || (seenKeys & transformKeysBitwise[key]) > 0) { continue; }\n\n            switch (key)\n            {\n               case 'rotateX':\n                  Mat4.multiply(matrix, matrix, Mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateY':\n                  Mat4.multiply(matrix, matrix, Mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateZ':\n                  Mat4.multiply(matrix, matrix, Mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'scale':\n                  s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data[key];\n                  Mat4.multiply(matrix, matrix, Mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n                  break;\n\n               case 'translateX':\n                  s_TRANSLATE_VECTOR[0] = data[key];\n                  s_TRANSLATE_VECTOR[1] = 0;\n                  s_TRANSLATE_VECTOR[2] = 0;\n                  Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n\n               case 'translateY':\n                  s_TRANSLATE_VECTOR[0] = 0;\n                  s_TRANSLATE_VECTOR[1] = data[key];\n                  s_TRANSLATE_VECTOR[2] = 0;\n                  Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n\n               case 'translateZ':\n                  s_TRANSLATE_VECTOR[0] = 0;\n                  s_TRANSLATE_VECTOR[1] = 0;\n                  s_TRANSLATE_VECTOR[2] = data[key];\n                  Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n                  break;\n            }\n         }\n      }\n\n      return matrix;\n   }\n\n   /**\n    * Provides an orthographic enhancement to convert left / top positional data to a translate operation.\n    *\n    * This transform matrix takes into account that the remaining operations are , but adds any left / top attributes from passed in data to\n    * translate X / Y.\n    *\n    * If no data object is provided then the source is the local transform data. If another data object is supplied\n    * then the stored local transform order is applied then all remaining transform keys are applied. This allows the\n    * construction of a transform matrix in advance of setting local data and is useful in collision detection.\n    *\n    * @param {object}   [data] - TJSPositionData instance or local transform data.\n    *\n    * @param {import('#runtime/math/gl-matrix').Mat4}  [output] - The output mat4 instance.\n    *\n    * @returns {import('#runtime/math/gl-matrix').Mat4} Transform matrix.\n    */\n   getMat4Ortho(data = this._data, output = Mat4.create())\n   {\n      const matrix = Mat4.identity(output);\n\n      // Attempt to retrieve values from passed in data otherwise default to 0.\n      // Always perform the translation last regardless of order added to local transform data.\n      // Add data.left to translateX and data.top to translateY.\n      s_TRANSLATE_VECTOR[0] = (data.left ?? 0) + (data.translateX ?? 0);\n      s_TRANSLATE_VECTOR[1] = (data.top ?? 0) + (data.translateY ?? 0);\n      s_TRANSLATE_VECTOR[2] = data.translateZ ?? 0;\n      Mat4.multiply(matrix, matrix, Mat4.fromTranslation(s_MAT4_TEMP, s_TRANSLATE_VECTOR));\n\n      // Scale can also be applied out of order.\n      if (data.scale !== null)\n      {\n         s_SCALE_VECTOR[0] = s_SCALE_VECTOR[1] = data.scale;\n         Mat4.multiply(matrix, matrix, Mat4.fromScaling(s_MAT4_TEMP, s_SCALE_VECTOR));\n      }\n\n      // Early out if there is not rotation data.\n      if (data.rotateX === null && data.rotateY === null && data.rotateZ === null) { return matrix; }\n\n      // Rotation transforms must be applied in the order they are added.\n\n      // Bitwise tracks applied transform keys from local transform data.\n      let seenKeys = 0;\n\n      const orderList = this.#orderList;\n\n      // First apply ordered transforms from local transform data.\n      for (let cntr = 0; cntr < orderList.length; cntr++)\n      {\n         const key = orderList[cntr];\n\n         switch (key)\n         {\n            case 'rotateX':\n               seenKeys |= transformKeysBitwise.rotateX;\n               Mat4.multiply(matrix, matrix, Mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateY':\n               seenKeys |= transformKeysBitwise.rotateY;\n               Mat4.multiply(matrix, matrix, Mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n\n            case 'rotateZ':\n               seenKeys |= transformKeysBitwise.rotateZ;\n               Mat4.multiply(matrix, matrix, Mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n               break;\n         }\n      }\n\n      // Now apply any new keys not set in local transform data that have not been applied yet.\n      if (data !== this._data)\n      {\n         for (let cntr = 0; cntr < transformKeys.length; cntr++)\n         {\n            const key = transformKeys[cntr];\n\n            // Reject bad / no data or if the key has already been applied.\n            if (data[key] === null || (seenKeys & transformKeysBitwise[key]) > 0) { continue; }\n\n            switch (key)\n            {\n               case 'rotateX':\n                  Mat4.multiply(matrix, matrix, Mat4.fromXRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateY':\n                  Mat4.multiply(matrix, matrix, Mat4.fromYRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n\n               case 'rotateZ':\n                  Mat4.multiply(matrix, matrix, Mat4.fromZRotation(s_MAT4_TEMP, degToRad(data[key])));\n                  break;\n            }\n         }\n      }\n\n      return matrix;\n   }\n\n   /**\n    * Tests an object if it contains transform keys and the values are finite numbers.\n    *\n    * @param {object} data - An object to test for transform data.\n    *\n    * @returns {boolean} Whether the given TJSPositionData has transforms.\n    */\n   hasTransform(data)\n   {\n      for (const key of transformKeys)\n      {\n         if (Number.isFinite(data[key])) { return true; }\n      }\n\n      return false;\n   }\n\n   /**\n    * Resets internal data from the given object containing valid transform keys.\n    *\n    * @param {object}   data - An object with transform data.\n    */\n   reset(data)\n   {\n      for (const key in data)\n      {\n         if (transformKeys.includes(key))\n         {\n            if (Number.isFinite(data[key]))\n            {\n               this._data[key] = data[key];\n            }\n            else\n            {\n               const index = this.#orderList.findIndex((entry) => entry === key);\n               if (index >= 0) { this.#orderList.splice(index, 1); }\n\n               delete this._data[key];\n            }\n         }\n      }\n   }\n}\n\n/**\n * Returns the translations necessary to translate a matrix operation based on the `transformOrigin` parameter of the\n * given position instance. The first entry / index 0 is the pre-translation and last entry / index 1 is the post-\n * translation.\n *\n * This method is used internally, but may be useful if you need the origin translation matrices to transform\n * bespoke points based on any `transformOrigin` set in {@link TJSPositionData}.\n *\n * @param {string}   transformOrigin - The transform origin attribute from TJSPositionData.\n *\n * @param {number}   width - The TJSPositionData width or validation data width when 'auto'.\n *\n * @param {number}   height - The TJSPositionData height or validation data height when 'auto'.\n *\n * @param {import('#runtime/math/gl-matrix').Mat4[]}   output - Output Mat4 array.\n *\n * @returns {import('#runtime/math/gl-matrix').Mat4[]} Output Mat4 array.\n */\nfunction s_GET_ORIGIN_TRANSLATION(transformOrigin, width, height, output)\n{\n   const vector = s_VEC3_TEMP;\n\n   switch (transformOrigin)\n   {\n      case 'top left':\n         vector[0] = vector[1] = 0;\n         Mat4.fromTranslation(output[0], vector);\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'top center':\n         vector[0] = -width * 0.5;\n         vector[1] = 0;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'top right':\n         vector[0] = -width;\n         vector[1] = 0;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'center left':\n         vector[0] = 0;\n         vector[1] = -height * 0.5;\n         Mat4.fromTranslation(output[0], vector);\n         vector[1] = height * 0.5;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      // By default, null / no transform is 'center'.\n      case null:\n      case 'center':\n         vector[0] = -width * 0.5;\n         vector[1] = -height * 0.5;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         vector[1] = height * 0.5;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'center right':\n         vector[0] = -width;\n         vector[1] = -height * 0.5;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         vector[1] = height * 0.5;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom left':\n         vector[0] = 0;\n         vector[1] = -height;\n         Mat4.fromTranslation(output[0], vector);\n         vector[1] = height;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom center':\n         vector[0] = -width * 0.5;\n         vector[1] = -height;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width * 0.5;\n         vector[1] = height;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      case 'bottom right':\n         vector[0] = -width;\n         vector[1] = -height;\n         Mat4.fromTranslation(output[0], vector);\n         vector[0] = width;\n         vector[1] = height;\n         Mat4.fromTranslation(output[1], vector);\n         break;\n\n      // No valid transform origin parameter; set identity.\n      default:\n         Mat4.identity(output[0]);\n         Mat4.identity(output[1]);\n         break;\n   }\n\n   return output;\n}\n\n/**\n * Provides the storage and sequencing of managed position validators. Each validator added may be a bespoke function or\n * a {@link ValidatorData} object containing an `id`, `validator`, and `weight` attributes; `validator` is\n * the only required attribute.\n *\n * The `id` attribute can be anything that creates a unique ID for the validator; recommended strings or numbers. This\n * allows validators to be removed by ID easily.\n *\n * The `weight` attribute is a number between 0 and 1 inclusive that allows validators to be added in a\n * predictable order which is especially handy if they are manipulated at runtime. A lower weighted validator always\n * runs before a higher weighted validator. If no weight is specified the default of '1' is assigned and it is appended\n * to the end of the validators list.\n *\n * This class forms the public API which is accessible from the `.validators` getter in the main TJSPosition instance.\n * ```\n * const position = new TJSPosition(<TJSPositionData>);\n * position.validators.add(...);\n * position.validators.clear();\n * position.validators.length;\n * position.validators.remove(...);\n * position.validators.removeBy(...);\n * position.validators.removeById(...);\n * ```\n */\nclass AdapterValidators\n{\n   /** @type {boolean} */\n   #enabled = true;\n\n   /**\n    * @type {import('../').ValidatorData[]}\n    */\n   #validatorData;\n\n   #mapUnsubscribe = new Map();\n\n   /**\n    * @returns {[AdapterValidators, import('../').ValidatorData[]]} Returns this and internal storage for validator\n    *          adapter.\n    */\n   constructor()\n   {\n      this.#validatorData = [];\n\n      Object.seal(this);\n\n      return [this, this.#validatorData];\n   }\n\n   /**\n    * @returns {boolean} Returns the enabled state.s\n    */\n   get enabled() { return this.#enabled; }\n\n   /**\n    * @returns {number} Returns the length of the validators array.\n    */\n   get length() { return this.#validatorData.length; }\n\n   /**\n    * @param {boolean}  enabled - Sets enabled state.\n    */\n   set enabled(enabled)\n   {\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   /**\n    * Provides an iterator for validators.\n    *\n    * @yields {import('../').ValidatorData}\n    */\n   *[Symbol.iterator]()\n   {\n      if (this.#validatorData.length === 0) { return; }\n\n      for (const entry of this.#validatorData)\n      {\n         yield { ...entry };\n      }\n   }\n\n   /**\n    * @param {...(import('../').ValidatorFn | import('../').ValidatorData)}   validators -\n    */\n   add(...validators)\n   {\n      /**\n       * Tracks the number of validators added that have subscriber functionality.\n       *\n       * @type {number}\n       */\n      // let subscribeCount = 0;  // TODO: Currently unused\n\n      for (const validator of validators)\n      {\n         const validatorType = typeof validator;\n\n         if ((validatorType !== 'function' && validatorType !== 'object') || validator === null)\n         {\n            throw new TypeError(`AdapterValidator error: 'validator' is not a function or object.`);\n         }\n\n         let data = void 0;\n         let subscribeFn = void 0;\n\n         switch (validatorType)\n         {\n            case 'function':\n               data = {\n                  id: void 0,\n                  validator,\n                  weight: 1\n               };\n\n               subscribeFn = validator.subscribe;\n               break;\n\n            case 'object':\n               if (typeof validator.validator !== 'function')\n               {\n                  throw new TypeError(`AdapterValidator error: 'validator' attribute is not a function.`);\n               }\n\n               if (validator.weight !== void 0 && typeof validator.weight !== 'number' ||\n                (validator.weight < 0 || validator.weight > 1))\n               {\n                  throw new TypeError(\n                   `AdapterValidator error: 'weight' attribute is not a number between '0 - 1' inclusive.`);\n               }\n\n               data = {\n                  id: validator.id !== void 0 ? validator.id : void 0,\n                  validator: validator.validator.bind(validator),\n                  weight: validator.weight || 1,\n                  instance: validator\n               };\n\n               subscribeFn = validator.validator.subscribe ?? validator.subscribe;\n               break;\n         }\n\n         // Find the index to insert where data.weight is less than existing values weight.\n         const index = this.#validatorData.findIndex((value) =>\n         {\n            return data.weight < value.weight;\n         });\n\n         // If an index was found insert at that location.\n         if (index >= 0)\n         {\n            this.#validatorData.splice(index, 0, data);\n         }\n         else // push to end of validators.\n         {\n            this.#validatorData.push(data);\n         }\n\n         if (typeof subscribeFn === 'function')\n         {\n            // TODO: consider how to handle validator updates.\n            const unsubscribe = subscribeFn();\n\n            // Ensure that unsubscribe is a function.\n            if (typeof unsubscribe !== 'function')\n            {\n               throw new TypeError(\n                'AdapterValidator error: Filter has subscribe function, but no unsubscribe function is returned.');\n            }\n\n            // Ensure that the same validator is not subscribed to multiple times.\n            if (this.#mapUnsubscribe.has(data.validator))\n            {\n               throw new Error(\n                'AdapterValidator error: Filter added already has an unsubscribe function registered.');\n            }\n\n            this.#mapUnsubscribe.set(data.validator, unsubscribe);\n            // subscribeCount++;  // TODO: Currently unused\n         }\n      }\n\n      // Filters with subscriber functionality are assumed to immediately invoke the `subscribe` callback. If the\n      // subscriber count is less than the amount of validators added then automatically trigger an index update\n      // manually.\n      // TODO: handle validator updates.\n      // if (subscribeCount < validators.length) { this.#indexUpdate(); }\n   }\n\n   clear()\n   {\n      this.#validatorData.length = 0;\n\n      // Unsubscribe from all validators with subscription support.\n      for (const unsubscribe of this.#mapUnsubscribe.values())\n      {\n         unsubscribe();\n      }\n\n      this.#mapUnsubscribe.clear();\n\n      // TODO: handle validator updates.\n      // this.#indexUpdate();\n   }\n\n   /**\n    * @param {...(import('../').ValidatorFn | import('../').ValidatorData)}   validators -\n    */\n   remove(...validators)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      for (const data of validators)\n      {\n         // Handle the case that the validator may either be a function or a validator entry / object.\n         const actualValidator = typeof data === 'function' ? data : isObject(data) ? data.validator : void 0;\n\n         if (!actualValidator) { continue; }\n\n         for (let cntr = this.#validatorData.length; --cntr >= 0;)\n         {\n            if (this.#validatorData[cntr].validator === actualValidator)\n            {\n               this.#validatorData.splice(cntr, 1);\n\n               // Invoke any unsubscribe function for given validator then remove from tracking.\n               let unsubscribe = void 0;\n               if (typeof (unsubscribe = this.#mapUnsubscribe.get(actualValidator)) === 'function')\n               {\n                  unsubscribe();\n                  this.#mapUnsubscribe.delete(actualValidator);\n               }\n            }\n         }\n      }\n\n      // Update the index a validator was removed.\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n\n   /**\n    * Remove validators by the provided callback. The callback takes 3 parameters: `id`, `validator`, and `weight`.\n    * Any truthy value returned will remove that validator.\n    *\n    * @param {function(*, import('../').ValidatorFn, number): boolean} callback - Callback function to evaluate each\n    *        validator entry.\n    */\n   removeBy(callback)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      if (typeof callback !== 'function')\n      {\n         throw new TypeError(`AdapterValidator error: 'callback' is not a function.`);\n      }\n\n      this.#validatorData = this.#validatorData.filter((data) =>\n      {\n         const remove = callback.call(callback, { ...data });\n\n         if (remove)\n         {\n            let unsubscribe;\n            if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.validator)) === 'function')\n            {\n               unsubscribe();\n               this.#mapUnsubscribe.delete(data.validator);\n            }\n         }\n\n         // Reverse remove boolean to properly validator / remove this validator.\n         return !remove;\n      });\n\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n\n   removeById(...ids)\n   {\n      const length = this.#validatorData.length;\n\n      if (length === 0) { return; }\n\n      this.#validatorData = this.#validatorData.filter((data) =>\n      {\n         let remove = false;\n\n         for (const id of ids) { remove |= data.id === id; }\n\n         // If not keeping invoke any unsubscribe function for given validator then remove from tracking.\n         if (remove)\n         {\n            let unsubscribe;\n            if (typeof (unsubscribe = this.#mapUnsubscribe.get(data.validator)) === 'function')\n            {\n               unsubscribe();\n               this.#mapUnsubscribe.delete(data.validator);\n            }\n         }\n\n         return !remove; // Swap here to actually remove the item via array validator method.\n      });\n\n      // TODO: handle validator updates.\n      // if (length !== this.#validatorData.length) { this.#indexUpdate(); }\n   }\n}\n\nclass BasicBounds\n{\n   /**\n    * When true constrains the min / max width or height to element.\n    *\n    * @type {boolean}\n    */\n   #constrain;\n\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * When true the validator is active.\n    *\n    * @type {boolean}\n    */\n   #enabled;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   constructor({ constrain = true, element, enabled = true, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.constrain = constrain;\n      this.enabled = enabled;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   get constrain() { return this.#constrain; }\n\n   get element() { return this.#element; }\n\n   get enabled() { return this.#enabled; }\n\n   get height() { return this.#height; }\n\n   get width() { return this.#width; }\n\n   set constrain(constrain)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof constrain !== 'boolean') { throw new TypeError(`'constrain' is not a boolean.`); }\n\n      this.#constrain = constrain;\n   }\n\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0  || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   set enabled(enabled)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Provides a validator that respects transforms in positional data constraining the position to within the target\n    * elements bounds.\n    *\n    * @param {import('../').ValidationData}   valData - The associated validation data for position updates.\n    *\n    * @returns {import('../').TJSPositionData} Potentially adjusted position data.\n    */\n   validator(valData)\n   {\n      // Early out if element is undefined or local enabled state is false.\n      if (!this.#enabled) { return valData.position; }\n\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      if (typeof valData.position.width === 'number')\n      {\n         const maxW = valData.maxWidth ?? (this.#constrain ? boundsWidth : Number.MAX_SAFE_INTEGER);\n         valData.position.width = valData.width = clamp(valData.position.width, valData.minWidth, maxW);\n\n         if ((valData.width + valData.position.left + valData.marginLeft) > boundsWidth)\n         {\n            valData.position.left = boundsWidth - valData.width - valData.marginLeft;\n         }\n      }\n\n      if (typeof valData.position.height === 'number')\n      {\n         const maxH = valData.maxHeight ?? (this.#constrain ? boundsHeight : Number.MAX_SAFE_INTEGER);\n         valData.position.height = valData.height = clamp(valData.position.height, valData.minHeight, maxH);\n\n         if ((valData.height + valData.position.top + valData.marginTop) > boundsHeight)\n         {\n            valData.position.top = boundsHeight - valData.height - valData.marginTop;\n         }\n      }\n\n      const maxL = Math.max(boundsWidth - valData.width - valData.marginLeft, 0);\n      valData.position.left = Math.round(clamp(valData.position.left, 0, maxL));\n\n      const maxT = Math.max(boundsHeight - valData.height - valData.marginTop, 0);\n      valData.position.top = Math.round(clamp(valData.position.top, 0, maxT));\n\n      return valData.position;\n   }\n}\n\nconst s_TRANSFORM_DATA = new TJSTransformData();\n\nclass TransformBounds\n{\n   /**\n    * When true constrains the min / max width or height to element.\n    *\n    * @type {boolean}\n    */\n   #constrain;\n\n   /**\n    * @type {HTMLElement}\n    */\n   #element;\n\n   /**\n    * When true the validator is active.\n    *\n    * @type {boolean}\n    */\n   #enabled;\n\n   /**\n    * Provides a manual setting of the element height. As things go `offsetHeight` causes a browser layout and is not\n    * performance oriented. If manually set this height is used instead of `offsetHeight`.\n    *\n    * @type {number}\n    */\n   #height;\n\n   /**\n    * Set from an optional value in the constructor to lock accessors preventing modification.\n    */\n   #lock;\n\n   /**\n    * Provides a manual setting of the element width. As things go `offsetWidth` causes a browser layout and is not\n    * performance oriented. If manually set this width is used instead of `offsetWidth`.\n    *\n    * @type {number}\n    */\n   #width;\n\n   constructor({ constrain = true, element, enabled = true, lock = false, width, height } = {})\n   {\n      this.element = element;\n      this.constrain = constrain;\n      this.enabled = enabled;\n      this.width = width;\n      this.height = height;\n\n      this.#lock = typeof lock === 'boolean' ? lock : false;\n   }\n\n   get constrain() { return this.#constrain; }\n\n   get element() { return this.#element; }\n\n   get enabled() { return this.#enabled; }\n\n   get height() { return this.#height; }\n\n   get width() { return this.#width; }\n\n   set constrain(constrain)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof constrain !== 'boolean') { throw new TypeError(`'constrain' is not a boolean.`); }\n\n      this.#constrain = constrain;\n   }\n\n   set element(element)\n   {\n      if (this.#lock) { return; }\n\n      if (element === void 0 || element === null || element instanceof HTMLElement)\n      {\n         this.#element = element;\n      }\n      else\n      {\n         throw new TypeError(`'element' is not a HTMLElement, undefined, or null.`);\n      }\n   }\n\n   set enabled(enabled)\n   {\n      if (this.#lock) { return; }\n\n      if (typeof enabled !== 'boolean') { throw new TypeError(`'enabled' is not a boolean.`); }\n\n      this.#enabled = enabled;\n   }\n\n   set height(height)\n   {\n      if (this.#lock) { return; }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   set width(width)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n   }\n\n   setDimension(width, height)\n   {\n      if (this.#lock) { return; }\n\n      if (width === void 0 || Number.isFinite(width))\n      {\n         this.#width = width;\n      }\n      else\n      {\n         throw new TypeError(`'width' is not a finite number or undefined.`);\n      }\n\n      if (height === void 0 || Number.isFinite(height))\n      {\n         this.#height = height;\n      }\n      else\n      {\n         throw new TypeError(`'height' is not a finite number or undefined.`);\n      }\n   }\n\n   /**\n    * Provides a validator that respects transforms in positional data constraining the position to within the target\n    * elements bounds.\n    *\n    * @param {import('../').ValidationData}   valData - The associated validation data for position updates.\n    *\n    * @returns {import('../').TJSPositionData} Potentially adjusted position data.\n    */\n   validator(valData)\n   {\n      // Early out if element is undefined or local enabled state is false.\n      if (!this.#enabled) { return valData.position; }\n\n      // Determine containing bounds from manual values; or any element; lastly the browser width / height.\n      const boundsWidth = this.#width ?? this.#element?.offsetWidth ?? globalThis.innerWidth;\n      const boundsHeight = this.#height ?? this.#element?.offsetHeight ?? globalThis.innerHeight;\n\n      // Ensure min / max width constraints when position width is a number; not 'auto' or 'inherit'. If constrain is\n      // true cap width bounds.\n      if (typeof valData.position.width === 'number')\n      {\n         const maxW = valData.maxWidth ?? (this.#constrain ? boundsWidth : Number.MAX_SAFE_INTEGER);\n         valData.position.width = clamp(valData.width, valData.minWidth, maxW);\n      }\n\n      // Ensure min / max height constraints when position height is a number; not 'auto' or 'inherit'. If constrain\n      // is true cap height bounds.\n      if (typeof valData.position.height === 'number')\n      {\n         const maxH = valData.maxHeight ?? (this.#constrain ? boundsHeight : Number.MAX_SAFE_INTEGER);\n         valData.position.height = clamp(valData.height, valData.minHeight, maxH);\n      }\n\n      // Get transform data. First set constraints including any margin top / left as offsets and width / height. Used\n      // when position width / height is 'auto'.\n      const data = valData.transforms.getData(valData.position, s_TRANSFORM_DATA, valData);\n\n      // Check the bounding rectangle against browser height / width. Adjust position based on how far the overlap of\n      // the bounding rect is outside the bounds height / width. The order below matters as the constraints are top /\n      // left oriented, so perform those checks last.\n\n      const initialX = data.boundingRect.x;\n      const initialY = data.boundingRect.y;\n\n      if (data.boundingRect.bottom + valData.marginTop > boundsHeight)\n      {\n         data.boundingRect.y += boundsHeight - data.boundingRect.bottom - valData.marginTop;\n      }\n\n      if (data.boundingRect.right + valData.marginLeft > boundsWidth)\n      {\n         data.boundingRect.x += boundsWidth - data.boundingRect.right - valData.marginLeft;\n      }\n\n      if (data.boundingRect.top - valData.marginTop < 0)\n      {\n         data.boundingRect.y += Math.abs(data.boundingRect.top - valData.marginTop);\n      }\n\n      if (data.boundingRect.left - valData.marginLeft < 0)\n      {\n         data.boundingRect.x += Math.abs(data.boundingRect.left - valData.marginLeft);\n      }\n\n      valData.position.left -= initialX - data.boundingRect.x;\n      valData.position.top -= initialY - data.boundingRect.y;\n\n      return valData.position;\n   }\n}\n\nclass UpdateElementData\n{\n   constructor()\n   {\n      /**\n       * Stores the private data from TJSPosition.\n       *\n       * @type {TJSPositionData}\n       */\n      this.data = void 0;\n\n      /**\n       * Provides a copy of local data sent to subscribers.\n       *\n       * @type {TJSPositionData}\n       */\n      this.dataSubscribers = new TJSPositionData();\n\n      /**\n       * Stores the current dimension data used for the readable `dimension` store.\n       *\n       * @type {{width: number | 'auto', height: number | 'auto'}}\n       */\n      this.dimensionData = { width: 0, height: 0 };\n\n      /**\n       * @type {import('../PositionChangeSet').PositionChangeSet}\n       */\n      this.changeSet = void 0;\n\n      /**\n       * @type {import('../').TJSPositionOptions}\n       */\n      this.options = void 0;\n\n      /**\n       * Stores if this TJSPosition / update data is queued for update.\n       *\n       * @type {boolean}\n       */\n      this.queued = false;\n\n      /**\n       * @type {import('../StyleCache').StyleCache}\n       */\n      this.styleCache = void 0;\n\n      /**\n       * @type {import('../transform').TJSTransforms}\n       */\n      this.transforms = void 0;\n\n      /**\n       * Stores the current transform data used for the readable `transform` store. It is only active when there are\n       * subscribers to the store or calculateTransform options is true.\n       *\n       * @type {TJSTransformData}\n       */\n      this.transformData = new TJSTransformData();\n\n      /**\n       * @type {(function(TJSPositionData): void)[]}\n       */\n      this.subscriptions = void 0;\n\n      /**\n       * @type {import('svelte/store').Writable<{width: (number|\"auto\"), height: (number|\"auto\")}>}\n       */\n      this.storeDimension = writable(this.dimensionData);\n\n      // When there are subscribers set option to calculate transform updates; set to false when no subscribers.\n\n      /**\n       * @type {import('svelte/store').Writable<TJSTransformData>}\n       */\n      this.storeTransform = writable(this.transformData, () =>\n      {\n         this.options.transformSubscribed = true;\n         return () => this.options.transformSubscribed = false;\n      });\n\n      /**\n       * Stores the queued state for update element processing.\n       *\n       * @type {boolean}\n       */\n      this.queued = false;\n\n      // Seal data backing readable stores.\n      Object.seal(this.dimensionData);\n   }\n}\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke\n * {@link TJSPosition.elementUpdated} to await on the returned promise that is resolved with the current\n * render time via `nextAnimationFrame` / `requestAnimationFrame`. This allows the underlying data model to be updated\n * immediately while updates to the element are in sync with the browser and potentially in the future be further\n * throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n */\nclass UpdateElementManager\n{\n   static list = [];\n   static listCntr = 0;\n\n   static updatePromise;\n\n   static get promise() { return this.updatePromise; }\n\n   /**\n    * Potentially adds the given element and internal updateData instance to the list.\n    *\n    * @param {HTMLElement}       el - An HTMLElement instance.\n    *\n    * @param {import('./UpdateElementData').UpdateElementData} updateData - An UpdateElementData instance.\n    *\n    * @returns {Promise<number>} The unified next frame update promise. Returns `currentTime`.\n    */\n   static add(el, updateData)\n   {\n      if (this.listCntr < this.list.length)\n      {\n         const entry = this.list[this.listCntr];\n         entry[0] = el;\n         entry[1] = updateData;\n      }\n      else\n      {\n         this.list.push([el, updateData]);\n      }\n\n      this.listCntr++;\n      updateData.queued = true;\n\n      if (!this.updatePromise) { this.updatePromise = this.wait(); }\n\n      return this.updatePromise;\n   }\n\n   /**\n    * Await on `nextAnimationFrame` and iterate over list map invoking callback functions.\n    *\n    * @returns {Promise<number>} The next frame Promise / currentTime from nextAnimationFrame.\n    */\n   static async wait()\n   {\n      // Await the next animation frame. In the future this can be extended to multiple frames to divide update rate.\n      const currentTime = await nextAnimationFrame();\n\n      this.updatePromise = void 0;\n\n      for (let cntr = this.listCntr; --cntr >= 0;)\n      {\n         // Obtain data for entry.\n         const entry = this.list[cntr];\n         const el = entry[0];\n         const updateData = entry[1];\n\n         // Clear entry data.\n         entry[0] = void 0;\n         entry[1] = void 0;\n\n         // Reset queued state.\n         updateData.queued = false;\n\n         // Early out if the element is no longer connected to the DOM / shadow root.\n         // if (!el.isConnected || !updateData.changeSet.hasChange()) { continue; }\n         if (!el.isConnected) { continue; }\n\n         if (updateData.options.ortho)\n         {\n            s_UPDATE_ELEMENT_ORTHO(el, updateData);\n         }\n         else\n         {\n            s_UPDATE_ELEMENT(el, updateData);\n         }\n\n         // If calculate transform options is enabled then update the transform data and set the readable store.\n         if (updateData.options.calculateTransform || updateData.options.transformSubscribed)\n         {\n            s_UPDATE_TRANSFORM(el, updateData);\n         }\n\n         // Update all subscribers with changed data.\n         this.updateSubscribers(updateData);\n      }\n\n      this.listCntr = 0;\n\n      return currentTime;\n   }\n\n   /**\n    * Potentially immediately updates the given element.\n    *\n    * @param {HTMLElement}       el - An HTMLElement instance.\n    *\n    * @param {import('./UpdateElementData').UpdateElementData} updateData - An UpdateElementData instance.\n    */\n   static immediate(el, updateData)\n   {\n      // Early out if the element is no longer connected to the DOM / shadow root.\n      // if (!el.isConnected || !updateData.changeSet.hasChange()) { continue; }\n      if (!el.isConnected) { return; }\n\n      if (updateData.options.ortho)\n      {\n         s_UPDATE_ELEMENT_ORTHO(el, updateData);\n      }\n      else\n      {\n         s_UPDATE_ELEMENT(el, updateData);\n      }\n\n      // If calculate transform options is enabled then update the transform data and set the readable store.\n      if (updateData.options.calculateTransform || updateData.options.transformSubscribed)\n      {\n         s_UPDATE_TRANSFORM(el, updateData);\n      }\n\n      // Update all subscribers with changed data.\n      this.updateSubscribers(updateData);\n   }\n\n   /**\n    * @param {import('./UpdateElementData').UpdateElementData} updateData - Data change set.\n    */\n   static updateSubscribers(updateData)\n   {\n      const data = updateData.data;\n      const changeSet = updateData.changeSet;\n\n      if (!changeSet.hasChange()) { return; }\n\n      // Make a copy of the data.\n      const output = updateData.dataSubscribers.copy(data);\n\n      const subscriptions = updateData.subscriptions;\n\n      // Early out if there are no subscribers.\n      if (subscriptions.length > 0)\n      {\n         for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](output); }\n      }\n\n      // Update dimension data if width / height has changed.\n      if (changeSet.width || changeSet.height)\n      {\n         updateData.dimensionData.width = data.width;\n         updateData.dimensionData.height = data.height;\n         updateData.storeDimension.set(updateData.dimensionData);\n      }\n\n      changeSet.set(false);\n   }\n}\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke\n * {@link TJSPosition.elementUpdated} to await on the returned promise that is resolved with the current\n * render time via `nextAnimationFrame` / `requestAnimationFrame`. This allows the underlying data model to be updated\n * immediately while updates to the element are in sync with the browser and potentially in the future be further\n * throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {import('./UpdateElementData').UpdateElementData} updateData - Update data.\n */\nfunction s_UPDATE_ELEMENT(el, updateData)\n{\n   const changeSet = updateData.changeSet;\n   const data = updateData.data;\n\n   if (changeSet.left)\n   {\n      el.style.left = `${data.left}px`;\n   }\n\n   if (changeSet.top)\n   {\n      el.style.top = `${data.top}px`;\n   }\n\n   if (changeSet.zIndex)\n   {\n      el.style.zIndex = typeof data.zIndex === 'number' ? `${data.zIndex}` : null;\n   }\n\n   if (changeSet.width)\n   {\n      el.style.width = typeof data.width === 'number' ? `${data.width}px` : data.width;\n   }\n\n   if (changeSet.height)\n   {\n      el.style.height = typeof data.height === 'number' ? `${data.height}px` : data.height;\n   }\n\n   if (changeSet.transformOrigin)\n   {\n      el.style.transformOrigin = data.transformOrigin;\n   }\n\n   // Update all transforms in order added to transforms object.\n   if (changeSet.transform)\n   {\n      el.style.transform = updateData.transforms.isActive ? updateData.transforms.getCSS() : null;\n   }\n}\n\n/**\n * Decouples updates to any parent target HTMLElement inline styles. Invoke\n * {@link TJSPosition.elementUpdated} to await on the returned promise that is resolved with the current\n * render time via `nextAnimationFrame` / `requestAnimationFrame`. This allows the underlying data model to be updated\n * immediately while updates to the element are in sync with the browser and potentially in the future be further\n * throttled.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {import('./UpdateElementData').UpdateElementData} updateData - Update data.\n */\nfunction s_UPDATE_ELEMENT_ORTHO(el, updateData)\n{\n   const changeSet = updateData.changeSet;\n   const data = updateData.data;\n\n   if (changeSet.zIndex)\n   {\n      el.style.zIndex = typeof data.zIndex === 'number' ? `${data.zIndex}` : null;\n   }\n\n   if (changeSet.width)\n   {\n      el.style.width = typeof data.width === 'number' ? `${data.width}px` : data.width;\n   }\n\n   if (changeSet.height)\n   {\n      el.style.height = typeof data.height === 'number' ? `${data.height}px` : data.height;\n   }\n\n   if (changeSet.transformOrigin)\n   {\n      el.style.transformOrigin = data.transformOrigin;\n   }\n\n   // Update all transforms in order added to transforms object.\n   if (changeSet.left || changeSet.top || changeSet.transform)\n   {\n      el.style.transform = updateData.transforms.getCSSOrtho(data);\n   }\n}\n\n/**\n * Updates the applied transform data and sets the readble `transform` store.\n *\n * @param {HTMLElement} el - The target HTMLElement.\n *\n * @param {import('./UpdateElementData').UpdateElementData} updateData - Update element data.\n */\nfunction s_UPDATE_TRANSFORM(el, updateData)\n{\n   s_VALIDATION_DATA$1.height = updateData.data.height !== 'auto' ? updateData.data.height :\n    updateData.styleCache.offsetHeight;\n\n   s_VALIDATION_DATA$1.width = updateData.data.width !== 'auto' ? updateData.data.width :\n    updateData.styleCache.offsetWidth;\n\n   s_VALIDATION_DATA$1.marginLeft = updateData.styleCache.marginLeft;\n\n   s_VALIDATION_DATA$1.marginTop = updateData.styleCache.marginTop;\n\n   // Get transform data. First set constraints including any margin top / left as offsets and width / height. Used\n   // when position width / height is 'auto'.\n   updateData.transforms.getData(updateData.data, updateData.transformData, s_VALIDATION_DATA$1);\n\n   updateData.storeTransform.set(updateData.transformData);\n}\n\nconst s_VALIDATION_DATA$1 = {\n   height: void 0,\n   width: void 0,\n   marginLeft: void 0,\n   marginTop: void 0\n};\n\n/**\n * Provides a store for position following the subscriber protocol in addition to providing individual writable derived\n * stores for each independent variable.\n */\nclass TJSPosition\n{\n   /**\n    * @type {{browserCentered: Centered, Centered: Centered}}\n    */\n   static #positionInitial = {\n      browserCentered: new Centered({ lock: true }),\n      Centered\n   };\n\n   /**\n    * @type {{TransformBounds: TransformBounds, BasicBounds: BasicBounds, basicWindow: BasicBounds, transformWindow: TransformBounds}}\n    */\n   static #positionValidators = {\n      basicWindow: new BasicBounds({ lock: true }),\n      BasicBounds,\n      transformWindow: new TransformBounds({ lock: true }),\n      TransformBounds\n   };\n\n   /**\n    * @type {TJSPositionData}\n    */\n   #data = new TJSPositionData();\n\n   /**\n    * Provides the animation API.\n    *\n    * @type {AnimationAPI}\n    */\n   #animate = new AnimationAPI(this, this.#data);\n\n   /**\n    * Provides a way to turn on / off the position handling.\n    *\n    * @type {boolean}\n    */\n   #enabled = true;\n\n   /**\n    * Stores ongoing options that are set in the constructor or by transform store subscription.\n    *\n    * @type {import('./').TJSPositionOptions}\n    */\n   #options = {\n      calculateTransform: false,\n      initialHelper: void 0,\n      ortho: true,\n      transformSubscribed: false\n   };\n\n   /**\n    * The associated parent for positional data tracking. Used in validators.\n    *\n    * @type {import('./').TJSPositionParent}\n    */\n   #parent;\n\n   /**\n    * Stores the style attributes that changed on update.\n    *\n    * @type {PositionChangeSet}\n    */\n   #positionChangeSet = new PositionChangeSet();\n\n   /**\n    * @type {import('./').TJSPositionStores}\n    */\n   #stores;\n\n   /**\n    * Stores an instance of the computer styles for the target element.\n    *\n    * @type {StyleCache}\n    */\n   #styleCache;\n\n   /**\n    * Stores the subscribers.\n    *\n    * @type {import('svelte/store').Subscriber<TJSPositionData>[]}\n    */\n   #subscriptions = [];\n\n   /**\n    * @type {TJSTransforms}\n    */\n   #transforms = new TJSTransforms();\n\n   /**\n    * @type {UpdateElementData}\n    */\n   #updateElementData;\n\n   /**\n    * Stores the UpdateElementManager wait promise.\n    *\n    * @type {Promise}\n    */\n   #updateElementPromise;\n\n   /**\n    * @type {AdapterValidators}\n    */\n   #validators;\n\n   /**\n    * @type {import('./').ValidatorData[]}\n    */\n   #validatorData;\n\n   /**\n    * @type {PositionStateAPI}\n    */\n   #state = new PositionStateAPI(this, this.#data, this.#transforms);\n\n   /**\n    * @returns {AnimationGroupAPI} Public Animation API.\n    */\n   static get Animate() { return AnimationGroupAPI; }\n\n   /**\n    * @returns {{browserCentered: Centered, Centered: Centered}} TJSPosition initial API.\n    */\n   static get Initial() { return this.#positionInitial; }\n\n   /**\n    * Returns TJSTransformData class / constructor.\n    *\n    * @returns {TJSTransformData} TJSTransformData class / constructor.\n    */\n   static get TransformData() { return TJSTransformData; }\n\n   /**\n    * Returns default validators.\n    *\n    * Note: `basicWindow` and `BasicBounds` will eventually be removed.\n    *\n    * @returns {{TransformBounds: TransformBounds, BasicBounds: BasicBounds, basicWindow: BasicBounds, transformWindow: TransformBounds}}\n    * Available validators.\n    */\n   static get Validators() { return this.#positionValidators; }\n\n   /**\n    * Returns a duplicate of a given position instance copying any options and validators.\n    *\n    * // TODO: Consider more safety over options processing.\n    *\n    * @param {TJSPosition}          position - A position instance.\n    *\n    * @param {import('./').TJSPositionOptions}   options - TJSPosition options.\n    *\n    * @returns {TJSPosition} A duplicate position instance.\n    */\n   static duplicate(position, options)\n   {\n      if (!(position instanceof TJSPosition)) { throw new TypeError(`'position' is not an instance of Position.`); }\n\n      const newPosition = new TJSPosition(options);\n\n      newPosition.#options = Object.assign({}, position.#options, options);\n      newPosition.#validators.add(...position.#validators);\n\n      newPosition.set(position.#data);\n\n      return newPosition;\n   }\n\n   /**\n    * @param {import('./').TJSPositionParent | import('./').TJSPositionOptionsAll}   [parent] - A\n    *        potential parent element or object w/ `elementTarget` getter. May also be the TJSPositionOptions object\n    *        w/ 1 argument.\n    *\n    * @param {import('./').TJSPositionOptionsAll}   [options] - Default values.\n    */\n   constructor(parent, options)\n   {\n      // Test if `parent` is a plain object; if so treat as options object.\n      if (isPlainObject(parent))\n      {\n         options = parent;\n      }\n      else\n      {\n         this.#parent = parent;\n      }\n\n      const data = this.#data;\n      const transforms = this.#transforms;\n\n      this.#styleCache = new StyleCache();\n\n      const updateData = new UpdateElementData();\n\n      updateData.changeSet = this.#positionChangeSet;\n      updateData.data = this.#data;\n      updateData.options = this.#options;\n      updateData.styleCache = this.#styleCache;\n      updateData.subscriptions = this.#subscriptions;\n      updateData.transforms = this.#transforms;\n\n      this.#updateElementData = updateData;\n\n      if (isObject(options))\n      {\n         // Set TJSPosition options\n         if (typeof options.calculateTransform === 'boolean')\n         {\n            this.#options.calculateTransform = options.calculateTransform;\n         }\n\n         if (typeof options.ortho === 'boolean')\n         {\n            this.#options.ortho = options.ortho;\n         }\n\n         // Set default values from options.\n\n         if (Number.isFinite(options.height) || options.height === 'auto' || options.height === 'inherit' ||\n          options.height === null)\n         {\n            data.height = updateData.dimensionData.height = typeof options.height === 'number' ?\n             Math.round(options.height) : options.height;\n         }\n\n         if (Number.isFinite(options.left) || options.left === null)\n         {\n            data.left = typeof options.left === 'number' ? Math.round(options.left) : options.left;\n         }\n\n         if (Number.isFinite(options.maxHeight) || options.maxHeight === null)\n         {\n            data.maxHeight = typeof options.maxHeight === 'number' ? Math.round(options.maxHeight) : options.maxHeight;\n         }\n\n         if (Number.isFinite(options.maxWidth) || options.maxWidth === null)\n         {\n            data.maxWidth = typeof options.maxWidth === 'number' ? Math.round(options.maxWidth) : options.maxWidth;\n         }\n\n         if (Number.isFinite(options.minHeight) || options.minHeight === null)\n         {\n            data.minHeight = typeof options.minHeight === 'number' ? Math.round(options.minHeight) : options.minHeight;\n         }\n\n         if (Number.isFinite(options.minWidth) || options.minWidth === null)\n         {\n            data.minWidth = typeof options.minWidth === 'number' ? Math.round(options.minWidth) : options.minWidth;\n         }\n\n         if (Number.isFinite(options.rotateX) || options.rotateX === null)\n         {\n            transforms.rotateX = data.rotateX = options.rotateX;\n         }\n\n         if (Number.isFinite(options.rotateY) || options.rotateY === null)\n         {\n            transforms.rotateY = data.rotateY = options.rotateY;\n         }\n\n         if (Number.isFinite(options.rotateZ) || options.rotateZ === null)\n         {\n            transforms.rotateZ = data.rotateZ = options.rotateZ;\n         }\n\n         if (Number.isFinite(options.scale) || options.scale === null)\n         {\n            transforms.scale = data.scale = options.scale;\n         }\n\n         if (Number.isFinite(options.top) || options.top === null)\n         {\n            data.top = typeof options.top === 'number' ? Math.round(options.top) : options.top;\n         }\n\n         if (typeof options.transformOrigin === 'string' || options.transformOrigin === null)\n         {\n            data.transformOrigin = transformOrigins.includes(options.transformOrigin) ?\n             options.transformOrigin : null;\n         }\n\n         if (Number.isFinite(options.translateX) || options.translateX === null)\n         {\n            transforms.translateX = data.translateX = options.translateX;\n         }\n\n         if (Number.isFinite(options.translateY) || options.translateY === null)\n         {\n            transforms.translateY = data.translateY = options.translateY;\n         }\n\n         if (Number.isFinite(options.translateZ) || options.translateZ === null)\n         {\n            transforms.translateZ = data.translateZ = options.translateZ;\n         }\n\n         if (Number.isFinite(options.width) || options.width === 'auto' || options.width === 'inherit' ||\n          options.width === null)\n         {\n            data.width = updateData.dimensionData.width = typeof options.width === 'number' ?\n             Math.round(options.width) : options.width;\n         }\n\n         if (Number.isFinite(options.zIndex) || options.zIndex === null)\n         {\n            data.zIndex = typeof options.zIndex === 'number' ? Math.round(options.zIndex) : options.zIndex;\n         }\n      }\n\n      this.#stores = {\n         // The main properties for manipulating TJSPosition.\n         height: propertyStore(this, 'height'),\n         left: propertyStore(this, 'left'),\n         rotateX: propertyStore(this, 'rotateX'),\n         rotateY: propertyStore(this, 'rotateY'),\n         rotateZ: propertyStore(this, 'rotateZ'),\n         scale: propertyStore(this, 'scale'),\n         top: propertyStore(this, 'top'),\n         transformOrigin: propertyStore(this, 'transformOrigin'),\n         translateX: propertyStore(this, 'translateX'),\n         translateY: propertyStore(this, 'translateY'),\n         translateZ: propertyStore(this, 'translateZ'),\n         width: propertyStore(this, 'width'),\n         zIndex: propertyStore(this, 'zIndex'),\n\n         // Stores that control validation when width / height is not `auto`.\n         maxHeight: propertyStore(this, 'maxHeight'),\n         maxWidth: propertyStore(this, 'maxWidth'),\n         minHeight: propertyStore(this, 'minHeight'),\n         minWidth: propertyStore(this, 'minWidth'),\n\n         // Readable stores based on updates or from resize observer changes.\n         dimension: { subscribe: updateData.storeDimension.subscribe },\n         element: { subscribe: this.#styleCache.stores.element.subscribe },\n         resizeContentHeight: { subscribe: this.#styleCache.stores.resizeContentHeight.subscribe },\n         resizeContentWidth: { subscribe: this.#styleCache.stores.resizeContentWidth.subscribe },\n         resizeOffsetHeight: { subscribe: this.#styleCache.stores.resizeOffsetHeight.subscribe },\n         resizeOffsetWidth: { subscribe: this.#styleCache.stores.resizeOffsetWidth.subscribe },\n         transform: { subscribe: updateData.storeTransform.subscribe },\n\n         // Protected store that should only be set by resizeObserver action.\n         resizeObserved: this.#styleCache.stores.resizeObserved,\n      };\n\n      // When resize change from any applied resizeObserver action automatically set data for new validation run.\n      // A resizeObserver prop should be set to true for ApplicationShell components or usage of resizeObserver action\n      // to monitor for changes. This should only be used on elements that have 'auto' for width or height.\n      subscribeIgnoreFirst(this.#stores.resizeObserved, (resizeData) =>\n      {\n         const parent = this.#parent;\n         const el = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n\n         // Only invoke set if there is a target element and the resize data has a valid offset width & height.\n         if (el instanceof HTMLElement && Number.isFinite(resizeData?.offsetWidth) &&\n          Number.isFinite(resizeData?.offsetHeight))\n         {\n            this.set(data);\n         }\n      });\n\n      this.#stores.transformOrigin.values = transformOrigins;\n\n      [this.#validators, this.#validatorData] = new AdapterValidators();\n\n      if (options?.initial || options?.positionInitial)\n      {\n         const initialHelper = options.initial ?? options.positionInitial;\n\n         if (typeof initialHelper?.getLeft !== 'function' || typeof initialHelper?.getTop !== 'function')\n         {\n            throw new Error(\n             `'options.initial' position helper does not contain 'getLeft' and / or 'getTop' functions.`);\n         }\n\n         this.#options.initialHelper = options.initial;\n      }\n\n      if (options?.validator)\n      {\n         if (isIterable(options?.validator)) { this.validators.add(...options.validator); }\n         else { this.validators.add(options.validator); }\n      }\n   }\n\n   /**\n    * Returns the animation API.\n    *\n    * @returns {AnimationAPI} Animation API.\n    */\n   get animate()\n   {\n      return this.#animate;\n   }\n\n   /**\n    * Returns the dimension data for the readable store.\n    *\n    * @returns {{width: number | 'auto', height: number | 'auto'}} Dimension data.\n    */\n   get dimension()\n   {\n      return this.#updateElementData.dimensionData;\n   }\n\n   /**\n    * Returns the enabled state.\n    *\n    * @returns {boolean} Enabled state.\n    */\n   get enabled()\n   {\n      return this.#enabled;\n   }\n\n   /**\n    * Returns the current HTMLElement being positioned.\n    *\n    * @returns {HTMLElement|undefined} Current HTMLElement being positioned.\n    */\n   get element()\n   {\n      return this.#styleCache.el;\n   }\n\n   /**\n    * Returns a promise that is resolved on the next element update with the time of the update.\n    *\n    * @returns {Promise<number>} Promise resolved on element update.\n    */\n   get elementUpdated()\n   {\n      return this.#updateElementPromise;\n   }\n\n   /**\n    * Returns the associated {@link TJSPositionParent} instance.\n    *\n    * @returns {import('./').TJSPositionParent} The TJSPositionParent instance.\n    */\n   get parent() { return this.#parent; }\n\n   /**\n    * Returns the state API.\n    *\n    * @returns {import('./PositionStateAPI').PositionStateAPI} TJSPosition state API.\n    */\n   get state() { return this.#state; }\n\n   /**\n    * Returns the derived writable stores for individual data variables.\n    *\n    * @returns {import('./').TJSPositionStores} Derived / writable stores.\n    */\n   get stores() { return this.#stores; }\n\n   /**\n    * Returns the transform data for the readable store.\n    *\n    * @returns {TJSTransformData} Transform Data.\n    */\n   get transform()\n   {\n      return this.#updateElementData.transformData;\n   }\n\n   /**\n    * Returns the validators.\n    *\n    * @returns {AdapterValidators} validators.\n    */\n   get validators() { return this.#validators; }\n\n   /**\n    * Sets the enabled state.\n    *\n    * @param {boolean}  enabled - New enabled state.\n    */\n   set enabled(enabled)\n   {\n      if (typeof enabled !== 'boolean')\n      {\n         throw new TypeError(`'enabled' is not a boolean.`);\n      }\n\n      this.#enabled = enabled;\n   }\n\n   /**\n    * Sets the associated {@link TJSPositionParent} instance. Resets the style cache and default data.\n    *\n    * @param {import('./').TJSPositionParent} parent - A TJSPositionParent instance.\n    */\n   set parent(parent)\n   {\n      if (parent !== void 0 && !(parent instanceof HTMLElement) && !isObject(parent))\n      {\n         throw new TypeError(`'parent' is not an HTMLElement, object, or undefined.`);\n      }\n\n      this.#parent = parent;\n\n      // Reset any stored default data & the style cache.\n      this.#state.remove({ name: '#defaultData' });\n      this.#styleCache.reset();\n\n      // If a parent is defined then invoke set to update any parent element.\n      if (parent) { this.set(this.#data); }\n   }\n\n// Data accessors ----------------------------------------------------------------------------------------------------\n\n   /**\n    * @returns {number|'auto'|'inherit'|null} height\n    */\n   get height() { return this.#data.height; }\n\n   /**\n    * @returns {number|null} left\n    */\n   get left() { return this.#data.left; }\n\n   /**\n    * @returns {number|null} maxHeight\n    */\n   get maxHeight() { return this.#data.maxHeight; }\n\n   /**\n    * @returns {number|null} maxWidth\n    */\n   get maxWidth() { return this.#data.maxWidth; }\n\n   /**\n    * @returns {number|null} minHeight\n    */\n   get minHeight() { return this.#data.minHeight; }\n\n   /**\n    * @returns {number|null} minWidth\n    */\n   get minWidth() { return this.#data.minWidth; }\n\n   /**\n    * @returns {number|null} rotateX\n    */\n   get rotateX() { return this.#data.rotateX; }\n\n   /**\n    * @returns {number|null} rotateY\n    */\n   get rotateY() { return this.#data.rotateY; }\n\n   /**\n    * @returns {number|null} rotateZ\n    */\n   get rotateZ() { return this.#data.rotateZ; }\n\n   /**\n    * @returns {number|null} alias for rotateZ\n    */\n   get rotation() { return this.#data.rotateZ; }\n\n   /**\n    * @returns {number|null} scale\n    */\n   get scale() { return this.#data.scale; }\n\n   /**\n    * @returns {number|null} top\n    */\n   get top() { return this.#data.top; }\n\n   /**\n    * @returns {import('./').TJSTransformOrigin} transformOrigin\n    */\n   get transformOrigin() { return this.#data.transformOrigin; }\n\n   /**\n    * @returns {number|null} translateX\n    */\n   get translateX() { return this.#data.translateX; }\n\n   /**\n    * @returns {number|null} translateY\n    */\n   get translateY() { return this.#data.translateY; }\n\n   /**\n    * @returns {number|null} translateZ\n    */\n   get translateZ() { return this.#data.translateZ; }\n\n   /**\n    * @returns {number|'auto'|'inherit'|null} width\n    */\n   get width() { return this.#data.width; }\n\n   /**\n    * @returns {number|null} z-index\n    */\n   get zIndex() { return this.#data.zIndex; }\n\n   /**\n    * @param {number|string|null} height -\n    */\n   set height(height)\n   {\n      this.#stores.height.set(height);\n   }\n\n   /**\n    * @param {number|string|null} left -\n    */\n   set left(left)\n   {\n      this.#stores.left.set(left);\n   }\n\n   /**\n    * @param {number|string|null} maxHeight -\n    */\n   set maxHeight(maxHeight)\n   {\n      this.#stores.maxHeight.set(maxHeight);\n   }\n\n   /**\n    * @param {number|string|null} maxWidth -\n    */\n   set maxWidth(maxWidth)\n   {\n      this.#stores.maxWidth.set(maxWidth);\n   }\n\n   /**\n    * @param {number|string|null} minHeight -\n    */\n   set minHeight(minHeight)\n   {\n      this.#stores.minHeight.set(minHeight);\n   }\n\n   /**\n    * @param {number|string|null} minWidth -\n    */\n   set minWidth(minWidth)\n   {\n      this.#stores.minWidth.set(minWidth);\n   }\n\n   /**\n    * @param {number|string|null} rotateX -\n    */\n   set rotateX(rotateX)\n   {\n      this.#stores.rotateX.set(rotateX);\n   }\n\n   /**\n    * @param {number|string|null} rotateY -\n    */\n   set rotateY(rotateY)\n   {\n      this.#stores.rotateY.set(rotateY);\n   }\n\n   /**\n    * @param {number|string|null} rotateZ -\n    */\n   set rotateZ(rotateZ)\n   {\n      this.#stores.rotateZ.set(rotateZ);\n   }\n\n   /**\n    * @param {number|string|null} rotateZ - alias for rotateZ\n    */\n   set rotation(rotateZ)\n   {\n      this.#stores.rotateZ.set(rotateZ);\n   }\n\n   /**\n    * @param {number|string|null} scale -\n    */\n   set scale(scale)\n   {\n      this.#stores.scale.set(scale);\n   }\n\n   /**\n    * @param {number|string|null} top -\n    */\n   set top(top)\n   {\n      this.#stores.top.set(top);\n   }\n\n   /**\n    * @param {import('./').TJSTransformOrigin} transformOrigin -\n    */\n   set transformOrigin(transformOrigin)\n   {\n      if (transformOrigins.includes(transformOrigin)) { this.#stores.transformOrigin.set(transformOrigin); }\n   }\n\n   /**\n    * @param {number|string|null} translateX -\n    */\n   set translateX(translateX)\n   {\n      this.#stores.translateX.set(translateX);\n   }\n\n   /**\n    * @param {number|string|null} translateY -\n    */\n   set translateY(translateY)\n   {\n      this.#stores.translateY.set(translateY);\n   }\n\n   /**\n    * @param {number|string|null} translateZ -\n    */\n   set translateZ(translateZ)\n   {\n      this.#stores.translateZ.set(translateZ);\n   }\n\n   /**\n    * @param {number|string|null} width -\n    */\n   set width(width)\n   {\n      this.#stores.width.set(width);\n   }\n\n   /**\n    * @param {number|string|null} zIndex -\n    */\n   set zIndex(zIndex)\n   {\n      this.#stores.zIndex.set(zIndex);\n   }\n\n   /**\n    * Assigns current position to object passed into method.\n    *\n    * @param {object|TJSPositionData}  [position] - Target to assign current position data.\n    *\n    * @param {import('./').TJSPositionGetOptions}   [options] - Defines options for specific keys and substituting null\n    *        for numeric default values.\n    *\n    * @returns {TJSPositionData} Passed in object with current position data.\n    */\n   get(position = {}, options)\n   {\n      const keys = options?.keys;\n      const excludeKeys = options?.exclude;\n      const numeric = options?.numeric ?? false;\n\n      if (isIterable(keys))\n      {\n         // Replace any null values potentially with numeric default values.\n         if (numeric)\n         {\n            for (const key of keys) { position[key] = this[key] ?? numericDefaults[key]; }\n         }\n         else // Accept current values.\n         {\n            for (const key of keys) { position[key] = this[key]; }\n         }\n\n         // Remove any excluded keys.\n         if (isIterable(excludeKeys))\n         {\n            for (const key of excludeKeys) { delete position[key]; }\n         }\n\n         return position;\n      }\n      else\n      {\n         const data = Object.assign(position, this.#data);\n\n         // Remove any excluded keys.\n         if (isIterable(excludeKeys))\n         {\n            for (const key of excludeKeys) { delete data[key]; }\n         }\n\n         // Potentially set numeric defaults.\n         if (numeric) { setNumericDefaults(data); }\n\n         return data;\n      }\n   }\n\n   /**\n    * @returns {TJSPositionData} Current position data.\n    */\n   toJSON()\n   {\n      return Object.assign({}, this.#data);\n   }\n\n   /**\n    * All calculation and updates of position are implemented in {@link TJSPosition}. This allows position to be fully\n    * reactive and in control of updating inline styles for the application.\n    *\n    * Note: the logic for updating position is improved and changes a few aspects from the default\n    * {@link globalThis.Application.setPosition}. The gate on `popOut` is removed, so to ensure no positional\n    * application occurs popOut applications can set `this.options.positionable` to false ensuring no positional inline\n    * styles are applied.\n    *\n    * The initial set call on an application with a target element will always set width / height as this is\n    * necessary for correct calculations.\n    *\n    * When a target element is present updated styles are applied after validation. To modify the behavior of set\n    * implement one or more validator functions and add them from the application via\n    * `this.position.validators.add(<Function>)`.\n    *\n    * Updates to any target element are decoupled from the underlying TJSPosition data. This method returns this instance\n    * that you can then await on the target element inline style update by using {@link TJSPosition.elementUpdated}.\n    *\n    * @param {import('./').TJSPositionDataExtended} [position] - TJSPosition data to set.\n    *\n    * @returns {TJSPosition} This TJSPosition instance.\n    */\n   set(position = {})\n   {\n      if (!isObject(position)) { throw new TypeError(`Position - set error: 'position' is not an object.`); }\n\n      const parent = this.#parent;\n\n      // An early out to prevent `set` from taking effect if not enabled.\n      if (!this.#enabled)\n      {\n         return this;\n      }\n\n      // An early out to prevent `set` from taking effect if options `positionable` is false.\n      if (parent !== void 0 && typeof parent?.options?.positionable === 'boolean' && !parent?.options?.positionable)\n      {\n         return this;\n      }\n\n      // Callers can specify to immediately update an associated element. This is useful if set is called from\n      // requestAnimationFrame / rAF. Library integrations like GSAP invoke set from rAF.\n      const immediateElementUpdate = position.immediateElementUpdate === true;\n\n      const data = this.#data;\n      const transforms = this.#transforms;\n\n      // Find the target HTML element and verify that it is connected storing it in `el`.\n      const targetEl = parent instanceof HTMLElement ? parent : parent?.elementTarget;\n      const el = targetEl instanceof HTMLElement && targetEl.isConnected ? targetEl : void 0;\n\n      const changeSet = this.#positionChangeSet;\n      const styleCache = this.#styleCache;\n\n      if (el)\n      {\n         // Cache the computed styles of the element.\n         if (!styleCache.hasData(el))\n         {\n            styleCache.update(el);\n\n            // Add will-change property if not already set in inline or computed styles.\n            if (!styleCache.hasWillChange)\n            ;\n\n            // Update all properties / clear queued state.\n            changeSet.set(true);\n            this.#updateElementData.queued = false;\n         }\n\n         // Converts any relative string position data to numeric inputs.\n         convertRelative(position, this);\n\n         position = this.#updatePosition(position, parent, el, styleCache);\n\n         // Check if a validator cancelled the update.\n         if (position === null) { return this; }\n      }\n\n      if (Number.isFinite(position.left))\n      {\n         position.left = Math.round(position.left);\n\n         if (data.left !== position.left) { data.left = position.left; changeSet.left = true; }\n      }\n\n      if (Number.isFinite(position.top))\n      {\n         position.top = Math.round(position.top);\n\n         if (data.top !== position.top) { data.top = position.top; changeSet.top = true; }\n      }\n\n      if (Number.isFinite(position.maxHeight) || position.maxHeight === null)\n      {\n         position.maxHeight = typeof position.maxHeight === 'number' ? Math.round(position.maxHeight) : null;\n\n         if (data.maxHeight !== position.maxHeight) { data.maxHeight = position.maxHeight; changeSet.maxHeight = true; }\n      }\n\n      if (Number.isFinite(position.maxWidth) || position.maxWidth === null)\n      {\n         position.maxWidth = typeof position.maxWidth === 'number' ? Math.round(position.maxWidth) : null;\n\n         if (data.maxWidth !== position.maxWidth) { data.maxWidth = position.maxWidth; changeSet.maxWidth = true; }\n      }\n\n      if (Number.isFinite(position.minHeight) || position.minHeight === null)\n      {\n         position.minHeight = typeof position.minHeight === 'number' ? Math.round(position.minHeight) : null;\n\n         if (data.minHeight !== position.minHeight) { data.minHeight = position.minHeight; changeSet.minHeight = true; }\n      }\n\n      if (Number.isFinite(position.minWidth) || position.minWidth === null)\n      {\n         position.minWidth = typeof position.minWidth === 'number' ? Math.round(position.minWidth) : null;\n\n         if (data.minWidth !== position.minWidth) { data.minWidth = position.minWidth; changeSet.minWidth = true; }\n      }\n\n      if (Number.isFinite(position.rotateX) || position.rotateX === null)\n      {\n         if (data.rotateX !== position.rotateX)\n         {\n            data.rotateX = transforms.rotateX = position.rotateX;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.rotateY) || position.rotateY === null)\n      {\n         if (data.rotateY !== position.rotateY)\n         {\n            data.rotateY = transforms.rotateY = position.rotateY;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.rotateZ) || position.rotateZ === null)\n      {\n         if (data.rotateZ !== position.rotateZ)\n         {\n            data.rotateZ = transforms.rotateZ = position.rotateZ;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.scale) || position.scale === null)\n      {\n         position.scale = typeof position.scale === 'number' ? Math.max(0, Math.min(position.scale, 1000)) : null;\n\n         if (data.scale !== position.scale)\n         {\n            data.scale = transforms.scale = position.scale;\n            changeSet.transform = true;\n         }\n      }\n\n      if ((typeof position.transformOrigin === 'string' && transformOrigins.includes(\n       position.transformOrigin)) || position.transformOrigin === null)\n      {\n         if (data.transformOrigin !== position.transformOrigin)\n         {\n            data.transformOrigin = position.transformOrigin;\n            changeSet.transformOrigin = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateX) || position.translateX === null)\n      {\n         if (data.translateX !== position.translateX)\n         {\n            data.translateX = transforms.translateX = position.translateX;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateY) || position.translateY === null)\n      {\n         if (data.translateY !== position.translateY)\n         {\n            data.translateY = transforms.translateY = position.translateY;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.translateZ) || position.translateZ === null)\n      {\n         if (data.translateZ !== position.translateZ)\n         {\n            data.translateZ = transforms.translateZ = position.translateZ;\n            changeSet.transform = true;\n         }\n      }\n\n      if (Number.isFinite(position.zIndex))\n      {\n         position.zIndex = Math.round(position.zIndex);\n\n         if (data.zIndex !== position.zIndex) { data.zIndex = position.zIndex; changeSet.zIndex = true; }\n      }\n\n      if (Number.isFinite(position.width) || position.width === 'auto' || position.width === 'inherit' ||\n       position.width === null)\n      {\n         position.width = typeof position.width === 'number' ? Math.round(position.width) : position.width;\n\n         if (data.width !== position.width) { data.width = position.width; changeSet.width = true; }\n      }\n\n      if (Number.isFinite(position.height) || position.height === 'auto' || position.height === 'inherit' ||\n       position.height === null)\n      {\n         position.height = typeof position.height === 'number' ? Math.round(position.height) : position.height;\n\n         if (data.height !== position.height) { data.height = position.height; changeSet.height = true; }\n      }\n\n      if (el)\n      {\n         const defaultData = this.#state.getDefault();\n\n         // Set default data after first set operation that has a target element.\n         if (!isObject(defaultData)) { this.#state.save({ name: '#defaultData', ...Object.assign({}, data) }); }\n\n         // If `immediateElementUpdate` is true in position data passed to `set` then update the element immediately.\n         // This is for rAF based library integrations like GSAP.\n         if (immediateElementUpdate)\n         {\n            UpdateElementManager.immediate(el, this.#updateElementData);\n            this.#updateElementPromise = Promise.resolve(performance.now());\n         }\n         // Else if not queued then queue an update for the next rAF callback.\n         else if (!this.#updateElementData.queued)\n         {\n            this.#updateElementPromise = UpdateElementManager.add(el, this.#updateElementData);\n         }\n      }\n      else\n      {\n         // Notify main store subscribers.\n         UpdateElementManager.updateSubscribers(this.#updateElementData);\n      }\n\n      return this;\n   }\n\n   /**\n    * @param {import('svelte/store').Subscriber<TJSPositionData>} handler - Callback function that is invoked on\n    *        update / changes. Receives a copy of the TJSPositionData.\n    *\n    * @returns {import('svelte/store').Unsubscriber} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler); // add handler to the array of subscribers\n\n      handler(Object.assign({}, this.#data));                     // call handler with current value\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n\n   /**\n    * @param {import('./').TJSPositionDataExtended} opts -\n    *\n    * @param {number|null} opts.left -\n    *\n    * @param {number|null} opts.top -\n    *\n    * @param {number|null} opts.maxHeight -\n    *\n    * @param {number|null} opts.maxWidth -\n    *\n    * @param {number|null} opts.minHeight -\n    *\n    * @param {number|null} opts.minWidth -\n    *\n    * @param {number|'auto'|null} opts.width -\n    *\n    * @param {number|'auto'|null} opts.height -\n    *\n    * @param {number|null} opts.rotateX -\n    *\n    * @param {number|null} opts.rotateY -\n    *\n    * @param {number|null} opts.rotateZ -\n    *\n    * @param {number|null} opts.scale -\n    *\n    * @param {string} opts.transformOrigin -\n    *\n    * @param {number|null} opts.translateX -\n    *\n    * @param {number|null} opts.translateY -\n    *\n    * @param {number|null} opts.translateZ -\n    *\n    * @param {number|null} opts.zIndex -\n    *\n    * @param {number|null} opts.rotation - alias for rotateZ\n    *\n    * @param {*} opts.rest -\n    *\n    * @param {object} parent -\n    *\n    * @param {HTMLElement} el -\n    *\n    * @param {StyleCache} styleCache -\n    *\n    * @returns {null|TJSPositionData} Updated position data or null if validation fails.\n    */\n   #updatePosition({\n      // Directly supported parameters\n      left, top, maxWidth, maxHeight, minWidth, minHeight, width, height, rotateX, rotateY, rotateZ, scale,\n       transformOrigin, translateX, translateY, translateZ, zIndex,\n\n      // Aliased parameters\n      rotation,\n\n      ...rest\n   } = {}, parent, el, styleCache)\n   {\n      let currentPosition = s_DATA_UPDATE.copy(this.#data);\n\n      // Update width if an explicit value is passed, or if no width value is set on the element.\n      if (el.style.width === '' || width !== void 0)\n      {\n         if (width === 'auto' || (currentPosition.width === 'auto' && width !== null))\n         {\n            currentPosition.width = 'auto';\n            width = styleCache.offsetWidth;\n         }\n         else if (width === 'inherit' || (currentPosition.width === 'inherit' && width !== null))\n         {\n            currentPosition.width = 'inherit';\n            width = styleCache.offsetWidth;\n         }\n         else\n         {\n            const newWidth = Number.isFinite(width) ? width : currentPosition.width;\n            currentPosition.width = width = Number.isFinite(newWidth) ? Math.round(newWidth) : styleCache.offsetWidth;\n         }\n      }\n      else\n      {\n         width = Number.isFinite(currentPosition.width) ? currentPosition.width : styleCache.offsetWidth;\n      }\n\n      // Update height if an explicit value is passed, or if no height value is set on the element.\n      if (el.style.height === '' || height !== void 0)\n      {\n         if (height === 'auto' || (currentPosition.height === 'auto' && height !== null))\n         {\n            currentPosition.height = 'auto';\n            height = styleCache.offsetHeight;\n         }\n         else if (height === 'inherit' || (currentPosition.height === 'inherit' && height !== null))\n         {\n            currentPosition.height = 'inherit';\n            height = styleCache.offsetHeight;\n         }\n         else\n         {\n            const newHeight = Number.isFinite(height) ? height : currentPosition.height;\n            currentPosition.height = height = Number.isFinite(newHeight) ? Math.round(newHeight) :\n             styleCache.offsetHeight;\n         }\n      }\n      else\n      {\n         height = Number.isFinite(currentPosition.height) ? currentPosition.height : styleCache.offsetHeight;\n      }\n\n      // Update left\n      if (Number.isFinite(left))\n      {\n         currentPosition.left = left;\n      }\n      else if (!Number.isFinite(currentPosition.left))\n      {\n         // Potentially use any initial position helper if available or set to 0.\n         currentPosition.left = typeof this.#options.initialHelper?.getLeft === 'function' ?\n          this.#options.initialHelper.getLeft(width) : 0;\n      }\n\n      // Update top\n      if (Number.isFinite(top))\n      {\n         currentPosition.top = top;\n      }\n      else if (!Number.isFinite(currentPosition.top))\n      {\n         // Potentially use any initial position helper if available or set to 0.\n         currentPosition.top = typeof this.#options.initialHelper?.getTop === 'function' ?\n          this.#options.initialHelper.getTop(height) : 0;\n      }\n\n      if (Number.isFinite(maxHeight) || maxHeight === null)\n      {\n         currentPosition.maxHeight = Number.isFinite(maxHeight) ? Math.round(maxHeight) : null;\n      }\n\n      if (Number.isFinite(maxWidth) || maxWidth === null)\n      {\n         currentPosition.maxWidth = Number.isFinite(maxWidth) ? Math.round(maxWidth) : null;\n      }\n\n      if (Number.isFinite(minHeight) || minHeight === null)\n      {\n         currentPosition.minHeight = Number.isFinite(minHeight) ? Math.round(minHeight) : null;\n      }\n\n      if (Number.isFinite(minWidth) || minWidth === null)\n      {\n         currentPosition.minWidth = Number.isFinite(minWidth) ? Math.round(minWidth) : null;\n      }\n\n      // Update rotate X/Y/Z, scale, z-index\n      if (Number.isFinite(rotateX) || rotateX === null) { currentPosition.rotateX = rotateX; }\n      if (Number.isFinite(rotateY) || rotateY === null) { currentPosition.rotateY = rotateY; }\n\n      // Handle alias for rotateZ. First check if `rotateZ` is valid and different from the current value. Next check if\n      // `rotation` is valid and use it for `rotateZ`.\n      if (rotateZ !== currentPosition.rotateZ && (Number.isFinite(rotateZ) || rotateZ === null))\n      {\n         currentPosition.rotateZ = rotateZ;\n      }\n      else if (rotation !== currentPosition.rotateZ && (Number.isFinite(rotation) || rotation === null))\n      {\n         currentPosition.rotateZ = rotation;\n      }\n\n      if (Number.isFinite(translateX) || translateX === null) { currentPosition.translateX = translateX; }\n      if (Number.isFinite(translateY) || translateY === null) { currentPosition.translateY = translateY; }\n      if (Number.isFinite(translateZ) || translateZ === null) { currentPosition.translateZ = translateZ; }\n\n      if (Number.isFinite(scale) || scale === null)\n      {\n         currentPosition.scale = typeof scale === 'number' ? Math.max(0, Math.min(scale, 1000)) : null;\n      }\n\n      if (typeof transformOrigin === 'string' || transformOrigin === null)\n      {\n         currentPosition.transformOrigin = transformOrigins.includes(transformOrigin) ? transformOrigin :\n          null;\n      }\n\n      if (Number.isFinite(zIndex) || zIndex === null)\n      {\n         currentPosition.zIndex = typeof zIndex === 'number' ? Math.round(zIndex) : zIndex;\n      }\n\n      const validatorData = this.#validatorData;\n\n      // If there are any validators allow them to potentially modify position data or reject the update.\n      if (this.#validators.enabled && validatorData.length)\n      {\n         s_VALIDATION_DATA.parent = parent;\n\n         s_VALIDATION_DATA.el = el;\n\n         s_VALIDATION_DATA.computed = styleCache.computed;\n\n         s_VALIDATION_DATA.transforms = this.#transforms;\n\n         s_VALIDATION_DATA.height = height;\n\n         s_VALIDATION_DATA.width = width;\n\n         s_VALIDATION_DATA.marginLeft = styleCache.marginLeft;\n\n         s_VALIDATION_DATA.marginTop = styleCache.marginTop;\n\n         s_VALIDATION_DATA.maxHeight = styleCache.maxHeight ?? currentPosition.maxHeight;\n\n         s_VALIDATION_DATA.maxWidth = styleCache.maxWidth ?? currentPosition.maxWidth;\n\n         // Given a parent w/ reactive state and is minimized ignore styleCache min-width/height.\n         const isMinimized = parent?.reactive?.minimized ?? false;\n\n         // Note the use of || for accessing the style cache as the left hand is ignored w/ falsy values such as '0'.\n         s_VALIDATION_DATA.minHeight = isMinimized ? currentPosition.minHeight ?? 0 :\n          styleCache.minHeight || (currentPosition.minHeight ?? 0);\n\n         s_VALIDATION_DATA.minWidth = isMinimized ? currentPosition.minWidth ?? 0 :\n          styleCache.minWidth || (currentPosition.minWidth ?? 0);\n\n         for (let cntr = 0; cntr < validatorData.length; cntr++)\n         {\n            s_VALIDATION_DATA.position = currentPosition;\n            s_VALIDATION_DATA.rest = rest;\n            currentPosition = validatorData[cntr].validator(s_VALIDATION_DATA);\n\n            if (currentPosition === null) { return null; }\n         }\n      }\n\n      // Return the updated position object.\n      return currentPosition;\n   }\n}\n\nconst s_DATA_UPDATE = new TJSPositionData();\n\n/**\n * @type {import('./').ValidationData}\n */\nconst s_VALIDATION_DATA = {\n   position: void 0,\n   parent: void 0,\n   el: void 0,\n   computed: void 0,\n   transforms: void 0,\n   height: void 0,\n   width: void 0,\n   marginLeft: void 0,\n   marginTop: void 0,\n   maxHeight: void 0,\n   maxWidth: void 0,\n   minHeight: void 0,\n   minWidth: void 0,\n   rest: void 0\n};\n\nObject.seal(s_VALIDATION_DATA);\n\n/**\n * Provides an action to apply a TJSPosition instance to a HTMLElement and invoke `position.parent`\n *\n * @param {HTMLElement}       node - The node associated with the action.\n *\n * @param {import('..').TJSPosition}   position - A position instance.\n *\n * @returns {import('svelte/action').ActionReturn<import('..').TJSPosition>} The action lifecycle methods.\n */\nfunction applyPosition(node, position)\n{\n   if (hasSetter(position, 'parent')) { position.parent = node; }\n\n   return {\n      update: (newPosition) =>\n      {\n         // Sanity case to short circuit update if positions are the same instance.\n         if (newPosition === position && newPosition.parent === position.parent) { return; }\n\n         if (hasSetter(position, 'parent')) { position.parent = void 0; }\n\n         position = newPosition;\n\n         if (hasSetter(position, 'parent')) { position.parent = node; }\n      },\n\n      destroy: () => { if (hasSetter(position, 'parent')) { position.parent = void 0; } }\n   };\n}\n\n/**\n * Provides an action to enable pointer dragging of an HTMLElement and invoke `position.set` on a given\n * {@link TJSPosition} instance provided. When the attached boolean store state changes the draggable\n * action is enabled or disabled.\n *\n * @param {HTMLElement}       node - The node associated with the action.\n *\n * @param {object}            params - Required parameters.\n *\n * @param {import('..').TJSPosition}   params.position - A position instance.\n *\n * @param {boolean}           [params.active=true] - A boolean value; attached to a readable store.\n *\n * @param {number}            [params.button=0] - MouseEvent button; {@link https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button}.\n *\n * @param {import('svelte/store').Writable<boolean>} [params.storeDragging] - A writable store that tracks \"dragging\"\n *        state.\n *\n * @param {boolean}           [params.ease=true] - When true easing is enabled.\n *\n * @param {object}            [params.easeOptions] - Gsap `to / `quickTo` vars object.\n *\n * @param {Iterable<string>}  [params.hasTargetClassList] - When defined any event targets that have a class in this\n *        list are allowed.\n *\n * @param {Iterable<string>}  [params.ignoreTargetClassList] - When defined any event targets that have a class in this\n *        list are ignored.\n *\n * @returns {import('svelte/action').ActionReturn<Record<string, any>>} Lifecycle functions.\n */\nfunction draggable(node, { position, active = true, button = 0, storeDragging = void 0, ease = false,\n easeOptions = { duration: 0.1, ease: cubicOut }, hasTargetClassList, ignoreTargetClassList })\n{\n   if (hasTargetClassList !== void 0 && !isIterable(hasTargetClassList))\n   {\n      throw new TypeError(`'hasTargetClassList' is not iterable.`);\n   }\n\n   if (ignoreTargetClassList !== void 0 && !isIterable(ignoreTargetClassList))\n   {\n      throw new TypeError(`'ignoreTargetClassList' is not iterable.`);\n   }\n\n   /**\n    * Used for direct call to `position.set`.\n    *\n    * @type {{top: number, left: number}}\n    */\n   const positionData = { left: 0, top: 0 };\n\n   /**\n    * Duplicate the app / Positionable starting position to track differences.\n    *\n    * @type {object}\n    */\n   let initialPosition = null;\n\n   /**\n    * Stores the initial X / Y on drag down.\n    *\n    * @type {object}\n    */\n   let initialDragPoint = {};\n\n   /**\n    * Stores the current dragging state and gates the move pointer as the dragging store is not\n    * set until the first pointer move.\n    *\n    * @type {boolean}\n    */\n   let dragging = false;\n\n   /**\n    * Stores the quickTo callback to use for optimized tweening when easing is enabled.\n    *\n    * @type {import('#runtime/svelte/store/position').quickToCallback}\n    */\n   let quickTo = position.animate.quickTo(['top', 'left'], easeOptions);\n\n   /**\n    * Remember event handlers associated with this action, so they may be later unregistered.\n    *\n    *  @type {{ [key: string]: [string, Function, boolean] }}\n    */\n   const handlers = {\n      dragDown: ['pointerdown', onDragPointerDown, false],\n      dragMove: ['pointermove', onDragPointerChange, false],\n      dragUp: ['pointerup', onDragPointerUp, false]\n   };\n\n   /**\n    * Activates listeners.\n    */\n   function activateListeners()\n   {\n      // Drag handlers\n      node.addEventListener(...handlers.dragDown);\n      node.classList.add('draggable');\n   }\n\n   /**\n    * Removes listeners.\n    */\n   function removeListeners()\n   {\n      if (typeof storeDragging?.set === 'function') { storeDragging.set(false); }\n\n      // Drag handlers\n      node.removeEventListener(...handlers.dragDown);\n      node.removeEventListener(...handlers.dragMove);\n      node.removeEventListener(...handlers.dragUp);\n      node.classList.remove('draggable');\n   }\n\n   if (active)\n   {\n      activateListeners();\n   }\n\n   /**\n    * Handle the initial pointer down that activates dragging behavior for the positionable.\n    *\n    * @param {PointerEvent} event - The pointer down event.\n    */\n   function onDragPointerDown(event)\n   {\n      if (event.button !== button || !event.isPrimary) { return; }\n\n      // Do not process if the position system is not enabled.\n      if (!position.enabled) { return; }\n\n      // Potentially ignore this event if `ignoreTargetClassList` is defined and the `event.target` has a matching\n      // class.\n      if (ignoreTargetClassList !== void 0 && event.target instanceof HTMLElement)\n      {\n         for (const targetClass of ignoreTargetClassList)\n         {\n            if (event.target.classList.contains(targetClass)) { return; }\n         }\n      }\n\n      // Potentially ignore this event if `hasTargetClassList` is defined and the `event.target` does not have any\n      // matching class from the list.\n      if (hasTargetClassList !== void 0 && event.target instanceof HTMLElement)\n      {\n         let foundTarget = false;\n\n         for (const targetClass of hasTargetClassList)\n         {\n            if (event.target.classList.contains(targetClass))\n            {\n               foundTarget = true;\n               break;\n            }\n         }\n\n         if (!foundTarget) { return; }\n      }\n\n      event.preventDefault();\n\n      dragging = false;\n\n      // Record initial position.\n      initialPosition = position.get();\n      initialDragPoint = { x: event.clientX, y: event.clientY };\n\n      // Add move and pointer up handlers.\n      node.addEventListener(...handlers.dragMove);\n      node.addEventListener(...handlers.dragUp);\n\n      node.setPointerCapture(event.pointerId);\n   }\n\n   /**\n    * Move the positionable.\n    *\n    * @param {PointerEvent} event - The pointer move event.\n    */\n   function onDragPointerChange(event)\n   {\n      // See chorded button presses for pointer events:\n      // https://www.w3.org/TR/pointerevents3/#chorded-button-interactions\n      // TODO: Support different button configurations for PointerEvents.\n      if ((event.buttons & 1) === 0)\n      {\n         onDragPointerUp(event);\n         return;\n      }\n\n      if (event.button !== -1 || !event.isPrimary) { return; }\n\n      event.preventDefault();\n\n      // Only set store dragging on first move event.\n      if (!dragging && typeof storeDragging?.set === 'function')\n      {\n         dragging = true;\n         storeDragging.set(true);\n      }\n\n      /** @type {number} */\n      const newLeft = initialPosition.left + (event.clientX - initialDragPoint.x);\n      /** @type {number} */\n      const newTop = initialPosition.top + (event.clientY - initialDragPoint.y);\n\n      if (ease)\n      {\n         quickTo(newTop, newLeft);\n      }\n      else\n      {\n         positionData.left = newLeft;\n         positionData.top = newTop;\n\n         position.set(positionData);\n      }\n   }\n\n   /**\n    * Finish dragging and set the final position and removing listeners.\n    *\n    * @param {PointerEvent} event - The pointer up event.\n    */\n   function onDragPointerUp(event)\n   {\n      event.preventDefault();\n\n      dragging = false;\n      if (typeof storeDragging?.set === 'function') { storeDragging.set(false); }\n\n      node.removeEventListener(...handlers.dragMove);\n      node.removeEventListener(...handlers.dragUp);\n   }\n\n   return {\n      // The default of active being true won't automatically add listeners twice.\n      update: (options) =>\n      {\n         if (typeof options.active === 'boolean')\n         {\n            active = options.active;\n            if (active) { activateListeners(); }\n            else { removeListeners(); }\n         }\n\n         if (typeof options.button === 'number')\n         {\n            button = options.button;\n         }\n\n         if (options.position !== void 0 && options.position !== position)\n         {\n            position = options.position;\n            quickTo = position.animate.quickTo(['top', 'left'], easeOptions);\n         }\n\n         if (typeof options.ease === 'boolean') { ease = options.ease; }\n\n         if (isObject(options.easeOptions))\n         {\n            easeOptions = options.easeOptions;\n            quickTo.options(easeOptions);\n         }\n\n         if (options.hasTargetClassList !== void 0)\n         {\n            if (!isIterable(options.hasTargetClassList))\n            {\n               throw new TypeError(`'hasTargetClassList' is not iterable.`);\n            }\n            else\n            {\n               hasTargetClassList = options.hasTargetClassList;\n            }\n         }\n\n         if (options.ignoreTargetClassList !== void 0)\n         {\n            if (!isIterable(options.ignoreTargetClassList))\n            {\n               throw new TypeError(`'ignoreTargetClassList' is not iterable.`);\n            }\n            else\n            {\n               ignoreTargetClassList = options.ignoreTargetClassList;\n            }\n         }\n      },\n\n      destroy: () => removeListeners()\n   };\n}\n\nclass DraggableOptions\n{\n   #ease = false;\n\n   /**\n    * @type {{ duration: number, ease: (t: number) => number | string }}\n    */\n   #easeOptions = { duration: 0.1, ease: cubicOut };\n\n   /**\n    * Stores the subscribers.\n    *\n    * @type {import('svelte/store').Subscriber<DraggableOptions>[]}\n    */\n   #subscriptions = [];\n\n   /**\n    *\n    * @param {object} [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.ease] -\n    *\n    * @param {object}   [opts.easeOptions] -\n    */\n   constructor({ ease, easeOptions } = {})\n   {\n      // Define the following getters directly on this instance and make them enumerable. This allows them to be\n      // picked up w/ `Object.assign`.\n      Object.defineProperty(this, 'ease', {\n         get: () => { return this.#ease; },\n         set: (newEase) =>\n         {\n            if (typeof newEase !== 'boolean') { throw new TypeError(`'ease' is not a boolean.`); }\n\n            this.#ease = newEase;\n            this.#updateSubscribers();\n         },\n         enumerable: true\n      });\n\n      Object.defineProperty(this, 'easeOptions', {\n         get: () => { return this.#easeOptions; },\n         set: (newEaseOptions) =>\n         {\n            if (!isObject(newEaseOptions))\n            {\n               throw new TypeError(`'easeOptions' is not an object.`);\n            }\n\n            if (newEaseOptions.duration !== void 0)\n            {\n               if (!Number.isFinite(newEaseOptions.duration))\n               {\n                  throw new TypeError(`'easeOptions.duration' is not a finite number.`);\n               }\n\n               if (newEaseOptions.duration < 0) { throw new Error(`'easeOptions.duration' is less than 0.`); }\n\n               this.#easeOptions.duration = newEaseOptions.duration;\n            }\n\n            if (newEaseOptions.ease !== void 0)\n            {\n               if (typeof newEaseOptions.ease !== 'function' && typeof newEaseOptions.ease !== 'string')\n               {\n                  throw new TypeError(`'easeOptions.ease' is not a function or string.`);\n               }\n\n               this.#easeOptions.ease = newEaseOptions.ease;\n            }\n\n            this.#updateSubscribers();\n         },\n         enumerable: true\n      });\n\n      // Set default options.\n      if (ease !== void 0) { this.ease = ease; }\n      if (easeOptions !== void 0) { this.easeOptions = easeOptions; }\n   }\n\n\n   /**\n    * @returns {number} Get ease duration\n    */\n   get easeDuration() { return this.#easeOptions.duration; }\n\n   /**\n    * @returns {string|Function} Get easing function value.\n    */\n   get easeValue() { return this.#easeOptions.ease; }\n\n\n   /**\n    * @param {number}   duration - Set ease duration.\n    */\n   set easeDuration(duration)\n   {\n      if (!Number.isFinite(duration))\n      {\n         throw new TypeError(`'duration' is not a finite number.`);\n      }\n\n      if (duration < 0) { throw new Error(`'duration' is less than 0.`); }\n\n      this.#easeOptions.duration = duration;\n      this.#updateSubscribers();\n   }\n\n   /**\n    * @param {string|Function} value - Get easing function value.\n    */\n   set easeValue(value)\n   {\n      if (typeof value !== 'function' && typeof value !== 'string')\n      {\n         throw new TypeError(`'value' is not a function or string.`);\n      }\n\n      this.#easeOptions.ease = value;\n      this.#updateSubscribers();\n   }\n\n   /**\n    * Resets all options data to default values.\n    */\n   reset()\n   {\n      this.#ease = false;\n      this.#easeOptions = { duration: 0.1, ease: cubicOut };\n      this.#updateSubscribers();\n   }\n\n   /**\n    * Resets easing options to default values.\n    */\n   resetEase()\n   {\n      this.#easeOptions = { duration: 0.1, ease: cubicOut };\n      this.#updateSubscribers();\n   }\n\n   /**\n    *\n    * @param {import('svelte/store').Subscriber<DraggableOptions>} handler - Callback function that is invoked on\n    *        update / changes. Receives the DraggableOptions object / instance.\n    *\n    * @returns {import('svelte/store').Unsubscriber} Unsubscribe function.\n    */\n   subscribe(handler)\n   {\n      this.#subscriptions.push(handler); // add handler to the array of subscribers\n\n      handler(this);                     // call handler with current value\n\n      // Return unsubscribe function.\n      return () =>\n      {\n         const index = this.#subscriptions.findIndex((sub) => sub === handler);\n         if (index >= 0) { this.#subscriptions.splice(index, 1); }\n      };\n   }\n\n   #updateSubscribers()\n   {\n      const subscriptions = this.#subscriptions;\n\n      // Early out if there are no subscribers.\n      if (subscriptions.length > 0)\n      {\n         for (let cntr = 0; cntr < subscriptions.length; cntr++) { subscriptions[cntr](this); }\n      }\n   }\n}\n\n/**\n * Define a function to get a DraggableOptions instance.\n *\n * @param {{ ease?: boolean, easeOptions?: object }} options - Draggable options.\n *\n * @returns {DraggableOptions} A new options instance.\n */\ndraggable.options = (options) => new DraggableOptions(options);\n\nexport { TJSPosition, TJSPositionData, applyPosition, draggable };\n//# sourceMappingURL=index.js.map\n","import { isObject } from '@typhonjs-fvtt/runtime/util/object';\nimport { group_outros, transition_out, check_outros } from 'svelte/internal';\n\n/**\n * Provides basic duck typing to determine if the provided object is a HMR ProxyComponent instance or class.\n *\n * @param {*}  comp - Data to check as a HMR proxy component.\n *\n * @returns {boolean} Whether basic duck typing succeeds.\n */\nfunction isHMRProxy(comp)\n{\n   const instanceName = comp?.constructor?.name;\n   if (typeof instanceName === 'string' && (instanceName.startsWith('Proxy<') || instanceName === 'ProxyComponent'))\n   {\n      return true;\n   }\n\n   const prototypeName = comp?.prototype?.constructor?.name;\n   return typeof prototypeName === 'string' && (prototypeName.startsWith('Proxy<') ||\n    prototypeName === 'ProxyComponent');\n}\n\n/**\n * Provides basic duck typing to determine if the provided function is a constructor function for a Svelte component.\n *\n * @param {*}  comp - Data to check as a Svelte component.\n *\n * @returns {boolean} Whether basic duck typing succeeds.\n */\nfunction isSvelteComponent(comp)\n{\n   if (comp === null || comp === void 0 || typeof comp !== 'function') { return false; }\n\n   // When using Vite in a developer build the SvelteComponent is wrapped in a ProxyComponent class.\n   // This class doesn't define methods on the prototype, so we must check if the constructor name\n   // starts with `Proxy<` as it provides the wrapped component as `Proxy<_wrapped component name_>`.\n   const prototypeName = comp?.prototype?.constructor?.name;\n   if (typeof prototypeName === 'string' && (prototypeName.startsWith('Proxy<') || prototypeName === 'ProxyComponent'))\n   {\n      return true;\n   }\n\n   return typeof window !== 'undefined' ?\n    typeof comp.prototype.$destroy === 'function' && typeof comp.prototype.$on === 'function' : // client-side\n     typeof comp.render === 'function'; // server-side\n}\n\n/**\n * Validates `config` argument whether it is a valid {@link TJSSvelteConfig}.\n *\n * @param {*}  config - The potential config object to validate.\n *\n * @param {boolean}  [raiseException=false] - If validation fails raise an exception.\n *\n * @returns {boolean} Is the config a valid TJSSvelteConfig.\n *\n * @throws {TypeError}  Any validation error when `raiseException` is enabled.\n */\nfunction isTJSSvelteConfig(config, raiseException = false)\n{\n   if (!isObject(config))\n   {\n      if (raiseException) { throw new TypeError(`isTJSSvelteConfig error: 'config' is not an object.`); }\n      return false;\n   }\n\n   if (!isSvelteComponent(config.class))\n   {\n      if (raiseException)\n      {\n         throw new TypeError(`isTJSSvelteConfig error: 'config.class' is not a Svelte component constructor.`);\n      }\n      return false;\n   }\n\n   return true;\n}\n\n/* eslint-disable */  // jsdoc/valid-types doesn't like the Google closure constructor function. TODO: verify in future eslint-plugin-jsdoc version\n/**\n * @typedef {object} TJSSvelteConfig Defines the TRL / client side configuration object to load a Svelte component.\n *\n * @property {({\n *    new(options: import('svelte').ComponentConstructorOptions):\n *     import('svelte').SvelteComponent | import('svelte').SvelteComponentTyped\n * })} class The Svelte component class / constructor function.\n *\n * @property {HTMLElement | ShadowRoot}   [target=document.body] A {@link HTMLElement} or {@link ShadowRoot} to\n * render to. By default, `document.body` is used as the target if not otherwise defined.\n *\n * @property {HTMLElement} [anchor] A child of `target` to render the component immediately before.\n *\n * @property {() => Record<string, *> | Record<string, *>} [props] Props to pass to the component.\n *\n * @property {() => (Record<string, *> | Map<string, *>) | Map<string, *> | Record<string, *>} [context] The root-level\n * context to pass to the component.\n *\n * @property {boolean}  [hydrate] See description in main Svelte docs\n * {@link https://svelte.dev/docs/client-side-component-api#creating-a-component | Creating a component.}\n *\n * @property {boolean} [intro] If true, will play transitions on initial render, rather than waiting for subsequent\n * state changes.\n*/\n/* eslint-enable */\n\n/**\n * Runs outro transition then destroys Svelte component.\n *\n * Workaround for https://github.com/sveltejs/svelte/issues/4056\n *\n * @param {*}  instance - A Svelte component.\n */\nasync function outroAndDestroy(instance)\n{\n   return new Promise((resolve) =>\n   {\n      if (instance.$$.fragment && instance.$$.fragment.o)\n      {\n         group_outros();\n         transition_out(instance.$$.fragment, 0, 0, () =>\n         {\n            instance.$destroy();\n            resolve();\n         });\n         check_outros();\n      }\n      else\n      {\n         instance.$destroy();\n         resolve();\n      }\n   });\n}\n\n/**\n * Parses a TyphonJS Svelte config object ensuring that classes specified are Svelte components and props are set\n * correctly.\n *\n * @param {object}   config - Svelte config object.\n *\n * @param {*}        [thisArg] - `This` reference to set for invoking any props function.\n *\n * @returns {object} The processed Svelte config object.\n */\nfunction parseTJSSvelteConfig(config, thisArg = void 0)\n{\n   if (!isObject(config))\n   {\n      throw new TypeError(`parseSvelteConfig - 'config' is not an object:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (!isSvelteComponent(config.class))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'class' is not a Svelte component constructor for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.hydrate !== void 0 && typeof config.hydrate !== 'boolean')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'hydrate' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.intro !== void 0 && typeof config.intro !== 'boolean')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'intro' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   if (config.target !== void 0 && typeof config.target !== 'string' && !(config.target instanceof HTMLElement) &&\n    !(config.target instanceof ShadowRoot) && !(config.target instanceof DocumentFragment))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'target' is not a string, HTMLElement, ShadowRoot, or DocumentFragment for config:\\n${\n        JSON.stringify(config)}.`);\n   }\n\n   if (config.anchor !== void 0 && typeof config.anchor !== 'string' && !(config.anchor instanceof HTMLElement) &&\n    !(config.anchor instanceof ShadowRoot) && !(config.anchor instanceof DocumentFragment))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'anchor' is not a string, HTMLElement, ShadowRoot, or DocumentFragment for config:\\n${\n        JSON.stringify(config)}.`);\n   }\n\n   if (config.context !== void 0 && typeof config.context !== 'function' && !(config.context instanceof Map) &&\n    !isObject(config.context))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'context' is not a Map, function or object for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // Validate extra TyphonJS options --------------------------------------------------------------------------------\n\n   // `selectorTarget` optionally stores a target element found in main element.\n   if (config.selectorTarget !== void 0 && typeof config.selectorTarget !== 'string')\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'selectorTarget' is not a string for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // `options` stores `injectApp`, `injectEventbus`, and `selectorElement`.\n   if (config.options !== void 0 && !isObject(config.options))\n   {\n      throw new TypeError(\n       `parseSvelteConfig - 'options' is not an object for config:\\n${JSON.stringify(config)}.`);\n   }\n\n   // Validate TyphonJS standard options.\n   if (config.options !== void 0)\n   {\n      if (config.options.injectApp !== void 0 && typeof config.options.injectApp !== 'boolean')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'options.injectApp' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n      }\n\n      if (config.options.injectEventbus !== void 0 && typeof config.options.injectEventbus !== 'boolean')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'options.injectEventbus' is not a boolean for config:\\n${JSON.stringify(config)}.`);\n      }\n\n      // `selectorElement` optionally stores a main element selector to be found in a HTMLElement target.\n      if (config.options.selectorElement !== void 0 && typeof config.options.selectorElement !== 'string')\n      {\n         throw new TypeError(\n          `parseSvelteConfig - 'selectorElement' is not a string for config:\\n${JSON.stringify(config)}.`);\n      }\n   }\n\n   const svelteConfig = { ...config };\n\n   // Delete extra Svelte options.\n   delete svelteConfig.options;\n\n   let externalContext = {};\n\n   // If a context callback function is provided then invoke it with `this` being the Foundry app.\n   // If an object is returned it adds the entries to external context.\n   if (typeof svelteConfig.context === 'function')\n   {\n      const contextFunc = svelteConfig.context;\n      delete svelteConfig.context;\n\n      const result = contextFunc.call(thisArg);\n      if (isObject(result))\n      {\n         externalContext = { ...result };\n      }\n      else\n      {\n         throw new Error(`parseSvelteConfig - 'context' is a function that did not return an object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n   }\n   else if (svelteConfig.context instanceof Map)\n   {\n      externalContext = Object.fromEntries(svelteConfig.context);\n      delete svelteConfig.context;\n   }\n   else if (isObject(svelteConfig.context))\n   {\n      externalContext = svelteConfig.context;\n      delete svelteConfig.context;\n   }\n\n   // If a props is a function then invoke it with `this` being the Foundry app.\n   // If an object is returned set it as the props.\n   svelteConfig.props = s_PROCESS_PROPS(svelteConfig.props, thisArg, config);\n\n   // Process children components attaching to external context.\n   if (Array.isArray(svelteConfig.children))\n   {\n      const children = [];\n\n      for (let cntr = 0; cntr < svelteConfig.children.length; cntr++)\n      {\n         const child = svelteConfig.children[cntr];\n\n         if (!isSvelteComponent(child.class))\n         {\n            throw new Error(`parseSvelteConfig - 'class' is not a Svelte component for child[${cntr}] for config:\\n${\n             JSON.stringify(config)}`);\n         }\n\n         child.props = s_PROCESS_PROPS(child.props, thisArg, config);\n\n         children.push(child);\n      }\n\n      if (children.length > 0)\n      {\n         externalContext.children = children;\n      }\n\n      delete svelteConfig.children;\n   }\n   else if (isObject(svelteConfig.children))\n   {\n      if (!isSvelteComponent(svelteConfig.children.class))\n      {\n         throw new Error(`parseSvelteConfig - 'class' is not a Svelte component for children object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n\n      svelteConfig.children.props = s_PROCESS_PROPS(svelteConfig.children.props, thisArg, config);\n\n      externalContext.children = [svelteConfig.children];\n      delete svelteConfig.children;\n   }\n\n   if (!(svelteConfig.context instanceof Map))\n   {\n      svelteConfig.context = new Map();\n   }\n\n   svelteConfig.context.set('#external', externalContext);\n\n   return svelteConfig;\n}\n\n/**\n * Processes Svelte props. Potentially props can be a function to invoke with `thisArg`.\n *\n * @param {object|Function}   props - Svelte props.\n *\n * @param {*}                 thisArg - `This` reference to set for invoking any props function.\n *\n * @param {object}            config - Svelte config\n *\n * @returns {object|void}     Svelte props.\n */\nfunction s_PROCESS_PROPS(props, thisArg, config)\n{\n   // If a props is a function then invoke it with `this` being the Foundry app.\n   // If an object is returned set it as the props.\n   if (typeof props === 'function')\n   {\n      const result = props.call(thisArg);\n      if (isObject(result))\n      {\n         return result;\n      }\n      else\n      {\n         throw new Error(`parseSvelteConfig - 'props' is a function that did not return an object for config:\\n${\n          JSON.stringify(config)}`);\n      }\n   }\n   else if (isObject(props))\n   {\n      return props;\n   }\n   else if (props !== void 0)\n   {\n      throw new Error(\n       `parseSvelteConfig - 'props' is not a function or an object for config:\\n${JSON.stringify(config)}`);\n   }\n\n   return {};\n}\n\nexport { isHMRProxy, isSvelteComponent, isTJSSvelteConfig, outroAndDestroy, parseTJSSvelteConfig };\n//# sourceMappingURL=index.js.map\n","import { linear }             from 'svelte/easing';\n\nimport { lerp }               from '@typhonjs-fvtt/runtime/math/interpolate';\nimport { isObject }           from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * @template T\n *\n * Provides the ability the save / restore application state for positional and UI state such as minimized status.\n *\n * You can restore a saved state with animation; please see the options of {@link ApplicationState.restore}.\n */\nexport class ApplicationState\n{\n   /** @type {T} */\n   #application;\n\n   /** @type {Map<string, ApplicationStateData>} */\n   #dataSaved = new Map();\n\n   /**\n    * @param {T}   application - The application.\n    */\n   constructor(application)\n   {\n      this.#application = application;\n\n      Object.seal(this);\n   }\n\n   /**\n    * Returns current application state along with any extra data passed into method.\n    *\n    * @param {object} [extra] - Extra data to add to application state.\n    *\n    * @returns {ApplicationStateData} Passed in object with current application state.\n    */\n   get(extra = {})\n   {\n      return Object.assign(extra, {\n         position: this.#application?.position?.get(),\n         beforeMinimized: this.#application?.position?.state.get({ name: '#beforeMinimized' }),\n         options: Object.assign({}, this.#application?.options),\n         ui: { minimized: this.#application?.reactive?.minimized }\n      });\n   }\n\n   /**\n    * Returns any stored save state by name.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - Saved data set name.\n    *\n    * @returns {ApplicationStateData} The saved data set.\n    */\n   getSave({ name })\n   {\n      if (typeof name !== 'string')\n      {\n         throw new TypeError(`ApplicationState - getSave error: 'name' is not a string.`);\n      }\n\n      return this.#dataSaved.get(name);\n   }\n\n   /**\n    * Removes and returns any application state by name.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - Name to remove and retrieve.\n    *\n    * @returns {ApplicationStateData} Saved application data.\n    */\n   remove({ name })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`ApplicationState - remove: 'name' is not a string.`); }\n\n      const data = this.#dataSaved.get(name);\n      this.#dataSaved.delete(name);\n\n      return data;\n   }\n\n   /**\n    * Restores a saved application state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n    * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to} allows\n    * specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * @param {object}            params - Parameters\n    *\n    * @param {string}            params.name - Saved data set name.\n    *\n    * @param {boolean}           [params.remove=false] - Remove data set.\n    *\n    * @param {boolean}           [params.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [params.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [params.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [params.ease=linear] - Easing function.\n    *\n    * @param {Function}          [params.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {ApplicationStateData|Promise<ApplicationStateData>} Saved application data.\n    */\n   restore({ name, remove = false, async = false, animateTo = false, duration = 0.1, ease = linear,\n    interpolate = lerp })\n   {\n      if (typeof name !== 'string')\n      {\n         throw new TypeError(`ApplicationState - restore error: 'name' is not a string.`);\n      }\n\n      const dataSaved = this.#dataSaved.get(name);\n\n      if (dataSaved)\n      {\n         if (remove) { this.#dataSaved.delete(name); }\n\n         if (async)\n         {\n            return this.set(dataSaved, { async, animateTo, duration, ease, interpolate }).then(() => dataSaved);\n         }\n         else\n         {\n            this.set(dataSaved, { async, animateTo, duration, ease, interpolate });\n         }\n      }\n\n      return dataSaved;\n   }\n\n   /**\n    * Saves current application state with the opportunity to add extra data to the saved state.\n    *\n    * @param {object}   options - Options.\n    *\n    * @param {string}   options.name - name to index this saved data.\n    *\n    * @param {...*}     [options.extra] - Extra data to add to saved data.\n    *\n    * @returns {ApplicationStateData} Current application data\n    */\n   save({ name, ...extra })\n   {\n      if (typeof name !== 'string') { throw new TypeError(`ApplicationState - save error: 'name' is not a string.`); }\n\n      const data = this.get(extra);\n\n      this.#dataSaved.set(name, data);\n\n      return data;\n   }\n\n   /**\n    * Restores a saved application state returning the data. Several optional parameters are available\n    * to control whether the restore action occurs silently (no store / inline styles updates), animates\n    * to the stored data, or simply sets the stored data. Restoring via {@link AnimationAPI.to} allows\n    * specification of the duration, easing, and interpolate functions along with configuring a Promise to be\n    * returned if awaiting the end of the animation.\n    *\n    * Note: If serializing application state any minimized apps will use the before minimized state on initial render\n    * of the app as it is currently not possible to render apps with Foundry VTT core API in the minimized state.\n    *\n    * TODO: THIS METHOD NEEDS TO BE REFACTORED WHEN TRL IS MADE INTO A STANDALONE FRAMEWORK.\n    *\n    * @param {ApplicationStateData}   data - Saved data set name.\n    *\n    * @param {object}            [opts] - Optional parameters\n    *\n    * @param {boolean}           [opts.async=false] - If animating return a Promise that resolves with any saved data.\n    *\n    * @param {boolean}           [opts.animateTo=false] - Animate to restore data.\n    *\n    * @param {number}            [opts.duration=0.1] - Duration in seconds.\n    *\n    * @param {Function}          [opts.ease=linear] - Easing function.\n    *\n    * @param {Function}          [opts.interpolate=lerp] - Interpolation function.\n    *\n    * @returns {T | Promise<T>} When synchronous the application or Promise when animating resolving with application.\n    */\n   set(data, { async = false, animateTo = false, duration = 0.1, ease = linear, interpolate = lerp } = {})\n   {\n      if (!isObject(data))\n      {\n         throw new TypeError(`ApplicationState - restore error: 'data' is not an object.`);\n      }\n\n      const application = this.#application;\n\n      if (!isObject(data?.position))\n      {\n         console.warn(`ApplicationState.set warning: 'data.position' is not an object.`);\n         return application;\n      }\n\n      // TODO: TAKE NOTE THAT WE ARE ACCESSING A FOUNDRY APP v1 GETTER HERE TO DETERMINE IF APPLICATION IS RENDERED.\n      // TODO: THIS NEEDS TO BE REFACTORED WHEN CONVERTING TRL TO A GENERIC FRAMEWORK.\n      const rendered = application.rendered;\n\n      if (animateTo && !rendered)\n      {\n         console.warn(`ApplicationState.set warning: Application is not rendered and 'animateTo' is true.`);\n         return application;\n      }\n\n      // Update data directly with no store or inline style updates.\n      if (animateTo)  // Animate to saved data.\n      {\n         // Provide special handling to potentially change transform origin as this parameter is not animated.\n         if (data.position.transformOrigin !== application.position.transformOrigin)\n         {\n            application.position.transformOrigin = data.position.transformOrigin;\n         }\n\n         if (isObject(data?.ui))\n         {\n            const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n            if (application?.reactive?.minimized && !minimized)\n            {\n               application.maximize({ animate: false, duration: 0 });\n            }\n         }\n\n         const promise = application.position.animate.to(data.position,\n          { duration, ease, interpolate }).finished.then((cancelled) =>\n         {\n            if (cancelled) { return application; }\n\n            // Merge in saved options to application.\n            if (isObject(data?.options))\n            {\n               application?.reactive.mergeOptions(data.options);\n            }\n\n            if (isObject(data?.ui))\n            {\n               const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n               // Application is currently minimized and stored state is not, so reset minimized state without\n               // animation.\n               if (!application?.reactive?.minimized && minimized)\n               {\n                  application.minimize({ animate: false, duration: 0 });\n               }\n            }\n\n            if (isObject(data?.beforeMinimized))\n            {\n               application.position.state.set({ name: '#beforeMinimized', ...data.beforeMinimized });\n            }\n\n            return application;\n         });\n\n         // Return a Promise with the application that resolves after animation ends.\n         if (async) { return promise; }\n      }\n      else\n      {\n         if (rendered)\n         {\n            // Merge in saved options to application.\n            if (isObject(data?.options))\n            {\n               application?.reactive.mergeOptions(data.options);\n            }\n\n            if (isObject(data?.ui))\n            {\n               const minimized = typeof data.ui?.minimized === 'boolean' ? data.ui.minimized : false;\n\n               // Application is currently minimized and stored state is not, so reset minimized state without\n               // animation.\n               if (application?.reactive?.minimized && !minimized)\n               {\n                  application.maximize({ animate: false, duration: 0 });\n               }\n               else if (!application?.reactive?.minimized && minimized)\n               {\n                  application.minimize({ animate: false, duration });\n               }\n            }\n\n            if (isObject(data?.beforeMinimized))\n            {\n               application.position.state.set({ name: '#beforeMinimized', ...data.beforeMinimized });\n            }\n\n            // Default options is to set data for an immediate update.\n            application.position.set(data.position);\n         }\n         else\n         {\n            // When not rendered set position to the 'beforeMinimized' data if it exists otherwise set w/ 'position'.\n            // Currently, w/ Foundry core Application API it is impossible to initially render an app in the minimized\n            // state.\n\n            let positionData = data.position;\n\n            if (isObject(data.beforeMinimized))\n            {\n               // Take before minimized data.\n               positionData = data.beforeMinimized;\n\n               // Apply position left / top to before minimized data. This covers the case when an app is minimized,\n               // but then moved. This allows restoration of the before minimized parameters w/ the last position\n               // location.\n               positionData.left = data.position.left;\n               positionData.top = data.position.top;\n            }\n\n            application.position.set(positionData);\n         }\n      }\n\n      return application;\n   }\n}\n\n/**\n * @typedef {object} ApplicationStateData\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSPositionDataExtended}   position Application position.\n *\n * @property {object}         beforeMinimized Any application saved position state for #beforeMinimized\n *\n * @property {object}         options Application options.\n *\n * @property {object}         ui Application UI state.\n */\n","/**\n * Provides a mechanism to retrieve and query all mounted Svelte components including the main application shell.\n */\nexport class GetSvelteData\n{\n   /** @type {import('./types').MountedAppShell[] | null[]} */\n   #applicationShellHolder;\n\n   /** @type {import('./types').SvelteData[]} */\n   #svelteData;\n\n   /**\n    * Keep a direct reference to the SvelteData array in an associated {@link SvelteApplication}.\n    *\n    * @param {import('./types').MountedAppShell[] | null[]}  applicationShellHolder - A reference to the\n    *        MountedAppShell array.\n    *\n    * @param {import('./types').SvelteData[]}  svelteData - A reference to the SvelteData array of mounted components.\n    */\n   constructor(applicationShellHolder, svelteData)\n   {\n      this.#applicationShellHolder = applicationShellHolder;\n      this.#svelteData = svelteData;\n   }\n\n   /**\n    * Returns any mounted {@link MountedAppShell}.\n    *\n    * @returns {import('./types').MountedAppShell | null} Any mounted application shell.\n    */\n   get applicationShell() { return this.#applicationShellHolder[0]; }\n\n   /**\n    * Returns the indexed Svelte component.\n    *\n    * @param {number}   index -\n    *\n    * @returns {object} The loaded Svelte component.\n    */\n   component(index)\n   {\n      const data = this.#svelteData[index];\n      return data?.component ?? void 0;\n   }\n\n   /**\n    * Returns the Svelte component entries iterator.\n    *\n    * @returns {IterableIterator<[number, import('svelte').SvelteComponent]>} Svelte component entries iterator.\n    * @yields\n    */\n   *componentEntries()\n   {\n      for (let cntr = 0; cntr < this.#svelteData.length; cntr++)\n      {\n         yield [cntr, this.#svelteData[cntr].component];\n      }\n   }\n\n   /**\n    * Returns the Svelte component values iterator.\n    *\n    * @returns {IterableIterator<import('svelte').SvelteComponent>} Svelte component values iterator.\n    * @yields\n    */\n   *componentValues()\n   {\n      for (let cntr = 0; cntr < this.#svelteData.length; cntr++)\n      {\n         yield this.#svelteData[cntr].component;\n      }\n   }\n\n   /**\n    * Returns the indexed SvelteData entry.\n    *\n    * @param {number}   index - The index of SvelteData instance to retrieve.\n    *\n    * @returns {import('./types').SvelteData} The loaded Svelte config + component.\n    */\n   data(index)\n   {\n      return this.#svelteData[index];\n   }\n\n   /**\n    * Returns the {@link SvelteData} instance for a given component.\n    *\n    * @param {import('svelte').SvelteComponent} component - Svelte component.\n    *\n    * @returns {import('./types').SvelteData} -  The loaded Svelte config + component.\n    */\n   dataByComponent(component)\n   {\n      for (const data of this.#svelteData)\n      {\n         if (data.component === component) { return data; }\n      }\n\n      return void 0;\n   }\n\n   /**\n    * Returns the SvelteData entries iterator.\n    *\n    * @returns {IterableIterator<[number, import('./types').SvelteData]>} SvelteData entries iterator.\n    */\n   dataEntries()\n   {\n      return this.#svelteData.entries();\n   }\n\n   /**\n    * Returns the SvelteData values iterator.\n    *\n    * @returns {IterableIterator<import('./types').SvelteData>} SvelteData values iterator.\n    */\n   dataValues()\n   {\n      return this.#svelteData.values();\n   }\n\n   /**\n    * Returns the length of the mounted Svelte component list.\n    *\n    * @returns {number} Length of mounted Svelte component list.\n    */\n   get length()\n   {\n      return this.#svelteData.length;\n   }\n}\n","import { writable, get } from 'svelte/store';\n\n/**\n * Generates derived, readable, writable helper functions wrapping the given Storage API provided with any additional\n * customization for data serialization. By default, JSON serialization is used.\n *\n * @param {object}   opts - Generator options.\n *\n * @param {Storage}  storage - The web storage source.\n *\n * @param {(value: any, ...rest: any[]) => string}  [opts.serialize] - Replace with custom serialization;\n *        default: `JSON.stringify`.\n *\n * @param {(value: string, ...rest: any[]) => any}  [opts.deserialize] - Replace with custom deserialization;\n *        default: `JSON.parse`.\n *\n * @returns {StorageStores} A complete set of store helper functions and associated storage API instance and\n *          serialization strategy.\n */\nfunction storeGenerator({ storage, serialize = JSON.stringify, deserialize = JSON.parse }) {\n    function isSimpleDeriver(deriver) {\n        return deriver.length < 2;\n    }\n    function storageReadable(key, value, start) {\n        return {\n            subscribe: storageWritable(key, value, start).subscribe\n        };\n    }\n    function storageWritable(key, value, start) {\n        function wrap_start(ogSet) {\n            return start(function wrap_set(new_value) {\n                if (storage) {\n                    storage.setItem(key, serialize(new_value));\n                }\n                return ogSet(new_value);\n            }, function wrap_update(fn) {\n                set(fn(get(ogStore)));\n            });\n        }\n        if (storage) {\n            const storageValue = storage.getItem(key);\n            try {\n                if (storageValue) {\n                    value = deserialize(storageValue);\n                }\n            }\n            catch (err) { /**/ }\n            storage.setItem(key, serialize(value));\n        }\n        const ogStore = writable(value, start ? wrap_start : void 0);\n        function set(new_value) {\n            if (storage) {\n                storage.setItem(key, serialize(new_value));\n            }\n            ogStore.set(new_value);\n        }\n        function update(fn) {\n            set(fn(get(ogStore)));\n        }\n        function subscribe(run, invalidate) {\n            return ogStore.subscribe(run, invalidate);\n        }\n        return { set, update, subscribe };\n    }\n    function storageDerived(key, stores, fn, initial_value) {\n        const single = !Array.isArray(stores);\n        const stores_array = single ? [stores] : stores;\n        if (storage && storage.getItem(key)) {\n            try {\n                initial_value = deserialize(storage.getItem(key));\n            }\n            catch (err) { /**/ }\n        }\n        return storageReadable(key, initial_value, (set, update) => {\n            let inited = false;\n            const values = [];\n            let pending = 0;\n            let cleanup;\n            const sync = () => {\n                if (pending) {\n                    return;\n                }\n                cleanup?.();\n                const input = single ? values[0] : values;\n                if (isSimpleDeriver(fn)) {\n                    set(fn(input));\n                }\n                else {\n                    const result = fn(input, set, update);\n                    if (typeof result === 'function') {\n                        cleanup = result;\n                    }\n                }\n            };\n            const unsubscribers = stores_array.map((store, i) => store.subscribe((value) => {\n                values[i] = value;\n                pending &= ~(1 << i);\n                if (inited) {\n                    sync();\n                }\n            }, () => { pending |= (1 << i); }));\n            inited = true;\n            sync();\n            return function stop() {\n                // Equivalent to run_all from Svelte internals.\n                unsubscribers.forEach((unsubscriber) => unsubscriber());\n                cleanup?.();\n            };\n        });\n    }\n    return {\n        readable: storageReadable,\n        writable: storageWritable,\n        derived: storageDerived,\n        storage,\n        serialize,\n        deserialize\n    };\n}\n\n/**\n * Provides all Storage API enabled `localStorage` store helper functions. Data is serialized as JSON.\n */\nconst localStores = storeGenerator({ storage: globalThis?.localStorage });\n/**\n * Provides the Storage API enabled derived `localStorage` store helper function. Data is serialized as JSON.\n */\nlocalStores.derived;\n/**\n * Provides the Storage API enabled readable `localStorage` store helper function. Data is serialized as JSON.\n */\nlocalStores.readable;\n/**\n * Provides the Storage API enabled writable `localStorage` store helper function. Data is serialized as JSON.\n */\nlocalStores.writable;\n\n/**\n * Provides all Storage API enabled `sessionStorage` store helper functions. Data is serialized as JSON.\n */\nconst sessionStores = storeGenerator({ storage: globalThis?.sessionStorage });\n/**\n * Provides the Storage API enabled derived `sessionStorage` store helper function. Data is serialized as JSON.\n */\nsessionStores.derived;\n/**\n * Provides the Storage API enabled readable `sessionStorage` store helper function. Data is serialized as JSON.\n */\nsessionStores.readable;\n/**\n * Provides the Storage API enabled writable `sessionStorage` store helper function. Data is serialized as JSON.\n */\nsessionStores.writable;\n\n/**\n * Provides the base Storage API store manager. It is recommended to use {@link TJSLocalStorage} &\n * {@link TJSSessionStorage} for standard browser local and session storage use cases. TJSWebStorage exists\n * to provide additional customization options for custom Storage API compatible storage instances and custom\n * serialization configuration.\n */\nclass TJSWebStorage\n{\n   /** @type {import('./').StorageStores} */\n   #storageStores;\n\n   /**\n    * @type {(Map<string, {\n    *    store: import('svelte/store').Writable,\n    *    deserialize?: (value: string, ...rest: any[]) => any,\n    *    serialize?: (value: any, ...rest: any[]) => string\n    * }>)}\n    */\n   #stores = new Map();\n\n   /**\n    * @param {import('./').StorageStores} storageStores - Provides a complete set of\n    *        storage API store helper functions and the associated storage API instance and serializations strategy.\n    */\n   constructor(storageStores)\n   {\n      this.#storageStores = storageStores;\n   }\n\n\n   /**\n    * @param {string}   key - Storage key.\n    *\n    * @returns {(value: string, ...rest: any[]) => any} Deserialize function.\n    */\n   #getDeserialize(key)\n   {\n      return this.#stores.get(key)?.deserialize ?? this.#storageStores.deserialize;\n   }\n\n\n   /**\n    * @param {string}   key - Storage key.\n    *\n    * @returns {(value: any, ...rest: any[]) => string} Serialize function.\n    */\n   #getSerialize(key)\n   {\n      return this.#stores.get(key)?.serialize ?? this.#storageStores.serialize;\n   }\n\n   /**\n    * Creates a new store for the given key.\n    *\n    * @template T\n    *\n    * @param {string}   key - Key to lookup in stores map.\n    *\n    * @param {T}        [defaultValue] - A default value to set for the store.\n    *\n    * @param {import('./').StorageStores} [storageStores] - Additional store creation options.\n    *\n    * @returns {import('svelte/store').Writable<T>} The new store.\n    */\n   #createStore(key, defaultValue = void 0, storageStores)\n   {\n      try\n      {\n         const value = this.#storageStores.storage.getItem(key);\n         if (value !== null)\n         {\n            const deserialize = storageStores?.deserialize ?? this.#storageStores.deserialize;\n            defaultValue = deserialize(value);\n         }\n      }\n      catch (err) { /**/ }\n\n      const writable = storageStores?.writable ?? this.#storageStores.writable;\n\n      return writable(key, defaultValue);\n   }\n\n   /**\n    * Gets a store from the `stores` Map or creates a new store for the key and a given default value.\n    *\n    * @template T\n    *\n    * @param {string}   key - Key to lookup in stores map.\n    *\n    * @param {T}        [defaultValue] - A default value to set for the store.\n    *\n    * @param {import('./').StorageStores} [storageStores] - Additional store creation options.\n    *\n    * @returns {import('svelte/store').Writable<T>} The store for the given key.\n    */\n   #getStore(key, defaultValue = void 0, storageStores)\n   {\n      const storeEntry = this.#stores.get(key);\n      if (storeEntry) { return storeEntry.store; }\n\n      const store = this.#createStore(key, defaultValue, storageStores);\n\n      // Set any key specific storage helper details.\n      this.#stores.set(key, {\n         store,\n         deserialize: storageStores?.deserialize,\n         serialize: storageStores?.serialize\n      });\n\n      return store;\n   }\n\n   /**\n    * Get value from the storage API.\n    *\n    * @param {string}   key - Key to lookup in storage API.\n    *\n    * @param {*}        [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {*} Value from session storage or if not defined any default value provided.\n    */\n   getItem(key, defaultValue)\n   {\n      let value = defaultValue;\n\n      const storageValue = this.#storageStores.storage.getItem(key);\n\n      if (storageValue !== null)\n      {\n         try\n         {\n            value = this.#getDeserialize(key)(storageValue);\n         }\n         catch (err)\n         {\n            value = defaultValue;\n         }\n      }\n      else if (defaultValue !== void 0)\n      {\n         try\n         {\n            const newValue = this.#getSerialize(key)(defaultValue);\n\n            // If there is no existing storage value and defaultValue is defined the storage value needs to be set.\n            this.#storageStores.storage.setItem(key, newValue);\n         }\n         catch (err) { /* */ }\n      }\n\n      return value;\n   }\n\n   /**\n    * Returns the backing Svelte store for the given key; potentially sets a default value if the key\n    * is not already set.\n    *\n    * @template T\n    *\n    * @param {string}   key - Key to lookup in storage API.\n    *\n    * @param {T}        [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @param {import('./').StorageStores} [storageStores] - Additional store creation options.\n    *\n    * @returns {import('svelte/store').Writable<T>} The Svelte store for this key.\n    */\n   getStore(key, defaultValue, storageStores)\n   {\n      return this.#getStore(key, defaultValue, storageStores);\n   }\n\n   /**\n    * Sets the value for the given key in storage API.\n    *\n    * @param {string}   key - Key to lookup in storage API.\n    *\n    * @param {*}        value - A value to set for this key.\n    */\n   setItem(key, value)\n   {\n      const store = this.#getStore(key);\n      store.set(value);\n   }\n\n   /**\n    * Convenience method to swap a boolean value stored in storage API.\n    *\n    * @param {string}   key - Key to lookup in storage API.\n    *\n    * @param {boolean}  [defaultValue] - A default value to return if key not present in session storage.\n    *\n    * @returns {boolean} The boolean swap for the given key.\n    */\n   swapItemBoolean(key, defaultValue)\n   {\n      const store = this.#getStore(key, defaultValue);\n\n      let currentValue = false;\n\n      try\n      {\n         currentValue = !!this.#getDeserialize(key)(this.#storageStores.storage.getItem(key));\n      }\n      catch (err) { /**/ }\n\n      const newValue = typeof currentValue === 'boolean' ? !currentValue : false;\n\n      store.set(newValue);\n      return newValue;\n   }\n}\n\n/**\n * Provides a {@link TJSWebStorage} instance for standard browser local storage use cases.\n */\nclass TJSLocalStorage extends TJSWebStorage\n{\n   constructor()\n   {\n      super(localStores);\n   }\n}\n\n/**\n * Provides a {@link TJSWebStorage} instance for standard browser session storage use cases.\n */\nclass TJSSessionStorage extends TJSWebStorage\n{\n   constructor()\n   {\n      super(sessionStores);\n   }\n}\n\nexport { TJSLocalStorage, TJSSessionStorage, TJSWebStorage, localStores, sessionStores, storeGenerator };\n//# sourceMappingURL=index.js.map\n","import { derived, writable }     from 'svelte/store';\n\nimport {\n   TJSSessionStorage,\n   TJSWebStorage }               from '@typhonjs-fvtt/runtime/svelte/store/web-storage';\n\nimport { propertyStore }         from '@typhonjs-fvtt/runtime/svelte/store/writable-derived';\n\nimport {\n   deepMerge,\n   safeAccess,\n   safeSet }                     from '@typhonjs-fvtt/runtime/util/object';\n\nimport { subscribeIgnoreFirst }  from '@typhonjs-fvtt/runtime/util/store';\n\n/**\n * Contains the reactive functionality / Svelte stores associated with SvelteApplication and retrievable by\n * {@link SvelteApplication.reactive}.\n *\n * There are several reactive getters for UI state such and for two-way bindings / stores see\n * {@link SvelteReactive.storeUIState}:\n * - {@link SvelteReactive.dragging}\n * - {@link SvelteReactive.minimized}\n * - {@link SvelteReactive.resizing}\n *\n * There are also reactive getters / setters for {@link SvelteApplicationOptions} and Foundry\n * {@link ApplicationOptions}. You can use the following as one way bindings and update the associated stores. For\n * two-way bindings / stores see {@link SvelteReactive.storeAppOptions}.\n *\n * - {@link SvelteReactive.draggable}\n * - {@link SvelteReactive.focusAuto}\n * - {@link SvelteReactive.focusKeep}\n * - {@link SvelteReactive.focusTrap}\n * - {@link SvelteReactive.headerButtonNoClose}\n * - {@link SvelteReactive.headerButtonNoLabel}\n * - {@link SvelteReactive.headerIcon}\n * - {@link SvelteReactive.headerNoTitleMinimized}\n * - {@link SvelteReactive.minimizable}\n * - {@link SvelteReactive.popOut}\n * - {@link SvelteReactive.positionable}\n * - {@link SvelteReactive.resizable}\n * - {@link SvelteReactive.title}\n *\n * An instance of TJSWebStorage (session) / TJSSessionStorage is accessible via {@link SvelteReactive.sessionStorage}.\n * Optionally you can pass in an existing TJSWebStorage instance that can be shared across multiple SvelteApplications\n * by setting {@link SvelteApplicationOptions.sessionStorage}.\n *\n * -------------------------------------------------------------------------------------------------------------------\n *\n * This API is not sealed, and it is recommended that you extend it with accessors to get / set data that is reactive\n * in your application. An example of setting an exported prop `document` from the main mounted application shell.\n *\n * @example\n * import { hasSetter } from '@typhonjs-fvtt/runtime/svelte/util';\n *\n * // Note: make a normal comment.\n * //  * @member {object} document - Adds accessors to SvelteReactive to get / set the document associated with\n * //  *                             Document with the mounted application shell Svelte component.\n * //  *\n * //  * @memberof SvelteReactive#\n * //  *\n * Object.defineProperty(this.reactive, 'document', {\n *    get: () => this.svelte?.applicationShell?.document,\n *    set: (document) =>\n *    {\n *       const component = this.svelte?.applicationShell;\n *       if (hasSetter(component, 'document')) { component.document = document; }\n *    }\n * });\n */\nexport class SvelteReactive\n{\n   /**\n    * @type {import('../SvelteApplication').SvelteApplication}\n    */\n   #application;\n\n   /**\n    * @type {boolean}\n    */\n   #initialized = false;\n\n   /** @type {import('@typhonjs-fvtt/runtime/svelte/store/web-storage').TJSWebStorage} */\n   #sessionStorage;\n\n   /**\n    * The Application option store which is injected into mounted Svelte component context under the `external` key.\n    *\n    * @type {import('./types').StoreAppOptions}\n    */\n   #storeAppOptions;\n\n   /**\n    * Stores the update function for `#storeAppOptions`.\n    *\n    * @type {(this: void, updater: import('svelte/store').Updater<object>) => void}\n    */\n   #storeAppOptionsUpdate;\n\n   /**\n    * Stores the UI state data to make it accessible via getters.\n    *\n    * @type {object}\n    */\n   #dataUIState;\n\n   /**\n    * The UI option store which is injected into mounted Svelte component context under the `external` key.\n    *\n    * @type {import('./types').StoreUIOptions}\n    */\n   #storeUIState;\n\n   /**\n    * Stores the update function for `#storeUIState`.\n    *\n    * @type {(this: void, updater: import('svelte/store').Updater<object>) => void}\n    */\n   #storeUIStateUpdate;\n\n   /**\n    * Stores the unsubscribe functions from local store subscriptions.\n    *\n    * @type {import('svelte/store').Unsubscriber[]}\n    */\n   #storeUnsubscribe = [];\n\n   /**\n    * @param {import('../SvelteApplication').SvelteApplication} application - The host Foundry application.\n    */\n   constructor(application)\n   {\n      this.#application = application;\n      const optionsSessionStorage = application?.options?.sessionStorage;\n\n      if (optionsSessionStorage !== void 0 && !(optionsSessionStorage instanceof TJSWebStorage))\n      {\n         throw new TypeError(`'options.sessionStorage' is not an instance of TJSWebStorage.`);\n      }\n\n      // If no external web storage API instance is available then create a TJSSessionStorage instance.\n      this.#sessionStorage = optionsSessionStorage !== void 0 ? optionsSessionStorage : new TJSSessionStorage();\n   }\n\n   /**\n    * Initializes reactive support. Package private for internal use.\n    *\n    * @returns {SvelteReactiveStores | undefined} Internal methods to interact with Svelte stores.\n    * @package\n    * @internal\n    */\n   initialize()\n   {\n      if (this.#initialized) { return; }\n\n      this.#initialized = true;\n\n      this.#storesInitialize();\n\n      return {\n         appOptionsUpdate: this.#storeAppOptionsUpdate,\n         uiStateUpdate: this.#storeUIStateUpdate,\n         subscribe: this.#storesSubscribe.bind(this),\n         unsubscribe: this.#storesUnsubscribe.bind(this)\n      };\n   }\n\n// Store getters -----------------------------------------------------------------------------------------------------\n\n   /**\n    * @returns {import('@typhonjs-fvtt/runtime/svelte/store/web-storage').TJSWebStorage} Returns TJSWebStorage (session) instance.\n    */\n   get sessionStorage()\n   {\n      return this.#sessionStorage;\n   }\n\n   /**\n    * Returns the store for app options.\n    *\n    * @returns {import('./types').StoreAppOptions} App options store.\n    */\n   get storeAppOptions() { return this.#storeAppOptions; }\n\n   /**\n    * Returns the store for UI options.\n    *\n    * @returns {import('./types').StoreUIOptions} UI options store.\n    */\n   get storeUIState() { return this.#storeUIState; }\n\n// Only reactive getters ---------------------------------------------------------------------------------------------\n\n   /**\n    * Returns the current dragging UI state.\n    *\n    * @returns {boolean} Dragging UI state.\n    */\n   get dragging() { return this.#dataUIState.dragging; }\n\n   /**\n    * Returns the current minimized UI state.\n    *\n    * @returns {boolean} Minimized UI state.\n    */\n   get minimized() { return this.#dataUIState.minimized; }\n\n   /**\n    * Returns the current resizing UI state.\n    *\n    * @returns {boolean} Resizing UI state.\n    */\n   get resizing() { return this.#dataUIState.resizing; }\n\n// Reactive getter / setters -----------------------------------------------------------------------------------------\n\n   /**\n    * Returns the draggable app option.\n    *\n    * @returns {boolean} Draggable app option.\n    */\n   get draggable() { return this.#application?.options?.draggable; }\n\n   /**\n    * Returns the focusAuto app option.\n    *\n    * @returns {boolean} When true auto-management of app focus is enabled.\n    */\n   get focusAuto() { return this.#application?.options?.focusAuto; }\n\n   /**\n    * Returns the focusKeep app option.\n    *\n    * @returns {boolean} When `focusAuto` and `focusKeep` is true; keeps internal focus.\n    */\n   get focusKeep() { return this.#application?.options?.focusKeep; }\n\n   /**\n    * Returns the focusTrap app option.\n    *\n    * @returns {boolean} When true focus trapping / wrapping is enabled keeping focus inside app.\n    */\n   get focusTrap() { return this.#application?.options?.focusTrap; }\n\n   /**\n    * Returns the headerButtonNoClose app option.\n    *\n    * @returns {boolean} Remove the close the button in header app option.\n    */\n   get headerButtonNoClose() { return this.#application?.options?.headerButtonNoClose; }\n\n   /**\n    * Returns the headerButtonNoLabel app option.\n    *\n    * @returns {boolean} Remove the labels from buttons in header app option.\n    */\n   get headerButtonNoLabel() { return this.#application?.options?.headerButtonNoLabel; }\n\n   /**\n    * Returns the headerIcon app option.\n    *\n    * @returns {string|void} URL for header app icon.\n    */\n   get headerIcon() { return this.#application?.options?.headerIcon; }\n\n   /**\n    * Returns the headerNoTitleMinimized app option.\n    *\n    * @returns {boolean} When true removes the header title when minimized.\n    */\n   get headerNoTitleMinimized() { return this.#application?.options?.headerNoTitleMinimized; }\n\n   /**\n    * Returns the minimizable app option.\n    *\n    * @returns {boolean} Minimizable app option.\n    */\n   get minimizable() { return this.#application?.options?.minimizable; }\n\n   /**\n    * Returns the Foundry popOut state; {@link Application.popOut}\n    *\n    * @returns {boolean} Positionable app option.\n    */\n   get popOut() { return this.#application.popOut; }\n\n   /**\n    * Returns the positionable app option; {@link SvelteApplicationOptions.positionable}\n    *\n    * @returns {boolean} Positionable app option.\n    */\n   get positionable() { return this.#application?.options?.positionable; }\n\n   /**\n    * Returns the resizable option.\n    *\n    * @returns {boolean} Resizable app option.\n    */\n   get resizable() { return this.#application?.options?.resizable; }\n\n   /**\n    * Returns the title accessor from the parent Application class; {@link Application.title}\n    * TODO: Application v2; note that super.title localizes `this.options.title`; IMHO it shouldn't.\n    *\n    * @returns {string} Title.\n    */\n   get title() { return this.#application.title; }\n\n   /**\n    * Sets `this.options.draggable` which is reactive for application shells.\n    *\n    * @param {boolean}  draggable - Sets the draggable option.\n    */\n   set draggable(draggable)\n   {\n      if (typeof draggable === 'boolean') { this.setOptions('draggable', draggable); }\n   }\n\n   /**\n    * Sets `this.options.focusAuto` which is reactive for application shells.\n    *\n    * @param {boolean}  focusAuto - Sets the focusAuto option.\n    */\n   set focusAuto(focusAuto)\n   {\n      if (typeof focusAuto === 'boolean') { this.setOptions('focusAuto', focusAuto); }\n   }\n\n   /**\n    * Sets `this.options.focusKeep` which is reactive for application shells.\n    *\n    * @param {boolean}  focusKeep - Sets the focusKeep option.\n    */\n   set focusKeep(focusKeep)\n   {\n      if (typeof focusKeep === 'boolean') { this.setOptions('focusKeep', focusKeep); }\n   }\n\n   /**\n    * Sets `this.options.focusTrap` which is reactive for application shells.\n    *\n    * @param {boolean}  focusTrap - Sets the focusTrap option.\n    */\n   set focusTrap(focusTrap)\n   {\n      if (typeof focusTrap === 'boolean') { this.setOptions('focusTrap', focusTrap); }\n   }\n\n   /**\n    * Sets `this.options.headerButtonNoClose` which is reactive for application shells.\n    *\n    * @param {boolean}  headerButtonNoClose - Sets the headerButtonNoClose option.\n    */\n   set headerButtonNoClose(headerButtonNoClose)\n   {\n      if (typeof headerButtonNoClose === 'boolean') { this.setOptions('headerButtonNoClose', headerButtonNoClose); }\n   }\n\n   /**\n    * Sets `this.options.headerButtonNoLabel` which is reactive for application shells.\n    *\n    * @param {boolean}  headerButtonNoLabel - Sets the headerButtonNoLabel option.\n    */\n   set headerButtonNoLabel(headerButtonNoLabel)\n   {\n      if (typeof headerButtonNoLabel === 'boolean') { this.setOptions('headerButtonNoLabel', headerButtonNoLabel); }\n   }\n\n   /**\n    * Sets `this.options.headerIcon` which is reactive for application shells.\n    *\n    * @param {string | undefined}  headerIcon - Sets the headerButtonNoLabel option.\n    */\n   set headerIcon(headerIcon)\n   {\n      if (headerIcon === void 0 || typeof headerIcon === 'string') { this.setOptions('headerIcon', headerIcon); }\n   }\n\n   /**\n    * Sets `this.options.headerNoTitleMinimized` which is reactive for application shells.\n    *\n    * @param {boolean}  headerNoTitleMinimized - Sets the headerNoTitleMinimized option.\n    */\n   set headerNoTitleMinimized(headerNoTitleMinimized)\n   {\n      if (typeof headerNoTitleMinimized === 'boolean')\n      {\n         this.setOptions('headerNoTitleMinimized', headerNoTitleMinimized);\n      }\n   }\n\n   /**\n    * Sets `this.options.minimizable` which is reactive for application shells that are also pop out.\n    *\n    * @param {boolean}  minimizable - Sets the minimizable option.\n    */\n   set minimizable(minimizable)\n   {\n      if (typeof minimizable === 'boolean') { this.setOptions('minimizable', minimizable); }\n   }\n\n   /**\n    * Sets `this.options.popOut` which is reactive for application shells. This will add / remove this application\n    * from `ui.windows`.\n    *\n    * @param {boolean}  popOut - Sets the popOut option.\n    */\n   set popOut(popOut)\n   {\n      if (typeof popOut === 'boolean') { this.setOptions('popOut', popOut); }\n   }\n\n   /**\n    * Sets `this.options.positionable` enabling / disabling {@link SvelteApplication.position}.\n    *\n    * @param {boolean}  positionable - Sets the positionable option.\n    */\n   set positionable(positionable)\n   {\n      if (typeof positionable === 'boolean') { this.setOptions('positionable', positionable); }\n   }\n\n   /**\n    * Sets `this.options.resizable` which is reactive for application shells.\n    *\n    * @param {boolean}  resizable - Sets the resizable option.\n    */\n   set resizable(resizable)\n   {\n      if (typeof resizable === 'boolean') { this.setOptions('resizable', resizable); }\n   }\n\n   /**\n    * Sets `this.options.title` which is reactive for application shells.\n    *\n    * Note: Will set empty string if title is undefined or null.\n    *\n    * @param {string | undefined | null}   title - Application title; will be localized, so a translation key is fine.\n    */\n   set title(title)\n   {\n      if (typeof title === 'string')\n      {\n         this.setOptions('title', title);\n      }\n      else if (title === void 0 || title === null)\n      {\n         this.setOptions('title', '');\n      }\n   }\n\n   // Reactive Options API -------------------------------------------------------------------------------------------\n\n   /**\n    * Provides a way to safely get this applications options given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * // TODO DOCUMENT the accessor in more detail.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {*}        [defaultValue] - A default value returned if the accessor is not found.\n    *\n    * @returns {*} Value at the accessor.\n    */\n   getOptions(accessor, defaultValue)\n   {\n      return safeAccess(this.#application.options, accessor, defaultValue);\n   }\n\n   /**\n    * Provides a way to merge `options` into this applications options and update the appOptions store.\n    *\n    * @param {object}   options - The options object to merge with `this.options`.\n    */\n   mergeOptions(options)\n   {\n      this.#storeAppOptionsUpdate((instanceOptions) => deepMerge(instanceOptions, options));\n   }\n\n   /**\n    * Provides a way to safely set this applications options given an accessor string which describes the\n    * entries to walk. To access deeper entries into the object format the accessor string with `.` between entries\n    * to walk.\n    *\n    * Additionally if an application shell Svelte component is mounted and exports the `appOptions` property then\n    * the application options is set to `appOptions` potentially updating the application shell / Svelte component.\n    *\n    * // TODO DOCUMENT the accessor in more detail.\n    *\n    * @param {string}   accessor - The path / key to set. You can set multiple levels.\n    *\n    * @param {any}      value - Value to set.\n    */\n   setOptions(accessor, value)\n   {\n      const success = safeSet(this.#application.options, accessor, value);\n\n      // If `this.options` modified then update the app options store.\n      if (success)\n      {\n         this.#storeAppOptionsUpdate(() => this.#application.options);\n      }\n   }\n\n   /**\n    * Initializes the Svelte stores and derived stores for the application options and UI state.\n    *\n    * While writable stores are created the update method is stored in private variables locally and derived Readable\n    * stores are provided for essential options which are commonly used.\n    *\n    * These stores are injected into all Svelte components mounted under the `external` context: `storeAppOptions` and\n    * `storeUIState`.\n    */\n   #storesInitialize()\n   {\n      const writableAppOptions = writable(this.#application.options);\n\n      // Keep the update function locally, but make the store essentially readable.\n      this.#storeAppOptionsUpdate = writableAppOptions.update;\n\n      /**\n       * Create custom store. The main subscribe method for all app options changes is provided along with derived\n       * writable stores for all reactive options.\n       *\n       * @type {import('./types').StoreAppOptions}\n       */\n      const storeAppOptions = {\n         subscribe: writableAppOptions.subscribe,\n\n         draggable: propertyStore(writableAppOptions, 'draggable'),\n         focusAuto: propertyStore(writableAppOptions, 'focusAuto'),\n         focusKeep: propertyStore(writableAppOptions, 'focusKeep'),\n         focusTrap: propertyStore(writableAppOptions, 'focusTrap'),\n         headerButtonNoClose: propertyStore(writableAppOptions, 'headerButtonNoClose'),\n         headerButtonNoLabel: propertyStore(writableAppOptions, 'headerButtonNoLabel'),\n         headerIcon: propertyStore(writableAppOptions, 'headerIcon'),\n         headerNoTitleMinimized: propertyStore(writableAppOptions, 'headerNoTitleMinimized'),\n         minimizable: propertyStore(writableAppOptions, 'minimizable'),\n         popOut: propertyStore(writableAppOptions, 'popOut'),\n         positionable: propertyStore(writableAppOptions, 'positionable'),\n         resizable: propertyStore(writableAppOptions, 'resizable'),\n         title: propertyStore(writableAppOptions, 'title')\n      };\n\n      Object.freeze(storeAppOptions);\n\n      this.#storeAppOptions = storeAppOptions;\n\n      this.#dataUIState = {\n         dragging: false,\n         headerButtons: [],\n         minimized: this.#application._minimized,\n         resizing: false\n      };\n\n      // Create a store for UI state data.\n      const writableUIOptions = writable(this.#dataUIState);\n\n      // Keep the update function locally, but make the store essentially readable.\n      this.#storeUIStateUpdate = writableUIOptions.update;\n\n      /**\n       * @type {import('./types').StoreUIOptions}\n       */\n      const storeUIState = {\n         subscribe: writableUIOptions.subscribe,\n\n         dragging: propertyStore(writableUIOptions, 'dragging'),\n         headerButtons: derived(writableUIOptions, ($options, set) => set($options.headerButtons)),\n         minimized: derived(writableUIOptions, ($options, set) => set($options.minimized)),\n         resizing: propertyStore(writableUIOptions, 'resizing')\n      };\n\n      Object.freeze(storeUIState);\n\n      // Initialize the store with options set in the Application constructor.\n      this.#storeUIState = storeUIState;\n   }\n\n   /**\n    * Registers local store subscriptions for app options. `popOut` controls registering this app with `ui.windows`.\n    *\n    * @see SvelteApplication._injectHTML\n    */\n   #storesSubscribe()\n   {\n      // Register local subscriptions.\n\n      // Handles updating header buttons to add / remove the close button.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.headerButtonNoClose, (value) =>\n      {\n         this.updateHeaderButtons({ headerButtonNoClose: value });\n      }));\n\n      // Handles updating header buttons to add / remove button labels.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.headerButtonNoLabel, (value) =>\n      {\n         this.updateHeaderButtons({ headerButtonNoLabel: value });\n      }));\n\n      // Handles adding / removing this application from `ui.windows` when popOut changes.\n      this.#storeUnsubscribe.push(subscribeIgnoreFirst(this.#storeAppOptions.popOut, (value) =>\n      {\n         if (value && this.#application.rendered)\n         {\n            globalThis.ui.windows[this.#application.appId] = this.#application;\n         }\n         else\n         {\n            delete globalThis.ui.windows[this.#application.appId];\n         }\n      }));\n   }\n\n   /**\n    * Unsubscribes from any locally monitored stores.\n    *\n    * @see SvelteApplication.close\n    */\n   #storesUnsubscribe()\n   {\n      this.#storeUnsubscribe.forEach((unsubscribe) => unsubscribe());\n      this.#storeUnsubscribe = [];\n   }\n\n   /**\n    * Updates the UI Options store with the current header buttons. You may dynamically add / remove header buttons\n    * if using an application shell Svelte component. In either overriding `_getHeaderButtons` or responding to the\n    * Hooks fired return a new button array and the uiOptions store is updated and the application shell will render\n    * the new buttons.\n    *\n    * Optionally you can set in the SvelteApplication app options {@link SvelteApplicationOptions.headerButtonNoClose}\n    * to remove the close button and {@link SvelteApplicationOptions.headerButtonNoLabel} to true and labels will be\n    * removed from the header buttons.\n    *\n    * @param {object} [opts] - Optional parameters (for internal use)\n    *\n    * @param {boolean} [opts.headerButtonNoClose] - The value for `headerButtonNoClose`.\n    *\n    * @param {boolean} [opts.headerButtonNoLabel] - The value for `headerButtonNoLabel`.\n    */\n   updateHeaderButtons({ headerButtonNoClose = this.#application.options.headerButtonNoClose,\n    headerButtonNoLabel = this.#application.options.headerButtonNoLabel } = {})\n   {\n      let buttons = this.#application._getHeaderButtons();\n\n      // Remove close button if this.options.headerButtonNoClose is true;\n      if (typeof headerButtonNoClose === 'boolean' && headerButtonNoClose)\n      {\n         buttons = buttons.filter((button) => button.class !== 'close');\n      }\n\n      // Remove labels if this.options.headerButtonNoLabel is true;\n      if (typeof headerButtonNoLabel === 'boolean' && headerButtonNoLabel)\n      {\n         for (const button of buttons) { button.label = void 0; }\n      }\n\n      this.#storeUIStateUpdate((options) =>\n      {\n         options.headerButtons = buttons;\n         return options;\n      });\n   }\n}\n\n/**\n * @typedef {object} SvelteReactiveStores\n *\n * @property {(this: void, updater: import('svelte/store').Updater<object>) => void} appOptionsUpdate Update function\n * for app options store.\n *\n * @property {Function} subscribe Subscribes to local stores.\n *\n * @property {(this: void, updater: import('svelte/store').Updater<object>) => void} uiStateUpdate Update function\n * for UI state stores.\n *\n * @property {Function} unsubscribe Unsubscribes from local stores.\n */\n","/**\n * Defines the application shell contract. If Svelte components export getter / setters for the following properties\n * then that component is considered an application shell.\n *\n * @type {string[]}\n */\nconst applicationShellContract = ['elementRoot'];\n\nObject.freeze(applicationShellContract);\n\nexport { applicationShellContract };\n","import { applicationShellContract } from './applicationShellContract.js';\n\n/**\n * Provides a method to determine if the passed in object / Svelte component follows the application shell contract.\n * This involves ensuring that the accessors defined in `applicationShellContract`.\n *\n * Note: A caveat is that when using Vite in a developer build components are wrapped in a proxy / ProxyComponent that\n * defines instance accessors versus on the prototype, so the check below ensures that all accessors in the contract are\n * either available on the prototype or directly on the instance.\n *\n * @param {*}  component - Object / component to test.\n *\n * @returns {boolean} Whether the component is a ApplicationShell or TJSApplicationShell.\n */\nexport function isApplicationShell(component)\n{\n   if (component === null || component === void 0) { return false; }\n\n   let compHasContract = true;\n   let protoHasContract = true;\n\n   // Check for accessors on the instance.\n   for (const accessor of applicationShellContract)\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(component, accessor);\n      if (descriptor === void 0 || descriptor.get === void 0 || descriptor.set === void 0) { compHasContract = false; }\n   }\n\n   // Get the prototype which is the parent SvelteComponent that has any getter / setters.\n   const prototype = Object.getPrototypeOf(component);\n\n   // Verify the application shell contract. If the accessors (getters / setters) are defined for\n   // `applicationShellContract`.\n   for (const accessor of applicationShellContract)\n   {\n      const descriptor = Object.getOwnPropertyDescriptor(prototype, accessor);\n      if (descriptor === void 0 || descriptor.get === void 0 || descriptor.set === void 0) { protoHasContract = false; }\n   }\n\n   return compHasContract || protoHasContract;\n}\n","import { parseTJSSvelteConfig }  from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport { isApplicationShell }    from './isApplicationShell.js';\n\nimport { isObject }              from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * Instantiates and attaches a Svelte component to the main inserted HTML.\n *\n * @param {object}            [opts] - Optional parameters.\n *\n * @param {object}            [opts.app] - The target application\n *\n * @param {HTMLElement}       [opts.template] - Any HTML template.\n *\n * @param {import('@typhonjs-fvtt/runtime/svelte/util').TJSSvelteConfig}  [opts.config] - Svelte component options\n *\n * @param {Function}          [opts.elementRootUpdate] - A callback to assign to the external context.\n *\n * @returns {import('@typhonjs-fvtt/runtime/svelte/application').SvelteData} The config + instantiated Svelte component.\n */\nexport function loadSvelteConfig({ app, template, config, elementRootUpdate } = {})\n{\n   const svelteOptions = isObject(config.options) ? config.options : {};\n\n   let target;\n\n   // A specific HTMLElement to append Svelte component.\n   if (config.target instanceof HTMLElement)\n   {\n      target = config.target;\n   }\n   // A string target defines a selector to find in existing HTML.\n   else if (template instanceof HTMLElement && typeof config.target === 'string')\n   {\n      target = template.querySelector(config.target);\n   }\n   else                                            // No target defined, create a document fragment.\n   {\n      target = document.createDocumentFragment();\n   }\n\n   if (target === void 0)\n   {\n      console.log(\n       `%c[TRL] loadSvelteConfig error - could not find target selector, '${config.target}', for config:\\n`,\n       'background: rgb(57,34,34)', config);\n\n      throw new Error();\n   }\n\n   const NewSvelteComponent = config.class;\n\n   const svelteConfig = parseTJSSvelteConfig({ ...config, target }, app);\n\n   const externalContext = svelteConfig.context.get('#external');\n\n   // Inject the Foundry application instance and `elementRootUpdate` to the external context.\n   externalContext.application = app;\n   externalContext.elementRootUpdate = elementRootUpdate;\n   externalContext.sessionStorage = app.reactive.sessionStorage;\n\n   let eventbus;\n\n   // Potentially inject any TyphonJS eventbus and track the proxy in the SvelteData instance.\n   if (isObject(app._eventbus) && typeof app._eventbus.createProxy === 'function')\n   {\n      eventbus = app._eventbus.createProxy();\n      externalContext.eventbus = eventbus;\n   }\n\n   // Seal external context so that it can't be extended.\n   Object.seal(externalContext);\n\n   // TODO: Remove deprecation warning in the future -----------------------------------------------------------------\n\n   svelteConfig.context.set('external', new Proxy({}, {\n      get(targetUnused, prop)\n      {\n         console.warn(`[TRL] Deprecation warning: Please change getContext('external') to getContext('#external').`);\n         return externalContext[prop];\n      }\n   }));\n\n   // TODO: Remove deprecation warning in the future -----------------------------------------------------------------\n\n   // Create the Svelte component.\n   /**\n    * @type {import('svelte').SvelteComponent}\n    */\n   const component = new NewSvelteComponent(svelteConfig);\n\n   // Set any eventbus to the config.\n   svelteConfig.eventbus = eventbus;\n\n   /**\n    * @type {HTMLElement}\n    */\n   let element;\n\n   // We can directly get the root element from components which follow the application store contract.\n   if (isApplicationShell(component))\n   {\n      element = component.elementRoot;\n   }\n\n   // Detect if target is a synthesized DocumentFragment with a child element. Child elements will be present\n   // if the Svelte component mounts and renders initial content into the document fragment.\n   if (target instanceof DocumentFragment && target.firstElementChild)\n   {\n      if (element === void 0) { element = target.firstElementChild; }\n      template.append(target);\n   }\n   else if (config.target instanceof HTMLElement && element === void 0)\n   {\n      if (config.target instanceof HTMLElement && typeof svelteOptions.selectorElement !== 'string')\n      {\n         console.log(\n          `%c[TRL] loadSvelteConfig error - HTMLElement target with no 'selectorElement' defined.\\n` +\n          `\\nNote: If configuring an application shell and directly targeting a HTMLElement did you bind an` +\n          `'elementRoot' and include '<svelte:options accessors={true}/>'?\\n` +\n          `\\nOffending config:\\n`, 'background: rgb(57,34,34)', config);\n\n         throw new Error();\n      }\n\n      // The target is an HTMLElement so find the Application element from `selectorElement` option.\n      element = target.querySelector(svelteOptions.selectorElement);\n\n      if (element === null || element === void 0)\n      {\n         console.log(\n          `%c[TRL] loadSvelteConfig error - HTMLElement target with 'selectorElement', '${\n           svelteOptions.selectorElement}', not found for config:\\n`,\n          'background: rgb(57,34,34)', config);\n\n         throw new Error();\n      }\n   }\n\n   // If the configuration / original target is an HTML element then do not inject HTML.\n   const injectHTML = !(config.target instanceof HTMLElement);\n\n   return { config: svelteConfig, component, element, injectHTML };\n}\n","/**\n * Provides an index of all visible rendered {@link SvelteApplication} instances in a given Svelte runtime. This allows\n * bulk operations to be performed across all apps.\n */\nexport class TJSAppIndex\n{\n   /**\n    * Stores all visible / rendered apps.\n    *\n    * @type {Map<string, import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication>}\n    */\n   static #visibleApps = new Map();\n\n   /**\n    * Adds a SvelteApplication to all visible apps tracked.\n    *\n    * @param {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication} app - A SvelteApplication\n    *\n    * @package\n    */\n   static add(app)\n   {\n      this.#visibleApps.set(app.id, app);\n   }\n\n   /**\n    * Removes a SvelteApplication from all visible apps tracked.\n    *\n    * @param {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication} app - A SvelteApplication\n    *\n    * @package\n    */\n   static delete(app)\n   {\n      this.#visibleApps.delete(app.id);\n   }\n\n   /**\n    * Gets a particular app by ID.\n    *\n    * @param {string}   key - App ID.\n    *\n    * @returns {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication} Associated app.\n    */\n   static get(key)\n   {\n      return this.#visibleApps.get(key);\n   }\n\n   /**\n    * Returns whether an associated app by ID is being tracked.\n    *\n    * @param {string}   key - App ID.\n    *\n    * @returns {boolean} The given App ID is visible.\n    */\n   static has(key)\n   {\n      return this.#visibleApps.has(key);\n   }\n\n   /**\n    * @returns {IterableIterator<string>} All visible app IDs.\n    */\n   static keys()\n   {\n      return this.#visibleApps.keys();\n   }\n\n   /**\n    * @returns {IterableIterator<import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplication>} All visible apps.\n    */\n   static values()\n   {\n      return this.#visibleApps.values();\n   }\n}\n","import { TJSPosition }  from '@typhonjs-fvtt/runtime/svelte/store/position';\n\nimport {\n   isHMRProxy,\n   outroAndDestroy }    from '@typhonjs-fvtt/runtime/svelte/util';\n\nimport { A11yHelper }   from '@typhonjs-fvtt/runtime/util/browser';\n\nimport {\n   deepMerge,\n   hasGetter,\n   isIterable,\n   isObject }           from '@typhonjs-fvtt/runtime/util/object';\n\nimport {\n   ApplicationState,\n   GetSvelteData,\n   loadSvelteConfig,\n   isApplicationShell,\n   SvelteReactive,\n   TJSAppIndex }        from './internal/index.js';\n\n/**\n * Provides a Svelte aware extension to the Foundry {@link Application} class to manage the app lifecycle\n * appropriately. You can declaratively load one or more components from `defaultOptions` using a\n * {@link TJSSvelteConfig} object in the SvelteApplicationOptions `options` {@link SvelteApplicationOptions.svelte}\n * property.\n */\nexport class SvelteApplication extends Application\n{\n   /**\n    * Stores the first mounted component which follows the application shell contract.\n    *\n    * @type {import('./internal/state-svelte/types').MountedAppShell[]|null[]} Application shell.\n    */\n   #applicationShellHolder = [null];\n\n   /**\n    * Stores and manages application state for saving / restoring / serializing.\n    *\n    * @type {ApplicationState<SvelteApplication>}\n    */\n   #applicationState;\n\n   /**\n    * Stores the target element which may not necessarily be the main element.\n    *\n    * @type {HTMLElement}\n    */\n   #elementTarget = null;\n\n   /**\n    * Stores the content element which is set for application shells.\n    *\n    * @type {HTMLElement}\n    */\n   #elementContent = null;\n\n   /**\n    * Stores initial z-index from `_renderOuter` to set to target element / Svelte component.\n    *\n    * @type {number}\n    */\n   #initialZIndex = 95;\n\n   /**\n    * Stores on mount state which is checked in _render to trigger onSvelteMount callback.\n    *\n    * @type {boolean}\n    */\n   #onMount = false;\n\n   /**\n    * The position store.\n    *\n    * @type {TJSPosition}\n    */\n   #position;\n\n   /**\n    * Contains the Svelte stores and reactive accessors.\n    *\n    * @type {SvelteReactive}\n    */\n   #reactive;\n\n   /**\n    * Stores SvelteData entries with instantiated Svelte components.\n    *\n    * @type {import('./internal/state-svelte/types').SvelteData[]}\n    */\n   #svelteData = [];\n\n   /**\n    * Provides a helper class that combines multiple methods for interacting with the mounted components tracked in\n    * #svelteData.\n    *\n    * @type {GetSvelteData}\n    */\n   #getSvelteData = new GetSvelteData(this.#applicationShellHolder, this.#svelteData);\n\n   /**\n    * Contains methods to interact with the Svelte stores.\n    *\n    * @type {import('./internal/state-reactive/SvelteReactive').SvelteReactiveStores}\n    */\n   #stores;\n\n   /**\n    * @param {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplicationOptions} options - The options for the application.\n    *\n    * @inheritDoc\n    */\n   constructor(options = {})\n   {\n      super(options);\n\n      /** @type {ApplicationState<SvelteApplication>} */\n      this.#applicationState = new ApplicationState(this);\n\n      // Initialize TJSPosition with the position object set by Application.\n      this.#position = new TJSPosition(this, {\n         ...this.position,\n         ...this.options,\n         initial: this.options.positionInitial,\n         ortho: this.options.positionOrtho,\n         validator: this.options.positionValidator\n      });\n\n      // Remove old position field.\n      delete this.position;\n\n      /**\n       * Define accessors to retrieve TJSPosition by `this.position`.\n       *\n       * @member {TJSPosition} position - Adds accessors to SvelteApplication to get / set the position data.\n       *\n       * @memberof SvelteApplication#\n       */\n      Object.defineProperty(this, 'position', {\n         get: () => this.#position,\n         set: (position) => { if (isObject(position)) { this.#position.set(position); } }\n      });\n\n      this.#reactive = new SvelteReactive(this);\n\n      this.#stores = this.#reactive.initialize();\n   }\n\n   /**\n    * Specifies the default options that SvelteApplication supports.\n    *\n    * @returns {import('@typhonjs-fvtt/runtime/svelte/application').SvelteApplicationOptions} options - Application options.\n    * @see https://foundryvtt.com/api/interfaces/client.ApplicationOptions.html\n    *\n    * @internal\n    */\n   static get defaultOptions()\n   {\n      return deepMerge(super.defaultOptions, {\n         defaultCloseAnimation: true,     // If false the default slide close animation is not run.\n         draggable: true,                 // If true then application shells are draggable.\n         focusAuto: true,                 // When true auto-management of app focus is enabled.\n         focusKeep: false,                // When `focusAuto` and `focusKeep` is true; keeps internal focus.\n         focusSource: void 0,             // Stores any A11yFocusSource data that is applied when app is closed.\n         focusTrap: true,                 // When true focus trapping / wrapping is enabled keeping focus inside app.\n         headerButtonNoClose: false,      // If true then the close header button is removed.\n         headerButtonNoLabel: false,      // If true then header button labels are removed for application shells.\n         headerIcon: void 0,              // Sets a header icon given an image URL.\n         headerNoTitleMinimized: false,   // If true then header title is hidden when application is minimized.\n         minHeight: MIN_WINDOW_HEIGHT,    // Assigned to position. Number specifying minimum window height.\n         minWidth: MIN_WINDOW_WIDTH,      // Assigned to position. Number specifying minimum window width.\n         positionable: true,              // If false then `position.set` does not take effect.\n         positionInitial: TJSPosition.Initial.browserCentered,      // A helper for initial position placement.\n         positionOrtho: true,             // When true TJSPosition is optimized for orthographic use.\n         positionValidator: TJSPosition.Validators.transformWindow, // A function providing the default validator.\n         sessionStorage: void 0,          // An instance of TJSWebStorage (session) to share across SvelteApplications.\n         svelte: void 0,                  // A Svelte configuration object.\n         transformOrigin: 'top left'      // By default, 'top / left' respects rotation when minimizing.\n      });\n   }\n\n   /**\n    * Returns the content element if an application shell is mounted.\n    *\n    * @returns {HTMLElement} Content element.\n    */\n   get elementContent() { return this.#elementContent; }\n\n   /**\n    * Returns the target element or main element if no target defined.\n    *\n    * @returns {HTMLElement} Target element.\n    */\n   get elementTarget() { return this.#elementTarget; }\n\n   /**\n    * Returns the reactive accessors & Svelte stores for SvelteApplication.\n    *\n    * @returns {import('./internal/state-reactive/types').SvelteReactive} The reactive accessors & Svelte stores.\n    */\n   get reactive() { return this.#reactive; }\n\n   /**\n    * Returns the application state manager.\n    *\n    * @returns {import('./internal/state-app/types').ApplicationState<SvelteApplication>} The application state manager.\n    */\n   get state() { return this.#applicationState; }\n\n   /**\n    * Returns the Svelte helper class w/ various methods to access mounted Svelte components.\n    *\n    * @returns {import('./internal/state-svelte/types').GetSvelteData} GetSvelteData\n    */\n   get svelte() { return this.#getSvelteData; }\n\n   /**\n    * In this case of when a template is defined in app options `html` references the inner HTML / template. However,\n    * to activate classic v1 tabs for a Svelte component the element target is passed as an array simulating JQuery as\n    * the element is retrieved immediately and the core listeners use standard DOM queries.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   _activateCoreListeners(html)\n   {\n      super._activateCoreListeners(typeof this.options.template === 'string' ? html :\n       [this.popOut ? this.#elementTarget?.firstChild : this.#elementTarget]);\n   }\n\n   /**\n    * Provide an override to set this application as the active window regardless of z-index. Changes behaviour from\n    * Foundry core. This is important / used for instance in dialog key handling for left / right button selection.\n    *\n    * @param {object} [opts] - Optional parameters.\n    *\n    * @param {boolean} [opts.force=false] - Force bring to top; will increment z-index by popOut order.\n    *\n    * @ignore\n    * @internal\n    */\n   bringToTop({ force = false } = {})\n   {\n      if (force || this.popOut) { super.bringToTop(); }\n\n      // If the activeElement is not `document.body` and not contained in this app via elementTarget then blur the\n      // current active element and make `document.body`focused. This allows <esc> key to close all open apps / windows.\n      if (document.activeElement !== document.body && !this.elementTarget.contains(document.activeElement))\n      {\n         // Blur current active element.\n         if (document.activeElement instanceof HTMLElement) { document.activeElement.blur(); }\n\n         // Make document body focused.\n         document.body.focus();\n      }\n\n      globalThis.ui.activeWindow = this;\n   }\n\n   /**\n    * Note: This method is fully overridden and duplicated as Svelte components need to be destroyed manually and the\n    * best visual result is to destroy them after the default slide up animation occurs, but before the element\n    * is removed from the DOM.\n    *\n    * If you destroy the Svelte components before the slide up animation the Svelte elements are removed immediately\n    * from the DOM. The purpose of overriding ensures the slide up animation is always completed before\n    * the Svelte components are destroyed and then the element is removed from the DOM.\n    *\n    * Close the application and un-register references to it within UI mappings.\n    * This function returns a Promise which resolves once the window closing animation concludes\n    *\n    * @param {object}   [options] - Optional parameters.\n    *\n    * @param {boolean}  [options.force] - Force close regardless of render state.\n    *\n    * @returns {Promise<void>}    A Promise which resolves once the application is closed.\n    *\n    * @ignore\n    * @internal\n    */\n   async close(options = {})\n   {\n      const states = Application.RENDER_STATES;\n      if (!options.force && ![states.RENDERED, states.ERROR].includes(this._state)) { return; }\n\n      // Unsubscribe from any local stores.\n      this.#stores.unsubscribe();\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._state = states.CLOSING;\n\n      /**\n       * Get the element.\n       *\n       * @type {HTMLElement}\n       */\n      const el = this.#elementTarget;\n      if (!el) { return this._state = states.CLOSED; }\n\n      // Make any window content overflow hidden to avoid any scrollbars appearing in default or Svelte outro\n      // transitions.\n      const content = el.querySelector('.window-content');\n      if (content)\n      {\n         content.style.overflow = 'hidden';\n\n         // Set all children of content to overflow hidden as if there is going to be additional scrolling elements\n         // they are likely one level deep.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = 'hidden';\n         }\n      }\n\n      // Dispatch Hooks for closing the base and subclass applications\n      for (const cls of this.constructor._getInheritanceChain())\n      {\n         /**\n          * A hook event that fires whenever this Application is closed.\n          *\n          * Note: JQuery wrapping as Foundry event arguments uses JQuery.\n          */\n         Hooks.call(`close${cls.name}`, this, $(el));\n      }\n\n      // If options `defaultCloseAnimation` is false then do not execute the standard slide up animation.\n      // This allows Svelte components to provide any out transition. Application shells will automatically set\n      // `defaultCloseAnimation` based on any out transition set or unset.\n      const animate = typeof this.options.defaultCloseAnimation === 'boolean' ? this.options.defaultCloseAnimation :\n       true;\n\n      if (animate)\n      {\n         // Set min height for full slide.\n         el.style.minHeight = '0';\n\n         const { paddingBottom, paddingTop } = globalThis.getComputedStyle(el);\n\n         // Slide-up application.\n         await el.animate([\n            { maxHeight: `${el.clientHeight}px`, paddingTop, paddingBottom },\n            { maxHeight: 0, paddingTop: 0, paddingBottom: 0 }\n         ], { duration: 250, easing: 'ease-in', fill: 'forwards' }).finished;\n      }\n\n      // Stores the Promises returned from running outro transitions and destroying each Svelte component.\n      const svelteDestroyPromises = [];\n\n      // Manually invoke the destroy callbacks for all Svelte components.\n      for (const entry of this.#svelteData)\n      {\n         // Use `outroAndDestroy` to run outro transitions before destroying.\n         svelteDestroyPromises.push(outroAndDestroy(entry.component));\n\n         // If any proxy eventbus has been added then remove all event registrations from the component.\n         const eventbus = entry.config.eventbus;\n         if (isObject(eventbus) && typeof eventbus.off === 'function')\n         {\n            eventbus.off();\n            entry.config.eventbus = void 0;\n         }\n      }\n\n      // Await all Svelte components to destroy.\n      await Promise.all(svelteDestroyPromises);\n\n      // Remove from all visible apps tracked.\n      TJSAppIndex.delete(this);\n\n      // Reset SvelteData like this to maintain reference to GetSvelteData / `this.svelte`.\n      this.#svelteData.length = 0;\n\n      // Remove element from the DOM. Most SvelteComponents have already removed it.\n      el.remove();\n\n      // Silently restore any width / height state before minimized as applicable.\n      this.position.state.restore({\n         name: '#beforeMinimized',\n         properties: ['width', 'height'],\n         silent: true,\n         remove: true\n      });\n\n      // Clean up data\n      this.#applicationShellHolder[0] = null;\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._element = null;\n      this.#elementContent = null;\n      this.#elementTarget = null;\n\n      delete globalThis.ui.windows[this.appId];\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._minimized = false;\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._scrollPositions = null;\n\n      /**\n       * @ignore\n       * @internal\n       */\n      this._state = states.CLOSED;\n\n      this.#onMount = false;\n\n      // Update the minimized UI store state.\n      this.#stores.uiStateUpdate((storeOptions) => deepMerge(storeOptions, { minimized: this._minimized }));\n\n      // Apply any stored focus options and then remove them from options.\n      A11yHelper.applyFocusSource(this.options.focusSource);\n\n      delete this.options.focusSource;\n   }\n\n   /**\n    * Inject the Svelte components defined in `this.options.svelte`. The Svelte component can attach to the existing\n    * pop-out of Application or provide no template and render into a document fragment which is then attached to the\n    * DOM.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   _injectHTML(html)\n   {\n      if (this.popOut && html.length === 0 && isIterable(this.options.svelte))\n      {\n         throw new Error(\n          'SvelteApplication - _injectHTML - A popout app with no template can only support one Svelte component.');\n      }\n\n      // Make sure the store is updated with the latest header buttons. Also allows filtering buttons before display.\n      this.reactive.updateHeaderButtons();\n\n      // Create a function to generate a callback for Svelte components to invoke to update the tracked elements for\n      // application shells in the rare cases that the main element root changes. The update is only trigged on\n      // successive changes of `elementRoot`. Returns a boolean to indicate the element roots are updated.\n      const elementRootUpdate = () =>\n      {\n         let cntr = 0;\n\n         return (elementRoot) =>\n         {\n            if (elementRoot !== null && elementRoot !== void 0 && cntr++ > 0)\n            {\n               this.#updateApplicationShell();\n               return true;\n            }\n\n            return false;\n         };\n      };\n\n      if (isIterable(this.options.svelte))\n      {\n         for (const svelteConfig of this.options.svelte)\n         {\n            const svelteData = loadSvelteConfig({\n               app: this,\n               template: html[0],\n               config: svelteConfig,\n               elementRootUpdate\n            });\n\n            if (isApplicationShell(svelteData.component))\n            {\n               if (this.svelte.applicationShell !== null)\n               {\n                  throw new Error(\n                   `SvelteApplication - _injectHTML - An application shell is already mounted; offending config:\n                    ${JSON.stringify(svelteConfig)}`);\n               }\n\n               this.#applicationShellHolder[0] = svelteData.component;\n\n               // If Vite / HMR / svelte_hmr is enabled then add a hook to receive callbacks when the ProxyComponent\n               // refreshes. Update the element root accordingly and force an update to TJSPosition.\n               // See this issue for info about `on_hmr`:\n               // https://github.com/sveltejs/svelte-hmr/issues/57\n               if (isHMRProxy(svelteData.component) && Array.isArray(svelteData.component?.$$?.on_hmr))\n               {\n                  svelteData.component.$$.on_hmr.push(() => () => this.#updateApplicationShell());\n               }\n            }\n\n            this.#svelteData.push(svelteData);\n         }\n      }\n      else if (isObject(this.options.svelte))\n      {\n         const svelteData = loadSvelteConfig({\n            app: this,\n            template: html[0],\n            config: this.options.svelte,\n            elementRootUpdate\n         });\n\n         if (isApplicationShell(svelteData.component))\n         {\n            // A sanity check as shouldn't hit this case as only one component is being mounted.\n            if (this.svelte.applicationShell !== null)\n            {\n               throw new Error(\n                `SvelteApplication - _injectHTML - An application shell is already mounted; offending config:\n                 ${JSON.stringify(this.options.svelte)}`);\n            }\n\n            this.#applicationShellHolder[0] = svelteData.component;\n\n            // If Vite / HMR / svelte_hmr is enabled then add a hook to receive callbacks when the ProxyComponent\n            // refreshes. Update the element root accordingly and force an update to TJSPosition.\n            // See this issue for info about `on_hmr`:\n            // https://github.com/sveltejs/svelte-hmr/issues/57\n            if (isHMRProxy(svelteData.component) && Array.isArray(svelteData.component?.$$?.on_hmr))\n            {\n               svelteData.component.$$.on_hmr.push(() => () => this.#updateApplicationShell());\n            }\n         }\n\n         this.#svelteData.push(svelteData);\n      }\n\n      // Detect if this is a synthesized DocumentFragment.\n      const isDocumentFragment = html.length && html[0] instanceof DocumentFragment;\n\n      // If any of the Svelte components mounted directly targets an HTMLElement then do not inject HTML.\n      let injectHTML = true;\n      for (const svelteData of this.#svelteData)\n      {\n         if (!svelteData.injectHTML) { injectHTML = false; break; }\n      }\n      if (injectHTML) { super._injectHTML(html); }\n\n      if (this.svelte.applicationShell !== null)\n      {\n         this._element = $(this.svelte.applicationShell.elementRoot);\n\n         // Detect if the application shell exports an `elementContent` accessor.\n         this.#elementContent = hasGetter(this.svelte.applicationShell, 'elementContent') ?\n          this.svelte.applicationShell.elementContent : null;\n\n         // Detect if the application shell exports an `elementTarget` accessor.\n         this.#elementTarget = hasGetter(this.svelte.applicationShell, 'elementTarget') ?\n          this.svelte.applicationShell.elementTarget : null;\n      }\n      else if (isDocumentFragment) // Set the element of the app to the first child element in order of Svelte components mounted.\n      {\n         for (const svelteData of this.#svelteData)\n         {\n            if (svelteData.element instanceof HTMLElement)\n            {\n               this._element = $(svelteData.element);\n               break;\n            }\n         }\n      }\n\n      // Potentially retrieve a specific target element if `selectorTarget` is defined otherwise make the target the\n      // main element.\n      if (this.#elementTarget === null)\n      {\n         this.#elementTarget = typeof this.options.selectorTarget === 'string' ?\n          this._element[0].querySelector(this.options.selectorTarget) : this._element[0];\n      }\n\n      if (this.#elementTarget === null || this.#elementTarget === void 0)\n      {\n         throw new Error(`SvelteApplication - _injectHTML: Target element '${this.options.selectorTarget}' not found.`);\n      }\n\n      // The initial zIndex may be set in application options or for popOut applications is stored by `_renderOuter`\n      // in `this.#initialZIndex`.\n      if (typeof this.options.positionable === 'boolean' && this.options.positionable)\n      {\n         this.#elementTarget.style.zIndex = typeof this.options.zIndex === 'number' ? this.options.zIndex :\n          this.#initialZIndex ?? 95;\n      }\n\n      // Subscribe to local store handling.\n      this.#stores.subscribe();\n   }\n\n   /**\n    * Provides a mechanism to update the UI options store for maximized.\n    *\n    * Note: the sanity check is duplicated from {@link Application.maximize} the store is updated _before_\n    * performing the rest of animations. This allows application shells to remove / show any resize handlers\n    * correctly. Extra constraint data is stored in a saved position state in {@link SvelteApplication.minimize}\n    * to animate the content area.\n    *\n    * @param {object}   [opts] - Optional parameters.\n    *\n    * @param {boolean}  [opts.animate=true] - When true perform default maximizing animation.\n    *\n    * @param {number}   [opts.duration=0.1] - Controls content area animation duration in seconds.\n    */\n   async maximize({ animate = true, duration = 0.1 } = {})\n   {\n      if (!this.popOut || [false, null].includes(this._minimized)) { return; }\n\n      this._minimized = null;\n\n      const durationMS = duration * 1000; // For WAAPI.\n\n      // Get content\n      const element = this.elementTarget;\n      const header = element.querySelector('.window-header');\n      const content = element.querySelector('.window-content');\n\n      // Get the complete position before minimized. Used to reset min width & height to initial values later.\n      const positionBefore = this.position.state.get({ name: '#beforeMinimized' });\n\n      // First animate / restore width / async.\n      if (animate)\n      {\n         await this.position.state.restore({\n            name: '#beforeMinimized',\n            async: true,\n            animateTo: true,\n            properties: ['width'],\n            duration: 0.1\n         });\n      }\n\n      element.classList.remove('minimized');\n\n      // Reset display none on all children of header.\n      for (let cntr = header.children.length; --cntr >= 0;) { header.children[cntr].style.display = null; }\n\n      content.style.display = null;\n\n      let constraints;\n\n      if (animate)\n      {\n         // Next animate / restore height synchronously and remove key. Retrieve constraints data for slide up animation\n         // below.\n         ({ constraints } = this.position.state.restore({\n            name: '#beforeMinimized',\n            animateTo: true,\n            properties: ['height'],\n            remove: true,\n            duration\n         }));\n      }\n      else\n      {\n         ({ constraints } = this.position.state.remove({ name: '#beforeMinimized' }));\n      }\n\n      // Slide down content with stored constraints.\n      await content.animate([\n         { maxHeight: 0, paddingTop: 0, paddingBottom: 0, offset: 0 },\n         { ...constraints, offset: 1 },\n         { maxHeight: '100%', offset: 1 },\n      ], { duration: durationMS, fill: 'forwards' }).finished; // WAAPI in ms.\n\n      // Restore previous min width & height from saved data, app options, or default Foundry values.\n      this.position.set({\n         minHeight: positionBefore.minHeight ?? this.options?.minHeight ?? MIN_WINDOW_HEIGHT,\n         minWidth: positionBefore.minWidth ?? this.options?.minWidth ?? MIN_WINDOW_WIDTH,\n      });\n\n      // Remove inline styles that override any styles assigned to the app.\n      element.style.minWidth = null;\n      element.style.minHeight = null;\n\n      this._minimized = false;\n\n      // Using a 50ms timeout prevents any instantaneous display of scrollbars with the above maximize animation.\n      setTimeout(() =>\n      {\n         content.style.overflow = null;\n\n         // Reset all children of content removing overflow hidden.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = null;\n         }\n      }, 50);\n\n      this.#stores.uiStateUpdate((options) => deepMerge(options, { minimized: false }));\n   }\n\n   /**\n    * Provides a mechanism to update the UI options store for minimized.\n    *\n    * Note: the sanity check is duplicated from {@link Application.minimize} the store is updated _before_\n    * performing the rest of animations. This allows application shells to remove / show any resize handlers\n    * correctly. Extra constraint data is stored in a saved position state in {@link SvelteApplication.minimize}\n    * to animate the content area.\n    *\n    * @param {object}   [opts] - Optional parameters\n    *\n    * @param {boolean}  [opts.animate=true] - When true perform default minimizing animation.\n    *\n    * @param {number}   [opts.duration=0.1] - Controls content area animation duration in seconds.\n    */\n   async minimize({ animate = true, duration = 0.1 } = {})\n   {\n      if (!this.rendered || !this.popOut || [true, null].includes(this._minimized)) { return; }\n\n      this.#stores.uiStateUpdate((options) => deepMerge(options, { minimized: true }));\n\n      this._minimized = null;\n\n      const durationMS = duration * 1000; // For WAAPI.\n\n      const element = this.elementTarget;\n\n      // Get content\n      const header = element.querySelector('.window-header');\n      const content = element.querySelector('.window-content');\n\n      // Save current max / min height & width.\n      const beforeMinWidth = this.position.minWidth;\n      const beforeMinHeight = this.position.minHeight;\n\n      // Set minimized min width & height for header bar.\n      this.position.set({ minWidth: 100, minHeight: 30 });\n\n      // Also set inline styles to override any styles scoped to the app.\n      element.style.minWidth = '100px';\n      element.style.minHeight = '30px';\n\n      if (content)\n      {\n         content.style.overflow = 'hidden';\n\n         // Set all children of content to overflow hidden as if there is going to be additional scrolling elements\n         // they are likely one level deep.\n         for (let cntr = content.children.length; --cntr >= 0;)\n         {\n            content.children[cntr].style.overflow = 'hidden';\n         }\n      }\n\n      const { paddingBottom, paddingTop } = globalThis.getComputedStyle(content);\n\n      // Extra data that is saved with the current position. Used during `maximize`.\n      const constraints = {\n         maxHeight: `${content.clientHeight}px`,\n         paddingTop,\n         paddingBottom\n      };\n\n      // Slide-up content\n      if (animate)\n      {\n         const animation = content.animate([\n            constraints,\n            { maxHeight: 0, paddingTop: 0, paddingBottom: 0 }\n         ], { duration: durationMS, fill: 'forwards' }); // WAAPI in ms.\n\n         // Set display style to none when animation finishes.\n         animation.finished.then(() => content.style.display = 'none');\n      }\n      else\n      {\n         setTimeout(() => content.style.display = 'none', durationMS);\n      }\n\n      // Save current position state and add the constraint data to use in `maximize`.\n      const saved = this.position.state.save({ name: '#beforeMinimized', constraints });\n\n      // Set the initial before min width & height.\n      saved.minWidth = beforeMinWidth;\n      saved.minHeight = beforeMinHeight;\n\n      const headerOffsetHeight = header.offsetHeight;\n\n      // minHeight needs to be adjusted to header height.\n      this.position.minHeight = headerOffsetHeight;\n\n      if (animate)\n      {\n         // First await animation of height upward.\n         await this.position.animate.to({ height: headerOffsetHeight }, { duration }).finished;\n      }\n\n      // Set all header buttons besides close and the window title to display none.\n      for (let cntr = header.children.length; --cntr >= 0;)\n      {\n         const className = header.children[cntr].className;\n\n         if (className.includes('window-title') || className.includes('close')) { continue; }\n\n         // v10+ of Foundry core styles automatically hides anything besides the window title and close button, so\n         // explicitly set display to block.\n         if (className.includes('keep-minimized'))\n         {\n            header.children[cntr].style.display = 'block';\n            continue;\n         }\n\n         header.children[cntr].style.display = 'none';\n      }\n\n      if (animate)\n      {\n         // Await animation of width to the left / minimum width.\n         await this.position.animate.to({ width: MIN_WINDOW_WIDTH }, { duration: 0.1 }).finished;\n      }\n\n      element.classList.add('minimized');\n\n      this._minimized = true;\n   }\n\n   /**\n    * Provides a callback after all Svelte components are initialized.\n    *\n    * @param {import('./internal/state-svelte/types').MountedAppShell} [mountedAppShell] - The mounted app shell\n    *        elements.\n    */\n   onSvelteMount(mountedAppShell) {} // eslint-disable-line no-unused-vars\n\n   /**\n    * Provides a callback after the main application shell is remounted. This may occur during HMR / hot module\n    * replacement or directly invoked from the `elementRootUpdate` callback passed to the application shell component\n    * context.\n    *\n    * @param {import('./internal/state-svelte/types').MountedAppShell} [mountedAppShell] - The mounted app shell\n    *        elements.\n    */\n   onSvelteRemount(mountedAppShell) {} // eslint-disable-line no-unused-vars\n\n   /**\n    * Override replacing HTML as Svelte components control the rendering process. Only potentially change the outer\n    * application frame / title for pop-out applications.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   _replaceHTML(element, html)  // eslint-disable-line no-unused-vars\n   {\n      if (!element.length) { return; }\n\n      this.reactive.updateHeaderButtons();\n   }\n\n   /**\n    * Provides an override verifying that a new Application being rendered for the first time doesn't have a\n    * corresponding DOM element already loaded. This is a check that only occurs when `this._state` is\n    * `Application.RENDER_STATES.NONE`. It is useful in particular when SvelteApplication has a static ID\n    * explicitly set in `this.options.id` and long intro / outro transitions are assigned. If a new application\n    * sharing this static ID attempts to open / render for the first time while an existing DOM element sharing\n    * this static ID exists then the initial render is cancelled below rather than crashing later in the render\n    * cycle {@link TJSPosition.set}.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   async _render(force = false, options = {})\n   {\n      // Store any focusSource instance.\n      if (isObject(options?.focusSource)) { this.options.focusSource = options.focusSource; }\n\n      if (this._state === Application.RENDER_STATES.NONE &&\n       document.querySelector(`#${this.id}`) instanceof HTMLElement)\n      {\n         console.warn(`SvelteApplication - _render: A DOM element already exists for CSS ID '${this.id\n         }'. Cancelling initial render for new application with appId '${this.appId}'.`);\n\n         return;\n      }\n\n      await super._render(force, options);\n\n      // Handle the same render exclusion tests that reject a render in Application.\n\n      // Do not render under certain conditions.\n      if ([Application.RENDER_STATES.CLOSING, Application.RENDER_STATES.RENDERING].includes(this._state)) { return; }\n\n      // Applications which are not currently rendered must be forced.\n      if (!force && (this._state <= Application.RENDER_STATES.NONE)) { return; }\n\n      // It is necessary to directly invoke `position.set` as TJSPosition uses accessors and is not a bare object, so\n      // the merging that occurs is `Application._render` does not take effect.\n      if (!this._minimized) { this.#position.set(options); }\n\n      if (!this.#onMount)\n      {\n         // Add to visible apps tracked.\n         TJSAppIndex.add(this);\n\n         this.onSvelteMount({ element: this._element[0], elementContent: this.#elementContent, elementTarget:\n          this.#elementTarget });\n\n         this.#onMount = true;\n      }\n   }\n\n   /**\n    * Render the inner application content. Only render a template if one is defined otherwise provide an empty\n    * JQuery element per the core Foundry API.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   async _renderInner(data)\n   {\n      const html = typeof this.template === 'string' ? await renderTemplate(this.template, data) :\n       document.createDocumentFragment();\n\n      return $(html);\n   }\n\n   /**\n    * Stores the initial z-index set in `_renderOuter` which is used in `_injectHTML` to set the target element\n    * z-index after the Svelte component is mounted.\n    *\n    * @protected\n    * @ignore\n    * @internal\n    */\n   async _renderOuter()\n   {\n      const html = await super._renderOuter();\n      this.#initialZIndex = html[0].style.zIndex;\n      return html;\n   }\n\n   /**\n    * All calculation and updates of position are implemented in {@link TJSPosition.set}. This allows position to be fully\n    * reactive and in control of updating inline styles for the application.\n    *\n    * This method remains for backward compatibility with Foundry. If you have a custom override quite likely you need\n    * to update to using the {@link TJSPosition.validators} functionality.\n    *\n    * @param {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSPositionDataExtended}   [position] - TJSPosition data.\n    *\n    * @returns {TJSPosition} The updated position object for the application containing the new values.\n    * @ignore\n    */\n   setPosition(position)\n   {\n      return this.position.set(position);\n   }\n\n   /**\n    * This method is invoked by the `elementRootUpdate` callback that is added to the external context passed to\n    * Svelte components. When invoked it updates the local element roots tracked by SvelteApplication.\n    *\n    * This method may also be invoked by HMR / hot module replacement via `svelte-hmr`.\n    */\n   #updateApplicationShell()\n   {\n      const applicationShell = this.svelte.applicationShell;\n\n      if (applicationShell !== null)\n      {\n         this._element = $(applicationShell.elementRoot);\n\n         // Detect if the application shell exports an `elementContent` accessor.\n         this.#elementContent = hasGetter(applicationShell, 'elementContent') ?\n          applicationShell.elementContent : null;\n\n         // Detect if the application shell exports an `elementTarget` accessor.\n         this.#elementTarget = hasGetter(applicationShell, 'elementTarget') ?\n          applicationShell.elementTarget : null;\n\n         if (this.#elementTarget === null)\n         {\n            this.#elementTarget = typeof this.options.selectorTarget === 'string' ?\n             this._element[0].querySelector(this.options.selectorTarget) : this._element[0];\n         }\n\n         // The initial zIndex may be set in application options or for popOut applications is stored by `_renderOuter`\n         // in `this.#initialZIndex`.\n         if (typeof this.options.positionable === 'boolean' && this.options.positionable)\n         {\n            this.#elementTarget.style.zIndex = typeof this.options.zIndex === 'number' ? this.options.zIndex :\n             this.#initialZIndex ?? 95;\n\n            super.bringToTop();\n\n            // Ensure that new root element has inline position styles set.\n            this.position.set(this.position.get());\n         }\n\n         super._activateCoreListeners([this.popOut ? this.#elementTarget?.firstChild : this.#elementTarget]);\n\n         this.onSvelteRemount({ element: this._element[0], elementContent: this.#elementContent, elementTarget:\n          this.#elementTarget });\n      }\n   }\n}\n","import { TJSStyleManager } from '@typhonjs-fvtt/runtime/util/browser';\n\nexport const cssVariables = new TJSStyleManager({ docKey: '#__trl-root-styles', version: 1 });\n","import { PUBLIC_VERSION } from '../../../shared/version.js';\n\nif (typeof window !== 'undefined')\n\t// @ts-ignore\n\t(window.__svelte || (window.__svelte = { v: new Set() })).v.add(PUBLIC_VERSION);\n","import { Timing } from '@typhonjs-fvtt/runtime/util';\nimport { isUpdatableStore, isWritableStore } from '@typhonjs-fvtt/runtime/util/store';\nimport { StyleParse } from '@typhonjs-fvtt/runtime/util/browser';\nimport { isObject } from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * Provides an action to always blur the element when any pointer up event occurs on the element.\n *\n * @param {HTMLElement}   node - The node to handle always blur on pointer up.\n *\n * @returns {import('svelte/action').ActionReturn} Lifecycle functions.\n */\nfunction alwaysBlur(node)\n{\n   /**\n    * Blurs node if active element.\n    */\n   function blurNode()\n   {\n      setTimeout(() => { if (document.activeElement === node) { node.blur(); } }, 0);\n   }\n\n   node.addEventListener('pointerup', blurNode);\n\n   return {\n      destroy: () => node.removeEventListener('pointerup', blurNode)\n   };\n}\n\n/**\n * Provides an action to monitor the given HTMLElement node with `ResizeObserver` posting width / height changes\n * to the target in various ways depending on the shape of the target. The target can be one of the following and the\n * precedence order is listed from top to bottom:\n *\n * - has a `resizeObserved` function as attribute; offset then content width / height are passed as parameters.\n * - has a `setContentBounds` function as attribute; content width / height are passed as parameters.\n * - has a `setDimension` function as attribute; offset width / height are passed as parameters.\n * - target is an object; offset and content width / height attributes directly set on target.\n * - target is a function; the function invoked with offset then content width / height parameters.\n * - has a writable store `resizeObserved` as an attribute; updated with offset & content width / height.\n * - has an object 'stores' that has a writable store `resizeObserved` as an attribute; updated with offset &\n *   content width / height.\n *\n * Note: Svelte currently uses an archaic IFrame based workaround to monitor offset / client width & height changes.\n * A more up to date way to do this is with ResizeObserver. To track when Svelte receives ResizeObserver support\n * monitor this issue: {@link https://github.com/sveltejs/svelte/issues/4233}\n *\n * Can-I-Use: {@link https://caniuse.com/resizeobserver}\n *\n * @param {HTMLElement}          node - The node associated with the action.\n *\n * @param {ResizeObserverTarget} target - An object or function to update with observed width & height changes.\n *\n * @returns {import('svelte/action').ActionReturn<ResizeObserverTarget>} The action lifecycle methods.\n * @see {@link https://github.com/sveltejs/svelte/issues/4233}\n */\nfunction resizeObserver(node, target)\n{\n   ResizeObserverManager.add(node, target);\n\n   return {\n      /**\n       * @param {ResizeObserverTarget} newTarget - An object or function to update with observed width & height changes.\n       */\n      update: (newTarget) =>\n      {\n         ResizeObserverManager.remove(node, target);\n         target = newTarget;\n         ResizeObserverManager.add(node, target);\n      },\n\n      destroy: () =>\n      {\n         ResizeObserverManager.remove(node, target);\n      }\n   };\n}\n\n/**\n * Provides a function that when invoked with an element updates the cached styles for each subscriber of the element.\n *\n * The style attributes cached to calculate offset height / width include border & padding dimensions. You only need\n * to update the cache if you change border or padding attributes of the element.\n *\n * @param {HTMLElement} el - An HTML element.\n */\nresizeObserver.updateCache = function(el)\n{\n   if (!(el instanceof HTMLElement)) { throw new TypeError(`resizeObserverUpdate error: 'el' is not an HTMLElement.`); }\n\n   const subscribers = s_MAP.get(el);\n\n   if (Array.isArray(subscribers))\n   {\n      const computed = globalThis.getComputedStyle(el);\n\n      // Cache styles first from any inline styles then computed styles defaulting to 0 otherwise.\n      // Used to create the offset width & height values from the context box ResizeObserver provides.\n      const borderBottom = StyleParse.pixels(el.style.borderBottom) ?? StyleParse.pixels(computed.borderBottom) ?? 0;\n      const borderLeft = StyleParse.pixels(el.style.borderLeft) ?? StyleParse.pixels(computed.borderLeft) ?? 0;\n      const borderRight = StyleParse.pixels(el.style.borderRight) ?? StyleParse.pixels(computed.borderRight) ?? 0;\n      const borderTop = StyleParse.pixels(el.style.borderTop) ?? StyleParse.pixels(computed.borderTop) ?? 0;\n      const paddingBottom = StyleParse.pixels(el.style.paddingBottom) ?? StyleParse.pixels(computed.paddingBottom) ?? 0;\n      const paddingLeft = StyleParse.pixels(el.style.paddingLeft) ?? StyleParse.pixels(computed.paddingLeft) ?? 0;\n      const paddingRight = StyleParse.pixels(el.style.paddingRight) ?? StyleParse.pixels(computed.paddingRight) ?? 0;\n      const paddingTop = StyleParse.pixels(el.style.paddingTop) ?? StyleParse.pixels(computed.paddingTop) ?? 0;\n\n      const additionalWidth = borderLeft + borderRight + paddingLeft + paddingRight;\n      const additionalHeight = borderTop + borderBottom + paddingTop + paddingBottom;\n\n      for (const subscriber of subscribers)\n      {\n         subscriber.styles.additionalWidth = additionalWidth;\n         subscriber.styles.additionalHeight = additionalHeight;\n         s_UPDATE_SUBSCRIBER(subscriber, subscriber.contentWidth, subscriber.contentHeight);\n      }\n   }\n};\n\n// Below is the static ResizeObserverManager ------------------------------------------------------------------------\n\nconst s_MAP = new Map();\n\n/**\n * Provides a static / single instance of ResizeObserver that can notify listeners in different ways.\n *\n * The action, {@link resizeObserver}, utilizes ResizeObserverManager for automatic registration and removal\n * via Svelte.\n */\nclass ResizeObserverManager\n{\n   /**\n    * Add an HTMLElement and ResizeObserverTarget instance for monitoring. Create cached style attributes for the\n    * given element include border & padding dimensions for offset width / height calculations.\n    *\n    * @param {HTMLElement}    el - The element to observe.\n    *\n    * @param {ResizeObserverTarget} target - A target that contains one of several mechanisms for updating resize data.\n    */\n   static add(el, target)\n   {\n      const updateType = s_GET_UPDATE_TYPE(target);\n\n      if (updateType === 0)\n      {\n         throw new Error(`'target' does not match supported ResizeObserverManager update mechanisms.`);\n      }\n\n      const computed = globalThis.getComputedStyle(el);\n\n      // Cache styles first from any inline styles then computed styles defaulting to 0 otherwise.\n      // Used to create the offset width & height values from the context box ResizeObserver provides.\n      const borderBottom = StyleParse.pixels(el.style.borderBottom) ?? StyleParse.pixels(computed.borderBottom) ?? 0;\n      const borderLeft = StyleParse.pixels(el.style.borderLeft) ?? StyleParse.pixels(computed.borderLeft) ?? 0;\n      const borderRight = StyleParse.pixels(el.style.borderRight) ?? StyleParse.pixels(computed.borderRight) ?? 0;\n      const borderTop = StyleParse.pixels(el.style.borderTop) ?? StyleParse.pixels(computed.borderTop) ?? 0;\n      const paddingBottom = StyleParse.pixels(el.style.paddingBottom) ?? StyleParse.pixels(computed.paddingBottom) ?? 0;\n      const paddingLeft = StyleParse.pixels(el.style.paddingLeft) ?? StyleParse.pixels(computed.paddingLeft) ?? 0;\n      const paddingRight = StyleParse.pixels(el.style.paddingRight) ?? StyleParse.pixels(computed.paddingRight) ?? 0;\n      const paddingTop = StyleParse.pixels(el.style.paddingTop) ?? StyleParse.pixels(computed.paddingTop) ?? 0;\n\n      const data = {\n         updateType,\n         target,\n\n         // Stores most recent contentRect.width and contentRect.height values from ResizeObserver.\n         contentWidth: 0,\n         contentHeight: 0,\n\n         // Convenience data for total border & padding for offset width & height calculations.\n         styles: {\n            additionalWidth: borderLeft + borderRight + paddingLeft + paddingRight,\n            additionalHeight: borderTop + borderBottom + paddingTop + paddingBottom\n         }\n      };\n\n      if (s_MAP.has(el))\n      {\n         const subscribers = s_MAP.get(el);\n         subscribers.push(data);\n      }\n      else\n      {\n         s_MAP.set(el, [data]);\n      }\n\n      s_RESIZE_OBSERVER.observe(el);\n   }\n\n   /**\n    * Removes all targets from monitoring when just an element is provided otherwise removes a specific target\n    * from the monitoring map. If no more targets remain then the element is removed from monitoring.\n    *\n    * @param {HTMLElement}          el - Element to remove from monitoring.\n    *\n    * @param {ResizeObserverTarget} [target] - A specific target to remove from monitoring.\n    */\n   static remove(el, target = void 0)\n   {\n      const subscribers = s_MAP.get(el);\n      if (Array.isArray(subscribers))\n      {\n         const index = subscribers.findIndex((entry) => entry.target === target);\n         if (index >= 0)\n         {\n            // Update target subscriber with undefined values.\n            s_UPDATE_SUBSCRIBER(subscribers[index], void 0, void 0);\n\n            subscribers.splice(index, 1);\n         }\n\n         // Remove element monitoring if last target removed.\n         if (subscribers.length === 0)\n         {\n            s_MAP.delete(el);\n            s_RESIZE_OBSERVER.unobserve(el);\n         }\n      }\n   }\n}\n\n/**\n * Defines the various shape / update type of the given target.\n *\n * @type {Record<string, number>}\n */\nconst s_UPDATE_TYPES = {\n   none: 0,\n   attribute: 1,\n   function: 2,\n   resizeObserved: 3,\n   setContentBounds: 4,\n   setDimension: 5,\n   storeObject: 6,\n   storesObject: 7\n};\n\nconst s_RESIZE_OBSERVER = new ResizeObserver((entries) =>\n{\n   for (const entry of entries)\n   {\n      const subscribers = s_MAP.get(entry?.target);\n\n      if (Array.isArray(subscribers))\n      {\n         const contentWidth = entry.contentRect.width;\n         const contentHeight = entry.contentRect.height;\n\n         for (const subscriber of subscribers)\n         {\n            s_UPDATE_SUBSCRIBER(subscriber, contentWidth, contentHeight);\n         }\n      }\n   }\n});\n\n/**\n * Determines the shape of the target instance regarding valid update mechanisms to set width & height changes.\n *\n * @param {*}  target - The target instance.\n *\n * @returns {number} Update type value.\n */\nfunction s_GET_UPDATE_TYPE(target)\n{\n   if (target?.resizeObserved instanceof Function) { return s_UPDATE_TYPES.resizeObserved; }\n   if (target?.setDimension instanceof Function) { return s_UPDATE_TYPES.setDimension; }\n   if (target?.setContentBounds instanceof Function) { return s_UPDATE_TYPES.setContentBounds; }\n\n   const targetType = typeof target;\n\n   // Does the target have resizeObserved writable store?\n   if (targetType !== null && (targetType === 'object' || targetType === 'function'))\n   {\n      if (isUpdatableStore(target.resizeObserved))\n      {\n         return s_UPDATE_TYPES.storeObject;\n      }\n\n      // Now check for a child stores object which is a common TRL pattern for exposing stores.\n      const stores = target?.stores;\n      if (isObject(stores) || typeof stores === 'function')\n      {\n         if (isUpdatableStore(stores.resizeObserved))\n         {\n            return s_UPDATE_TYPES.storesObject;\n         }\n      }\n   }\n\n   if (targetType !== null && targetType === 'object') { return s_UPDATE_TYPES.attribute; }\n\n   if (targetType === 'function') { return s_UPDATE_TYPES.function; }\n\n   return s_UPDATE_TYPES.none;\n}\n\n/**\n * Updates a subscriber target with given content width & height values. Offset width & height is calculated from\n * the content values + cached styles.\n *\n * @param {object}            subscriber - Internal data about subscriber.\n *\n * @param {number|undefined}  contentWidth - ResizeObserver contentRect.width value or undefined.\n *\n * @param {number|undefined}  contentHeight - ResizeObserver contentRect.height value or undefined.\n */\nfunction s_UPDATE_SUBSCRIBER(subscriber, contentWidth, contentHeight)\n{\n   const styles = subscriber.styles;\n\n   subscriber.contentWidth = contentWidth;\n   subscriber.contentHeight = contentHeight;\n\n   const offsetWidth = Number.isFinite(contentWidth) ? contentWidth + styles.additionalWidth : void 0;\n   const offsetHeight = Number.isFinite(contentHeight) ? contentHeight + styles.additionalHeight : void 0;\n\n   const target = subscriber.target;\n\n   switch (subscriber.updateType)\n   {\n      case s_UPDATE_TYPES.attribute:\n         target.contentWidth = contentWidth;\n         target.contentHeight = contentHeight;\n         target.offsetWidth = offsetWidth;\n         target.offsetHeight = offsetHeight;\n         break;\n\n      case s_UPDATE_TYPES.function:\n         target?.(offsetWidth, offsetHeight, contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.resizeObserved:\n         target.resizeObserved?.(offsetWidth, offsetHeight, contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.setContentBounds:\n         target.setContentBounds?.(contentWidth, contentHeight);\n         break;\n\n      case s_UPDATE_TYPES.setDimension:\n         target.setDimension?.(offsetWidth, offsetHeight);\n         break;\n\n      case s_UPDATE_TYPES.storeObject:\n         target.resizeObserved.update((object) =>\n         {\n            object.contentHeight = contentHeight;\n            object.contentWidth = contentWidth;\n            object.offsetHeight = offsetHeight;\n            object.offsetWidth = offsetWidth;\n\n            return object;\n         });\n         break;\n\n      case s_UPDATE_TYPES.storesObject:\n         target.stores.resizeObserved.update((object) =>\n         {\n            object.contentHeight = contentHeight;\n            object.contentWidth = contentWidth;\n            object.offsetHeight = offsetHeight;\n            object.offsetWidth = offsetWidth;\n\n            return object;\n         });\n         break;\n   }\n}\n\n/**\n * @typedef {(\n *    offsetWidth: number,\n *    offsetHeight: number,\n *    contentWidth: number,\n *    contentHeight: number\n * ) => void } ResizeObserverFunction A function that receives offset / content height & width.\n */\n\n/**\n * @typedef {ResizeObserverObject | ResizeObserverObjectExtended | ResizeObserverFunction} ResizeObserverTarget The\n *          receiving target for observed resize data.\n */\n\n/**\n * @typedef {object} ResizeObserverObject A direct object to update observed resize updates.\n *\n * @property {number} [contentHeight] Direct attribute to store contentHeight.\n *\n * @property {number} [contentWidth] Direct attribute to store contentWidth.\n *\n * @property {number} [offsetHeight] Direct attribute to store offsetHeight.\n *\n * @property {number} [offsetWidth] Direct attribute to store offsetWidth.\n */\n\n/**\n * @typedef {object} ResizeObserverObjectExtended Provides extended attributes supported for observed resize updates.\n *\n * @property {import('svelte/store').Writable<ResizeObserverObject> | ResizeObserverFunction} [resizedObserver] Either\n *           a function or a writable store.\n *\n * @property {(contentWidth: number, contentHeight: number) => void} [setContentBounds] - A function that is invoked\n *           with content width & height changes.\n *\n * @property {(offsetWidth: number, offsetHeight: number) => void} [setDimension] - A function that is invoked with\n *           offset width & height changes.\n *\n * @property {{resizedObserver: import('svelte/store').Writable<ResizeObserverObject>}} [stores] - An object with a\n *           `stores` attribute and subsequent `resizedObserver` writable store.\n */\n\n/**\n * Provides an action to save `scrollTop` of an element with a vertical scrollbar. This action should be used on the\n * scrollable element and must include a writable store that holds the active store for the current `scrollTop` value.\n * You may switch the stores externally and this action will set the `scrollTop` based on the newly set store. This is\n * useful for instance providing a select box that controls the scrollable container.\n *\n * @param {HTMLElement} element - The target scrollable HTML element.\n *\n * @param {import('svelte/store').Writable<number>}   store - A writable store that stores the element scrollTop.\n *\n * @returns {import('svelte/action').ActionReturn<import('svelte/store').Writable<number>>} Lifecycle functions.\n */\nfunction applyScrolltop(element, store)\n{\n   if (!isWritableStore(store))\n   {\n      throw new TypeError(`applyScrolltop error: 'store' must be a writable Svelte store.`);\n   }\n\n   /**\n    * Updates element `scrollTop`.\n    *\n    * @param {number}   value -\n    */\n   function storeUpdate(value)\n   {\n      if (!Number.isFinite(value)) { return; }\n\n      // For some reason for scrollTop to take on first update from a new element setTimeout is necessary.\n      setTimeout(() => element.scrollTop = value, 0);\n   }\n\n   let unsubscribe = store.subscribe(storeUpdate);\n\n   const resizeControl = resizeObserver(element, Timing.debounce(() =>\n   {\n      if (element.isConnected) { store.set(element.scrollTop); }\n   }, 500));\n\n   /**\n    * Save target `scrollTop` to the current set store.\n    *\n    * @param {Event} event -\n    */\n   function onScroll(event)\n   {\n      store.set(event.target.scrollTop);\n   }\n\n   const debounceFn = Timing.debounce((e) => onScroll(e), 500);\n\n   element.addEventListener('scroll', debounceFn);\n\n   return {\n      /**\n       * @param {import('svelte/store').Writable<number>} newStore - A writable store that stores the element scrollTop.\n       */\n      update: (newStore) =>\n      {\n         unsubscribe();\n         store = newStore;\n\n         if (!isWritableStore(store))\n         {\n            throw new TypeError(`applyScrolltop.update error: 'store' must be a writable Svelte store.`);\n         }\n\n         unsubscribe = store.subscribe(storeUpdate);\n      },\n\n      destroy: () =>\n      {\n         element.removeEventListener('scroll', debounceFn);\n         unsubscribe();\n         resizeControl.destroy();\n      }\n   };\n}\n\n/**\n * Provides an action to apply style properties provided as an object.\n *\n * @param {HTMLElement} node - Target element\n *\n * @param {Record<string, string>}  properties - Key / value object of properties to set.\n *\n * @returns {import('svelte/action').ActionReturn<Record<string, string>>} Lifecycle functions.\n */\nfunction applyStyles(node, properties)\n{\n   /** Sets properties on node. */\n   function setProperties()\n   {\n      if (!isObject(properties)) { return; }\n\n      for (const prop of Object.keys(properties))\n      {\n         node.style.setProperty(`${prop}`, properties[prop]);\n      }\n   }\n\n   setProperties();\n\n   return {\n      /**\n       * @param {Record<string, string>}  newProperties - Key / value object of properties to set.\n       */\n      update: (newProperties) =>\n      {\n         properties = newProperties;\n         setProperties();\n      }\n   };\n}\n\n/**\n * Provides an action to blur the element when any pointer down event occurs outside the element. This can be useful\n * for input elements including select to blur / unfocus the element when any pointer down occurs outside the element.\n *\n * @param {HTMLElement}   node - The node to handle automatic blur on focus loss.\n *\n * @returns {import('svelte/action').ActionReturn} Lifecycle functions.\n */\nfunction autoBlur(node)\n{\n   /**\n    * Removes listener on blur.\n    */\n   function onBlur() { document.body.removeEventListener('pointerdown', onPointerDown); }\n\n   /**\n    * Adds listener on focus.\n    */\n   function onFocus() { document.body.addEventListener('pointerdown', onPointerDown); }\n\n   /**\n    * Blur the node if a pointer down event happens outside the node.\n    *\n    * @param {PointerEvent} event -\n    */\n   function onPointerDown(event)\n   {\n      if (event.target === node || node.contains(event.target)) { return; }\n\n      if (document.activeElement === node) { node.blur(); }\n   }\n\n   node.addEventListener('blur', onBlur);\n   node.addEventListener('focus', onFocus);\n\n   return {\n      destroy: () =>\n      {\n         document.body.removeEventListener('pointerdown', onPointerDown);\n         node.removeEventListener('blur', onBlur);\n         node.removeEventListener('focus', onFocus);\n      }\n   };\n}\n\n/**\n * Provides an action to monitor focus state of a given element and set an associated store with current focus state.\n *\n * This action is usable with any writable store.\n *\n * @param {HTMLElement} node - Target element.\n *\n * @param {import('svelte/store').Writable<boolean>}  storeFocused - Update store for focus changes.\n *\n * @returns {import('svelte/action').ActionReturn<import('svelte/store').Writable<boolean>>} Lifecycle functions.\n */\nfunction isFocused(node, storeFocused)\n{\n   let localFocused = false;\n\n   /**\n    * Updates `storeFocused` w/ current focused state.\n    *\n    * @param {boolean}  current - current focused state.\n    */\n   function setFocused(current)\n   {\n      localFocused = current;\n\n      if (isWritableStore(storeFocused)) { storeFocused.set(localFocused); }\n   }\n\n   /**\n    * Focus event listener.\n    */\n   function onFocus()\n   {\n      setFocused(true);\n   }\n\n   /**\n    * Blur event listener.\n    */\n   function onBlur()\n   {\n      setFocused(false);\n   }\n\n   /**\n    * Activate listeners.\n    */\n   function activateListeners()\n   {\n      node.addEventListener('focus', onFocus);\n      node.addEventListener('blur', onBlur);\n   }\n\n   /**\n    * Remove listeners.\n    */\n   function removeListeners()\n   {\n      node.removeEventListener('focus', onFocus);\n      node.removeEventListener('blur', onBlur);\n   }\n\n   activateListeners();\n\n   return {\n      /**\n       * @param {import('svelte/store').Writable<boolean>}  newStoreFocused - Update store for focus changes.\n       */\n      update: (newStoreFocused) =>\n      {\n         storeFocused = newStoreFocused;\n         setFocused(localFocused);\n      },\n\n      destroy: () => removeListeners()\n   };\n}\n\nexport { alwaysBlur, applyScrolltop, applyStyles, autoBlur, isFocused, resizeObserver };\n//# sourceMappingURL=index.js.map\n","import { linear } from 'svelte/easing';\nimport { lerp } from '@typhonjs-fvtt/runtime/math/interpolate';\nimport { fade, slide } from 'svelte/transition';\n\n/**\n * Provides a rotate transition. For options `easing` is applied to the rotate transition. The default easing is\n * linear.\n *\n * Note: that when reversing the transition that time goes from `1 - 0`, so if specific options are applied for\n * rotating out transition then `end` and `initial` are swapped.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      [options] - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easing=linear] - The easing function to apply to the\n *        rotate transition.\n *\n * @param {number}      [options.end=0] - End rotation in degrees.\n *\n * @param {number}      [options.initial=0] - Initial rotation in degrees.\n *\n * @returns {import('svelte/transition').TransitionConfig} Transition config.\n */\nfunction rotate(node, options)\n{\n   const easingRotate = options.easing ?? linear;\n\n   const initialDeg = options.initial ?? 0;\n   const endDeg = options.end ?? 0;\n\n   return {\n      delay: options.delay ?? 0,\n      duration: options.duration ?? 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const rotateT = easingRotate(t);\n         return `transform: rotate(${lerp(initialDeg, endDeg, rotateT)}deg)`;\n      }\n   };\n}\n\n/**\n * Combines rotate & fade transitions into a single transition. For options `easing` this is applied to both transitions,\n * however if provided `easingRotate` and / or `easingFade` will take precedence. The default easing is linear.\n *\n * Note: that when reversing the transition that time goes from `1 - 0`, so if specific options are applied for\n * rotating out transition then `end` and `initial` are swapped.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      [options] - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easing=linear] - The easing function to apply to both\n *        slide & fade transitions.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easingFade=linear] - The easing function to apply to\n *        the fade transition.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easingRotate=linear] - The easing function to apply\n *        to the rotate transition.\n *\n * @param {number}      [options.end=0] - End rotation in degrees.\n *\n * @param {number}      [options.initial=0] - Initial rotation in degrees.\n *\n * @returns {import('svelte/transition').TransitionConfig} Transition config.\n */\nfunction rotateFade(node, options)\n{\n   const easingFade = options.easingFade || options.easing || linear;\n   const easingRotate = options.easingRotate || options.easing || linear;\n\n   const fadeTransition = fade(node);\n\n   const initialDeg = options.initial ?? 0;\n   const endDeg = options.end ?? 0;\n\n   return {\n      delay: options.delay ?? 0,\n      duration: options.duration ?? 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const fadeT = easingFade(t);\n         const rotateT = easingRotate(t);\n\n         return `transform: rotate(${lerp(initialDeg, endDeg, rotateT)}deg); ${fadeTransition.css(fadeT, 1 - fadeT)}`;\n      }\n   };\n}\n\n/**\n * Combines slide & fade transitions into a single transition. For options `easing` this is applied to both transitions,\n * however if provided `easingSlide` and / or `easingFade` will take precedence. The default easing is linear.\n *\n * @param {HTMLElement} node - The transition node.\n *\n * @param {object}      [options] - Optional parameters.\n *\n * @param {number}      [options.delay] - Delay in ms before start of transition.\n *\n * @param {number}      [options.duration] - Total transition length in ms.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easing=linear] - The easing function to apply to both\n *        slide & fade transitions.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easingFade=linear] - The easing function to apply to\n *        the fade transition.\n *\n * @param {import('svelte/transition').EasingFunction}   [options.easingSlide=linear] - The easing function to apply to\n *        the slide transition.\n *\n * @returns {import('svelte/transition').TransitionConfig} Transition config.\n */\nfunction slideFade(node, options)\n{\n   const fadeEasing = options.easingFade || options.easing || linear;\n   const slideEasing = options.easingSlide || options.easing || linear;\n\n   const fadeTransition = fade(node);\n   const slideTransition = slide(node);\n\n   return {\n      delay: options.delay || 0,\n      duration: options.duration || 500,\n      easing: linear,\n      css: (t) =>\n      {\n         const fadeT = fadeEasing(t);\n         const slideT = slideEasing(t);\n         return `${slideTransition.css(slideT, 1 - slideT)}; ${fadeTransition.css(fadeT, 1 - fadeT)}`;\n      }\n   };\n}\n\n/**\n * Converts a Svelte transition to an animation. Both transitions & animations use the same CSS / styles solution and\n * resulting data so wrap the transition function with the signature of an animation.\n *\n * @param {(node: Element, ...rest: any[]) => import('svelte/transition').TransitionConfig} fn -\n *        A Svelte transition function.\n *\n * @returns {(\n *    node: Element,\n *    data: { from: DOMRect, to: DOMRect },\n *    ...rest: any\n * ) => import('svelte/animation').AnimationConfig} - Transition function converted to an animation.\n */\nfunction toAnimation(fn)\n{\n   return (node, animations, ...rest) => fn(node, ...rest);\n}\n\n/**\n * Provides static data useful for handling custom props / options to components that allow dynamic configuration of\n * transitions. This is used in all application shells and components that have configurable transitions.\n *\n * @ignore\n */\nclass TJSDefaultTransition\n{\n   static #options = {};\n\n   static #default = () => void 0;\n\n   /**\n    * @returns {() => undefined} Default empty transition.\n    */\n   static get default() { return this.#default; }\n\n   /**\n    * @returns {{}} Default empty options.\n    */\n   static get options() { return this.#options; }\n}\n\nexport { TJSDefaultTransition, rotate, rotateFade, slideFade, toAnimation };\n//# sourceMappingURL=index.js.map\n","import { writable } from 'svelte/store';\n\n/**\n * Provides the internal context to all application shells.\n */\nexport class AppShellContextInternal\n{\n   /** @type {InternalAppStores} */\n   #stores;\n\n   constructor()\n   {\n      this.#stores = {\n         elementContent: writable(void 0),\n         elementRoot: writable(void 0)\n      };\n\n      Object.freeze(this.#stores);\n      Object.seal(this);\n   }\n\n   /**\n    * @returns {InternalAppStores} The internal context stores for elementContent / elementRoot\n    */\n   get stores()\n   {\n      return this.#stores;\n   }\n}\n\n/**\n * @typedef {object} InternalAppStores\n *\n * @property {import('svelte/store').Writable<HTMLElement>} elementContent The window content element.\n *\n * @property {import('svelte/store').Writable<HTMLElement>} elementRoot The window root element.\n */\n","import { isObject } from '@typhonjs-fvtt/runtime/util/object';\n\n/**\n * A helper to create a set of radio checkbox input elements in a named set.\n * The provided keys are the possible radio values while the provided values are human readable labels.\n *\n * @param {string} name         The radio checkbox field name\n *\n * @param {object} choices      A mapping of radio checkbox values to human readable labels\n *\n * @param {object} options      Options which customize the radio boxes creation\n *\n * @param {string} options.checked    Which key is currently checked?\n *\n * @param {boolean} options.localize  Pass each label through string localization?\n *\n * @returns {string} HTML for radio boxes.\n *\n * @example <caption>The provided input data</caption>\n * let groupName = \"importantChoice\";\n * let choices = {a: \"Choice A\", b: \"Choice B\"};\n * let chosen = \"a\";\n *\n * @example <caption>The template HTML structure</caption>\n * <div class=\"form-group\">\n *   <label>Radio Group Label</label>\n *   <div class=\"form-fields\">\n *     {@html radioBoxes(groupName, choices, { checked: chosen, localize: true})}\n *   </div>\n * </div>\n */\nfunction radioBoxes(name, choices, options)\n{\n   const checked = options['checked'] || null;\n\n   const localize = options['localize'] || false;\n\n   let html = '';\n\n   for (let [key, label] of Object.entries(choices)) // eslint-disable-line prefer-const\n   {\n      if (localize) { label = globalThis.game.i18n.localize(label); }\n      const isChecked = checked === key;\n      html += `<label class=\"checkbox\"><input type=\"radio\" name=\"${name}\" value=\"${key}\" ${isChecked ? \"checked\" : \"\"}> ${label}</label>`;\n   }\n\n   return new globalThis.Handlebars.SafeString(html);\n}\n\n/**\n * Converts the `selectOptions` Handlebars helper to be Svelte compatible. This is useful when initially converting\n * over an app to Svelte and for essential usage to several dialogs that mirror the core Foundry experience. For\n * an example of usage see {@link TJSDocumentOwnership}.\n *\n * A helper to create a set of <option> elements in a <select> block based on a provided dictionary.\n * The provided keys are the option values while the provided values are human-readable labels.\n * This helper supports both single-select and multi-select input fields.\n *\n * @param {object} choices                     A mapping of radio checkbox values to human-readable labels\n *\n * @param {object} options                     Helper options\n *\n * @param {string|string[]} [options.selected] Which key or array of keys that are currently selected?\n *\n * @param {boolean} [options.localize=false]   Pass each label through string localization?\n *\n * @param {string} [options.blank]             Add a blank option as the first option with this label\n *\n * @param {string} [options.nameAttr]          Look up a property in the choice object values to use as the option value\n *\n * @param {string} [options.labelAttr]         Look up a property in the choice object values to use as the option label\n *\n * @param {boolean} [options.inverted=false]   Use the choice object value as the option value, and the key as the label\n *                                             instead of vice-versa\n *\n * @param {boolean} [options.sort=false]       When true sort by label name.\n *\n * @returns {string} The <options> HTML element(s).\n *\n * @example <caption>The provided input data</caption>\n * let choices = {a: 'Choice A', b: 'Choice B'};\n * let value = 'a';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices { selected: value, localize: true })}\n * </select>\n *\n * @example <caption>The resulting HTML</caption>\n * <select name=\"importantChoice\">\n *   <option value=\"a\" selected>Choice A</option>\n *   <option value=\"b\">Choice B</option>\n * </select>\n *\n * @example <caption>Using inverted</caption>\n * let choices = {'Choice A': 'a', 'Choice B': 'b'};\n * let value = 'a';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, inverted: true })}\n * </select>\n *\n * @example <caption>Using nameAttr and labelAttr with objects</caption>\n * let choices = {foo: {key: 'a', label: 'Choice A'}, bar: {key: 'b', label: 'Choice B'}};\n * let value = 'b';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, nameAttr: 'key', labelAttr: 'label' })}\n * </select>\n *\n * @example <caption>Using nameAttr and labelAttr with arrays</caption>\n * let choices = [{key: 'a', label: 'Choice A'}, {key: 'b', label: 'Choice B'}];\n * let value = 'b';\n *\n * @example <caption>The template HTML structure</caption>\n * <select name=\"importantChoice\">\n *   {@html selectOptions(choices, { selected: value, nameAttr: 'key', labelAttr: 'label' })}\n * </select>\n */\nfunction selectOptions(choices, options)\n{\n   const { localize = false, blank = null, sort = false, nameAttr, labelAttr, inverted } = options;\n   let { selected = null } = options;\n\n   selected = selected instanceof Array ? selected.map(String) : [String(selected)];\n\n   // Prepare the choices as an array of objects\n   const selectChoices = [];\n\n   if (choices instanceof Array)\n   {\n      for (const choice of choices)\n      {\n         const name = String(choice[nameAttr]);\n         let label = choice[labelAttr];\n         if (localize) { label = globalThis.game.i18n.localize(label); }\n         selectChoices.push({ name, label });\n      }\n   }\n   else\n   {\n      for (const choice of Object.entries(choices))\n      {\n         const [key, value] = inverted ? choice.reverse() : choice;\n         const name = String(nameAttr ? value[nameAttr] : key);\n         let label = labelAttr ? value[labelAttr] : value;\n         if (localize) { label = globalThis.game.i18n.localize(label); }\n         selectChoices.push({ name, label });\n      }\n   }\n\n   // Sort the array of options\n   if (sort) { selectChoices.sort((a, b) => a.label.localeCompare(b.label)); }\n\n   // Prepend a blank option\n   if (blank !== null)\n   {\n      const label = localize ? globalThis.game.i18n.localize(blank) : blank;\n      selectChoices.unshift({ name: '', label });\n   }\n\n   // Create the HTML\n   let html = '';\n   for (const option of selectChoices)\n   {\n      const label = globalThis.Handlebars.escapeExpression(option.label);\n      const isSelected = selected.includes(option.name);\n      html += `<option value=\"${option.name}\" ${isSelected ? \"selected\" : \"\"}>${label}</option>`;\n   }\n\n   return new globalThis.Handlebars.SafeString(html);\n}\n\n/**\n * Localize a string including variable formatting for input arguments. Provide a string ID which defines the localized\n * template. Variables can be included in the template enclosed in braces and will be substituted using those named\n * keys.\n *\n * @param {string}   stringId - The string ID to translate.\n *\n * @param {object}   [data] - Provided input data.\n *\n * @returns {string} The translated and formatted string\n */\nfunction localize(stringId, data)\n{\n   const result = !isObject(data) ? globalThis.game.i18n.localize(stringId) :\n    globalThis.game.i18n.format(stringId, data);\n\n   return result !== void 0 ? result : '';\n}\n\nexport { localize, radioBoxes, selectOptions };\n//# sourceMappingURL=index.js.map\n","<script>\n   /**\n    * Provides an app header button conforming to the Foundry {@link ApplicationHeaderButton} type. Additionally, a\n    * `title` field is supported to give a tool tip for the button. For backward compatibility `onclick` is supported,\n    * but for uniformity across TRL defining an `onPress` function is recommended. If defined it is invoked when\n    * the button is clicked or `Enter` key pressed and state is updated accordingly.\n    *\n    * TRL also supports the following extra button data:\n    * - {keyCode='Enter'}           keyCode: A string conforming to `KeyboardEvent.code` to activate `onPress` callback.\n    * - {keepMinimized=false}       keepMinimized: When true the button is not removed when app minimized.\n    * - {Function}                  onContextMenu: Invoked when right mouse button or contextmenu key is pressed.\n    * - {Function}                  onPress: Invoked when left mouse button or `keyCode` key is pressed.\n    * - {Record<string, string>}    styles: Additional inline styles to apply to button.\n    * - {string}                    title: Tooltip title.\n    */\n   import { applyStyles }   from '@typhonjs-fvtt/runtime/svelte/action/dom';\n   import { isObject }      from '@typhonjs-fvtt/runtime/util/object';\n\n   import { localize }      from '@typhonjs-fvtt/runtime/svelte/helper';\n\n   export let button = void 0;\n\n   const s_REGEX_HTML = /^\\s*<.*>$/;\n\n   $: title = isObject(button) && typeof button.title === 'string' ? localize(button.title) : '';\n\n   // Handle icon and treat bare strings as the icon class; otherwise assume the icon is fully formed HTML.\n   $: icon = isObject(button) && typeof button.icon !== 'string' ? void 0 : s_REGEX_HTML.test(button.icon) ?\n    button.icon : `<i class=\"${button.icon}\" title=\"${title}\"></i>`;\n\n   $: label = isObject(button) && typeof button.label === 'string' ? localize(button.label) : void 0;\n\n   $: keepMinimized = isObject(button) && typeof button.keepMinimized === 'boolean' ? button.keepMinimized : false;\n\n   $: keyCode = isObject(button) && typeof button.keyCode === 'string' ? button.keyCode : 'Enter';\n\n   $: styles = isObject(button) && isObject(button.styles) ? button.styles : void 0;\n\n   function onClick(event)\n   {\n      // Accept `onPress or `onclick` as the function / data to invoke.\n      const invoke = button?.onPress ?? button?.onclick;\n\n      if (typeof invoke === 'function')\n      {\n         invoke.call(button, event);\n         button = button; // This provides a reactive update if button data changes.\n      }\n   }\n\n   function onContextMenu(event)\n   {\n      // Accept `onContextMenu` as the function / data to invoke.\n      const invoke = button?.onContextMenu;\n\n      if (typeof invoke === 'function')\n      {\n         invoke.call(button, event);\n         button = button; // This provides a reactive update if button data changes.\n      }\n   }\n\n   /**\n    * Consume / stop propagation of key down when key codes match.\n    *\n    * @param {KeyboardEvent}    event -\n    */\n   function onKeydown(event)\n   {\n      if (event.code === keyCode)\n      {\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n\n   /**\n    * Handle press event if key codes match.\n    *\n    * @param {KeyboardEvent}    event -\n    */\n   function onKeyup(event)\n   {\n      if (event.code === keyCode)\n      {\n         const invoke = button.onPress ?? button.onclick;\n\n         if (typeof invoke === 'function')\n         {\n            invoke.call(button, event);\n            button = button; // This provides a reactive update if button data changes.\n         }\n\n         event.preventDefault();\n         event.stopPropagation();\n      }\n   }\n</script>\n\n<svelte:options accessors={true}/>\n\n<!-- svelte-ignore a11y-missing-attribute -->\n<a on:click|preventDefault|stopPropagation={onClick}\n   on:contextmenu|preventDefault|stopPropagation={onContextMenu}\n   on:keydown={onKeydown}\n   on:keyup={onKeyup}\n   use:applyStyles={styles}\n   class=\"header-button {button.class}\"\n   class:keep-minimized={keepMinimized}\n   aria-label={label}\n   tabindex=0\n   role=button>\n    {@html icon}{#if label}<span class:has-icon={icon !== void 0}>{label}</span>{/if}\n</a>\n\n<style>\n   a {\n      padding: var(--tjs-app-header-button-padding, 0 3px);\n   }\n\n   a :global(i) {\n      padding: var(--tjs-app-header-button-icon-padding, 0);\n   }\n\n   a:hover {\n      text-shadow: var(--tjs-app-header-button-text-shadow-hover, var(--tjs-default-text-shadow-focus-hover, inherit));\n   }\n\n   a:focus-visible {\n      box-shadow: var(--tjs-app-header-button-box-shadow-focus-visible, var(--tjs-default-box-shadow-focus-visible));\n      outline: var(--tjs-app-header-button-outline-focus-visible, var(--tjs-default-outline-focus-visible, revert));\n      transition: var(--tjs-app-header-button-transition-focus-visible, var(--tjs-default-transition-focus-visible));\n      text-shadow: var(--tjs-app-header-button-text-shadow-focus-visible, var(--tjs-default-text-shadow-focus-hover, inherit));\n   }\n\n   span {\n      padding: var(--tjs-app-header-button-label-padding, 0);\n   }\n\n   span.has-icon {\n      padding: var(--tjs-app-header-button-label-padding, 0 0 0 3px);\n   }\n</style>\n","<script>\n   import { getContext }            from 'svelte';\n   import { cubicOut }              from 'svelte/easing';\n\n   import { isSvelteComponent }     from '@typhonjs-fvtt/runtime/svelte/util';\n   import { isObject }              from '@typhonjs-fvtt/runtime/util/object';\n\n   import { localize }              from '@typhonjs-fvtt/runtime/svelte/helper';\n\n   import {\n      draggable as dragDefault }    from '@typhonjs-fvtt/runtime/svelte/store/position';\n\n   import TJSHeaderButton           from './TJSHeaderButton.svelte';\n\n   export let draggable = void 0;\n   export let draggableOptions = void 0;\n\n   const { application } = getContext('#external');\n\n   // Focus related app options stores.\n   const { focusAuto, focusKeep } = application.reactive.storeAppOptions;\n\n   const { elementRoot } = getContext('#internal').stores;\n\n   const storeTitle = application.reactive.storeAppOptions.title;\n   const storeDraggable = application.reactive.storeAppOptions.draggable;\n   const storeDragging = application.reactive.storeUIState.dragging;\n   const storeHeaderButtons = application.reactive.storeUIState.headerButtons;\n   const storeHeaderIcon = application.reactive.storeAppOptions.headerIcon;\n   const storeHeaderNoTitleMinimized = application.reactive.storeAppOptions.headerNoTitleMinimized;\n   const storeMinimizable = application.reactive.storeAppOptions.minimizable;\n   const storeMinimized = application.reactive.storeUIState.minimized;\n\n   // These classes in the window header allow dragging.\n   const s_DRAG_TARGET_CLASSLIST = Object.freeze(['tjs-app-icon', 'tjs-window-header-spacer',\n    'window-header', 'window-title']);\n\n   let dragOptions;\n\n   $: draggable = typeof draggable === 'function' ? draggable : dragDefault;\n\n   // Combines external options with defaults for TJSApplicationHeader. By default, easing is turned on w/ duration of\n   // 0.08 seconds and cubicOut, but can be overridden by any provided `draggableOptions`. `position`, `active`, and\n   // `storeDragging` are always overridden by application position / stores.\n   $: dragOptions = Object.assign({}, { ease: true, easeOptions: { duration: 0.06, ease: cubicOut } },\n    isObject(draggableOptions) ? draggableOptions : {}, { position: application.position, active:\n     $storeDraggable, storeDragging, hasTargetClassList: s_DRAG_TARGET_CLASSLIST });\n\n   let displayHeaderTitle;\n\n   $: displayHeaderTitle = $storeHeaderNoTitleMinimized && $storeMinimized ? 'none' : null;\n\n   let buttonsLeft;\n   let buttonsRight;\n\n   $:\n   {\n      buttonsLeft = [];\n      buttonsRight = [];\n\n      for (const button of $storeHeaderButtons)\n      {\n         const buttonsList = typeof button?.alignLeft === 'boolean' && button?.alignLeft ? buttonsLeft : buttonsRight;\n\n         // If the button is a Svelte component set it as the class otherwise use `TJSHeaderButton` w/ button as props.\n         buttonsList.push(isSvelteComponent(button) ? { class: button, props: {} } :\n          { class: TJSHeaderButton, props: { button } });\n      }\n   }\n\n   function minimizable(node, booleanStore)\n   {\n      const callback = (event) =>\n      {\n         // Only toggle minimize state if window title or header is the event target. Also allow toggle state if the\n         // event target has 'keep-minimized' class.\n         if (event.target.classList.contains('window-title') || event.target.classList.contains('window-header') ||\n           event.target.classList.contains('keep-minimized'))\n         {\n            application._onToggleMinimize(event);\n         }\n      }\n\n      function activateListeners() { node.addEventListener('dblclick', callback); }\n      function removeListeners() { node.removeEventListener('dblclick', callback); }\n\n      if (booleanStore) { activateListeners(); }\n\n      return {\n         update: (booleanStore) =>  // eslint-disable-line no-shadow\n         {\n            if (booleanStore) { activateListeners(); }\n            else { removeListeners(); }\n         },\n\n         destroy: () => removeListeners()\n      };\n   }\n\n   /**\n    * Explicitly focus `elementRoot` if pointer event is not consumed by header buttons / components. This allows\n    * keyboard tab navigation to select header buttons.\n    *\n    * Note: if `focusKeep` app option store is set to true `elementRoot` is only focused if the current browser wide\n    * active element is not contained inside the app element.\n    */\n   function onPointerdown(event)\n   {\n      const rootEl = $elementRoot;\n\n      if ($focusAuto && rootEl instanceof HTMLElement && rootEl?.isConnected)\n      {\n         if ($focusKeep)\n         {\n            const focusOutside = document.activeElement instanceof HTMLElement &&\n             !rootEl.contains(document.activeElement);\n\n            // Only focus the content element if the active element is outside the app; maintaining internal focused\n            // element.\n            if (focusOutside)\n            {\n               rootEl.focus();\n            }\n            else\n            {\n               event.preventDefault();\n            }\n         }\n         else\n         {\n            rootEl.focus();\n         }\n      }\n   }\n</script>\n\n{#key draggable}\n   <header class=\"window-header flexrow\"\n           use:draggable={dragOptions}\n           use:minimizable={$storeMinimizable}\n           on:pointerdown={onPointerdown}>\n      {#if typeof $storeHeaderIcon === 'string'}\n         <img class=\"tjs-app-icon keep-minimized\" src={$storeHeaderIcon} alt=icon>\n      {/if}\n      <h4 class=window-title style:display={displayHeaderTitle}>\n         {localize($storeTitle)}\n      </h4>\n      {#each buttonsLeft as button}\n         <svelte:component this={button.class} {...button.props} />\n      {/each}\n      <span class=\"tjs-window-header-spacer keep-minimized\" />\n      {#each buttonsRight as button}\n         <svelte:component this={button.class} {...button.props} />\n      {/each}\n   </header>\n{/key}\n\n<style>\n   /**\n    * Provides a zero space element that expands to the right creating the gap between window title and left aligned\n    * buttons and right aligned buttons. Note the use of a negative left margin to remove the gap between elements.\n    */\n   .tjs-window-header-spacer {\n      flex: 0;\n      margin-left: calc(-1 * var(--tjs-app-header-gap, 5px));\n      margin-right: auto;\n   }\n\n   .window-header {\n      flex: var(--tjs-app-header-flex, 0 0 30px);\n      gap: var(--tjs-app-header-gap, 5px);\n      padding: var(--tjs-app-header-padding, 0 4px);\n   }\n\n   .window-header .tjs-app-icon {\n      align-self: center;\n      border-radius: var(--tjs-app-header-icon-border-radius, 4px);\n      flex: 0 0 var(--tjs-app-header-icon-width, 24px);\n      height: var(--tjs-app-header-icon-height, 24px);\n   }\n\n   .window-title {\n      gap: var(--tjs-app-header-gap, 5px);\n      max-width: fit-content;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n   }\n</style>\n","<script>\n   import { A11yHelper }    from '@typhonjs-fvtt/runtime/util/browser';\n\n   /** @type {HTMLElement} */\n   export let elementRoot = void 0;\n\n   /** @type {boolean} */\n   export let enabled = true;\n\n   let ignoreElements, wrapEl;\n\n   $: if (wrapEl) { ignoreElements = new Set([wrapEl]); }\n\n   function onFocus()\n   {\n      // Early out if not enabled.\n      if (!enabled) { return; }\n\n      if (elementRoot instanceof HTMLElement)\n      {\n         const firstFocusEl = A11yHelper.getFirstFocusableElement(elementRoot, ignoreElements);\n\n         if (firstFocusEl instanceof HTMLElement && firstFocusEl !== wrapEl)\n         {\n            firstFocusEl.focus();\n         }\n         else\n         {\n            // No focus target found, so focus elementRoot.\n            elementRoot.focus();\n         }\n      }\n   }\n</script>\n\n<!-- svelte-ignore a11y-no-noninteractive-tabindex -->\n<div bind:this={wrapEl} class=tjs-focus-wrap tabindex=0 on:focus={onFocus} />\n\n<style>\n    div {\n        width: 0;\n        height: 0;\n        flex: 0;\n    }\n\n    div:focus {\n        outline: none;\n    }\n</style>\n","<script>\n   import { getContext }         from 'svelte';\n\n   export let isResizable = false;\n\n   const application = getContext('#external').application;\n\n   // Allows retrieval of the element root at runtime.\n   const storeElementRoot = getContext('#internal').stores.elementRoot;\n\n   const storeResizable = application.reactive.storeAppOptions.resizable;\n\n   const storeMinimized = application.reactive.storeUIState.minimized;\n   const storeResizing = application.reactive.storeUIState.resizing;\n\n   let elementResize;\n\n   $: if (elementResize)\n   {\n      // Instead of creating a derived store it is easier to use isResizable and the minimized store below.\n      elementResize.style.display = isResizable && !$storeMinimized ? 'block' : 'none';\n\n      // Add / remove `resizable` class from element root.\n      const elementRoot = $storeElementRoot;\n      if (elementRoot) { elementRoot.classList[isResizable ? 'add' : 'remove']('resizable'); }\n   }\n\n   /**\n    * Provides an action to handle resizing the application shell based on the resizable app option.\n    *\n    * @param {HTMLElement}       node - The node associated with the action.\n    *\n    * @param {object}            [opts] - Optional parameters.\n    *\n    * @param {boolean}           [opts.active=true] - A boolean value; attached to a readable store.\n    *\n    * @param {Writable<boolean>} [opts.storeResizing] - A writable store that tracks \"resizing\" state.\n    *\n    * @returns {{update: Function, destroy: Function}} The action lifecycle methods.\n    */\n   function resizable(node, { active = true, storeResizing = void 0 } = {})\n   {\n      /**\n       * Duplicate the app / Positionable starting position to track differences.\n       *\n       * @type {object}\n       */\n      let position = null;\n\n      /**\n       * Stores the initial X / Y on drag down.\n       *\n       * @type {object}\n       */\n      let initialPosition = {};\n\n      /**\n       * Stores the current resizing state and gates the move pointer as the resizing store is not\n       * set until the first pointer move.\n       *\n       * @type {boolean}\n       */\n      let resizing = false;\n\n      /**\n       * Remember event handlers associated with this action so they may be later unregistered.\n       *\n       * @type {Object}\n       */\n      const handlers = {\n         resizeDown: ['pointerdown', (e) => onResizePointerDown(e), false],\n         resizeMove: ['pointermove', (e) => onResizePointerMove(e), false],\n         resizeUp: ['pointerup', (e) => onResizePointerUp(e), false]\n      };\n\n      /**\n       * Activates listeners.\n       */\n      function activateListeners()\n      {\n         // Resize handlers\n         node.addEventListener(...handlers.resizeDown);\n\n         isResizable = true;\n\n         node.style.display = 'block';\n      }\n\n      /**\n       * Removes listeners.\n       */\n      function removeListeners()\n      {\n         if (typeof storeResizing?.set === 'function') { storeResizing.set(false); }\n\n         // Resize handlers\n         node.removeEventListener(...handlers.resizeDown);\n         node.removeEventListener(...handlers.resizeMove);\n         node.removeEventListener(...handlers.resizeUp);\n\n         node.style.display = 'none';\n\n         isResizable = false;\n      }\n\n      // On mount if resizable is true then activate listeners otherwise set element display to `none`.\n      if (active)\n      {\n         activateListeners();\n      }\n      else\n      {\n         node.style.display = 'none';\n      }\n\n      /**\n       * Handle the initial pointer down that activates resizing capture.\n       */\n      function onResizePointerDown(event)\n      {\n         event.preventDefault();\n\n         resizing = false;\n\n         // Record initial position\n         position = application.position.get();\n\n         if (position.height === 'auto') { position.height = $storeElementRoot.clientHeight; }\n         if (position.width === 'auto') { position.width = $storeElementRoot.clientWidth; }\n\n         initialPosition = { x: event.clientX, y: event.clientY };\n\n         // Add temporary handlers\n         node.addEventListener(...handlers.resizeMove);\n         node.addEventListener(...handlers.resizeUp);\n\n         node.setPointerCapture(event.pointerId);\n      }\n\n      /**\n       * Sets the width / height of the positionable application.\n       */\n      function onResizePointerMove(event)\n      {\n         event.preventDefault();\n\n         if (!resizing && typeof storeResizing?.set === 'function')\n         {\n            resizing = true;\n            storeResizing.set(true);\n         }\n\n         application.position.set({\n            width: position.width + (event.clientX - initialPosition.x),\n            height: position.height + (event.clientY - initialPosition.y)\n         });\n      }\n\n      /**\n       * Conclude the dragging behavior when the pointer is released setting the final position and\n       * removing listeners.\n       */\n      function onResizePointerUp(event)\n      {\n         resizing = false;\n         if (typeof storeResizing?.set === 'function') { storeResizing.set(false); }\n\n         event.preventDefault();\n         node.removeEventListener(...handlers.resizeMove);\n         node.removeEventListener(...handlers.resizeUp);\n\n         // TODO: Direct Foundry API access.\n         application?._onResize?.(event);\n      }\n\n      return {\n         update: ({ active }) =>  // eslint-disable-line no-shadow\n         {\n            if (active) { activateListeners(); }\n            else { removeListeners(); }\n         },\n\n         destroy: () => removeListeners()\n      };\n   }\n\n</script>\n\n<div class=\"window-resizable-handle\"\n     use:resizable={{active: $storeResizable, storeResizing}}\n     bind:this={elementResize}>\n   <i class=\"fas fa-arrows-alt-h\"></i>\n</div>\n\n<style>\n   .window-resizable-handle {\n      display: block;\n      position: absolute;\n      width: var(--tjs-app-resizable-handle-width, 20px);\n      height: var(--tjs-app-resizable-handle-height, 20px);\n      top: var(--tjs-app-resizable-handle-top, unset);\n      bottom: var(--tjs-app-resizable-handle-bottom, -1px);\n      right: var(--tjs-app-resizable-handle-right, 0);\n      left: var(--tjs-app-resizable-handle-left, unset);\n      background: var(--tjs-app-resizable-handle-background, #444);\n      border: var(--tjs-app-resizable-handle-border, 1px solid #111);\n      border-radius: var(--tjs-app-resizable-handle-border-radius, 4px 0 0 0);\n      padding: var(--tjs-app-resizable-handle-padding, 2px);\n   }\n\n   .fa-arrows-alt-h {\n      color: var(--tjs-app-resizable-handle-icon-color, #f0f0e0);\n      transform: var(--tjs-app-resizable-handle-icon-transform, rotate(45deg));\n   }\n</style>\n","<script>\n   /**\n    * Provides an application shell is a main top level slotted component that provides a reactive\n    * outer wrapper and header bar for the main content component.\n    */\n\n   import {\n      getContext,\n      onMount,\n      setContext }                     from 'svelte';\n\n   import {\n      applyStyles,\n      resizeObserver }                 from '@typhonjs-fvtt/runtime/svelte/action/dom';\n\n   import { TJSDefaultTransition }     from '@typhonjs-fvtt/runtime/svelte/transition';\n   import { A11yHelper }               from '@typhonjs-fvtt/runtime/util/browser';\n   import { isObject }                 from '@typhonjs-fvtt/runtime/util/object';\n\n   import { AppShellContextInternal }  from './AppShellContextInternal.js';\n   import TJSApplicationHeader         from './TJSApplicationHeader.svelte';\n   import TJSFocusWrap                 from './TJSFocusWrap.svelte';\n   import ResizableHandle              from './ResizableHandle.svelte';\n\n   // Bound to the content and root elements. Can be used by parent components. SvelteApplication will also\n   // use 'elementRoot' to set the element of the Application. You can also provide `elementContent` and\n   // `elementTarget`. Please see SvelteApplication lifecycle documentation.\n   export let elementContent = void 0;\n   export let elementRoot = void 0;\n\n   // Allows custom draggable implementations to be forwarded to TJSApplicationHeader.\n   export let draggable = void 0;\n   export let draggableOptions = void 0;\n\n   // The children array can be specified by a parent via prop or is read below from the external context.\n   // export let children = void 0;\n\n   // Explicit style overrides for the main app and content elements. Uses action `applyStyles`.\n   export let stylesApp = void 0;\n   export let stylesContent = void 0;\n\n   // If a parent component binds and sets `appOffsetHeight` to true then a resizeObserver action is enabled on the\n   // outer application `div`. Additionally, the SvelteApplication position resizeObserved store is updated.\n   export let appOffsetHeight = false;\n   export let appOffsetWidth = false;\n\n   // Set to `resizeObserver` if either of the above props are truthy otherwise a null operation.\n   const appResizeObserver = !!appOffsetHeight || !!appOffsetWidth ? resizeObserver : () => null;\n\n   // If a parent component binds and sets `contentOffsetHeight` or `contentOffsetWidth` to true then a\n   // resizeObserver action is enabled on the content `section`.\n   export let contentOffsetHeight = false;\n   export let contentOffsetWidth = false;\n\n   // Set to `resizeObserver` if either of the above props are truthy otherwise a null operation.\n   const contentResizeObserver = !!contentOffsetHeight || !!contentOffsetWidth ? resizeObserver : () => null;\n\n   // Provides the internal context for data / stores of the application shell.\n   const internal = new AppShellContextInternal();\n\n   // Provides options to `A11yHelper.getFocusableElements` to ignore TJSFocusWrap by CSS class.\n   const s_IGNORE_CLASSES = { ignoreClasses: ['tjs-focus-wrap'] };\n\n   // Internal context for `elementContent` / `elementRoot` stores.\n   setContext('#internal', internal);\n\n   // Only update the `elementContent` store if the new `elementContent` is not null or undefined.\n   $: if (elementContent !== void 0 && elementContent !== null)\n   {\n      getContext('#internal').stores.elementContent.set(elementContent);\n   }\n\n   // Only update the `elementRoot` store if the new `elementRoot` is not null or undefined.\n   $: if (elementRoot !== void 0 && elementRoot !== null)\n   {\n      getContext('#internal').stores.elementRoot.set(elementRoot);\n   }\n\n   // Store application reference.\n   const { application } = getContext('#external');\n\n   // Focus related app options stores.\n   const { focusAuto, focusKeep, focusTrap } = application.reactive.storeAppOptions;\n\n   const { minimized } = application.reactive.storeUIState;\n\n   let focusWrapEnabled;\n\n   // Enable TJSFocusWrap component when focus trapping app option is true and app is not minimized.\n   $: focusWrapEnabled = $focusAuto && $focusTrap && !$minimized;\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   // The following block is somewhat complex, but allows transition options to be updated reactively during\n   // runtime execution.\n\n   // Exports properties to set a transition w/ in / out options.\n   export let transition = TJSDefaultTransition.default;\n   export let inTransition = TJSDefaultTransition.default;\n   export let outTransition = TJSDefaultTransition.default;\n\n   // Exports properties to set options for any transitions.\n   export let transitionOptions = void 0;\n   export let inTransitionOptions = TJSDefaultTransition.options;\n   export let outTransitionOptions = TJSDefaultTransition.options;\n\n   // Tracks last transition state.\n   let oldTransition = TJSDefaultTransition.default;\n   let oldTransitionOptions = void 0\n\n   // Run this reactive block when the last transition state is not equal to the current state.\n   $: if (oldTransition !== transition)\n   {\n      // If transition is defined and not the default transition then set it to both in and out transition otherwise\n      // set the default transition to both in & out transitions.\n      const newTransition = typeof transition === 'function' ? transition : TJSDefaultTransition.default;\n\n      inTransition = newTransition;\n      outTransition = newTransition;\n\n      oldTransition = newTransition;\n   }\n\n   // Run this reactive block when the last transition options state is not equal to the current options state.\n   $: if (oldTransitionOptions !== transitionOptions)\n   {\n      const newOptions = transitionOptions !== TJSDefaultTransition.options && isObject(transitionOptions) ?\n       transitionOptions : TJSDefaultTransition.options;\n\n      inTransitionOptions = newOptions;\n      outTransitionOptions = newOptions;\n\n      oldTransitionOptions = newOptions;\n   }\n\n   // Handle cases if inTransition is unset; assign noop default transition function.\n   $: if (typeof inTransition !== 'function') { inTransition = TJSDefaultTransition.default; }\n\n   $:\n   {\n      // Handle cases if outTransition is unset; assign noop default transition function.\n      if (typeof outTransition !== 'function') { outTransition = TJSDefaultTransition.default; }\n\n      // Set close animation to `false` / not run when an out transition is defined.\n      const defaultCloseAnimation = application?.options?.defaultCloseAnimation;\n      if (typeof defaultCloseAnimation === 'boolean' && defaultCloseAnimation &&\n       outTransition !== TJSDefaultTransition.default)\n      {\n         application.options.defaultCloseAnimation = false;\n      }\n   }\n\n   // Handle cases if inTransitionOptions is unset; assign empty default transition options.\n   $: if (!isObject(inTransitionOptions)) { inTransitionOptions = TJSDefaultTransition.options; }\n\n   // Handle cases if outTransitionOptions is unset; assign empty default transition options.\n   $: if (!isObject(outTransitionOptions)) { outTransitionOptions = TJSDefaultTransition.options; }\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   // Focus `elementRoot` on mount to allow keyboard tab navigation of header buttons.\n   onMount(() => elementRoot.focus());\n\n   // ---------------------------------------------------------------------------------------------------------------\n\n   /**\n    * Provides a handler for the custom `close:popup` event fired by `svelte-standard` components like TJSMenu. The\n    * intention is to handle focus management of a component that is no longer connected in the DOM. If a target element\n    * that is the source of the close event is attached attempt to resolve internal focus to the application.\n    *\n    * @param {CustomEvent}  event - A custom event for `close:popup`.\n    */\n   function onClosePopup(event)\n   {\n      // Early out as automatic focus management is not enabled.\n      if (!$focusAuto) { return; }\n\n      const targetEl = event?.detail?.target;\n\n      // Early out if there is no target element.\n      if (!(targetEl instanceof HTMLElement)) { return; }\n\n      // Early out if the target element is focusable as it will gain focus naturally.\n      if (A11yHelper.isFocusable(targetEl)) { return; }\n\n      const elementRootContains = elementRoot.contains(targetEl);\n\n      // First check for if the target is elementRoot or elementContent then fallback to contains checks.\n      if (targetEl === elementRoot)\n      {\n         elementRoot.focus();\n      }\n      else if (targetEl === elementContent)\n      {\n         elementContent.focus();\n      }\n      else if (elementRootContains)\n      {\n         if (elementContent.contains(targetEl))\n         {\n            elementContent.focus();\n         }\n         else\n         {\n            elementRoot.focus();\n         }\n      }\n   }\n\n   /**\n    * Provides focus cycling inside the application capturing `<Shift-Tab>` and if `elementRoot` or `firstFocusEl` is\n    * the actively focused element then last focusable element is focused skipping `TJSFocusWrap`.\n    *\n    * Also, if a popout app all key down events will bring this application to the top such that when focus is trapped\n    * the app is top most.\n    *\n    * @param {KeyboardEvent} event - Keyboard Event.\n    */\n   function onKeydown(event)\n   {\n      // TODO: Note this handling is specifically for Foundry v11+ as the platform KeyboardManager uses\n      // `document.querySelector(':focus')` to short circuit keyboard handling internally to KeyboardManager.\n      // ApplicationShell manages containing focus programmatically and this prevents the Foundry KeyboardManager from\n      // activating. We need to check if this key event target is currently the `elementRoot` or `elementContent` and\n      // the event matches any KeyboardManager actions and if so blur current focus.\n      if ((event.target === elementRoot || event.target === elementContent) &&\n       KeyboardManager && KeyboardManager?._getMatchingActions?.(\n        KeyboardManager?.getKeyboardEventContext?.(event))?.length)\n      {\n         event.target?.blur();\n         return;\n      }\n\n      if (focusWrapEnabled && event.shiftKey && event.code === 'Tab')\n      {\n         // Collect all focusable elements from `elementRoot` and ignore TJSFocusWrap.\n         const allFocusable = A11yHelper.getFocusableElements(elementRoot, s_IGNORE_CLASSES);\n\n         // Find first and last focusable elements.\n         const firstFocusEl = allFocusable.length > 0 ? allFocusable[0] : void 0;\n         const lastFocusEl = allFocusable.length > 0 ? allFocusable[allFocusable.length - 1] : void 0;\n\n         // Only cycle focus to the last keyboard focusable app element if `elementRoot` or first focusable element\n         // is the active element.\n         if (elementRoot === document.activeElement || firstFocusEl === document.activeElement)\n         {\n            if (lastFocusEl instanceof HTMLElement && firstFocusEl !== lastFocusEl) { lastFocusEl.focus(); }\n\n            event.preventDefault();\n            event.stopPropagation();\n         }\n      }\n\n      // Make sure this application is top most when it receives keyboard events.\n      if (typeof application?.options?.popOut === 'boolean' && application.options.popOut &&\n       application !== globalThis.ui?.activeWindow)\n      {\n         application.bringToTop.call(application);\n      }\n   }\n\n   /**\n    * If the application is a popOut application then when clicked bring to top if not already the Foundry\n    * `activeWindow`.\n    */\n   function onPointerdownApp()\n   {\n      if (typeof application?.options?.popOut === 'boolean' && application.options.popOut &&\n       application !== globalThis.ui?.activeWindow)\n      {\n         application.bringToTop.call(application);\n      }\n   }\n\n   /**\n    * Focus `elementContent` if the event target is not focusable and `focusAuto` is enabled.\n    *\n    * Note: `focusAuto` is an app option store. This check is a bit tricky as `section.window-content` has a tabindex\n    * of '-1', so it is focusable manually.\n    */\n   function onPointerdownContent(event)\n   {\n      const focusable = A11yHelper.isFocusable(event.target);\n\n      if (!focusable && $focusAuto)\n      {\n         if ($focusKeep)\n         {\n            const focusOutside = document.activeElement instanceof HTMLElement &&\n             !elementRoot.contains(document.activeElement);\n\n            // Only focus the content element if the active element is outside the app; maintaining internal focused\n            // element.\n            if (focusOutside)\n            {\n               elementContent.focus();\n            }\n            else\n            {\n               event.preventDefault();\n            }\n         }\n         else\n         {\n            elementContent.focus();\n         }\n      }\n   }\n\n   /**\n    * Callback for content resizeObserver action. This is enabled when contentOffsetHeight or contentOffsetWidth is\n    * bound.\n    *\n    * @param {number}   offsetWidth - Observed offsetWidth.\n    *\n    * @param {number}   offsetHeight - Observed offsetHeight\n    */\n   function resizeObservedContent(offsetWidth, offsetHeight)\n   {\n      contentOffsetWidth = offsetWidth;\n      contentOffsetHeight = offsetHeight;\n   }\n\n   /**\n    * Callback for app resizeObserver action. This is enabled when appOffsetHeight or appOffsetWidth is\n    * bound. Additionally, the Application position resizeObserved store is updated.\n    *\n    * @param {number}   contentWidth - Observed contentWidth.\n    * @param {number}   contentHeight - Observed contentHeight\n    * @param {number}   offsetWidth - Observed offsetWidth.\n    * @param {number}   offsetHeight - Observed offsetHeight\n    */\n   function resizeObservedApp(offsetWidth, offsetHeight, contentWidth, contentHeight)\n   {\n      application.position.stores.resizeObserved.update((object) =>\n      {\n         object.contentWidth = contentWidth;\n         object.contentHeight = contentHeight;\n         object.offsetWidth = offsetWidth;\n         object.offsetHeight = offsetHeight;\n\n         return object;\n      });\n\n      appOffsetHeight = offsetHeight;\n      appOffsetWidth = offsetWidth;\n   }\n\n   /**\n    * Transitions can cause side effects. Work around this issue by using an if conditional.\n    * Due to timing issues and the onDestroy / outro transitions can cause elementRoot / elementContent to be set to\n    * null when swapped dynamically. There is a feature request to allow transition functions to be undefined:\n    *\n    * @see: https://github.com/sveltejs/svelte/issues/6942\n    */\n</script>\n\n<svelte:options accessors={true}/>\n\n{#if inTransition !== TJSDefaultTransition.default || outTransition !== TJSDefaultTransition.default}\n   <!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n   <div id={application.id}\n        class=\"app window-app {application.options.classes.join(' ')}\"\n        data-appid={application.appId}\n        bind:this={elementRoot}\n        in:inTransition|global={inTransitionOptions}\n        out:outTransition|global={outTransitionOptions}\n        on:close:popup|preventDefault|stopPropagation={onClosePopup}\n        on:keydown|capture={onKeydown}\n        on:pointerdown={onPointerdownApp}\n        use:applyStyles={stylesApp}\n        use:appResizeObserver={resizeObservedApp}\n        role=application\n        tabindex=-1>\n      <TJSApplicationHeader {draggable} {draggableOptions} />\n      <section class=window-content\n               bind:this={elementContent}\n               on:pointerdown={onPointerdownContent}\n               use:applyStyles={stylesContent}\n               use:contentResizeObserver={resizeObservedContent}\n               tabindex=-1>\n         <slot />\n      </section>\n      <ResizableHandle />\n      <TJSFocusWrap {elementRoot} />\n   </div>\n{:else}\n   <!-- svelte-ignore a11y-no-noninteractive-element-interactions -->\n   <div id={application.id}\n        class=\"app window-app {application.options.classes.join(' ')}\"\n        data-appid={application.appId}\n        bind:this={elementRoot}\n        on:close:popup|preventDefault|stopPropagation={onClosePopup}\n        on:keydown|capture={onKeydown}\n        on:pointerdown={onPointerdownApp}\n        use:applyStyles={stylesApp}\n        use:appResizeObserver={resizeObservedApp}\n        role=application\n        tabindex=-1>\n      <TJSApplicationHeader {draggable} {draggableOptions} />\n      <section class=window-content\n               bind:this={elementContent}\n               on:pointerdown={onPointerdownContent}\n               use:applyStyles={stylesContent}\n               use:contentResizeObserver={resizeObservedContent}\n               tabindex=-1>\n         <slot />\n      </section>\n      <ResizableHandle />\n      <TJSFocusWrap {elementRoot} enabled={focusWrapEnabled} />\n   </div>\n{/if}\n\n<style>\n   /* Note: this is different than stock Foundry and allows rounded corners from .app core styles */\n   .window-app {\n      overflow: var(--tjs-app-overflow, hidden);\n   }\n\n   .window-app:focus-visible {\n      outline: var(--tjs-app-outline-focus-visible, var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent));\n   }\n\n   .window-content:focus-visible {\n      outline: var(--tjs-app-content-outline-focus-visible, var(--tjs-default-a11y-outline-focus-visible, 2px solid transparent));\n   }\n\n   /* Override Foundry default; adjust --tjs-app-header-gap to change gap size */\n   .window-app :global(.window-header a) {\n      flex: none;\n      margin: 0;\n   }\n\n   /* Override Foundry default; See TJSHeaderButton for CSS variables */\n   .window-app :global(.window-header i[class^=fa]) {\n      margin: 0\n   }\n</style>\n","import { cssVariables } from './cssVariables.js';\n\nexport { default as TJSComponentShell }   from './TJSComponentShell.svelte';\nexport { default as TJSContainer }        from './TJSContainer.svelte';\nexport { default as TJSGlassPane }        from './TJSGlassPane.svelte';\nexport *                                  from './application/index.js';\nexport *                                  from './dialog/index.js';\n\n/**\n * Provides default CSS variables for core components.\n */\ncssVariables.setProperties({\n   // Anchor text shadow / header buttons\n   '--tjs-default-text-shadow-focus-hover': '0 0 8px var(--color-shadow-primary)',\n\n   // TJSApplicationShell app background.\n   '--tjs-app-background': `url(\"${globalThis.foundry.utils.getRoute('/ui/denim075.png')}\")`,\n}, false);\n","import { SvelteApplication } from './SvelteApplication.js';\nimport { TJSAppIndex }       from './internal/index.js';\n\nexport * from './SvelteApplication.js';\nexport * from './TJSDialog.js';\n\n// Handle `hotReload` Foundry hook when running the Vite dev server. -------------------------------------------------\n\nif (import.meta.hot)\n{\n   Hooks.on('hotReload', (data) =>\n   {\n      // Only handle JSON hot reload presumably specified in package manifest for language translation files.\n      if (data?.extension === 'json')\n      {\n         // Postpone until next clock tick to allow Foundry to update localization first.\n         setTimeout(() =>\n         {\n            for (const app of TJSAppIndex.values())\n            {\n               const appShell = app.svelte.applicationShell;\n\n               // Retrieve the original `svelte-hmr` instrumented HMR component / not the proxy.\n               const hmrComponent = appShell?.$$?.hmr_cmp;\n\n               if (appShell && typeof hmrComponent?.$replace === 'function')\n               {\n                  const svelteData = app.svelte.dataByComponent(appShell);\n                  if (svelteData)\n                  {\n                     try\n                     {\n                        // Replace with self; this will invoke `on_hmr` callback in associated SvelteApplication.\n                        hmrComponent.$replace(hmrComponent.constructor, {\n                           target: svelteData.config.target,\n                           anchor: svelteData.config.anchor,\n                           preserveLocalState: true,\n                           conservative: true\n                        });\n                     }\n                     catch (error)\n                     {\n                        const name = hmrComponent?.constructor?.name ?? 'Unknown';\n                        console.error(`TyphonJS Runtime Library error; Could not hot reload component: '${name}'`);\n                        console.error(error);\n                     }\n                  }\n               }\n            }\n         }, 0);\n      }\n\n      return true;\n   });\n}\n\n// Handle `PopOut!` module hooks to allow applications to popout to their own browser window -------------------------\n\nHooks.on('PopOut:loading', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = false; }\n});\n\nHooks.on('PopOut:popin', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = true; }\n});\n\nHooks.on('PopOut:close', (app) =>\n{\n   if (app instanceof SvelteApplication) { app.position.enabled = true; }\n});\n\n// From: SvelteApplication.js ----------------------------------------------------------------------------------------\n\n/**\n * @typedef {object} SvelteApplicationOptions Options for SvelteApplication. Note: that this extends the Foundry\n * {@link ApplicationOptions}.\n *\n * @property {boolean}  [defaultCloseAnimation=true] If false the default slide close animation is not run.\n *\n * @property {boolean}  [draggable=true] If true then application shells are draggable.\n *\n * @property {boolean}  [focusAuto=true] When true auto-management of app focus is enabled.\n *\n * @property {boolean}  [focusKeep=false] When `focusAuto` and `focusKeep` is true; keeps internal focus.\n *\n * @property {import('@typhonjs-fvtt/runtime/util/browser').A11yFocusSource}   [focusSource] - Defines A11yHelper focus source to\n *           apply when application closes.\n *\n * @property {boolean}  [focusTrap=true] When true focus trapping / wrapping is enabled keeping focus inside app.\n *\n * @property {boolean}  [headerButtonNoClose=false] If true then the close header button is removed.\n *\n * @property {boolean}  [headerButtonNoLabel=false] If true then header button labels are removed.\n *\n * @property {string}   [headerIcon] Sets a header icon given an image URL.\n *\n * @property {boolean}  [headerNoTitleMinimized=false] If true then header title is hidden when minimized.\n *\n * @property {number}   [minHeight=MIN_WINDOW_HEIGHT] Assigned to position. Number specifying minimum\n *           window height.\n *\n * @property {number}   [minWidth=MIN_WINDOW_WIDTH] Assigned to position. Number specifying minimum\n *           window width.\n *\n * @property {boolean}  [positionable=true] If false then `position.set` does not take effect.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSPositionInitialHelper}   [positionInitial] A helper for\n *           initial position placement.\n *\n * @property {boolean}  [positionOrtho=true] When true TJSPosition is optimized for orthographic use.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSPositionValidatorOptions}   [positionValidator] A validator\n *           function or data or list of validators.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/web-storage').TJSWebStorage}   [sessionStorage] An instance of\n *           TJSWebStorage (session) to share across SvelteApplications.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/util').TJSSvelteConfig}   [svelte] A Svelte configuration object defining\n *           the main component.\n *\n * @property {import('@typhonjs-fvtt/runtime/svelte/store/position').TJSTransformOrigin}   [transformOrigin='top left'] By default,\n *           'top / left' respects rotation when minimizing.\n */\n","import { debug } from \"../lib/lib.js\";\n\nclass loading_bar {\n  constructor() {\n    this.total = 0;\n    this.current = 0;\n    this.lastPct = 0;\n  }\n\n  init(context, total) {\n    this.context = context;\n    this.total = total;\n    this.current = 0;\n    this.lastPct = 0;\n    SceneNavigation.displayProgressBar({ label: this.context, pct: 1 });\n  }\n\n  incrementProgress() {\n    this.current += 1;\n    const pct = Math.round((this.current / this.total) * 100);\n    if (pct !== this.lastPct) {\n      debug(`${pct}% loaded...`);\n      SceneNavigation.displayProgressBar({ label: this.context, pct: pct });\n    }\n    this.lastPct = pct;\n  }\n}\n\nconst LoadingBar = new loading_bar();\n\nexport default LoadingBar;\n","export default class ColorMatrixFilter extends globalThis.PIXI.filters\n  .ColorMatrixFilter {\n  /**\n   * Properties & default values:\n   *     - hue [false]\n   *     - brightness [1]\n   *     - contrast [1]\n   *     - saturate [1]\n   */\n  constructor(inData) {\n    super();\n    this.isValid = true;\n    this.values = {};\n    for (let [key, value] of Object.entries(inData)) {\n      this.setValue(key, value);\n      if (!this.isValid) break;\n    }\n  }\n\n  setValue(key, value) {\n    try {\n      this.values[key] = value;\n      this[key](value, true);\n    } catch (err) {\n      ui.notifications.warn(\n        `Sequencer | ${this.constructor.name} | Could not set property ${key}`\n      );\n    }\n  }\n}\n","export default class BlurFilter extends globalThis.PIXI.filters.BlurFilter {\n  /**\n   * Properties & default values:\n   *     - strength [8]\n   *     - blur [2]\n   *     - blurX [2]\n   *     - blurY [2]\n   *     - quality [4]\n   *     - resolution [PIXI.settings.FILTER_RESOLUTION]\n   *     - kernelSize [5]\n   */\n  constructor(inData = {}) {\n    inData = foundry.utils.mergeObject(\n      {\n        strength: 1,\n        quality: 4,\n        resolution: PIXI.settings.FILTER_RESOLUTION,\n        kernelSize: 5,\n      },\n      inData\n    );\n\n    super(...Object.values(inData));\n\n    this.isValid = true;\n    for (let [key, value] of Object.entries(inData)) {\n      try {\n        this[key] = value;\n      } catch (err) {\n        ui.notifications.warn(\n          `Sequencer | ${this.constructor.name} | Could not set property ${key}`\n        );\n        this.isValid = false;\n      }\n    }\n  }\n}\n","export default class NoiseFilter extends globalThis.PIXI.filters.NoiseFilter {\n  /**\n   * Properties & default values:\n   *     - noise [0.5]\n   *     - seed [Math.random()]\n   */\n  constructor(inData = {}) {\n    super();\n\n    inData = foundry.utils.mergeObject(\n      {\n        noise: 0.5,\n        seed: Math.random(),\n      },\n      inData\n    );\n\n    this.isValid = true;\n    for (let [key, value] of Object.entries(inData)) {\n      try {\n        this[key] = value;\n      } catch (err) {\n        ui.notifications.warn(\n          `Sequencer | ${this.constructor.name} | Could not set property ${key}`\n        );\n        this.isValid = false;\n      }\n    }\n  }\n}\n","export default class GlowFilter extends globalThis.PIXI.filters.GlowFilter {\n  /**\n   * Properties & default values:\n   *     - distance [10]\n   *     - outerStrength [4]\n   *     - innerStrength [0]\n   *     - color [0xffffff]\n   *     - quality [0.1]\n   *     - knockout [false]\n   */\n  constructor(inData = {}) {\n    inData = foundry.utils.mergeObject(\n      {\n        distance: 10,\n        outerStrength: 4,\n        innerStrength: 0,\n        color: 0xffffff,\n        quality: 0.1,\n        knockout: false,\n      },\n      inData\n    );\n\n    super(inData);\n\n    this.isValid = true;\n  }\n}\n","let shader = `\nuniform sampler2D uSampler;\nvarying vec2 vTextureCoord;\nfloat alpha;\n\nvoid main() {\n    vec4 pixel = texture2D(uSampler, vTextureCoord);\n    alpha = smoothstep(0.6,1.0,pixel.a);\n    gl_FragColor = vec4(alpha, alpha, alpha, pixel.a);\n}\n`;\n\nexport default class ClipFilter extends PIXI.Filter {\n  constructor() {\n    super(null, shader);\n  }\n}\n","import ColorMatrixFilter from \"./filters/color-matrix-filter.js\";\nimport BlurFilter from \"./filters/blur-filter.js\";\nimport NoiseFilter from \"./filters/noise-filter.js\";\nimport GlowFilter from \"./filters/glow-filter.js\";\nimport ClipFilter from \"./filters/clip-filter.js\";\n\nconst filters = {\n  ColorMatrix: ColorMatrixFilter,\n  Blur: BlurFilter,\n  Noise: NoiseFilter,\n  Glow: GlowFilter,\n  Clip: ClipFilter,\n};\n\nexport default filters;\n","import * as lib from \"../lib/lib.js\";\n\nconst SequencerAnimationEngine = {\n\t_animations: [],\n\t_debug: undefined,\n\t_deltas: [],\n\n\tticker: false,\n\tdt: 0,\n\n\tisRunning: false,\n\n\taddAnimation(origin, attributes = [], timeDifference = 0) {\n\t\tif (!Array.isArray(attributes)) attributes = [attributes];\n\n\t\treturn new Promise((resolve) => {\n\t\t\tthis._animations.push({\n\t\t\t\torigin,\n\t\t\t\tattributes: attributes.map((attribute) => {\n\t\t\t\t\tattribute.targetId = lib.get_object_identifier(attribute.target) + \"-\" + attribute.propertyName;\n\t\t\t\t\tattribute.id = foundry.utils.randomID();\n\t\t\t\t\tattribute.started = false;\n\t\t\t\t\tattribute.initialized = false;\n\t\t\t\t\tattribute.finishing = false;\n\t\t\t\t\tattribute.complete = false;\n\t\t\t\t\tattribute.previousValue = null;\n\t\t\t\t\tattribute.progress = 0;\n\t\t\t\t\tattribute.value = 0;\n\t\t\t\t\tattribute.coreValue = 0;\n\t\t\t\t\tattribute.isFunkyProperty = attribute.propertyName.startsWith(\"scale.\");\n\n\t\t\t\t\tattribute.duration = attribute.duration ?? 0;\n\t\t\t\t\tattribute.durationDone = timeDifference ?? 0;\n\n\t\t\t\t\tif (attribute?.looping) {\n\t\t\t\t\t\tattribute.loopDuration = attribute.loopDuration ?? attribute.duration ?? 0;\n\t\t\t\t\t\tattribute.loopDurationDone = timeDifference % attribute.loopDuration ?? 0;\n\t\t\t\t\t\tattribute.loops = attribute.loops ?? 0;\n\t\t\t\t\t\tattribute.loopsDone = Math.floor(\n\t\t\t\t\t\t\tattribute.durationDone / attribute.duration\n\t\t\t\t\t\t);\n\t\t\t\t\t\tattribute.index = attribute.loopsDone % attribute.values.length;\n\t\t\t\t\t\tattribute.nextIndex =\n\t\t\t\t\t\t\t(attribute.loopsDone + 1) % attribute.values.length;\n\t\t\t\t\t\tif (!attribute.pingPong && attribute.nextIndex === 0) {\n\t\t\t\t\t\t\tattribute.index = 0;\n\t\t\t\t\t\t\tattribute.nextIndex = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn attribute;\n\t\t\t\t}),\n\t\t\t\tcomplete: false,\n\t\t\t\ttotalDt: timeDifference,\n\t\t\t\tresolve: resolve,\n\t\t\t});\n\n\t\t\tthis._animations.sort((a, b) => {\n\t\t\t\tconst aNumAbsolute = a.attributes.filter(attr => !attr.complete && attr.absolute).length;\n\t\t\t\tconst bNumAbsolute = b.attributes.filter(attr => !attr.complete && attr.absolute).length;\n\t\t\t\treturn bNumAbsolute - aNumAbsolute;\n\t\t\t});\n\n\t\t\tif (!this.ticker) {\n\t\t\t\tthis.start();\n\t\t\t}\n\n\t\t\tlib.debug(`Added animations to Animation Engine`);\n\t\t});\n\t},\n\n\tendAnimations(target) {\n\t\tthis._animations = this._animations.filter(\n\t\t\t(animation) => animation.origin !== target\n\t\t);\n\t},\n\n\tupdateStartValues(target, propertyName) {\n\t\tconst targetId = lib.get_object_identifier(target) + \"-\" + propertyName;\n\t\tif (targetId in this._coreValues) {\n\t\t\tthis._coreValues[targetId].value = lib.deep_get(target, propertyName);\n\t\t}\n\t},\n\n\tstart() {\n\t\tif (!this.ticker) {\n\t\t\tlib.debug(`Animation Engine Started`);\n\t\t\tthis.ticker = CanvasAnimation.ticker;\n\t\t\tthis.ticker.add(this.nextFrame.bind(this));\n\t\t}\n\t},\n\n\tnextFrame() {\n\t\tif (this._animations.length === 0) {\n\t\t\tthis._coreValues = {};\n\t\t\treturn;\n\t\t}\n\n\t\tthis._storedValues = {};\n\n\t\tthis._animations.forEach((animation) => this._animate(animation));\n\n\t\tfor (let delta of Object.values(this._storedValues)) {\n\t\t\ttry {\n\t\t\t\tlib.deep_set(delta.target, delta.propertyName, delta.value);\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t}\n\n\t\tthis._animations = this._animations.filter((animation) => !animation.complete);\n\n\t},\n\n\t_coreValues: {},\n\t_storedValues: {},\n\n\t_animate(animation) {\n\t\tanimation.totalDt += this.ticker.elapsedMS;\n\n\t\tanimation.attributes.filter((attribute) => {\n\t\t\treturn !attribute.complete && animation.totalDt >= attribute.delay;\n\t\t}).forEach((attr) => {\n\t\t\tthis._animateAttribute(attr);\n\t\t\tif(attr.finishing){\n\t\t\t\tattr.complete = true;\n\t\t\t\tif (this._coreValues[attr.targetId]) {\n\t\t\t\t\tdelete this._coreValues[attr.targetId];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tanimation.complete = animation.attributes.filter((attribute) => !attribute.complete).length === 0;\n\n\t\tif (animation.complete) {\n\t\t\tanimation.resolve();\n\t\t}\n\t},\n\n\t_animateAttribute(attribute) {\n\n\t\tif (this._coreValues[attribute.targetId] === undefined) {\n\t\t\tthis._coreValues[attribute.targetId] = {\n\t\t\t\tid: attribute.id,\n\t\t\t\tvalue: lib.deep_get(attribute.target, attribute.propertyName)\n\t\t\t};\n\t\t}\n\n\t\tif (this._storedValues[attribute.targetId] === undefined) {\n\t\t\tthis._storedValues[attribute.targetId] = {\n\t\t\t\tvalue: this._coreValues[attribute.targetId].value,\n\t\t\t\ttarget: attribute.target,\n\t\t\t\tpropertyName: attribute.propertyName,\n\t\t\t\ttargetId: attribute.targetId\n\t\t\t};\n\t\t}\n\n\t\tif (attribute?.looping && attribute?.indefinite) {\n\t\t\tthis._handleIndefiniteLoop(attribute);\n\t\t} else if (attribute?.looping) {\n\t\t\tthis._handleLoops(attribute);\n\t\t} else {\n\t\t\tthis._handleDefault(attribute);\n\t\t}\n\n\t\t// This is absolutely horrendous, but 50% of the time, it works 90% of the time.\n\t\tif (attribute.absolute) {\n\t\t\tthis._coreValues[attribute.targetId].value = attribute.value;\n\t\t\tconst delta = this._coreValues[attribute.targetId].value - this._storedValues[attribute.targetId].value;\n\t\t\tthis._storedValues[attribute.targetId].value += delta;\n\t\t} else {\n\t\t\tif (attribute.isFunkyProperty) {\n\t\t\t\tconst coreValue = this._coreValues[attribute.targetId].value;\n\t\t\t\tattribute.delta = (coreValue * attribute.value) - coreValue;\n\t\t\t\tthis._storedValues[attribute.targetId].value += attribute.delta;\n\t\t\t} else {\n\t\t\t\tthis._storedValues[attribute.targetId].value += attribute.value;\n\t\t\t}\n\t\t}\n\n\t},\n\n\t_handleBaseLoop(attribute) {\n\t\tif (!attribute.initialized) {\n\t\t\tif (attribute.values.length === 1) {\n\t\t\t\tattribute.values.unshift(this._coreValues[attribute.targetId].value);\n\t\t\t}\n\t\t\tattribute.initialized = true;\n\t\t}\n\n\t\tattribute.loopDurationDone += this.ticker.deltaMS;\n\t\tattribute.progress = attribute.loopDurationDone / attribute.loopDuration;\n\n\t\tattribute.value = lib.interpolate(\n\t\t\tattribute.values[attribute.index],\n\t\t\tattribute.values[attribute.nextIndex],\n\t\t\tattribute.progress,\n\t\t\tattribute.ease\n\t\t);\n\n\t\tif (attribute.progress >= 1.0) {\n\t\t\tattribute.loopDurationDone -= attribute.loopDuration;\n\n\t\t\tattribute.index = (attribute.index + 1) % attribute.values.length;\n\t\t\tattribute.nextIndex = (attribute.nextIndex + 1) % attribute.values.length;\n\n\t\t\tif (!attribute.pingPong && attribute.nextIndex === 0) {\n\t\t\t\tattribute.index = 0;\n\t\t\t\tattribute.nextIndex = 1;\n\t\t\t}\n\n\t\t\tattribute.loopsDone++;\n\n\t\t\tattribute.value = lib.interpolate(\n\t\t\t\tattribute.values[attribute.index],\n\t\t\t\tattribute.values[attribute.nextIndex],\n\t\t\t\tattribute.progress % 1.0,\n\t\t\t\tattribute.ease\n\t\t\t);\n\t\t}\n\t},\n\n\t_handleIndefiniteLoop(attribute) {\n\t\treturn this._handleBaseLoop(attribute);\n\t},\n\n\t_handleLoops(attribute) {\n\t\tthis._handleBaseLoop(attribute);\n\n\t\tattribute.durationDone += this.ticker.deltaMS;\n\t\tattribute.overallProgress = attribute.durationDone / attribute.duration;\n\n\t\tif (\n\t\t\tattribute.progress >= 1.0 &&\n\t\t\tattribute.loopsDone === attribute.loops * 2\n\t\t) {\n\t\t\tattribute.finishing = true;\n\t\t\tattribute.value = attribute.values[attribute.index];\n\t\t}\n\n\t\tif (attribute.overallProgress >= 1.0) {\n\t\t\tattribute.finishing = true;\n\t\t}\n\t},\n\n\t_handleDefault(attribute) {\n\t\tif (!attribute.initialized) {\n\t\t\tif (attribute.from === undefined) {\n\t\t\t\tattribute.from = this._coreValues[attribute.targetId].value;\n\t\t\t}\n\t\t\tattribute.initialized = true;\n\t\t}\n\n\t\tattribute.durationDone += this.ticker.deltaMS;\n\t\tattribute.progress = attribute.durationDone / attribute.duration;\n\n\t\tattribute.value = lib.interpolate(\n\t\t\tattribute.from,\n\t\t\tattribute.to,\n\t\t\tlib.clamp(attribute.progress, 0.0, 1.0),\n\t\t\tattribute.ease\n\t\t);\n\n\t\tif (attribute.progress >= 1.0) {\n\t\t\tattribute.value = attribute.to;\n\t\t\tattribute.finishing = true;\n\t\t}\n\t},\n};\n\nexport default SequencerAnimationEngine;\n","import { get, writable } from \"svelte/store\";\nimport CONSTANTS from \"../constants.js\";\n\nconst SequenceManager = {\n  VisibleEffects: writable({}),\n  RunningSounds: writable({}),\n  RunningSequences: writable({}),\n};\n\n/* ------------------ Effects ------------------ */\nSequenceManager.VisibleEffects.get = (id) => {\n  return get(SequenceManager.VisibleEffects)[id];\n};\n\nSequenceManager.VisibleEffects.add = (id, data) => {\n  SequenceManager.VisibleEffects.update((effects) => {\n    effects[id] = data;\n    return effects;\n  });\n};\n\nSequenceManager.VisibleEffects.delete = (id) => {\n  SequenceManager.VisibleEffects.update((effects) => {\n    delete effects[id];\n    return effects;\n  });\n};\n\nSequenceManager.VisibleEffects.values = () => {\n  return Object.values(get(SequenceManager.VisibleEffects));\n};\n\n/* ------------------ Sounds ------------------ */\nSequenceManager.RunningSounds.get = (id) => {\n  return get(SequenceManager.RunningSounds)[id];\n};\n\nSequenceManager.RunningSounds.add = (id, data) => {\n  SequenceManager.RunningSounds.update((sounds) => {\n    sounds[id] = data;\n    return sounds;\n  });\n};\n\nSequenceManager.RunningSounds.delete = (id) => {\n  SequenceManager.RunningSounds.update((sounds) => {\n    delete sounds[id];\n    return sounds;\n  });\n};\n\nSequenceManager.RunningSounds.values = () => {\n  return Object.values(get(SequenceManager.RunningSounds));\n};\n\nSequenceManager.RunningSounds.keys = () => {\n  return Object.keys(get(SequenceManager.RunningSounds));\n};\n\n/* ----------------- Sequences ------------------ */\nSequenceManager.RunningSequences.get = (id) => {\n  return get(SequenceManager.RunningSequences)[id];\n};\n\nSequenceManager.RunningSequences.add = (id, sequence) => {\n  SequenceManager.RunningSequences.update((sequences) => {\n    sequences[id] = sequence;\n    return sequences;\n  });\n};\n\nSequenceManager.RunningSequences.delete = (id) => {\n  SequenceManager.RunningSequences.update((sequences) => {\n    delete sequences[id];\n    return sequences;\n  });\n};\n\nSequenceManager.RunningSequences.clearFinishedSequences = () => {\n  SequenceManager.RunningSequences.update((sequences) => {\n    for (const sequence of Object.values(sequences)) {\n      if (\n        sequence.status === CONSTANTS.STATUS.COMPLETE ||\n        sequence.status === CONSTANTS.STATUS.ABORTED\n      ) {\n        delete sequences[sequence.id];\n      }\n    }\n    return sequences;\n  });\n};\n\nSequenceManager.RunningSequences.stopAll = () => {\n  SequenceManager.RunningSequences.update((sequences) => {\n    for (const sequence of Object.values(sequences)) {\n      sequence._abort();\n    }\n    return sequences;\n  });\n};\n\nSequenceManager.RunningSequences.values = () => {\n  return Object.values(get(SequenceManager.RunningSequences));\n};\n\nexport default SequenceManager;\n","<script>\r\n  import { localize } from '#runtime/svelte/helper';\r\n  import * as lib from \"/lib/lib.js\"\r\n\r\n  async function openSettings(){\r\n\r\n    const settings = new SettingsConfig();\r\n\r\n    await settings.render(true)\r\n\r\n    await lib.wait(75);\r\n\r\n    const focusElement = settings.element.find('select[name=\"sequencer.permissions-effect-create\"]');\r\n\r\n    settings.element.find(\"div.scrollable\").scrollTop(focusElement.offset().top)\r\n\r\n    await lib.wait(250);\r\n\r\n    focusElement.css(\"box-shadow\", \"rgba(200, 64, 67, 0.75) inset 0 0 10px\");\r\n\r\n    await lib.wait(5000);\r\n\r\n    focusElement.css(\"box-shadow\", \"none\");\r\n\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"howto-container\">\r\n\t<p>{@html localize(\"SEQUENCER.HowTo.Welcome\")}</p>\r\n\t<p>{@html localize(\"SEQUENCER.HowTo.Explanation\")}</p>\r\n\t{#if game.user.isGM}\r\n\t\t<p>{@html localize(\"SEQUENCER.HowTo.PermissionsExplanation\")}</p>\r\n\t\t<button type=\"button\" class=\"w-100 open-module-settings\" on:click={openSettings}>\r\n\t\t\t<i class=\"fas fa-plug\"></i> {@html localize(\"SEQUENCER.HowTo.OpenModuleSettings\")}\r\n\t\t</button>\r\n\t{/if}\r\n\t<p>{@html localize(\"SEQUENCER.HowTo.PlayerExplanation\")}</p>\r\n\t<p>{@html localize(\"SEQUENCER.HowTo.LayerExplanation\")}</p>\r\n\t<ol>\r\n\t\t<li>\r\n\t\t\t<strong>{@html localize(\"SEQUENCER.HowTo.Click\")}</strong><br>\r\n\t\t\t{@html localize(\"SEQUENCER.HowTo.ClickLabel\")}\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<strong>{@html localize(\"SEQUENCER.HowTo.ClickDrag\")}</strong><br>\r\n\t\t\t{@html localize(\"SEQUENCER.HowTo.ClickDragLabel\")}\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<strong>{@html localize(\"SEQUENCER.HowTo.Shift\")}</strong><br>\r\n\t\t\t{@html localize(\"SEQUENCER.HowTo.ShiftLabel\")}\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<strong>{@html localize(\"SEQUENCER.HowTo.ShiftControl\")}</strong><br>\r\n\t\t\t{@html localize(\"SEQUENCER.HowTo.ShiftControlLabel\")}\r\n\t\t</li>\r\n\t\t<li>\r\n\t\t\t<strong>{@html localize(\"SEQUENCER.HowTo.MoreToCome\")}</strong>\r\n\t\t</li>\r\n\t</ol>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .howto-container{\r\n    min-width: 320px;\r\n    max-width: 320px;\r\n    min-height: 563px;\r\n\r\n    li{\r\n      list-style: none;\r\n      margin-bottom: 0.5rem;\r\n    }\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import { localize } from '#runtime/svelte/helper';\r\n\r\n  export let activeTab;\r\n  export let tabs;\r\n  export let underscore = false;\r\n  export let separateElements = false;\r\n\r\n</script>\r\n\r\n<nav class=\"tabs\" data-group=\"primary\" style={$$props.style}>\r\n\t{#each tabs.filter(tab => !tab.hidden) as tab, index (tab.value)}\r\n\t\t{#if separateElements && index > 0}\r\n\t\t\t<div style=\"border-right: 1px solid rgba(0,0,0,0.5); margin: 0 10px;\"></div>\r\n\t\t{/if}\r\n\t\t<div on:click={() => { activeTab = tab.value}}\r\n\t\t\t\t class=\"item item-piles-flexrow item-piles-clickable-link\"\r\n\t\t\t\t class:underscore={underscore}\r\n\t\t\t\t class:active={activeTab === tab.value}\r\n\t\t\t\t data-tab=\"rest\">\r\n\t\t\t{#if tab.icon} <i class=\"icon {tab.icon}\"></i> {/if}\r\n\t\t\t{localize(tab.label)}\r\n\t\t</div>\r\n\t{/each}\r\n</nav>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .tabs {\r\n\t\tflex: 0;\r\n    border-bottom: 1px solid rgba(0, 0, 0, 0.25);\r\n    margin-bottom: 0.5rem;\r\n    padding-bottom: 0.5rem;\r\n  }\r\n\r\n  .item {\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    border-bottom: 2px solid transparent;\r\n\r\n    &.active {\r\n      text-shadow: 0 0 10px rgba(255,0,0,1);\r\n\r\n      &.underscore {\r\n        text-shadow: none;\r\n        border-bottom: 2px solid rgba(125, 0, 0, 0.5);\r\n      }\r\n    }\r\n  }\r\n\r\n  .icon {\r\n    margin-right: 0.25rem;\r\n  }\r\n\r\n</style>\r\n","import { writable, get } from \"svelte/store\";\nimport { EffectPlayer } from \"../../modules/sequencer-interaction-manager.js\";\nimport CONSTANTS from \"../../constants.js\";\n\nconst PlayerSettings = {\n  file: {\n    label: \"SEQUENCER.Player.Option.File\",\n    store: writable(\"\"),\n    default: \"\",\n  },\n  scale: {\n    label: \"SEQUENCER.Player.Option.Scale\",\n    store: writable(1.0),\n    default: 1.0,\n  },\n  users: {\n    label: \"SEQUENCER.Player.Option.ForUsers\",\n    store: writable([]),\n    default: [],\n  },\n  belowTokens: {\n    label: \"SEQUENCER.Player.Option.BelowTokens\",\n    store: writable(false),\n    default: false,\n  },\n  snapToGrid: {\n    label: \"SEQUENCER.Player.Option.SnapToGrid\",\n    store: writable(false),\n    default: false,\n  },\n  rotation: {\n    label: \"SEQUENCER.Player.Option.Rotation\",\n    store: writable(0),\n    default: 0,\n  },\n  randomRotation: {\n    label: \"SEQUENCER.Player.Option.Randomize\",\n    store: writable(false),\n    default: false,\n  },\n  fadeIn: {\n    label: \"SEQUENCER.Player.Option.FadeIn\",\n    store: writable(0),\n    default: 0,\n  },\n  fadeOut: {\n    label: \"SEQUENCER.Player.Option.FadeOut\",\n    store: writable(0),\n    default: 0,\n  },\n  scaleIn: {\n    label: \"SEQUENCER.Player.Option.ScaleIn\",\n    store: writable(0),\n    default: 0,\n  },\n  scaleOut: {\n    label: \"SEQUENCER.Player.Option.ScaleOut\",\n    store: writable(0),\n    default: 0,\n  },\n\n  mirrorX: {\n    label: \"SEQUENCER.Player.Option.MirrorX\",\n    store: writable(false),\n    default: false,\n  },\n  mirrorY: {\n    label: \"SEQUENCER.Player.Option.MirrorY\",\n    store: writable(false),\n    default: false,\n  },\n  randomMirrorX: {\n    label: \"SEQUENCER.Player.Option.Randomize\",\n    store: writable(false),\n    default: false,\n  },\n  randomMirrorY: {\n    label: \"SEQUENCER.Player.Option.Randomize\",\n    store: writable(false),\n    default: false,\n  },\n\n  offsetX: {\n    label: \"SEQUENCER.Player.Option.OffsetX\",\n    store: writable(0),\n    default: 0,\n  },\n  offsetY: {\n    label: \"SEQUENCER.Player.Option.OffsetY\",\n    store: writable(0),\n    default: 0,\n  },\n\n  offsetGridUnits: {\n    label: \"SEQUENCER.Player.Option.GridUnits\",\n    store: writable(false),\n    default: false,\n  },\n\n  randomOffsetAmount: {\n    label: \"SEQUENCER.Player.Option.RandomOffset\",\n    store: writable(0),\n    default: 0,\n  },\n\n  randomOffset: {\n    label: \"SEQUENCER.Player.Option.Randomize\",\n    store: writable(false),\n    default: false,\n  },\n\n  preload: {\n    label: \"SEQUENCER.Player.Option.Preload\",\n    store: writable(false),\n    default: false,\n  },\n  moveTowards: {\n    label: \"SEQUENCER.Player.Option.DragBehavior\",\n    label_off: \"SEQUENCER.Player.Option.DragStretch\",\n    label_on: \"SEQUENCER.Player.Option.DragMove\",\n    store: writable(false),\n    default: false,\n  },\n  moveSpeed: {\n    label: \"SEQUENCER.Player.Option.MoveSpeed\",\n    store: writable(0),\n    default: 0,\n  },\n  attachTo: {\n    label: \"SEQUENCER.Player.Option.AttachTo\",\n    store: writable(false),\n    default: false,\n    callback: (e) => {\n      EffectPlayer.sourceAttach = e.target.checked;\n    },\n  },\n  stretchToAttach: {\n    label: \"SEQUENCER.Player.Option.StretchToAttach\",\n    store: writable(false),\n    default: false,\n    callback: (e) => {\n      EffectPlayer.targetAttach = e.target.checked;\n    },\n  },\n  persist: {\n    label: \"SEQUENCER.Player.Option.Persist\",\n    store: writable(false),\n    default: false,\n  },\n  repeat: {\n    label: \"SEQUENCER.Player.Option.Repeat\",\n    store: writable(false),\n    default: false,\n  },\n  repetitions: {\n    label: \"SEQUENCER.Player.Option.Repetitions\",\n    store: writable(1.0),\n    default: 1.0,\n  },\n  repeatDelayMin: {\n    label: \"SEQUENCER.Player.Option.DelayMin\",\n    store: writable(200),\n    default: 200,\n  },\n  repeatDelayMax: {\n    label: \"SEQUENCER.Player.Option.DelayMax\",\n    store: writable(400),\n    default: 400,\n  },\n};\n\nPlayerSettings.export = () => {\n  return Object.fromEntries(\n    Object.entries(PlayerSettings).map((entry) => {\n      return [entry[0], get(entry[1].store)];\n    })\n  );\n};\n\nPlayerSettings.import = (settings) => {\n  Object.entries(PlayerSettings).forEach((entry) => {\n    if (settings?.[entry[0]] !== undefined) {\n      entry[1].store.set(settings?.[entry[0]]);\n    } else if (entry[1]?.default !== undefined) {\n      entry[1].store.set(entry[1].default);\n    }\n  });\n};\n\nPlayerSettings.getPresets = () => {\n  return Object.keys(game.settings.get(CONSTANTS.MODULE_NAME, \"effectPresets\"));\n};\n\nPlayerSettings.loadPreset = (name) => {\n  const effectPresets = game.settings.get(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\"\n  );\n  return PlayerSettings.import(effectPresets[name]);\n};\n\nPlayerSettings.savePreset = async (name) => {\n  const newName = await promptNewPresetName(name);\n  if (!newName) return;\n  const effectPresets = game.settings.get(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\"\n  );\n  effectPresets[newName] = PlayerSettings.export();\n  return game.settings.set(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\",\n    effectPresets\n  );\n};\n\nPlayerSettings.copyPreset = async (name) => {\n  const newName = await promptNewPresetName(name, true);\n  if (!newName) return;\n  const effectPresets = game.settings.get(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\"\n  );\n  effectPresets[newName] = PlayerSettings.export();\n  return game.settings.set(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\",\n    effectPresets\n  );\n};\n\nPlayerSettings.deletePreset = (name) => {\n  const effectPresets = game.settings.get(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\"\n  );\n  delete effectPresets[name];\n  return game.settings.set(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\",\n    effectPresets\n  );\n};\n\nasync function promptNewPresetName(inName, copy = false) {\n  const effectPresets = game.settings.get(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\"\n  );\n\n  let title = copy\n    ? game.i18n.localize(\"SEQUENCER.Player.CopyPresetTitle\")\n    : game.i18n.localize(\"SEQUENCER.Player.CreateNewPresetTitle\");\n\n  let presetName = await new Promise((resolve) => {\n    let rejected = false;\n    new Dialog({\n      title: title,\n      content: `<p><input type=\"text\" placeholder=\"${game.i18n.localize(\n        \"SEQUENCER.Player.CreateNewPresetInputLabel\"\n      )}\" id=\"newPresetName\" style=\"width:100%;\"></p>`,\n      buttons: {\n        okay: {\n          icon: '<i class=\"fas fa-check\"></i>',\n          label: game.i18n.localize(\"SEQUENCER.OK\"),\n          callback: async (html) => {\n            let name = html.find(\"#newPresetName\").val();\n\n            if (name === \"\" || !name) {\n              name = false;\n              rejected = true;\n            }\n\n            resolve(name);\n          },\n        },\n        cancel: {\n          icon: '<i class=\"fas fa-times\"></i>',\n          label: game.i18n.localize(\"SEQUENCER.Cancel\"),\n          callback: () => {\n            rejected = true;\n            resolve(false);\n          },\n        },\n      },\n      close: () => {},\n      render: (html) => {\n        html.find(\"#newPresetName\").val(inName).focus();\n      },\n    }).render(true);\n  });\n\n  if (presetName) {\n    if (presetName.toLowerCase() === \"default\") {\n      Dialog.prompt({\n        title: game.i18n.localize(\"SEQUENCER.Player.DefaultErrorTitle\"),\n        content: `<p>${game.i18n.localize(\n          \"SEQUENCER.Player.DefaultErrorContent\"\n        )}</p>`,\n        label: game.i18n.localize(\"SEQUENCER.OK\"),\n        callback: () => {},\n      });\n      return false;\n    }\n\n    if (effectPresets[presetName]) {\n      const overwrite = await Dialog.confirm({\n        title: game.i18n.localize(\"SEQUENCER.Player.OverwritePresetTitle\"),\n        content: `<p>${game.i18n.format(\n          \"SEQUENCER.Player.OverwritePresetContent\",\n          { preset_name: presetName }\n        )}</p>`,\n      });\n\n      if (!overwrite) {\n        presetName = await promptPresetName(presetName);\n      }\n    }\n  }\n\n  return presetName;\n}\n\nPlayerSettings.migrateOldPresets = () => {\n  if (!game.user.isGM) return;\n\n  const effectPresets = game.settings.get(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\"\n  );\n\n  const presetsToUpdate = Object.values(effectPresets).filter((preset) => {\n    return !preset?.version;\n  });\n\n  if (!presetsToUpdate.length) return;\n\n  const newEffectPresets = Object.fromEntries(\n    Object.entries(effectPresets).map(([name, preset]) => {\n      if (preset?.version) return [name, preset];\n      preset.version = game.modules.get(CONSTANTS.MODULE_NAME).version;\n      if (preset.repetitions > 1) {\n        preset.repeat = true;\n      }\n      if (preset.randomMirrorY) {\n        preset.mirrorY = true;\n      }\n      if (preset.randomOffset) {\n        preset.randomOffsetAmount = 1;\n        preset.offsetGridUnits = true;\n      }\n      return [name, preset];\n    })\n  );\n\n  return game.settings.set(\n    CONSTANTS.MODULE_NAME,\n    \"effectPresets\",\n    newEffectPresets\n  );\n};\n\nexport { PlayerSettings };\n","import * as lib from \"../lib/lib.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport SequencerEffectManager from \"./sequencer-effect-manager.js\";\nimport CONSTANTS from \"../constants.js\";\nimport SequencerFileCache from \"./sequencer-file-cache.js\";\nimport { EffectsUIApp } from \"../formapplications/effects-ui/effects-ui-app.js\";\nimport { get } from \"svelte/store\";\nimport { PlayerSettings } from \"../formapplications/effects-ui/effect-player-store.js\";\n\n/**\n * -------------------------------------------------------------\n * |         THIS IS A MESS, YOU HAVE BEEN WARNED              |\n * -------------------------------------------------------------\n */\n\nexport const InteractionManager = {\n  startDragPosition: false,\n\n  state: {\n    LeftMouseDown: false,\n    RightMouseDown: false,\n    Dragging: false,\n  },\n\n  get isLayerActive() {\n    return canvas.sequencerInterfaceLayer.active;\n  },\n\n  initialize() {\n    window.addEventListener(\"mousedown\", (event) => {\n      if (!canvas.ready) return;\n      if (!this.isLayerActive) return;\n      const hover = document.elementFromPoint(event.clientX, event.clientY);\n      if (!hover || hover.id !== \"board\") return;\n\n      const button = event.button;\n      if (!(button === 0 || button === 2)) return;\n      if (button === 0) {\n        this.state.LeftMouseDown = true;\n        this._propagateEvent(\"mouseLeftDown\");\n      }\n      if (button === 2) {\n        this.state.RightMouseDown = true;\n        this._propagateEvent(\"mouseRightDown\");\n      }\n    });\n\n    window.addEventListener(\"mouseup\", (event) => {\n      if (!canvas.ready) return;\n      if (!this.isLayerActive) return;\n      const hover = document.elementFromPoint(event.clientX, event.clientY);\n      if (!hover || hover.id !== \"board\") return;\n      if (document.activeElement.tagName !== \"BODY\") return;\n\n      const button = event.button;\n      if (!(button === 0 || button === 2)) return;\n      if (button === 0) {\n        this.state.LeftMouseDown = false;\n        this._propagateEvent(\"mouseLeftUp\");\n        this.state.Dragging = false;\n        this.startDragPosition = false;\n      }\n      if (button === 2) {\n        this.state.RightMouseDown = false;\n        this._propagateEvent(\"mouseRightUp\");\n        this.state.Dragging = false;\n        this.startDragPosition = false;\n      }\n    });\n\n    window.addEventListener(\"mousemove\", (event) => {\n      if (!canvas.ready) return;\n      const hover = document.elementFromPoint(event.clientX, event.clientY);\n      if (!hover || hover.id !== \"board\") return;\n      if (!this.isLayerActive) return;\n      this._propagateEvent(\"mouseMove\");\n      if (this.state.LeftMouseDown && !this.startDragPosition) {\n        this.startDragPosition = canvaslib.get_mouse_position();\n      }\n      if (this.state.LeftMouseDown && !this.state.Dragging) {\n        const distance = canvaslib.distance_between(\n          this.startDragPosition,\n          canvaslib.get_mouse_position()\n        );\n        this.state.Dragging = distance > 20;\n      }\n    });\n\n    EffectPlayer.initialize();\n    SelectionManager.initialize();\n  },\n\n  tearDown() {\n    EffectPlayer.tearDown();\n    SelectionManager.tearDown();\n  },\n\n  _propagateEvent(eventName) {\n    if (EffectPlayer.isActive && EffectPlayer[eventName]) {\n      EffectPlayer[eventName]();\n    }\n    if (SelectionManager.isActive && SelectionManager[eventName]) {\n      SelectionManager[eventName]();\n    }\n  },\n};\n\nexport const EffectPlayer = {\n  sequenceBuffer: [],\n\n  playMany: false,\n  playManySequenced: false,\n\n  cursorPos: false,\n  startPos: false,\n  endPos: false,\n\n  get snapLocationToGrid() {\n    return get(PlayerSettings.snapToGrid.store);\n  },\n\n  get sourceAttach() {\n    return get(PlayerSettings.attachTo.store);\n  },\n\n  get targetAttach() {\n    return get(PlayerSettings.stretchToAttach.store);\n  },\n\n  sourceAttachFound: false,\n  targetAttachFound: false,\n\n  get isActive() {\n    return (\n      InteractionManager.isLayerActive && game?.activeTool === \"play-effect\"\n    );\n  },\n\n  /**\n   * Opens the Sequencer Effects UI with the player tab open\n   */\n  show() {\n    return EffectsUIApp.show({ tab: \"player\" });\n  },\n\n  initialize() {\n    this.layer = canvas.sequencerInterfaceLayer;\n  },\n\n  tearDown() {\n    this._reset();\n  },\n\n  /**\n   * Mouse events\n   */\n  mouseLeftDown() {\n    this._evaluateStartPosition();\n  },\n\n  mouseLeftUp() {\n    if (!this.startPos) return;\n    this._playEffect();\n    this.startPos = false;\n    this.endPos = false;\n    this.sourceAttachFound = false;\n    this.targetAttachFound = false;\n  },\n\n  mouseRightUp() {\n    this._reset();\n  },\n\n  mouseMove() {\n    this._evaluateCursorPosition();\n\n    if (InteractionManager.state.Dragging) {\n      this._evaluateEndPosition();\n    }\n  },\n\n  /**\n   * Hotkeys\n   */\n  playManyUp() {\n    this._playEffects();\n    this._reset();\n  },\n\n  /**\n   * Private methods\n   */\n  _evaluatePosition(attach = false) {\n    let position = canvaslib.get_mouse_position(this.snapLocationToGrid);\n\n    const attachToObject = attach\n      ? canvaslib.get_closest_token(position, {\n          minimumDistance: canvas.grid.size,\n        })\n      : false;\n\n    let attachFound = false;\n    if (attachToObject) {\n      attachFound = true;\n      position = canvaslib.get_object_position(attachToObject);\n    }\n\n    return [position, attachFound];\n  },\n\n  _evaluateCursorPosition() {\n    const attach = InteractionManager.state.Dragging\n      ? this.targetAttach\n      : this.sourceAttach;\n\n    [this.cursorPos] = this._evaluatePosition(attach);\n  },\n\n  _evaluateStartPosition() {\n    if (this.startPos) return;\n\n    [this.startPos, this.sourceAttachFound] = this._evaluatePosition(\n      this.sourceAttach\n    );\n  },\n\n  _evaluateEndPosition() {\n    [this.endPos, this.targetAttachFound] = this._evaluatePosition(\n      this.targetAttach\n    );\n  },\n\n  _reset() {\n    if (!this.layer) return;\n    this.startPos = false;\n    this.endPos = false;\n    this.sourceAttachFound = false;\n    this.targetAttachFound = false;\n    this.sequenceBuffer = [];\n    this._evaluateCursorPosition();\n  },\n\n  async _playEffect() {\n    const settings = foundry.utils.mergeObject(PlayerSettings.export(), {\n      ...InteractionManager.state,\n      startPos: this.startPos,\n      endPos: this.endPos,\n    });\n\n    if (!settings.users.length || settings.users?.[0] === \"all\")\n      settings.users = [];\n\n    if (settings.file === \"\") return;\n\n    if (\n      !(\n        Sequencer.Database.entryExists(settings.file) ||\n        (await SequencerFileCache.srcExists(settings.file))\n      )\n    ) {\n      throw lib.custom_error(\n        \"Sequencer\",\n        `Sequencer Player | Could not find file or database entry: ${settings.file}`\n      );\n    }\n\n    if (settings.preload) {\n      await Sequencer.Preloader.preloadForClients(settings.file);\n    }\n\n    const sequence =\n      this.sequenceBuffer.length > 0 && this.playManySequenced\n        ? this.sequenceBuffer[this.sequenceBuffer.length - 1]\n        : new Sequence();\n\n    const effect = sequence\n      .effect()\n      .file(settings.file)\n      .forUsers(settings.users)\n      .mirrorX(settings.mirrorX && !settings.randomMirrorX)\n      .mirrorY(settings.mirrorY && !settings.randomMirrorY)\n      .randomizeMirrorX(settings.randomMirrorX)\n      .randomizeMirrorY(settings.randomMirrorY)\n      .persist(settings.persist)\n      .belowTokens(settings.belowTokens);\n\n    if (settings.repeat) {\n      effect.repeats(\n        settings.repetitions,\n        settings.repeatDelayMin,\n        settings.repeatDelayMax\n      );\n    }\n\n    if (settings.fadeIn > 0) effect.fadeIn(settings.fadeIn);\n    if (settings.fadeOut > 0) effect.fadeOut(settings.fadeOut);\n\n    const offsetData = settings.randomOffset\n      ? {\n          offset: { x: settings.offsetX, y: settings.offsetY },\n          gridUnits: settings.offsetGridUnits,\n        }\n      : {};\n    const offsetSource = !settings.Dragging ? offsetData : {};\n    const attachToObject = settings.attachTo\n      ? canvaslib.get_closest_token(settings.startPos, {\n          minimumDistance: canvas.grid.size,\n        })\n      : false;\n    if (attachToObject) {\n      effect.attachTo(attachToObject, {\n        randomOffset:\n          settings.randomOffset && !settings.Dragging\n            ? settings.randomOffsetAmount\n            : false,\n        ...offsetSource,\n      });\n    } else {\n      effect.atLocation(settings.startPos, {\n        randomOffset:\n          settings.randomOffset && !settings.Dragging\n            ? settings.randomOffsetAmount\n            : false,\n        ...offsetSource,\n      });\n    }\n\n    if (\n      settings.persist &&\n      settings.name &&\n      settings.name !== \"\" &&\n      settings.name !== \"default\" &&\n      settings.name !== \"new\"\n    ) {\n      effect.name(\"Preset: \" + settings.name);\n    }\n\n    if (settings.Dragging) {\n      if (settings.moveTowards) {\n        effect.moveTowards(settings.endPos, {\n          randomOffset: settings.randomOffset\n            ? settings.randomOffsetAmount\n            : false,\n          ...offsetData,\n        });\n        if (settings.moveSpeed) {\n          effect.moveSpeed(settings.moveSpeed);\n        }\n      } else {\n        let target = settings.stretchToAttach\n          ? canvaslib.get_closest_token(settings.endPos, {\n              minimumDistance: canvas.grid.size,\n            })\n          : settings.endPos;\n        effect.stretchTo(target, {\n          attachTo: settings.stretchToAttach,\n          randomOffset: settings.randomOffset\n            ? settings.randomOffsetAmount\n            : false,\n          ...offsetData,\n        });\n      }\n    }\n\n    if (!settings.Dragging || (settings.Dragging && settings.moveTowards)) {\n      effect.scale(settings.scale);\n      if (settings.scaleIn > 0)\n        effect.scaleIn(0, settings.scaleIn, { ease: \"easeInOutSine\" });\n      if (settings.scaleOut > 0)\n        effect.scaleOut(0, settings.scaleOut, { ease: \"easeInOutSine\" });\n      effect.randomRotation(settings.randomRotation);\n    }\n\n    if (this.playManySequenced) {\n      effect.waitUntilFinished();\n    }\n\n    if (!this.playManySequenced || this.sequenceBuffer.length === 0) {\n      this.sequenceBuffer.push(sequence);\n    }\n\n    if (!this.playMany && !this.playManySequenced) this._playEffects();\n  },\n\n  _playEffects() {\n    this.sequenceBuffer.forEach((sequence) => sequence.play());\n    this.sequenceBuffer = [];\n  },\n};\n\nexport const SelectionManager = {\n  selectedEffect: false,\n  hoveredEffects: new Set(),\n  suggestedProperties: false,\n  sourceOrTarget: false,\n  dragOffset: false,\n  hoveredEffectUI: false,\n\n  get snapToGrid() {\n    return get(PlayerSettings.snapToGrid.store);\n  },\n\n  set snapToGrid(bool) {\n    PlayerSettings.snapToGrid.store.set(bool);\n  },\n\n  set attachToTarget(bool) {\n    PlayerSettings.stretchToAttach.store.set(bool);\n  },\n\n  get attachToTarget() {\n    return get(PlayerSettings.stretchToAttach.store);\n  },\n\n  get isActive() {\n    return (\n      InteractionManager.isLayerActive && game?.activeTool === \"select-effect\"\n    );\n  },\n\n  get effects() {\n    return SequencerEffectManager.effects.filter(\n      (effect) => effect.userCanDelete\n    );\n  },\n\n  initialize() {\n    this.layer = canvas.sequencerInterfaceLayer;\n  },\n\n  tearDown() {\n    this._reset();\n    this.hoveredEffects = new Set();\n  },\n\n  sourcePointSelected() {\n    this.sourceOrTarget = \"source\";\n  },\n\n  targetPointSelected() {\n    this.sourceOrTarget = \"target\";\n  },\n\n  /**\n   * Mouse Events\n   */\n  mouseLeftDown() {\n    if (!this.selectedEffect) {\n      return this._selectEffects();\n    }\n    if (!this.hoveredEffects.size) {\n      this._reset();\n    }\n  },\n\n  mouseRightDown() {},\n\n  mouseLeftUp() {\n    if (!InteractionManager.state.Dragging) {\n      return this._selectEffects();\n    }\n    if (\n      !InteractionManager.state.Dragging ||\n      !this.selectedEffect ||\n      !this.suggestedProperties\n    )\n      return;\n    this._updateEffect();\n  },\n\n  mouseRightUp() {\n    InteractionManager.state.LeftMouseDown = false;\n    this.suggestedProperties = false;\n    this.sourceOrTarget = false;\n    this.dragOffset = false;\n  },\n\n  mouseMove() {\n    this._evaluateHoveredEffects();\n    if (\n      InteractionManager.state.LeftMouseDown &&\n      !InteractionManager.state.RightMouseDown\n    ) {\n      this._evaluateEffectPositionUpdate();\n    }\n  },\n\n  /**\n   * Hotkeys\n   */\n  async delete() {\n    if (!this.selectedEffect) return;\n    await SequencerEffectManager.endEffects({ effects: this.selectedEffect });\n    this.selectedEffect = false;\n  },\n\n  attachToTargetDown() {\n    if (\n      InteractionManager.state.LeftMouseDown &&\n      !InteractionManager.state.RightMouseDown\n    ) {\n      this._evaluateEffectPositionUpdate();\n    }\n  },\n\n  /**\n   * Private methods\n   */\n  _selectEffects() {\n    this._reset();\n    if (!this.hoveredEffects.size) return;\n    const firstElement = Array.from(this.hoveredEffects)[0];\n    this.selectedEffect = !firstElement.selected ? firstElement : false;\n  },\n\n  _evaluateHoveredEffects() {\n    const position = canvaslib.get_mouse_position();\n    this.hoveredEffects = this.effects.filter((effect) =>\n      effect.isPositionWithinBounds(position)\n    );\n    this.hoveredEffects.sort((a, b) => {\n      return a.data.layer !== b.data.zIndex\n        ? a.data.zIndex - b.data.zIndex\n        : a.data.layer - b.data.zIndex;\n    });\n    this.hoveredEffects = new Set(this.hoveredEffects);\n  },\n\n  _evaluateEffectPositionUpdate() {\n    if (!this.selectedEffect) return;\n\n    if (this.selectedEffect.data.stretchTo && !this.sourceOrTarget) {\n      return;\n    }\n\n    let showCursor = false;\n    let showPoint = this.snapToGrid;\n\n    let position = canvaslib.get_mouse_position(this.snapToGrid);\n\n    if (!this.selectedEffect.data.stretchTo && !this.dragOffset) {\n      this.dragOffset = {\n        x: position.x - this.selectedEffect.position.x,\n        y: position.y - this.selectedEffect.position.y,\n      };\n    }\n\n    if (this.attachToTarget) {\n      const obj = canvaslib.get_closest_token(position, {\n        minimumDistance: canvas.grid.size,\n      });\n      if (obj) {\n        position = canvaslib.get_object_position(obj);\n        showCursor = true;\n        showPoint = false;\n      }\n    }\n\n    if (this.dragOffset && !showCursor && !this.snapToGrid) {\n      position.x -= this.dragOffset.x;\n      position.y -= this.dragOffset.y;\n    }\n\n    const color =\n      (this.sourceOrTarget || \"source\") === \"source\"\n        ? CONSTANTS.COLOR.PRIMARY\n        : CONSTANTS.COLOR.SECONDARY;\n\n    this.suggestedProperties = {\n      position,\n      showCursor,\n      showPoint,\n      color,\n    };\n  },\n\n  _updateEffect() {\n    if (!this.selectedEffect) return;\n\n    const updates = {\n      attachTo: this.selectedEffect.data.attachTo,\n      stretchTo: this.selectedEffect.data.stretchTo,\n    };\n\n    const obj = this.attachToTarget\n      ? canvaslib.get_closest_token(this.suggestedProperties.position, {\n          minimumDistance: canvas.grid.size,\n          type: TokenDocument,\n        })\n      : false;\n    let objUuid = obj ? lib.get_object_identifier(obj) : false;\n\n    if (this.sourceOrTarget === \"source\") {\n      if (!updates.attachTo) {\n        updates.attachTo = {\n          active: false,\n          align: \"center\",\n          rotation: true,\n          bindVisibility: true,\n          bindAlpha: true,\n        };\n      }\n      updates.attachTo = foundry.utils.mergeObject(updates.attachTo || {}, {\n        active: this.attachToTarget && !!objUuid,\n      });\n      if (this.attachToTarget && objUuid) {\n        updates.source = objUuid;\n      } else {\n        updates[\"source\"] = this.suggestedProperties.position;\n      }\n    } else if (this.sourceOrTarget === \"target\") {\n      updates.stretchTo.attachTo = this.attachToTarget && !!objUuid;\n      if (this.attachToTarget && objUuid) {\n        updates.target = objUuid;\n      } else {\n        updates[\"target\"] = this.suggestedProperties.position;\n      }\n    } else {\n      updates[\"source\"] = this.suggestedProperties.position;\n    }\n\n    this.selectedEffect.update(updates);\n\n    this.suggestedProperties = false;\n    this.sourceOrTarget = false;\n    this.dragOffset = false;\n  },\n\n  _reset() {\n    this.selectedEffect = false;\n    this.suggestedProperties = false;\n    this.sourceOrTarget = false;\n    this.dragOffset = false;\n  },\n};\n","<script>\r\n\r\n  import { localize } from '#runtime/svelte/helper';\r\n  import { SelectionManager } from \"../../../modules/sequencer-interaction-manager.js\";\r\n  import SequencerEffectManager from \"../../../modules/sequencer-effect-manager.js\";\r\n\r\n  export let effect;\r\n\r\n  function getEffectName(effect) {\r\n\r\n    let effectName = \"\";\r\n    if (effect.data.file) {\r\n      effectName = effect.data.file.split('\\\\').pop().split('/').pop();\r\n    } else if (effect.data.text) {\r\n      effectName = \"Text: \" + effect.data.text.text;\r\n    } else {\r\n      effectName =  effect.data?.shapes?.[0]?.type ? \"Shape: \" + effect.data.shapes[0]?.type : \"Unknown effect\"\r\n    }\r\n\r\n    effectName = effect.data.name ? `${effect.data.name} (${effectName})` : effectName;\r\n\r\n    if (effect.data.creatorUserId !== game.userId) {\r\n      let user_name = game.users.get(effect.data.creatorUserId)?.name;\r\n      let formattedUsername = (user_name\r\n        ? localize(\"SEQUENCER.ManagerPlayersEffect\", { user_name })\r\n        : localize(\"SEQUENCER.ManagerUnknownEffect\"));\r\n      effectName += ` (${formattedUsername})`;\r\n    }\r\n\r\n    return effectName;\r\n\r\n  }\r\n\r\n  function mouseOver() {\r\n    SelectionManager.hoveredEffectUI = effect;\r\n  }\r\n\r\n  function mouseLeave() {\r\n    SelectionManager.hoveredEffectUI = false;\r\n  }\r\n\r\n  function endEffect(){\r\n    SequencerEffectManager.endEffects({ effects: [effect] });\r\n\t}\r\n\r\n</script>\r\n\r\n\r\n<div class=\"effect hover-highlight\" on:mouseleave={mouseLeave} on:mouseover={mouseOver}>\r\n\t<button class=\"btn_end\" type=\"button\" on:click={endEffect}>\r\n\t\t<i class=\"fas fa-times\"></i>\r\n\t</button>\r\n\t<div class=\"effect-text hover-text\">\r\n\t\t{getEffectName(effect)}\r\n\t</div>\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .effect {\r\n    display: flex;\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n  .effect > button {\r\n    flex: 0;\r\n    font-size: 0.7rem;\r\n    height: 1.25rem;\r\n    line-height: normal;\r\n    margin-right: 5px;\r\n  }\r\n\r\n  .btn_end {\r\n    min-width: 1.5rem;\r\n  }\r\n\r\n  .effect > div {\r\n    flex: 1;\r\n    line-height: 1.25rem;\r\n  }\r\n\r\n  .hover-highlight:hover > .hover-text {\r\n    color: #000;\r\n    text-shadow: 0 0 10px red;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n\timport SequencerSoundManager from \"../../../modules/sequencer-sound-manager.js\";\r\n\r\n\texport let id;\r\n\texport let sound;\r\n\r\n\tfunction endSound() {\r\n\t\tSequencerSoundManager.endSounds({ sounds: [id] }, true);\r\n\t}\r\n\r\n</script>\r\n\r\n\r\n<div class=\"effect hover-highlight\">\r\n\t<button class=\"btn_end\" on:click={endSound} type=\"button\">\r\n\t\t<i class=\"fas fa-times\"></i>\r\n\t</button>\r\n\t<div class=\"effect-text hover-text\">\r\n\t\t{sound.src.split(\"/\").slice(-1)}\r\n\t</div>\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .effect {\r\n    display: flex;\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n  .effect > button {\r\n    flex: 0;\r\n    font-size: 0.7rem;\r\n    height: 1.25rem;\r\n    line-height: normal;\r\n    margin-right: 5px;\r\n  }\r\n\r\n  .btn_end {\r\n    min-width: 1.5rem;\r\n  }\r\n\r\n  .effect > div {\r\n    flex: 1;\r\n    line-height: 1.25rem;\r\n  }\r\n\r\n  .hover-highlight:hover > .hover-text {\r\n    color: #000;\r\n    text-shadow: 0 0 10px red;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import { localize } from \"#runtime/svelte/helper\";\r\n  import SequenceManager from \"../../modules/sequence-manager.js\";\r\n  import EffectEntry from \"./components/EffectEntry.svelte\";\r\n  import SoundEntry from \"./components/SoundEntry.svelte\";\r\n  import SequencerSoundManager from \"../../modules/sequencer-sound-manager.js\";\r\n\r\n  const VisibleEffects = SequenceManager.VisibleEffects;\r\n  const RunningSounds = SequenceManager.RunningSounds;\r\n\r\n  $: effects = Object.values($VisibleEffects);\r\n  $: sounds = Object.entries($RunningSounds).filter(e => e[1].sound_playing);\r\n  $: persistentEffects = effects.filter(effect => effect.data.persist);\r\n  $: temporaryEffects = effects.filter(effect => !effect.data.persist);\r\n\r\n  function endAllEffects() {\r\n    Sequencer.EffectManager.endEffects({\r\n      effects: effects.filter(effect => effect.userCanDelete && !effect.data.private)\r\n\t\t});\r\n  }\r\n\r\n  function endAllSounds() {\r\n    SequencerSoundManager.endSounds({\r\n      sounds: Object.entries($RunningSounds)\r\n        .filter(e => e[1].sound_playing)\r\n        .map(e => e[0])\r\n\t\t});\r\n  }\r\n\r\n</script>\r\n\r\n<div class=\"effects-container\">\r\n\r\n  {#if !effects.length && !sounds.length}\r\n\r\n    <div class=\"no-effects\">\r\n      <h2>{localize(\"SEQUENCER.Manager.NothingPlaying\")}</h2>\r\n    </div>\r\n\r\n  {/if}\r\n\r\n  {#if effects.length}\r\n    <button class=\"w-100 end-all-effects mb-2\" on:click={endAllEffects} type=\"button\">\r\n      {localize(\"SEQUENCER.Manager.EndAllEffects\")}\r\n    </button>\r\n\r\n    <div class=\"effects\">\r\n\r\n      {#if persistentEffects.length}\r\n        <h2>{localize(\"SEQUENCER.Manager.PersistentEffects\")}</h2>\r\n        <div>\r\n          {#each persistentEffects as effect (effect.id)}\r\n            <EffectEntry {effect} />\r\n          {/each}\r\n        </div>\r\n      {/if}\r\n\r\n      {#if temporaryEffects.length && persistentEffects.length}\r\n        <hr />\r\n      {/if}\r\n\r\n      {#if temporaryEffects.length}\r\n        <h2>{localize(\"SEQUENCER.Manager.TemporaryEffects\")}</h2>\r\n        <div>\r\n          {#each temporaryEffects as effect (effect.id)}\r\n            <EffectEntry {effect} />\r\n          {/each}\r\n        </div>\r\n      {/if}\r\n\r\n    </div>\r\n\r\n  {/if}\r\n\r\n  {#if sounds.length}\r\n    <button class=\"w-100 end-all-effects mb-2\" on:click={endAllSounds} type=\"button\">\r\n      {localize(\"SEQUENCER.Manager.EndAllSounds\")}\r\n    </button>\r\n\r\n    <div>\r\n\r\n      <h2>{localize(\"SEQUENCER.Manager.Sounds\")}</h2>\r\n\r\n      <div>\r\n        {#each sounds as [id, sound] (id)}\r\n          <SoundEntry {id} {sound}/>\r\n        {/each}\r\n      </div>\r\n    </div>\r\n\r\n  {/if}\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .end-all-effects{\r\n    margin-bottom: 0.5rem;\r\n  }\r\n\r\n  .effects-container {\r\n    min-width: 320px;\r\n    min-height: 563px;\r\n    max-width: 320px;\r\n    max-height: 563px;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .effects {\r\n    flex: 1;\r\n    margin-top: 0.5rem;\r\n  }\r\n\r\n  .running-sequences {\r\n    flex: 1;\r\n    margin-top: 0.5rem;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from \"#runtime/svelte/helper\";\r\n  import { writable } from \"svelte/store\";\r\n  import { applyStyles } from \"#runtime/svelte/action/dom\";\r\n\r\n  export let setting;\r\n  export let lock = false;\r\n  export let min = 0.1;\r\n  export let max = 2;\r\n  export let maxInput = Infinity;\r\n  export let step = 0.01;\r\n  export let styles = {};\r\n\r\n  const store = setting.store;\r\n  const isLocked = lock ? lock.store : writable(false);\r\n\r\n</script>\r\n\r\n<div style=\"display: flex; align-items: center;\" use:applyStyles={styles}>\r\n\t<label>{localize(setting.label)}</label>\r\n\t<input bind:value=\"{$store}\" disabled={$isLocked} {max} {min} {step} type=\"range\"/>\r\n\t<input bind:value=\"{$store}\" disabled={$isLocked} max={maxInput} {min} required {step} type=\"number\"/>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n\tlabel {\r\n\t\tflex: 1 0 auto;\r\n\t\tmargin-right: 0.25rem;\r\n\t}\r\n\r\n\tinput[type=\"range\"] {\r\n    flex: 1 0 50%;\r\n    margin-right: 0.25rem;\r\n\t}\r\n\r\n\tinput[type=\"number\"] {\r\n    flex: 1 0 15%;\r\n\t}\r\n\r\n</style>\r\n","<script>\r\n  import { localize } from \"#runtime/svelte/helper\";\r\n  import { applyStyles } from \"#runtime/svelte/action/dom\";\r\n  import { writable } from \"svelte/store\";\r\n\r\n  export let setting;\r\n  export let label = false;\r\n  export let lock = false;\r\n  export let inverse = false\r\n  export let styles = {};\r\n\r\n\tconst id = \"sequencer-input-\" + foundry.utils.randomID();\r\n  const store = setting.store;\r\n  const isLocked = lock ? lock.store : writable(inverse);\r\n\r\n  $: {\r\n    if($isLocked !== inverse){\r\n      $store = false;\r\n\t\t}\r\n  }\r\n\r\n</script>\r\n\r\n<div style=\"display: flex; align-items: center;\" use:applyStyles={styles}>\r\n\t<input id={id} disabled={$isLocked !== inverse} style=\"height:15px;\" type=\"checkbox\" bind:checked={$store}/>\r\n\t<label for={id}>{localize(setting.label)}</label>\r\n</div>\r\n","<script>\r\n\timport { localize } from \"#runtime/svelte/helper\";\r\n  import { applyStyles } from \"#runtime/svelte/action/dom\";\r\n  import { writable } from \"svelte/store\";\r\n\r\n  export let setting;\r\n  export let lock = false;\r\n  export let inverse = false;\r\n  export let styles = {};\r\n\r\n  const id = \"sequencer-input-\" + foundry.utils.randomID();\r\n  const store = setting.store;\r\n  const isLocked = lock ? lock.store : writable(inverse);\r\n</script>\r\n\r\n<div style=\"display: flex; align-items: center;\" use:applyStyles={styles}>\r\n\t{#if localize(setting.label)}\r\n\t\t<label for={id}>{localize(setting.label)}</label>\r\n\t{/if}\r\n\t<input id={id} type=\"number\" disabled={$isLocked !== inverse} bind:value={$store} on:change={() => { if($store === null) $store = 0; }}/>\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\tlabel {\r\n    text-align: right;\r\n    flex: 1 0 auto;\r\n\t\tpadding-right: 0.25rem;\r\n\t}\r\n\r\n\tinput {\r\n\t\twidth: 100%;\r\n\t\tflex: 1 0 40%;\r\n\t}\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from \"#runtime/svelte/helper\";\r\n  import { applyStyles } from \"#runtime/svelte/action/dom\";\r\n\r\n\texport let setting;\r\n  export let styles = {};\r\n\r\n  const store = setting.store;\r\n\r\n  const width = 5.75;\r\n\r\n  $: finalStyles = {\r\n    ...styles,\r\n\t\t\"--switch-width\": `${width}em`,\r\n\t\t\"--half-switch-width\": `${width-1.5}em`,\r\n\t\t\"--half-switch-width-on\": `${width-1.7}em`,\r\n\t}\r\n\r\n</script>\r\n\r\n<div style=\"display: flex; align-items: center;\" use:applyStyles={finalStyles}>\r\n\r\n\t<div class=\"first\" class:active={!$store} on:click={() => { $store = false; }}>\r\n\t\t<span>{localize(setting.label_off)}</span>\r\n\t</div>\r\n\t<div class=\"second\" class:active={$store} on:click={() => { $store = true; }}>\r\n\t\t<span>{localize(setting.label_on)}</span>\r\n\t</div>\r\n\r\n</div>\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n\tdiv > div {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tpadding: 2px 5px;\r\n\t\tborder: 1px solid #919191;\r\n\t\tcursor:pointer;\r\n\t}\r\n\r\n\t.first {\r\n\t\tborder-bottom-left-radius: 5px;\r\n\t\tborder-top-left-radius: 5px;\r\n\t\tbackground: #ccc;\r\n    border-right: 0;\r\n\t}\r\n\r\n\t.second {\r\n\t\tborder-bottom-right-radius: 5px;\r\n\t\tborder-top-right-radius: 5px;\r\n\t\tbackground: #ccc;\r\n\t}\r\n\r\n\t.active {\r\n    background: #eaeaea;\r\n\t}\r\n\r\n</style>\r\n","<script>\r\n  import { localize } from '#runtime/svelte/helper';\r\n  import { PlayerSettings } from \"./effect-player-store.js\";\r\n  import { get } from \"svelte/store\";\r\n  import SequencerDatabase from \"../../modules/sequencer-database.js\";\r\n  import SliderInput from \"./components/SliderInput.svelte\";\r\n  import Checkbox from \"./components/Checkbox.svelte\";\r\n  import NumberInput from \"./components/NumberInput.svelte\";\r\n  import SwitchToggle from \"./components/SwitchToggle.svelte\";\r\n\r\n  const fileStore = PlayerSettings.file.store;\r\n  const users = game.users.filter(user => user.active);\r\n  const userStore = PlayerSettings.users.store;\r\n\r\n  let lastInput = \"\";\r\n  let lastResults = [];\r\n  let suggestions = [];\r\n  const searchDebounce = foundry.utils.debounce(() => {\r\n    const fileInput = get(fileStore).toLowerCase();\r\n    if(!fileInput){\r\n      suggestions = SequencerDatabase.publicModules;\r\n      return;\r\n\t\t}\r\n    if (lastInput === fileInput) return;\r\n    let results = SequencerDatabase.searchFor(fileInput);\r\n    if (lastResults.equals(results)) return;\r\n    lastResults = foundry.utils.duplicate(results);\r\n    if (results.length === 1 && results[0].startsWith(fileInput)) return;\r\n    if (results.length > 100) {\r\n      results = results.slice(0, 100);\r\n    }\r\n    suggestions = foundry.utils.duplicate(results);\r\n  }, 200);\r\n\r\n  $: searchDebounce($fileStore);\r\n\r\n  async function activateLayer(){\r\n    ui.controls.initialize({ control: \"sequencer\", tool: \"play-effect\" });\r\n    canvas.sequencerInterfaceLayer.activate({ tool: \"play-effect\" });\r\n\t}\r\n\r\n  let filePicker = false;\r\n\r\n  function handleClick() {\r\n    if (!filePicker) {\r\n      const file = get(fileStore);\r\n      const current = SequencerDatabase.getEntry(file, { softFail: true })\r\n        ? file\r\n        : \"\";\r\n      filePicker = new FilePicker({\r\n        type: \"imageVideo\",\r\n        current,\r\n        callback: path => {\r\n          fileStore.set(path);\r\n          filePicker = false;\r\n        }\r\n      });\r\n    }\r\n    filePicker.render(true, { focus: true });\r\n  }\r\n\r\n  const presets = PlayerSettings.getPresets();\r\n  let selectedPreset = \"default\";\r\n\r\n</script>\r\n\r\n<div class=\"effect-player-container\">\r\n\r\n\t<fieldset>\r\n\r\n\t\t<legend>Effect</legend>\r\n\r\n\t\t<button class=\"activate-layer\" type=\"button\" on:click={() => activateLayer()}>{localize(\"SEQUENCER.Player.SwitchToLayer\")}</button>\r\n\r\n\t\t<div class=\"file-settings\">\r\n\t\t\t<input bind:value={$fileStore} class=\"file-input flex3\"\r\n             list=\"dblist\"\r\n\t\t\t\t\t\t placeholder='{localize(\"SEQUENCER.Player.PathInput\")}'\r\n\t\t\t\t\t\t type=\"text\"/>\r\n\t\t\t<button class=\"custom-file-picker small-button\" type=\"button\" on:click={handleClick}>\r\n        <i class=\"fas fa-file-import\"></i>\r\n      </button>\r\n\t\t\t<datalist id=\"dblist\">\r\n\t\t\t\t{#each suggestions as suggestion}\r\n\t\t\t\t\t<option>{suggestion}</option>\r\n\t\t\t\t{/each}\r\n\t\t\t</datalist>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"user-settings flexcol\">\r\n\t\t\t<label for=\"user-select\">Play for users:</label>\r\n\t\t\t<select class=\"user-select\" id=\"user-select\" multiple bind:value={$userStore}>\r\n\t\t\t\t<option selected value=\"all\">{localize(\"SEQUENCER.Player.AllUsers\")}</option>\r\n\t\t\t\t{#each users as user (user.id)}\r\n\t\t\t\t\t<option value=\"{user.id}\">{user.name}</option>\r\n\t\t\t\t{/each}\r\n\t\t\t</select>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"flexcol\">\r\n\r\n\t\t\t<div class=\"row w-100\">{localize(\"SEQUENCER.Player.Presets\")}</div>\r\n\r\n\t\t\t<div class=\"preset-container\">\r\n\r\n\t\t\t\t<select class=\"preset-select\" bind:value={selectedPreset} on:change={() => PlayerSettings.loadPreset(selectedPreset)}>\r\n\r\n\t\t\t\t\t<option value=\"default\">{localize(\"SEQUENCER.Player.PresetsDefault\")}</option>\r\n\t\t\t\t\t{#each presets as preset}\r\n\t\t\t\t\t\t<option>{preset}</option>\r\n\t\t\t\t\t{/each}\r\n\t\t\t\t\t<!--{{#each presets}}-->\r\n\t\t\t\t\t<!--<option>{{ @key }}</option>-->\r\n\t\t\t\t\t<!--{{/each}}-->\r\n\r\n\t\t\t\t</select>\r\n\r\n\t\t\t\t<button class=\"save-preset small-button\" data-tooltip=\"Save Preset\" type=\"button\" on:click={() => PlayerSettings.savePreset(selectedPreset)}>\r\n\t\t\t\t\t<i class=\"fas fa-download\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class=\"copy-preset small-button\" data-tooltip=\"Copy Preset\" disabled={selectedPreset === \"default\"} type=\"button\" on:click={() => PlayerSettings.copyPreset(selectedPreset)}>\r\n\t\t\t\t\t<i class=\"fas fa-copy\"></i>\r\n\t\t\t\t</button>\r\n\t\t\t\t<button class=\"delete-preset small-button\" data-tooltip=\"Delete Preset\" disabled={selectedPreset === \"default\"} type=\"button\" on:click={() => PlayerSettings.deletePreset(selectedPreset)}>\r\n\t\t\t\t\t<i class=\"fas fa-times\"></i>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</fieldset>\r\n\r\n\t<fieldset>\r\n\r\n\t\t<legend>Transform</legend>\r\n\r\n\t\t<div class=\"effect-transform-container\">\r\n\t\t\t<SliderInput setting={PlayerSettings.scale} styles={{ \"grid-column\": `1 / 5` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.scaleIn} styles={{ \"grid-column\": `1 / 3` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.scaleOut} styles={{ \"grid-column\": `3 / 5` }}/>\r\n\t\t\t<div class=\"divider\"></div>\r\n\t\t\t<SliderInput setting={PlayerSettings.rotation} lock={PlayerSettings.randomRotation} min=\"-180\" max=\"180\"  styles={{ \"grid-column\": `1 / 5` }}/>\r\n\t\t\t<div></div>\r\n\t\t\t<Checkbox setting={PlayerSettings.randomRotation} styles={{ \"grid-column\": `2 / 4` }}/>\r\n\t\t\t<div></div>\r\n\t\t\t<div class=\"divider\"></div>\r\n\t\t\t<Checkbox setting={PlayerSettings.mirrorX} styles={{ \"grid-column\": `1 / 3` }}/>\r\n\t\t\t<Checkbox setting={PlayerSettings.mirrorY} styles={{ \"grid-column\": `3 / 5` }}/>\r\n\t\t\t<Checkbox setting={PlayerSettings.randomMirrorX} styles={{ \"grid-column\": `1 / 3` }} lock={PlayerSettings.mirrorX} inverse/>\r\n\t\t\t<Checkbox setting={PlayerSettings.randomMirrorY} styles={{ \"grid-column\": `3 / 5` }} lock={PlayerSettings.mirrorY} inverse/>\r\n\t\t\t<div class=\"divider\"></div>\r\n\t\t\t<NumberInput setting={PlayerSettings.offsetX} lock={PlayerSettings.randomOffset} styles={{ \"grid-column\": `1 / 3` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.offsetY} lock={PlayerSettings.randomOffset} styles={{ \"grid-column\": `3 / 5` }}/>\r\n\t\t\t<Checkbox setting={PlayerSettings.randomOffset} styles={{ \"grid-column\": `1 / 3` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.randomOffsetAmount} lock={PlayerSettings.randomOffset} inverse styles={{ \"grid-column\": `3 / 5` }}/>\r\n\t\t\t<Checkbox setting={PlayerSettings.offsetGridUnits} styles={{ \"grid-column\": `2 / 5` }}/>\r\n\t\t\t<div></div>\r\n\t\t</div>\r\n\r\n\t</fieldset>\r\n\r\n\t<fieldset>\r\n\r\n\t\t<legend>Behavior</legend>\r\n\t\t<div class=\"effect-transform-container\">\r\n\t\t\t<NumberInput setting={PlayerSettings.fadeIn} styles={{ \"grid-column\": `1 / 3` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.fadeOut} styles={{ \"grid-column\": `3 / 5` }}/>\r\n\t\t\t<div class=\"divider\"></div>\r\n\t\t\t<Checkbox setting={PlayerSettings.repeat} styles={{ \"grid-column\": `1 / 3` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.repetitions} lock={PlayerSettings.repeat} inverse styles={{ \"grid-column\": `3 / 5` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.repeatDelayMin} lock={PlayerSettings.repeat} inverse styles={{ \"grid-column\": `3 / 4` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.repeatDelayMax} lock={PlayerSettings.repeat} inverse styles={{ \"grid-column\": `4 / 5` }}/>\r\n\t\t\t<div class=\"divider\"></div>\r\n\t\t\t<SwitchToggle setting={PlayerSettings.moveTowards} styles={{ \"grid-column\": `1 / 3` }}/>\r\n\t\t\t<NumberInput setting={PlayerSettings.moveSpeed} lock={PlayerSettings.moveTowards} inverse styles={{ \"grid-column\": `3 / 5` }}/>\r\n\t\t\t<div class=\"divider\"></div>\r\n\t\t\t<Checkbox setting={PlayerSettings.attachTo} styles={{ \"grid-column\": `1 / 5` }}/>\r\n\t\t\t<Checkbox setting={PlayerSettings.stretchToAttach} styles={{ \"grid-column\": `1 / 5` }}/>\r\n\t\t\t<Checkbox setting={PlayerSettings.snapToGrid} styles={{ \"grid-column\": `1 / 5` }}/>\r\n\t\t\t<Checkbox setting={PlayerSettings.persist} styles={{ \"grid-column\": `1 / 5` }}/>\r\n\t\t\t<Checkbox setting={PlayerSettings.belowTokens} styles={{ \"grid-column\": `1 / 5` }}/>\r\n\t\t</div>\r\n\r\n\t</fieldset>\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n\t.activate-layer {\r\n\t\tmargin-bottom: 0.5rem;\r\n\t}\r\n\r\n\t.file-settings {\r\n\t\tdisplay: flex;\r\n    margin-bottom: 0.5rem;\r\n\t}\r\n\r\n\t.preset-container {\r\n\t\tdisplay: flex;\r\n    margin-bottom: 0.5rem;\r\n\r\n\t\tselect {\r\n\t\t\tflex: 1;\r\n    }\r\n\t}\r\n\r\n  .small-button {\r\n    flex: 0 0 24px;\r\n    min-width: 30px;\r\n    line-height: 24px;\r\n    margin: -1px 0 -1px 4px;\r\n    order: 99;\r\n    text-align: center;\r\n\r\n    i {\r\n      margin: 0;\r\n    }\r\n\r\n    &:disabled {\r\n      cursor: initial;\r\n      opacity: 0.5;\r\n    }\r\n\r\n  }\r\n\r\n\t.user-settings {\r\n    margin-bottom: 0.5rem;\r\n\t}\r\n\r\n  .scrolling-text {\r\n\r\n  }\r\n\r\n  /* jb2a.breath_weapons02.burst.cone.arcana */\r\n\r\n</style>\r\n","<script>\r\n\r\n  import CONSTANTS from \"../../../constants.js\";\r\n\r\n  export let status;\r\n\r\n</script>\r\n\r\n<i class=\"fa-solid background-circle\"\r\n   class:invisible={$status === CONSTANTS.STATUS.READY}\r\n   class:fa-arrow-right={$status === CONSTANTS.STATUS.RUNNING || $status === CONSTANTS.STATUS.READY}\r\n   class:fa-check={$status === CONSTANTS.STATUS.COMPLETE}\r\n   class:fa-arrow-down={$status === CONSTANTS.STATUS.SKIPPED}\r\n   class:fa-times={$status === CONSTANTS.STATUS.ABORTED}>\r\n</i>\r\n<i class=\"fa-solid \"></i>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .background-circle{\r\n    position: relative;\r\n    z-index: 2;\r\n    margin-right: 0.2rem;\r\n    min-width: 1rem;\r\n    text-align: center;\r\n  }\r\n\r\n  .invisible {\r\n    opacity: 0;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from \"#runtime/svelte/helper\";\r\n  import SequenceStatus from \"./SequenceStatus.svelte\";\r\n  import CONSTANTS from \"../../../constants.js\";\r\n\r\n  export let section;\r\n\r\n  const status = section.sectionStatus;\r\n  const sectionName = (section?.constructor?.niceName ? section?.constructor?.niceName : section.constructor.name) + (section?._name ? \" - \" + section._name : \"\");\r\n\r\n</script>\r\n\r\n<div>\r\n  <span>\r\n    <SequenceStatus {status}/>\r\n  </span>\r\n  <span class=\"section-name\">{sectionName}</span>\r\n  <span class=\"sequence-actions\" data-tooltip={localize(\"SEQUENCER.Sequences.AbortSection\")}>\r\n    <a class:section-done={$status > CONSTANTS.STATUS.READY} on:click={() => { section._abortSection(); }}>\r\n      <i class=\"fas fa-stop\"></i>\r\n    </a>\r\n  </span>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n  div {\r\n    display: flex;\r\n    flex-direction: row;\r\n    align-items: center;\r\n    margin-left: 0.5rem;\r\n    padding: 3px 5px;\r\n    border-radius: 3px;\r\n\r\n    .section-name {\r\n      flex: 1;\r\n    }\r\n\r\n    &:hover {\r\n      background: rgba(0, 0, 0, 0.1);\r\n    }\r\n\r\n    .sequence-actions {\r\n      opacity: 0.3;\r\n    }\r\n\r\n    &:hover .sequence-actions {\r\n      opacity: 0.8;\r\n    }\r\n\r\n    .section-done {\r\n      display: none;\r\n    }\r\n  }\r\n</style>\r\n","<script>\r\n\r\n  import { localize } from \"#runtime/svelte/helper\";\r\n  import SequenceSection from \"./SequenceSection.svelte\";\r\n  import SequenceStatus from \"./SequenceStatus.svelte\";\r\n  import SequenceManager from \"../../../modules/sequence-manager.js\";\r\n  import CONSTANTS from \"../../../constants.js\";\r\n\r\n  export let sequence;\r\n  export let index;\r\n\r\n  const status = sequence.statusStore;\r\n\r\n</script>\r\n\r\n\r\n<div class=\"sequence-name-container\">\r\n  <span>\r\n    <SequenceStatus {status}/>\r\n  </span>\r\n  <span class=\"sequence-name\">\r\n    Sequence {index}{sequence.moduleName ? ` (${sequence.moduleName})` : \"\"}\r\n  </span>\r\n  <span class=\"sequence-actions\">\r\n    <a class=\"clear-sequence\"\r\n       class:sequence-done-show={$status > CONSTANTS.STATUS.RUNNING}\r\n       on:click={() => { SequenceManager.RunningSequences.delete(sequence.id); }}\r\n       data-tooltip={localize(\"SEQUENCER.Sequences.Clear\")}\r\n    >\r\n      <i class=\"fas fa-trash-can\"></i>\r\n    </a>\r\n    <a class:sequence-done-hide={$status > CONSTANTS.STATUS.RUNNING} on:click={() => { sequence._abort(); }} data-tooltip={localize(\"SEQUENCER.Sequences.AbortSequence\")}>\r\n      <i class=\"fas fa-stop\"></i>\r\n    </a>\r\n  </span>\r\n</div>\r\n{#each sequence.sections as section}\r\n  <SequenceSection {section} />\r\n{/each}\r\n\r\n\r\n<style lang=\"scss\">\r\n\r\n  .sequence-name-container{\r\n    display: flex;\r\n    font-weight: bold;\r\n    padding: 3px 5px;\r\n    border-radius: 3px;\r\n\r\n    .sequence-name {\r\n      flex: 1;\r\n    }\r\n\r\n    &:hover {\r\n      background: rgba(0, 0, 0, 0.1);\r\n    }\r\n\r\n    .sequence-actions {\r\n      display: flex;\r\n      max-width: 10px;\r\n      flex: 0 1 10px;\r\n      & a {\r\n        opacity: 0.35;\r\n      }\r\n    }\r\n\r\n    &:hover .sequence-actions a {\r\n      opacity: 0.7;\r\n\r\n      &:hover{\r\n        opacity: 1.0;\r\n      }\r\n    }\r\n\r\n    .clear-sequence {\r\n      margin-right: 0.5rem;\r\n      display: none;\r\n    }\r\n\r\n    .sequence-done-show {\r\n      display: block;\r\n    }\r\n\r\n    .sequence-done-hide {\r\n      display: none;\r\n    }\r\n\r\n  }\r\n\r\n</style>\r\n","<script>\r\n  import { localize } from \"#runtime/svelte/helper\";\r\n  import { onMount, onDestroy } from \"svelte\";\r\n  import SequenceManager from \"../../modules/sequence-manager.js\";\r\n  import Sequence from \"./components/Sequence.svelte\";\r\n\r\n  const VisibleEffects = SequenceManager.VisibleEffects;\r\n  const RunningSequences = SequenceManager.RunningSequences;\r\n\r\n  $: runningSequences = Object.entries($RunningSequences);\r\n\r\n  onMount(() => {\r\n    SequenceManager.RunningSequences.clearFinishedSequences();\r\n  });\r\n\r\n  onDestroy(() => {\r\n    SequenceManager.RunningSequences.clearFinishedSequences();\r\n  });\r\n\r\n</script>\r\n\r\n<div class=\"sequence-container\">\r\n\r\n  {#if !runningSequences.length}\r\n\r\n    <div class=\"no-sequences\">\r\n      <h2>{localize(\"SEQUENCER.Sequences.NoSequences\")}</h2>\r\n    </div>\r\n\r\n  {:else}\r\n\r\n    <div class=\"sequence-button-header\">\r\n      <button type=\"button\" on:click={() => {\r\n         SequenceManager.RunningSequences.clearFinishedSequences();\r\n      }}>\r\n        {localize(\"SEQUENCER.Sequences.ClearFinished\")}\r\n      </button>\r\n      <button type=\"button\" on:click={() => {\r\n         SequenceManager.RunningSequences.stopAll();\r\n      }}>\r\n        {localize(\"SEQUENCER.Sequences.StopAll\")}\r\n      </button>\r\n    </div>\r\n\r\n    <div class=\"running-sequences\">\r\n      {#each runningSequences as [id, sequence], index (id)}\r\n        <Sequence {sequence} index={index+1}/>\r\n      {/each}\r\n    </div>\r\n\r\n  {/if}\r\n\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .sequence-container {\r\n    min-width: 320px;\r\n    min-height: 563px;\r\n    max-width: 320px;\r\n    max-height: 563px;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .sequence-button-header{\r\n    display: flex;\r\n    button {\r\n      font-size: 0.85rem;\r\n    }\r\n  }\r\n\r\n  .effects {\r\n    flex: 1;\r\n    margin-top: 0.5rem;\r\n  }\r\n\r\n  .running-sequences{\r\n    flex: 1;\r\n    margin-top: 0.5rem;\r\n  }\r\n\r\n</style>\r\n","<script>\r\n\r\n  import { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n  import { localize } from '#runtime/svelte/helper';\r\n  import { getContext } from \"svelte\";\r\n  import HowTo from \"./HowTo.svelte\";\r\n  import Tabs from \"./Tabs.svelte\";\r\n  import Manager from \"./Manager.svelte\";\r\n  import Player from \"./Player.svelte\";\r\n  import Sequences from \"./Sequences.svelte\";\r\n\r\n  const { application } = getContext(\"#external\");\r\n\r\n  export let elementRoot;\r\n\r\n  let tabs = [\r\n    { value: \"player\", label: localize(\"SEQUENCER.Player.Title\"), icon: \"fas fa-play-circle\", component: Player },\r\n    { value: \"manager\", label: localize(\"SEQUENCER.Manager.Title\"), icon: \"fas fa-film\", component: Manager },\r\n    { value: \"sequences\", label: localize(\"SEQUENCER.Sequences.Title\"), icon: \"fas fa-play\", component: Sequences },\r\n    { value: \"howto\", label: localize(\"SEQUENCER.HowTo.Title\"), icon: \"fas fa-chalkboard-teacher\", component: HowTo },\r\n  ];\r\n\r\n  let activeTab = application.options.tab ?? \"manager\";\r\n  $: component = tabs.find(tab => tab.value === activeTab).component;\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<Tabs bind:activeTab {tabs}/>\r\n\r\n\t<svelte:component this={component}/>\r\n\r\n</ApplicationShell>\r\n","import { SvelteApplication } from \"#runtime/svelte/application\";\nimport EffectsUIShell from \"./effects-ui-shell.svelte\";\n\nexport class EffectsUIApp extends SvelteApplication {\n  static get defaultOptions() {\n    return foundry.utils.mergeObject(super.defaultOptions, {\n      title: game.i18n.localize(\"SEQUENCER.ManagerUI\"),\n      classes: [\"dialog\"],\n      width: \"auto\",\n      height: \"auto\",\n      top: 65,\n      left: 120,\n      resizable: false,\n      svelte: {\n        class: EffectsUIShell,\n        target: document.body,\n      },\n    });\n  }\n\n  static getActiveApp() {\n    return Object.values(ui.windows).find((app) => {\n      return (\n        app instanceof this && app._state > Application.RENDER_STATES.CLOSED\n      );\n    });\n  }\n\n  static async show(options = {}) {\n    const existingApp = this.getActiveApp();\n    if (existingApp) return existingApp.render(false, { focus: true });\n    return new Promise((resolve) => {\n      options.resolve = resolve;\n      new this(options).render(true, { focus: true });\n    });\n  }\n}\n","import CanvasEffect from \"../canvas-effects/canvas-effect.js\";\nimport { sequencerSocket, SOCKET_HANDLERS } from \"../sockets.js\";\nimport * as lib from \"../lib/lib.js\";\nimport flagManager from \"../utils/flag-manager.js\";\nimport CONSTANTS from \"../constants.js\";\nimport SequenceManager from \"./sequence-manager.js\";\nimport { EffectsUIApp } from \"../formapplications/effects-ui/effects-ui-app.js\";\n\nconst PositionContainer = new Map();\nconst TemporaryPositionsContainer = new Map();\n\nexport default class SequencerEffectManager {\n  /**\n   * Returns all the currently running effects on the canvas\n   *\n   * @returns {Array}\n   */\n  static get effects() {\n    return Array.from(SequenceManager.VisibleEffects.values());\n  }\n\n  static _updatePosition(uuid, position) {\n    TemporaryPositionsContainer.set(uuid, position);\n  }\n\n  static getPositionForUUID(uuid) {\n    return TemporaryPositionsContainer.get(uuid);\n  }\n\n  /**\n   * Opens the Sequencer Manager UI with the effects tab open\n   */\n  static show() {\n    return EffectsUIApp.show({ tab: \"manager\" });\n  }\n\n  /**\n   * Play an effect on the canvas.\n   *\n   * @param {object} data The data that describes the audio to play\n   * @param {boolean} [push=true] A flag indicating whether or not to make other clients play the effect\n   * @returns {CanvasEffect} A CanvasEffect object\n   */\n  static async play(data, push = true) {\n    if (!lib.user_can_do(\"permissions-effect-create\")) {\n      lib.custom_warning(\n        \"Sequencer\",\n        \"EffectManager | play | Players do not have permissions to play effects. This can be configured in Sequencer's module settings.\"\n      );\n      return;\n    }\n    if (push)\n      sequencerSocket.executeForOthers(SOCKET_HANDLERS.PLAY_EFFECT, data);\n    if (data?.persistOptions?.persistTokenPrototype) {\n      this._playPrototypeTokenEffects(data, push);\n    }\n    return this._playEffect(data);\n  }\n\n  /**\n   * Get effects that are playing on the canvas based on a set of filters\n   *\n   * @param {object} inFilter An object containing filters that determine which effects to return\n   *                             - object: An ID or a PlaceableObject\n   *                             - name: The name of the effect\n   *                             - sceneId: the ID of the scene to search within\n   * @returns {Array} An array containing effects that match the given filter\n   */\n  static getEffects(inFilter = {}) {\n    const filters = this._validateFilters(inFilter);\n    if (!inFilter)\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"EffectManager | getEffects | Incorrect or incomplete parameters provided\"\n      );\n    return this._filterEffects(filters);\n  }\n\n  /**\n   * Updates effects based on a set of filters\n   *\n   * @param {object} inFilter An object containing filters that determine which effects to return\n   *                             - object: An ID or a PlaceableObject\n   *                             - name: The name of the effect\n   *                             - sceneId: the ID of the scene to search within\n   *                             - effects: a single CanvasEffect or its ID, or an array of such\n   * @param {object} inUpdates\n   * @returns {promise}\n   */\n  static updateEffects(inFilter, inUpdates) {\n    inFilter = this._validateFilters(inFilter);\n    if (!inFilter)\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"EffectManager | updateEffects | Incorrect or incomplete parameters provided\"\n      );\n\n    CanvasEffect.validateUpdate(inUpdates);\n\n    const effectsToUpdate = this._filterEffects(inFilter).filter(\n      (effect) => effect.userCanUpdate\n    );\n\n    return Promise.allSettled(\n      effectsToUpdate.map((effect) => effect.update(inUpdates))\n    );\n  }\n\n  /**\n   * End effects that are playing on the canvas based on a set of filters\n   *\n   * @param {object} inFilter An object containing filters that determine which effects to end\n   *                             - object: An ID or a PlaceableObject\n   *                             - name: The name of the effect\n   *                             - sceneId: the ID of the scene to search within\n   *                             - effects: a single CanvasEffect or its ID, or an array of such\n   * @param {boolean} [push=true] A flag indicating whether or not to make other clients end the effects\n   * @returns {promise} A promise that resolves when the effects have ended\n   */\n  static async endEffects(inFilter = {}, push = true) {\n    inFilter = this._validateFilters(inFilter);\n    if (!inFilter)\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"EffectManager | endEffects | Incorrect or incomplete parameters provided\"\n      );\n    const effectsToEnd = this._getEffectsByFilter(inFilter);\n    if (!effectsToEnd.length) return;\n    if (push)\n      sequencerSocket.executeForOthers(\n        SOCKET_HANDLERS.END_EFFECTS,\n        effectsToEnd\n      );\n    return this._endManyEffects(effectsToEnd);\n  }\n\n  /**\n   * End all effects that are playing on the canvas\n   *\n   * @param {string} [inSceneId] A parameter which determines which scene to end all effects on, defaults to current viewed scene\n   * @param {boolean} [push=true] A flag indicating whether or not to make other clients end all effects\n   * @returns {promise} A promise that resolves when all of the effects have _ended\n   */\n  static async endAllEffects(inSceneId = game.user.viewedScene, push = true) {\n    const inFilter = this._validateFilters({ sceneId: inSceneId });\n    if (!inFilter)\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"EffectManager | endAllEffects | Incorrect or incomplete parameters provided\"\n      );\n    const effectsToEnd = this._getEffectsByFilter(inFilter);\n    if (!effectsToEnd.length) return;\n    if (push)\n      sequencerSocket.executeForOthers(\n        SOCKET_HANDLERS.END_EFFECTS,\n        effectsToEnd\n      );\n    return this._endManyEffects(effectsToEnd);\n  }\n\n  static _getEffectsByFilter(inFilter) {\n    return lib.make_array_unique(\n      this._filterEffects(inFilter)\n        .filter((effect) => effect.userCanDelete)\n        .map((effect) => {\n          return effect.data?.persistOptions?.persistTokenPrototype\n            ? effect.data?.persistOptions?.id ?? effect.id\n            : effect.id;\n        })\n    );\n  }\n\n  /**\n   * If an effect has been named its position will be cached, which can be retrieved with this method\n   *\n   * @param {string} inName\n   * @returns {object|boolean}\n   * @private\n   */\n  static getEffectPositionByName(inName) {\n    if (!(typeof inName === \"string\"))\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"EffectManager | getEffectPositionByName | inName must be of type string\"\n      );\n    return PositionContainer.get(inName) ?? false;\n  }\n\n  /**\n   * Filters the existing effects based on the given filter\n   *\n   * @param inFilter\n   * @returns {array}\n   * @private\n   */\n  static _filterEffects(inFilter) {\n    if (inFilter.name) {\n      inFilter.name = new RegExp(\n        \"^\" + lib.str_to_search_regex_str(lib.safe_str(inFilter.name)) + \"$\",\n        \"gu\"\n      );\n    }\n    let effects = this.effects;\n    if (inFilter.sceneId && inFilter.sceneId !== canvas.scene.id) {\n      effects = lib\n        .get_all_documents_from_scene(inFilter.sceneId)\n        .map((doc) => {\n          return foundry.utils.getProperty(doc, CONSTANTS.EFFECTS_FLAG);\n        })\n        .filter((flags) => !!flags)\n        .map((flags) => {\n          return flags.map((flag) => CanvasEffect.make(flag[1]));\n        })\n        .deepFlatten();\n    }\n    return effects.filter((effect) => {\n      return (\n        (!inFilter.effects || inFilter.effects.includes(effect.id)) &&\n        (!inFilter.name ||\n          (effect.data.name &&\n            effect.data.name.match(inFilter.name)?.length)) &&\n        (!inFilter.source || inFilter.source === effect.data.source) &&\n        (!inFilter.target || inFilter.target === effect.data.target) &&\n        (!inFilter.origin || inFilter.origin === effect.data.origin)\n      );\n    });\n  }\n\n  /**\n   * Validates an object actually exists, and gets its UUID\n   *\n   * @param object\n   * @param sceneId\n   * @returns {string}\n   * @private\n   */\n  static _validateObject(object, sceneId) {\n    if (\n      !(\n        object instanceof foundry.abstract.Document ||\n        object instanceof PlaceableObject ||\n        typeof object === \"string\"\n      )\n    ) {\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"EffectManager | object must be instance of PlaceableObject or of type string\"\n      );\n    } else if (\n      object instanceof PlaceableObject ||\n      object instanceof foundry.abstract.Document\n    ) {\n      object = lib.get_object_identifier(object?.document ?? object);\n    } else if (typeof object === \"string\") {\n      const actualObject = lib.get_object_from_scene(object, sceneId);\n      if (!actualObject) {\n        throw lib.custom_error(\n          \"Sequencer\",\n          `EffectManager | could not find object with ID: ${object}`\n        );\n      }\n      const uuid = lib.get_object_identifier(actualObject);\n      if (!uuid) {\n        throw lib.custom_error(\n          \"Sequencer\",\n          `EffectManager | could could not establish identifier of object with ID: ${object}`\n        );\n      }\n      object = uuid;\n    }\n\n    return object;\n  }\n\n  /**\n   * Validates the filter given to any of the above public methods\n   *\n   * @param inFilter\n   * @returns {boolean}\n   * @private\n   */\n  static _validateFilters(inFilter) {\n    if (inFilter?.sceneId) {\n      if (typeof inFilter.sceneId !== \"string\")\n        throw lib.custom_error(\n          \"Sequencer\",\n          \"EffectManager | inFilter.sceneId must be of type string\"\n        );\n      if (!game.scenes.get(inFilter.sceneId))\n        throw lib.custom_error(\n          \"Sequencer\",\n          \"EffectManager | inFilter.sceneId must be a valid scene id (could not find scene)\"\n        );\n    } else {\n      inFilter.sceneId = game.user.viewedScene;\n    }\n\n    if (inFilter?.object) {\n      inFilter.source = this._validateObject(inFilter.object, inFilter.sceneId);\n      delete inFilter.object;\n    }\n\n    if (inFilter?.source) {\n      inFilter.source = this._validateObject(inFilter.source, inFilter.sceneId);\n    }\n\n    if (inFilter?.target) {\n      inFilter.target = this._validateObject(inFilter.target, inFilter.sceneId);\n    }\n\n    if (inFilter?.name && typeof inFilter?.name !== \"string\")\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"EffectManager | inFilter.name must be of type string\"\n      );\n    if (inFilter?.origin && typeof inFilter?.origin !== \"string\")\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"EffectManager | inFilter.origin must be of type string\"\n      );\n\n    if (inFilter?.effects) {\n      if (!Array.isArray(inFilter.effects))\n        inFilter.effects = [inFilter.effects];\n      inFilter.effects = inFilter.effects.map((effect) => {\n        if (!(typeof effect === \"string\" || effect instanceof CanvasEffect))\n          throw lib.custom_error(\n            \"Sequencer\",\n            \"EffectManager | collections in inFilter.effects must be of type string or CanvasEffect\"\n          );\n        if (effect instanceof CanvasEffect) return effect.id;\n        return effect;\n      });\n    }\n\n    if (\n      !inFilter.name &&\n      !inFilter.origin &&\n      !inFilter.target &&\n      !inFilter.sceneId &&\n      !inFilter.effects &&\n      !inFilter.origin\n    )\n      return false;\n\n    return foundry.utils.mergeObject(\n      {\n        effects: false,\n        name: false,\n        source: false,\n        target: false,\n        sceneId: false,\n        origin: false,\n      },\n      inFilter\n    );\n  }\n\n  /**\n   * Actually plays the effect on the canvas\n   *\n   * @param data\n   * @param setFlags\n   * @returns {Promise<{duration: Promise<number>, promise: Promise<void>}>}\n   * @private\n   */\n  static async _playEffect(data, setFlags = true) {\n    const effect = CanvasEffect.make(data);\n\n    if (\n      data.persist &&\n      setFlags &&\n      effect.context &&\n      effect.owner &&\n      !data.temporary &&\n      !data.remote\n    ) {\n      flagManager.addEffectFlags(effect.context.uuid, effect.data);\n    }\n\n    if (!effect.shouldPlay) return;\n\n    const playData = effect.play();\n\n    SequenceManager.VisibleEffects.add(effect.id, effect);\n    if (effect.data.name) {\n      effect._ticker.add(() => {\n        if (effect.isDestroyed) return;\n        PositionContainer.set(effect.data.name, {\n          start: effect.sourcePosition,\n          end: effect.targetPosition,\n        });\n      });\n    }\n\n    if (data.temporary && effect.owner) {\n      let lastSourcePosition = {};\n      let lastTargetPosition = {};\n      effect._addToTicker(() => {\n        if (effect.source && !effect.isSourceDestroyed) {\n          const sourceData = effect.getSourceData();\n          if (JSON.stringify(sourceData) !== lastSourcePosition) {\n            sequencerSocket.executeForOthers(\n              SOCKET_HANDLERS.UPDATE_EFFECT_POSITION,\n              data.source,\n              sourceData\n            );\n            lastSourcePosition = JSON.stringify(sourceData);\n          }\n        }\n        if (effect.target && !effect.isTargetDestroyed) {\n          const targetData = effect.getTargetData();\n          if (JSON.stringify(targetData) !== lastTargetPosition) {\n            sequencerSocket.executeForOthers(\n              SOCKET_HANDLERS.UPDATE_EFFECT_POSITION,\n              data.target,\n              targetData\n            );\n            lastTargetPosition = JSON.stringify(targetData);\n          }\n        }\n      });\n    }\n\n    if (!data.persist) {\n      playData.promise.then(() => this._removeEffect(effect));\n    }\n\n    return playData;\n  }\n\n  /**\n   * Updates a single effect with the given data\n   *\n   * @param inEffectId\n   * @param inUpdates\n   * @returns {promise|boolean}\n   * @private\n   */\n  static _updateEffect(inEffectId, inUpdates) {\n    const effect = SequenceManager.VisibleEffects.get(inEffectId);\n    if (!effect) return false;\n    return effect._update(inUpdates);\n  }\n\n  /**\n   * Updates a single effect with new animations\n   *\n   * @param inEffectId\n   * @param inAnimations\n   * @param inLoopingAnimations\n   * @returns {promise|boolean}\n   * @private\n   */\n  static _addEffectAnimations(inEffectId, inAnimations, inLoopingAnimations) {\n    const effect = SequenceManager.VisibleEffects.get(inEffectId);\n    if (!effect) return false;\n    return effect._addAnimations(inAnimations, inLoopingAnimations);\n  }\n\n  /**\n   * Sets up persisting effects when the scene is first loaded\n   *\n   * @returns {promise}\n   */\n  static async initializePersistentEffects() {\n    await this.tearDownPersists();\n    const allObjects = lib.get_all_documents_from_scene();\n    allObjects.push(canvas.scene);\n    const docEffectsMap = allObjects.reduce((acc, doc) => {\n      let effects = flagManager.getEffectFlags(doc);\n      effects.forEach((e) => {\n        if (lib.is_UUID(e[1].source) && e[1].source !== doc.uuid) {\n          e[1].delete = true;\n        }\n      });\n      if (doc instanceof TokenDocument && doc?.actorLink) {\n        const actorEffects = flagManager.getEffectFlags(doc?.actor);\n        actorEffects.forEach((e) => {\n          e[1]._id = foundry.utils.randomID();\n          e[1].source = doc.uuid;\n          e[1].sceneId = doc.parent.id;\n        });\n        effects = effects.concat(actorEffects);\n      }\n      if (effects.length) {\n        acc[doc.uuid] = effects;\n      }\n      return acc;\n    }, {});\n    const promises = Object.entries(docEffectsMap)\n      .map(([uuid, effects]) => {\n        return this._playEffectMap(effects, fromUuidSync(uuid));\n      })\n      .flat();\n    return Promise.all(promises).then(() => {\n      Hooks.callAll(\"sequencerEffectManagerReady\");\n    });\n  }\n\n  /**\n   * Tears down persisting effects when the scene is unloaded\n   */\n  static tearDownPersists() {\n    return Promise.allSettled(\n      this.effects.map((effect) => {\n        SequenceManager.VisibleEffects.delete(effect.id);\n        return effect.destroy();\n      })\n    );\n  }\n\n  static setup() {\n    Hooks.on(\"preCreateToken\", this._patchCreationData.bind(this));\n    Hooks.on(\"preCreateDrawing\", this._patchCreationData.bind(this));\n    Hooks.on(\"preCreateTile\", this._patchCreationData.bind(this));\n    Hooks.on(\"preCreateMeasuredTemplate\", this._patchCreationData.bind(this));\n    Hooks.on(\"createToken\", this._documentCreated.bind(this));\n    Hooks.on(\"createDrawing\", this._documentCreated.bind(this));\n    Hooks.on(\"createTile\", this._documentCreated.bind(this));\n    Hooks.on(\"createMeasuredTemplate\", this._documentCreated.bind(this));\n  }\n\n  /**\n   * Patches an object's creation data before it's created so that the effect plays on it correctly\n   *\n   * @param inDocument\n   * @param data\n   * @param options\n   * @returns {*}\n   */\n  static async _patchCreationData(inDocument, data, options) {\n    const effects = flagManager.getEffectFlags(inDocument);\n\n    if (!effects?.length) return;\n\n    const updates = {};\n\n    let documentUuid;\n    if (!inDocument._id) {\n      const documentId = foundry.utils.randomID();\n      documentUuid = inDocument.uuid + documentId;\n      updates[\"_id\"] = documentId;\n      options.keepId = true;\n    } else {\n      documentUuid = inDocument.uuid;\n    }\n\n    updates[CONSTANTS.EFFECTS_FLAG] = this._patchEffectDataForDocument(\n      documentUuid,\n      effects\n    );\n\n    return inDocument.updateSource(updates);\n  }\n\n  static _patchEffectDataForDocument(inDocumentUuid, effects) {\n    return effects.map((effect) => {\n      effect[0] = foundry.utils.randomID();\n      const effectData = effect[1];\n      effectData._id = effect[0];\n      if (lib.is_UUID(effectData.source)) {\n        if (effectData.masks.includes(effectData.source)) {\n          const index = effectData.masks.indexOf(effectData.source);\n          effectData.masks[index] = inDocumentUuid;\n        }\n        effectData.source = inDocumentUuid;\n      }\n      effectData.sceneId = inDocumentUuid.split(\".\")[1];\n      return effect;\n    });\n  }\n\n  /**\n   * Plays the effects of a given document on creation\n   *\n   * @param inDocument\n   * @returns {*}\n   */\n  static async _documentCreated(inDocument) {\n    let effects = flagManager.getEffectFlags(inDocument);\n    if (inDocument instanceof TokenDocument && inDocument?.actorLink) {\n      let actorEffects = flagManager.getEffectFlags(inDocument.actor);\n      if (actorEffects.length) {\n        actorEffects = this._patchEffectDataForDocument(\n          inDocument.uuid,\n          actorEffects\n        );\n      }\n      effects = effects.concat(actorEffects);\n    }\n    if (!effects?.length) return;\n    return this._playEffectMap(effects, inDocument);\n  }\n\n  /**\n   * Plays multiple effects at the same time\n   *\n   * @param inEffects\n   * @param inDocument\n   * @returns {Promise<{duration: Promise<number>, promise: Promise<void>}[]>}\n   * @private\n   */\n  static _playEffectMap(inEffects, inDocument) {\n    if (inEffects instanceof Map) inEffects = Array.from(inEffects);\n    return Promise.all(\n      inEffects.map((effect) => {\n        if (!CanvasEffect.checkValid(effect[1])) {\n          if (!game.user.isGM) return;\n          lib.custom_warning(\n            `Sequencer`,\n            `Removed effect from ${inDocument.uuid} as it no longer had a valid source or target`\n          );\n          return flagManager.removeEffectFlags(inDocument.uuid, effect);\n        }\n        return this._playEffect(effect[1], false)\n          .then((result) => {\n            if (!result) {\n              lib.debug(\"Error playing effect\");\n            }\n          })\n          .catch((err) => {\n            lib.debug(\"Error playing effect:\", err);\n          });\n      })\n    );\n  }\n\n  /**\n   * Ends one or many effects at the same time, returning a promise that resolves once every effect has fully ended\n   *\n   * @param inEffectIds\n   * @returns {Promise}\n   * @private\n   */\n  static async _endManyEffects(inEffectIds = false) {\n    const actorEffectsToEnd = this.effects.filter((effect) => {\n      return (\n        effect.context?.actorLink &&\n        inEffectIds.includes(effect.data?.persistOptions?.id)\n      );\n    });\n    const effectsByActorUuid = Object.values(\n      lib.group_by(actorEffectsToEnd, \"context.actor.uuid\")\n    );\n\n    const regularEffectsToEnd = this.effects.filter((effect) => {\n      return (\n        inEffectIds.includes(effect.id) ||\n        (!effect.context?.actorLink &&\n          inEffectIds.includes(effect.data?.persistOptions?.id))\n      );\n    });\n    const effectsByContextUuid = Object.values(\n      lib.group_by(regularEffectsToEnd, \"context.uuid\")\n    );\n\n    effectsByContextUuid.forEach((effects) => {\n      effects = effects.filter(\n        (effect) => effect.data.persist && !effect.data.temporary\n      );\n      if (!effects.length) return;\n      const effectData = effects.map((effect) => effect.data);\n      flagManager.removeEffectFlags(\n        effects[0].context.uuid,\n        effectData,\n        !inEffectIds\n      );\n    });\n\n    effectsByActorUuid.forEach((effects) => {\n      effects = effects.filter(\n        (effect) => effect.data.persist && !effect.data.temporary\n      );\n      if (!effects.length) return;\n\n      const effectContext = effects[0].context;\n      const effectData = effects.map((effect) => effect.data);\n\n      if (\n        !(\n          effectContext instanceof TokenDocument &&\n          effectContext.actorLink &&\n          effectContext.actor.prototypeToken.actorLink\n        )\n      ) {\n        return;\n      }\n\n      const persistentEffectData = effectData.filter(\n        (data) => data?.persistOptions?.persistTokenPrototype\n      );\n      if (!persistentEffectData.length) return;\n\n      const actorEffects = flagManager.getEffectFlags(effectContext.actor);\n      const applicableActorEffects = actorEffects\n        .filter((effect) => {\n          return (\n            effect[1]?.persistOptions?.persistTokenPrototype &&\n            persistentEffectData.some(\n              (persistentEffect) =>\n                persistentEffect.persistOptions.id ===\n                effect[1]?.persistOptions?.id\n            )\n          );\n        })\n        .map((e) => e[0]);\n\n      flagManager.removeEffectFlags(\n        effectContext.actor.uuid,\n        applicableActorEffects,\n        !inEffectIds\n      );\n    });\n\n    const effectsToEnd = effectsByContextUuid\n      .concat(effectsByActorUuid)\n      .deepFlatten();\n\n    return Promise.allSettled(\n      effectsToEnd.map((effect) => this._removeEffect(effect))\n    );\n  }\n\n  static _effectContextFilter(inUUID, effectData) {\n    return (\n      effectData?.source === inUUID ||\n      effectData?.target === inUUID ||\n      (effectData?.tiedDocuments ?? []).indexOf(inUUID) > -1\n    );\n  }\n\n  /**\n   * Handles the deletion of objects that effects are attached to\n   *\n   * @param inUUID\n   * @returns {Promise}\n   */\n  static objectDeleted(inUUID) {\n    const documentsToCheck = game.scenes\n      .filter((scene) => scene.id !== game.user.viewedScene)\n      .map((scene) => [scene, ...lib.get_all_documents_from_scene(scene.id)])\n      .deepFlatten();\n\n    const documentEffectsToEnd = documentsToCheck\n      .map((obj) => {\n        const objEffects = flagManager.getEffectFlags(obj);\n        const effectsToEnd = objEffects.filter(([effectId, effectData]) =>\n          this._effectContextFilter(inUUID, effectData)\n        );\n        return {\n          document: obj,\n          effects: effectsToEnd.map((effect) => effect[0]),\n        };\n      })\n      .filter((obj) => obj.effects.length);\n\n    const visibleEffectsToEnd = this.effects\n      .filter((effect) => this._effectContextFilter(inUUID, effect.data))\n      .map((e) => e.id);\n\n    return Promise.allSettled([\n      this._endManyEffects(visibleEffectsToEnd),\n      ...documentEffectsToEnd.map((obj) => {\n        return flagManager.removeEffectFlags(obj.document.uuid, obj.effects);\n      }),\n    ]);\n  }\n\n  /**\n   * Removes the effect from the manager and ends it, returning a promise that resolves once the effect has fully _ended\n   *\n   * @param effect\n   * @returns {Promise}\n   * @private\n   */\n  static _removeEffect(effect) {\n    SequenceManager.VisibleEffects.delete(effect.id);\n    TemporaryPositionsContainer.delete(effect.data.source);\n    TemporaryPositionsContainer.delete(effect.data.target);\n    return effect.endEffect();\n  }\n\n  static async _playPrototypeTokenEffects(data, push) {\n    if (!lib.is_UUID(data.source)) return;\n\n    const object = fromUuidSync(data.source);\n\n    if (!(object instanceof TokenDocument)) return;\n\n    const tokenEffectsToPlay = game.scenes\n      .map((scene) =>\n        scene.tokens.filter((token) => {\n          return (\n            token.actorLink && token.actor === object.actor && token !== object\n          );\n        })\n      )\n      .deepFlatten();\n\n    for (const tokenDocument of tokenEffectsToPlay) {\n      const duplicatedData = foundry.utils.deepClone(data);\n      duplicatedData._id = foundry.utils.randomID();\n      duplicatedData.sceneId = tokenDocument.uuid.split(\".\")[1];\n      duplicatedData.masks = duplicatedData.masks\n        .map((uuid) => uuid.replace(duplicatedData.source, tokenDocument.uuid))\n        .filter((uuid) => uuid.includes(duplicatedData.sceneId));\n      duplicatedData.source = tokenDocument.uuid;\n      if (CanvasEffect.checkValid(duplicatedData)) {\n        if (push)\n          sequencerSocket.executeForOthers(\n            SOCKET_HANDLERS.PLAY_EFFECT,\n            duplicatedData\n          );\n        if (duplicatedData.sceneId === game.user.viewedScene) {\n          await this._playEffect(duplicatedData, false);\n        }\n      }\n    }\n  }\n}\n","import {\n  EffectPlayer,\n  InteractionManager,\n  SelectionManager,\n} from \"../modules/sequencer-interaction-manager.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport CONSTANTS from \"../constants.js\";\n\nexport class BaseEffectsLayer extends InteractionLayer {\n  static get layerOptions() {\n    return foundry.utils.mergeObject(super.layerOptions, {\n      elevation: 100000000,\n      name: \"sequencerEffects\",\n    });\n  }\n}\n\nexport class SequencerInterfaceLayer extends InteractionLayer {\n  constructor(...args) {\n    super(...args);\n  }\n\n  static get layerOptions() {\n    return foundry.utils.mergeObject(super.layerOptions, {\n      elevation: 100000000,\n      name: \"sequencerInterfaceEffects\",\n    });\n  }\n\n  deactivate() {\n    super.deactivate();\n    if (!this.active) return;\n    this._clearChildren();\n    this.active = false;\n    InteractionManager.tearDown();\n  }\n\n  _setup() {\n    if (!this.UIContainer || this.UIContainer._destroyed) {\n      this.UIContainer = new PIXI.Container();\n      this.UIContainer.sortableChildren = true;\n      this.UIContainer.parentName = \"sequencerUIContainer\";\n      this.UIContainer.zIndex = 10000000000000;\n      this.addChild(this.UIContainer);\n\n      this.linePoint = this.UIContainer.addChild(new PIXI.Graphics());\n      this.line = this.UIContainer.addChild(new PIXI.Graphics());\n      this.lineHead = this.UIContainer.addChild(new PIXI.Graphics());\n      this.suggestionPoint = this.UIContainer.addChild(new PIXI.Graphics());\n      this.effectHoverBoxes = this.UIContainer.addChild(new PIXI.Graphics());\n      this.effectSelectionBorder = this.UIContainer.addChild(\n        new PIXI.Graphics()\n      );\n      this.effectSourcePosition = this.UIContainer.addChild(\n        new PIXI.Graphics()\n      );\n      this.effectTargetPosition = this.UIContainer.addChild(\n        new PIXI.Graphics()\n      );\n\n      this.suggestionPoint.filters = [new PIXI.filters.AlphaFilter(0.75)];\n      this.effectSourcePosition.filters = [new PIXI.filters.AlphaFilter(0.75)];\n      this.effectTargetPosition.filters = [new PIXI.filters.AlphaFilter(0.75)];\n\n      this.effectSelectionBorder.zIndex = 1;\n\n      this.effectSourcePosition.interactive = true;\n      this.effectSourcePosition.on(\"mousedown\", () => {\n        SelectionManager.sourcePointSelected();\n      });\n\n      this.effectTargetPosition.interactive = true;\n      this.effectTargetPosition.on(\"mousedown\", () => {\n        SelectionManager.targetPointSelected();\n      });\n    }\n  }\n\n  async _draw(...args) {}\n\n  render(...args) {\n    super.render(...args);\n    this._setup();\n    this._clearChildren();\n    this._drawHoveredEffectElements();\n    if (!this.active) return;\n    this._drawLine();\n    this._drawPoints();\n    this._drawSelectedEffectElements();\n    this._drawSuggestionPoint();\n  }\n\n  _clearChildren() {\n    if (!this.UIContainer) return;\n    this.UIContainer.children.forEach((child) => {\n      child.clear();\n    });\n  }\n\n  _drawLine() {\n    if (\n      !EffectPlayer.startPos ||\n      !EffectPlayer.endPos ||\n      game?.activeTool !== \"play-effect\"\n    )\n      return;\n\n    this.line.lineStyle(3, CONSTANTS.COLOR.PRIMARY, 1);\n    // If line already present then set its position only\n    this.line.moveTo(EffectPlayer.startPos.x, EffectPlayer.startPos.y);\n    this.line.lineTo(EffectPlayer.endPos.x, EffectPlayer.endPos.y);\n  }\n\n  _drawPoints() {\n    if (game?.activeTool !== \"play-effect\") return;\n\n    const startPos = EffectPlayer.startPos || EffectPlayer.cursorPos;\n\n    this.linePoint.beginFill(CONSTANTS.COLOR.PRIMARY);\n    this.linePoint.drawCircle(startPos.x, startPos.y, 5);\n\n    if (EffectPlayer.sourceAttachFound) {\n      this._drawCrossAtLocation(this.linePoint, startPos);\n    }\n\n    if (!EffectPlayer.endPos) return;\n\n    const angle = new Ray(startPos, EffectPlayer.endPos).angle;\n\n    this.lineHead.beginFill(CONSTANTS.COLOR.PRIMARY);\n    this.lineHead.moveTo(0, -5);\n    this.lineHead.lineTo(-15, 30);\n    this.lineHead.lineTo(15, 30);\n    this.lineHead.endFill();\n    this.lineHead.rotation = angle + Math.PI / 2;\n    this.lineHead.position.set(EffectPlayer.endPos.x, EffectPlayer.endPos.y);\n\n    if (EffectPlayer.targetAttachFound) {\n      this.linePoint.beginFill(CONSTANTS.COLOR.SECONDARY);\n      this._drawCrossAtLocation(this.linePoint, EffectPlayer.endPos);\n    }\n  }\n\n  _drawHoveredEffectElements() {\n    const effects = new Set(SelectionManager.hoveredEffects);\n    if (SelectionManager.hoveredEffectUI)\n      effects.add(SelectionManager.hoveredEffectUI);\n    for (const effect of effects) {\n      if (\n        !effect ||\n        effect === SelectionManager.selectedEffect ||\n        effect.data.screenSpace ||\n        effect._isEnding\n      )\n        continue;\n      this._drawBoxAroundEffect(this.effectHoverBoxes, effect);\n    }\n  }\n\n  _drawSelectedEffectElements() {\n    if (!SelectionManager.selectedEffect) return;\n    this._drawBoxAroundEffect(\n      this.effectSelectionBorder,\n      SelectionManager.selectedEffect,\n      true\n    );\n    this._drawEffectStartEndPoints(SelectionManager.selectedEffect);\n  }\n\n  _drawBoxAroundEffect(graphic, effect, selected = false) {\n    if (\n      !effect ||\n      effect._destroyed ||\n      !effect.spriteContainer ||\n      !effect.ready\n    )\n      return;\n\n    graphic.lineStyle(3, selected ? CONSTANTS.COLOR.PRIMARY : 0xffffff, 0.9);\n\n    let boundingBox = effect.sprite.getLocalBounds();\n    let dimensions = {\n      x: effect.position.x + boundingBox.x * effect.sprite.scale.x,\n      y: effect.position.y + boundingBox.y * effect.sprite.scale.y,\n      width: boundingBox.width * effect.sprite.scale.x,\n      height: boundingBox.height * effect.sprite.scale.y,\n    };\n\n    if (effect.data.shapes.length) {\n      for (const shape of Object.values(effect.shapes)) {\n        boundingBox = shape.getLocalBounds();\n        dimensions = {\n          x: Math.min(\n            dimensions.x,\n            effect.position.x + boundingBox.x * shape.scale.x\n          ),\n          y: Math.min(\n            dimensions.y,\n            effect.position.y + boundingBox.y * shape.scale.y\n          ),\n          width: Math.max(dimensions.width, boundingBox.width * shape.scale.x),\n          height: Math.max(\n            dimensions.height,\n            boundingBox.height * shape.scale.y\n          ),\n        };\n      }\n    }\n\n    const rotation = Math.normalizeRadians(\n      effect.rotationContainer.rotation +\n        effect.spriteContainer.rotation +\n        effect.sprite.rotation\n    );\n\n    this._drawRectangle(graphic, effect.position, rotation, dimensions);\n  }\n\n  _drawRectangle(graphic, position, rotation, dimensions) {\n    graphic.moveTo(\n      ...canvaslib.rotate_coordinate(\n        position,\n        {\n          x: dimensions.x,\n          y: dimensions.y,\n        },\n        -rotation\n      )\n    );\n\n    graphic.lineTo(\n      ...canvaslib.rotate_coordinate(\n        position,\n        {\n          x: dimensions.x + dimensions.width,\n          y: dimensions.y,\n        },\n        -rotation\n      )\n    );\n\n    graphic.lineTo(\n      ...canvaslib.rotate_coordinate(\n        position,\n        {\n          x: dimensions.x + dimensions.width,\n          y: dimensions.y + dimensions.height,\n        },\n        -rotation\n      )\n    );\n\n    graphic.lineTo(\n      ...canvaslib.rotate_coordinate(\n        position,\n        {\n          x: dimensions.x,\n          y: dimensions.y + dimensions.height,\n        },\n        -rotation\n      )\n    );\n\n    graphic.lineTo(\n      ...canvaslib.rotate_coordinate(\n        position,\n        {\n          x: dimensions.x,\n          y: dimensions.y,\n        },\n        -rotation\n      )\n    );\n\n    graphic.lineTo(\n      ...canvaslib.rotate_coordinate(\n        position,\n        {\n          x: dimensions.x + dimensions.width,\n          y: dimensions.y,\n        },\n        -rotation\n      )\n    );\n  }\n\n  /**\n   * Draws the start/end point circles\n   * @private\n   */\n  _drawEffectStartEndPoints(effect) {\n    if (!effect || effect._destroyed || !effect.spriteContainer) return;\n\n    if (\n      !effect.data.stretchTo ||\n      !effect.sourcePosition ||\n      !effect.targetPosition\n    )\n      return;\n\n    this.effectSourcePosition.beginFill(CONSTANTS.COLOR.PRIMARY);\n    this.effectSourcePosition.drawCircle(\n      effect.sourcePosition.x,\n      effect.sourcePosition.y,\n      canvas.grid.size * 0.25\n    );\n\n    if (typeof effect.data.source === \"string\") {\n      this._drawCrossAtLocation(\n        this.effectSourcePosition,\n        effect.sourcePosition\n      );\n    }\n\n    this.effectTargetPosition.beginFill(CONSTANTS.COLOR.SECONDARY);\n    this.effectTargetPosition.drawCircle(\n      effect.targetPosition.x,\n      effect.targetPosition.y,\n      canvas.grid.size * 0.25\n    );\n    this.effectTargetPosition.alpha = 0.75;\n\n    if (typeof effect.data.target === \"string\") {\n      this._drawCrossAtLocation(\n        this.effectTargetPosition,\n        effect.targetPosition\n      );\n    }\n  }\n\n  _drawSuggestionPoint() {\n    if (\n      !SelectionManager.suggestedProperties ||\n      !SelectionManager.selectedEffect\n    )\n      return;\n\n    const effect = SelectionManager.selectedEffect;\n    const suggestion = SelectionManager.suggestedProperties;\n\n    this.suggestionPoint.position.set(0, 0);\n    this.suggestionPoint.rotation = 0;\n\n    if (effect.data.stretchTo) {\n      this.suggestionPoint.beginFill(suggestion.color);\n      this.suggestionPoint.drawCircle(\n        suggestion.position.x,\n        suggestion.position.y,\n        canvas.grid.size * 0.25\n      );\n      if (suggestion.showCursor) {\n        this._drawCrossAtLocation(this.suggestionPoint, suggestion.position);\n      }\n      return;\n    }\n\n    const boundingBox = effect.spriteContainer.getLocalBounds();\n\n    const dimensions = {\n      x: boundingBox.x * effect.scale.x,\n      y: boundingBox.y * effect.scale.y,\n      width: boundingBox.width * effect.scale.x,\n      height: boundingBox.height * effect.scale.y,\n    };\n\n    this.suggestionPoint.lineStyle(3, CONSTANTS.COLOR.PRIMARY, 0.9);\n    this.suggestionPoint.position.set(\n      suggestion.position.x,\n      suggestion.position.y\n    );\n    this._drawRectangle(\n      this.suggestionPoint,\n      suggestion.position,\n      effect.rotation,\n      dimensions,\n      true\n    );\n\n    if (suggestion.showCursor) {\n      this.suggestionPoint.beginFill(CONSTANTS.COLOR.SECONDARY);\n      this._drawCrossAtLocation(this.suggestionPoint);\n    }\n\n    if (suggestion.showPoint) {\n      this.suggestionPoint.drawCircle(0, 0, canvas.grid.size * 0.2);\n    }\n  }\n\n  _drawCrossAtLocation(inElement, inPosition = { x: 0, y: 0 }) {\n    inElement.drawRect(\n      inPosition.x + canvas.grid.size * -0.05,\n      inPosition.y + canvas.grid.size * -0.5,\n      canvas.grid.size * 0.1,\n      canvas.grid.size\n    );\n    inElement.drawRect(\n      inPosition.x + canvas.grid.size * -0.5,\n      inPosition.y + canvas.grid.size * -0.05,\n      canvas.grid.size,\n      canvas.grid.size * 0.1\n    );\n  }\n}\n\nexport class UIEffectsLayer extends InteractionLayer {\n  static get layerOptions() {\n    return foundry.utils.mergeObject(super.layerOptions, {\n      zIndex: 999999999999999,\n      name: \"sequencerEffectsAboveEverything\",\n    });\n  }\n\n  updateTransform() {\n    if (this.sortableChildren && this.sortDirty) {\n      this.sortChildren();\n    }\n\n    this._boundsID++;\n\n    this.transform.updateTransform(PIXI.Transform.IDENTITY);\n    this.worldAlpha = this.alpha;\n\n    for (let child of this.children) {\n      if (child.visible) {\n        child.updateTransform();\n      }\n    }\n  }\n}\n\nlet layer = false;\n\nexport class SequencerAboveUILayer {\n  constructor(name, zIndex = 0.1) {\n    this.canvas = document.createElement(\"canvas\");\n    this.canvas.id = name;\n\n    this.canvas.style.cssText = `\n            position:absolute;\n            touch-action: none;\n            pointer-events: none;\n            width:100%;\n            height:100%;\n            z-index:${zIndex};\n            padding: 0;\n            margin: 0;\n        `;\n\n    document.body.appendChild(this.canvas);\n\n    this.app = new PIXI.Application({\n      width: window.innerWidth,\n      height: window.innerHeight,\n      view: this.canvas,\n      antialias: true,\n      backgroundAlpha: 0.0,\n      sharedTicker: true,\n    });\n\n    this.app.resizeTo = window;\n    this.app.stage.renderable = false;\n  }\n\n  static setup() {\n    if (!game.settings.get(\"sequencer\", \"enable-above-ui-screenspace\")) return;\n    layer = new this(\"sequencerUILayerAbove\", 10000);\n  }\n\n  static getLayer() {\n    return layer ? layer.app.stage : canvas.uiEffectsLayer;\n  }\n\n  static addChild(...args) {\n    const result = this.getLayer().addChild(...args);\n    layer.app.stage.renderable = layer.app.stage.children.length > 0;\n    return result;\n  }\n\n  static sortChildren() {\n    return this.getLayer().sortChildren();\n  }\n\n  static removeContainerByEffect(inEffect) {\n    const child = this.getLayer().children.find((child) => child === inEffect);\n    if (!child) return;\n    this.getLayer().removeChild(child);\n    layer.app.stage.renderable = layer.app.stage.children.length > 0;\n  }\n\n  updateTransform() {\n    if (this.app.stage.sortableChildren && this.app.stage.sortDirty) {\n      this.app.stage.sortChildren();\n    }\n\n    this.app.stage._boundsID++;\n\n    this.app.stage.transform.updateTransform(PIXI.Transform.IDENTITY);\n    this.app.stage.worldAlpha = this.app.stage.alpha;\n\n    for (let child of this.app.stage.children) {\n      if (child.visible) {\n        child.updateTransform();\n      }\n    }\n  }\n}\n","export default class VisionSamplerShader extends BaseSamplerShader {\n  /** @override */\n  static classPluginName = null;\n\n  /** @inheritdoc */\n  static vertexShader = `\n      precision ${PIXI.settings.PRECISION_VERTEX} float;\n      attribute vec2 aVertexPosition;\n      attribute vec2 aTextureCoord;\n      uniform mat3 projectionMatrix;\n      uniform vec2 screenDimensions;\n      varying vec2 vUvsMask;\n      varying vec2 vUvs;\n      void main() {\n        vUvs = aTextureCoord;\n        vUvsMask = aVertexPosition / screenDimensions;\n        gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n      }\n    `;\n\n  /** @inheritdoc */\n  static fragmentShader = `\n      precision ${PIXI.settings.PRECISION_FRAGMENT} float;\n      varying vec2 vUvs;\n      varying vec2 vUvsMask;\n      uniform vec4 tintAlpha;\n      uniform sampler2D sampler;\n      uniform sampler2D maskSampler;\n      uniform bool enableVisionMasking;\n      void main() {\n        float mask = enableVisionMasking ? texture2D(maskSampler, vUvsMask).r : 1.0;\n        gl_FragColor = texture2D(sampler, vUvs) * tintAlpha * mask;\n      }\n    `;\n\n  /** @inheritdoc */\n  static defaultUniforms = {\n    tintAlpha: [1, 1, 1, 1],\n    sampler: 0,\n    maskSampler: 0,\n    screenDimensions: [1, 1],\n    enableVisionMasking: false,\n  };\n\n  /** @override */\n  _preRender(mesh) {\n    super._preRender(mesh);\n    this.uniforms.maskSampler = canvas.masks.vision.renderTexture;\n    this.uniforms.screenDimensions = canvas.screenDimensions;\n    this.uniforms.enableVisionMasking = canvas.visible;\n  }\n}\n","export default class MaskFilter extends AbstractBaseFilter {\n  /** @override */\n  static fragmentShader = `\\\n        varying vec2 vTextureCoord;\n\n        uniform sampler2D uSampler;\n        uniform sampler2D uMaskSampler;\n\n        void main(void) {\n            gl_FragColor = texture2D(uSampler, vTextureCoord)\n                * texture2D(uMaskSampler, vTextureCoord).a;\n        }`;\n\n  /** @override */\n  static defaultUniforms = { uMaskSampler: null };\n\n  /** @type {DisplayObject[]|null} */\n  masks = [];\n\n  /** @override */\n  apply(filterManager, input, output, clearMode, currentState) {\n    const maskFilterTexture = filterManager.getFilterTexture();\n    const originalFilterTexture = this.#push(\n      filterManager,\n      currentState,\n      maskFilterTexture\n    );\n    const renderer = filterManager.renderer;\n\n    for (const mask of this.masks) {\n      if (mask?.obj?.destroyed) continue;\n      const renderable = mask.renderable;\n      mask.renderable = true;\n      mask.render(renderer);\n      mask.renderable = renderable;\n    }\n\n    renderer.batch.flush();\n\n    this.#pop(filterManager, currentState, originalFilterTexture);\n    this.uniforms.uMaskSampler = maskFilterTexture;\n    filterManager.applyFilter(this, input, output, clearMode);\n    filterManager.returnFilterTexture(maskFilterTexture);\n  }\n\n  #push(filterManager, currentState, maskFilterTexture) {\n    const originalFilterTexture = currentState.renderTexture;\n\n    currentState.renderTexture = maskFilterTexture;\n    filterManager.defaultFilterStack.push(currentState);\n    filterManager.bindAndClear(maskFilterTexture);\n\n    return originalFilterTexture;\n  }\n\n  #pop(filterManager, currentState, originalFilterTexture) {\n    currentState.renderTexture = originalFilterTexture;\n    filterManager.defaultFilterStack.pop();\n\n    if (filterManager.activeState === currentState) {\n      return;\n    }\n\n    filterManager.activeState = currentState;\n\n    const globalUniforms = filterManager.globalUniforms.uniforms;\n\n    globalUniforms.outputFrame = currentState.sourceFrame;\n    globalUniforms.resolution = currentState.resolution;\n\n    const inputSize = globalUniforms.inputSize;\n    const inputPixel = globalUniforms.inputPixel;\n    const inputClamp = globalUniforms.inputClamp;\n\n    inputSize[0] = currentState.destinationFrame.width;\n    inputSize[1] = currentState.destinationFrame.height;\n    inputSize[2] = 1.0 / inputSize[0];\n    inputSize[3] = 1.0 / inputSize[1];\n\n    inputPixel[0] = Math.round(inputSize[0] * currentState.resolution);\n    inputPixel[1] = Math.round(inputSize[1] * currentState.resolution);\n    inputPixel[2] = 1.0 / inputPixel[0];\n    inputPixel[3] = 1.0 / inputPixel[1];\n\n    inputClamp[0] = 0.5 * inputPixel[2];\n    inputClamp[1] = 0.5 * inputPixel[3];\n    inputClamp[2] =\n      currentState.sourceFrame.width * inputSize[2] - 0.5 * inputPixel[2];\n    inputClamp[3] =\n      currentState.sourceFrame.height * inputSize[3] - 0.5 * inputPixel[3];\n\n    if (currentState.legacy) {\n      const filterArea = globalUniforms.filterArea;\n\n      filterArea[0] = currentState.destinationFrame.width;\n      filterArea[1] = currentState.destinationFrame.height;\n      filterArea[2] = currentState.sourceFrame.x;\n      filterArea[3] = currentState.sourceFrame.y;\n\n      globalUniforms.filterClamp = globalUniforms.inputClamp;\n    }\n\n    filterManager.globalUniforms.update();\n  }\n}\n","import CONSTANTS from \"../constants.js\";\nimport filters from \"../lib/filters.js\";\nimport * as lib from \"../lib/lib.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport { SequencerFileBase } from \"../modules/sequencer-file.js\";\nimport SequencerAnimationEngine from \"../modules/sequencer-animation-engine.js\";\nimport SequencerFileCache from \"../modules/sequencer-file-cache.js\";\nimport flagManager from \"../utils/flag-manager.js\";\nimport { sequencerSocket, SOCKET_HANDLERS } from \"../sockets.js\";\nimport SequencerEffectManager from \"../modules/sequencer-effect-manager.js\";\nimport { SequencerAboveUILayer } from \"./effects-layer.js\";\nimport VisionSamplerShader from \"../lib/filters/vision-mask-filter.js\";\nimport MaskFilter from \"../lib/filters/mask-filter.js\";\n\nconst hooksManager = {\n\t_hooks: new Map(),\n\t_hooksRegistered: new Set(),\n\n\taddHook(effectUuid, hookName, callable, callNow = false) {\n\t\tif (!this._hooksRegistered.has(hookName)) {\n\t\t\tlib.debug(\"registering hook for: \" + hookName);\n\t\t\tthis._hooksRegistered.add(hookName);\n\t\t\tHooks.on(hookName, (...args) => {\n\t\t\t\tthis._hookCalled(hookName, ...args);\n\t\t\t});\n\t\t}\n\n\t\tconst key = hookName + \"-\" + effectUuid;\n\n\t\tif (!this._hooks.has(key)) {\n\t\t\tthis._hooks.set(key, []);\n\t\t}\n\n\t\tthis._hooks.get(key).push(callable);\n\n\t\tif (callNow) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tcallable();\n\t\t\t}, 20);\n\t\t}\n\t},\n\n\t_hookCalled(hookName, ...args) {\n\t\tArray.from(this._hooks)\n\t\t\t.filter((entry) => entry[0].startsWith(hookName + \"-\"))\n\t\t\t.map((hooks) => hooks[1])\n\t\t\t.deepFlatten()\n\t\t\t.forEach((callback) => callback(...args));\n\t},\n\n\tremoveHooks(effectUuid) {\n\t\tArray.from(this._hooks)\n\t\t\t.filter((entry) => entry[0].endsWith(\"-\" + effectUuid))\n\t\t\t.forEach((entry) => this._hooks.delete(entry[0]));\n\t},\n};\n\nconst SyncGroups = {\n\ttimes: new Map(),\n\teffectIds: new Map(),\n\n\tget(effect) {\n\t\tconst fullName = effect.data.sceneId + \"-\" + effect.data.syncGroup;\n\t\tconst effectIds = new Set(this.effectIds.get(fullName));\n\t\tif (effectIds && !effectIds.has(effect.id)) {\n\t\t\teffectIds.add(effect.id);\n\t\t\tthis.effectIds.set(fullName, Array.from(effectIds));\n\t\t}\n\t\treturn this.times.get(fullName);\n\t},\n\n\tset(effect) {\n\t\tconst fullName = effect.data.sceneId + \"-\" + effect.data.syncGroup;\n\t\tthis.times.set(fullName, effect.data.creationTimestamp);\n\t\tthis.effectIds.set(fullName, [effect.id]);\n\t},\n\n\tremove(effect) {\n\t\tconst fullName = effect.data.sceneId + \"-\" + effect.data.syncGroup;\n\t\tconst effectIds = new Set(this.effectIds.get(fullName));\n\t\teffectIds.delete(effect.id);\n\t\tif (effectIds.size) {\n\t\t\tthis.effectIds.set(fullName, Array.from(effectIds));\n\t\t} else {\n\t\t\tthis.effectIds.delete(fullName);\n\t\t\tthis.times.delete(fullName);\n\t\t}\n\t}\n};\n\nexport default class CanvasEffect extends PIXI.Container {\n\t#elevation = 0;\n\t#sort = 0;\n\t#sortLayer = 800\n\n\tconstructor(inData) {\n\t\tsuper();\n\n\t\tthis.sortableChildren = true;\n\t\tthis.interactiveChildren = false;\n\n\t\t// Set default values\n\t\tthis.actualCreationTime = +new Date();\n\t\tthis.data = inData;\n\n\t\tthis._resolve = null;\n\t\tthis._durationResolve = null;\n\n\t\tthis.ready = false;\n\t\tthis._ended = false;\n\t\tthis._isEnding = false;\n\n\t\tthis._cachedSourceData = {};\n\t\tthis._cachedTargetData = {};\n\n\t\tthis.uuid = false;\n\n\t}\n\n\tstatic get protectedValues() {\n\t\treturn [\n\t\t\t\"_id\",\n\t\t\t\"sequenceId\",\n\t\t\t\"creationTimestamp\",\n\t\t\t\"creatorUserId\",\n\t\t\t\"moduleName\",\n\t\t\t\"index\",\n\t\t\t\"repetition\",\n\t\t\t\"moves\",\n\t\t\t\"fadeIn\",\n\t\t\t\"fadeOut\",\n\t\t\t\"scaleIn\",\n\t\t\t\"scaleOut\",\n\t\t\t\"rotateIn\",\n\t\t\t\"rotateOut\",\n\t\t\t\"fadeInAudio\",\n\t\t\t\"fadeOutAudio\",\n\t\t\t\"animations\",\n\t\t\t\"nameOffsetMap\",\n\t\t\t\"persist\",\n\t\t];\n\t}\n\n\t/** @type {number} */\n\tget elevation() {\n\t\treturn this.#elevation;\n\t}\n\n\tset elevation(value) {\n\t\tthis.#elevation = value;\n\t}\n\n\t/** @type {number} */\n\tget sort() {\n\t\treturn this.#sort;\n\t}\n\n\tset sort(value) {\n\t\tthis.#sort = value;\n\t}\n\n\t/** @type {number} */\n\tget sortLayer() {\n\t\treturn this.#sortLayer;\n\t}\n\n\tset sortLayer(value) {\n\t\tthis.#sortLayer = value;\n\t}\n\n\tget context() {\n\t\treturn this.data.attachTo?.active && this.sourceDocument\n\t\t\t? this.sourceDocument\n\t\t\t: game.scenes.get(this.data.sceneId);\n\t}\n\n\tget isIsometricActive() {\n\t\tconst sceneIsIsometric = foundry.utils.getProperty(\n\t\t\tgame.scenes.get(this.data.sceneId),\n\t\t\tCONSTANTS.INTEGRATIONS.ISOMETRIC.SCENE_ENABLED\n\t\t);\n\t\treturn CONSTANTS.INTEGRATIONS.ISOMETRIC.ACTIVE && sceneIsIsometric;\n\t}\n\n\tget creationTimestamp() {\n\t\tif (this.data.syncGroup) {\n\t\t\tconst time = SyncGroups.get(this);\n\t\t\tif (time) return time;\n\t\t\tSyncGroups.set(this)\n\t\t}\n\t\treturn this.data.creationTimestamp;\n\t}\n\n\t/**\n\t * The ID of the effect\n\t *\n\t * @returns {string}\n\t */\n\tget id() {\n\t\treturn this.data._id;\n\t}\n\n\t/**\n\t * Whether this effect is destroyed or is in the process of being destroyed\n\t */\n\tget isDestroyed() {\n\t\treturn (\n\t\t\tthis.destroyed ||\n\t\t\t(this.source && this.isSourceDestroyed) ||\n\t\t\t(this.target && this.isTargetDestroyed)\n\t\t);\n\t}\n\n\t/**\n\t * Whether the source of this effect is temporary\n\t *\n\t * @returns {boolean}\n\t */\n\tget isSourceTemporary() {\n\t\treturn (\n\t\t\tthis.data.attachTo?.active &&\n\t\t\tthis.sourceDocument &&\n\t\t\t!lib.is_UUID(this.sourceDocument?.uuid)\n\t\t);\n\t}\n\n\t/**\n\t * Whether the source of this effect has been destroyed\n\t *\n\t * @returns {boolean}\n\t */\n\tget isSourceDestroyed() {\n\t\treturn (\n\t\t\tthis.source && this.source?.destroyed && (!this.sourceDocument?.object || this.sourceDocument?.object?.destroyed || this.source.constructor.name === \"Crosshairs\")\n\t\t);\n\t}\n\n\t/**\n\t * Whether the target of this effect is temporary\n\t *\n\t * @returns {boolean}\n\t */\n\tget isTargetTemporary() {\n\t\treturn (\n\t\t\t(this.data.stretchTo?.attachTo || this.data.rotateTowards?.attachTo) &&\n\t\t\tthis.targetDocument &&\n\t\t\t!lib.is_UUID(this.targetDocument.uuid)\n\t\t);\n\t}\n\n\t/**\n\t * Whether the target of this effect has been destroyed\n\t *\n\t * @returns {boolean}\n\t */\n\tget isTargetDestroyed() {\n\t\treturn (\n\t\t\tthis.target && this.target?.destroyed && (!this.targetDocument?.object || this.targetDocument?.object?.destroyed || this.target.constructor.name === \"Crosshairs\")\n\t\t);\n\t}\n\n\t/**\n\t * The source object (or source location) of the effect\n\t *\n\t * @returns {boolean|object}\n\t */\n\tget source() {\n\t\tif (!this._source && this.data.source) {\n\t\t\tthis._source = this._getObjectByID(this.data.source?.uuid ?? this.data.source);\n\t\t\tthis._source = this._source?._object ?? this._source;\n\t\t}\n\t\treturn this._source;\n\t}\n\n\t/**\n\t * Retrieves the source document\n\t *\n\t * @returns {Document|PlaceableObject}\n\t */\n\tget sourceDocument() {\n\t\treturn this.source?.document ?? this.source;\n\t}\n\n\t/**\n\t * Retrieves the PIXI object for the source object\n\t *\n\t * @returns {*|PIXI.Sprite|TileHUD<Application.Options>}\n\t */\n\tget sourceMesh() {\n\t\treturn this.source?.mesh ?? this.source?.template;\n\t}\n\n\t/**\n\t * The source position with the relevant offsets calculated\n\t *\n\t * @returns {{x: number, y: number}}\n\t */\n\tget sourcePosition() {\n\t\tlet position = this.getSourceData().position;\n\t\tlet offset = this._getOffset(this.data.source, true);\n\n\t\treturn {\n\t\t\tx: position.x - offset.x,\n\t\t\ty: position.y - offset.y,\n\t\t};\n\t}\n\n\t/**\n\t * The target object (or target location) of the effect\n\t *\n\t * @returns {boolean|object}\n\t */\n\tget target() {\n\t\tif (!this._target && this.data.target) {\n\t\t\tthis._target = this._getObjectByID(this.data.target?.uuid ?? this.data.target);\n\t\t\tthis._target = this._target?._object ?? this._target;\n\t\t}\n\t\treturn this._target;\n\t}\n\n\t/**\n\t * Retrieves the document of the target\n\t *\n\t * @returns {Document|PlaceableObject}\n\t */\n\tget targetDocument() {\n\t\treturn this.target?.document ?? this.target;\n\t}\n\n\t/**\n\t * Retrieves the PIXI object for the target object\n\t *\n\t * @returns {*|PIXI.Sprite|TileHUD<Application.Options>}\n\t */\n\tget targetMesh() {\n\t\treturn this.target?.mesh ?? this.target?.template;\n\t}\n\n\t/**\n\t * The target position with the relevant offsets calculated\n\t *\n\t * @returns {{x: number, y: number}}\n\t */\n\tget targetPosition() {\n\t\tconst position = this.getTargetData().position;\n\t\tconst offset = this._getOffset(this.data.target);\n\n\t\treturn {\n\t\t\tx: position.x - offset.x,\n\t\t\ty: position.y - offset.y,\n\t\t};\n\t}\n\n\t/**\n\t * Returns this effect's world position\n\t *\n\t * @returns {{x: number, y: number}}\n\t */\n\tget worldPosition() {\n\t\tconst t = canvas.stage.worldTransform;\n\t\treturn {\n\t\t\tx: (this.sprite.worldTransform.tx - t.tx) / canvas.stage.scale.x,\n\t\t\ty: (this.sprite.worldTransform.ty - t.ty) / canvas.stage.scale.y,\n\t\t};\n\t}\n\n\t/**\n\t * Whether the current user is the owner of this effect\n\t *\n\t * @returns {boolean}\n\t */\n\tget owner() {\n\t\treturn this.data.creatorUserId === game.user.id;\n\t}\n\n\tget loopDelay() {\n\t\treturn (this.data.loopOptions?.loopDelay ?? 0);\n\t}\n\n\tget loops() {\n\t\treturn (this.data.loopOptions?.loops ?? 0);\n\t}\n\n\t/**\n\t * Whether the current user can update this effect\n\t *\n\t * @returns {boolean}\n\t */\n\tget userCanUpdate() {\n\t\treturn (\n\t\t\tgame.user.isGM ||\n\t\t\tthis.owner ||\n\t\t\t(this.data.attachTo?.active &&\n\t\t\t\tthis.sourceDocument.canUserModify(game.user, \"update\"))\n\t\t);\n\t}\n\n\t/**\n\t * Whether the current user can delete this effect\n\t *\n\t * @returns {boolean}\n\t */\n\tget userCanDelete() {\n\t\treturn this.userCanUpdate || lib.user_can_do(\"permissions-effect-delete\");\n\t}\n\n\t/**\n\t * Whether this effect is on the current scene\n\t *\n\t * @returns {boolean}\n\t */\n\tget onCurrentScene() {\n\t\treturn this.data.sceneId === game.user.viewedScene;\n\t}\n\n\t/**\n\t * Whether this effect should be shown as faded or not - effects created by users for other users should be shown\n\t * for all\n\t *\n\t * @returns {boolean}\n\t */\n\tget shouldShowFadedVersion() {\n\t\t// If the user has not set the opacity user-specific effects to 0\n\t\t// And it is not an effect that is only played for the user who created the effect\n\t\t// And if the effect is going to be played for a subset of users\n\t\t// And the users does not contain this user\n\t\treturn (\n\t\t\tthis.data.users &&\n\t\t\tthis.data.users.length &&\n\t\t\t!(\n\t\t\t\tthis.data.users.length === 1 &&\n\t\t\t\tthis.data.users.includes(this.data.creatorUserId)\n\t\t\t) &&\n\t\t\t!this.data.users.includes(game.userId)\n\t\t);\n\t}\n\n\t/**\n\t * Getter for the current playing video of the effect\n\t *\n\t * @returns {null|*}\n\t */\n\tget video() {\n\t\treturn this._video;\n\t}\n\n\t/**\n\t * Setter for the current playing video of the effect\n\t */\n\tset video(inVideo) {\n\t\tif (!inVideo) return;\n\n\t\tinVideo.playbackRate = this.data.playbackRate\n\t\t\t? this.data.playbackRate\n\t\t\t: 1.0;\n\t\tinVideo.muted = !this.data.volume;\n\t\tinVideo.volume =\n\t\t\t(this.data.volume ?? 0) *\n\t\t\tgame.settings.get(\"core\", \"globalInterfaceVolume\");\n\n\t\tif (!this._video) {\n\t\t\tthis._video = inVideo;\n\t\t\treturn;\n\t\t}\n\n\t\tconst isLooping = this._video?.loop;\n\t\tconst currentTime = this._video.currentTime;\n\n\t\tthis._video = inVideo;\n\n\t\tthis._video.currentTime = Math.min(currentTime, this._video.duration);\n\t\tthis._video.loop = isLooping;\n\n\t\tthis.updateTexture();\n\t}\n\n\tasync playMedia() {\n\t\tif (this.animatedSprite) {\n\t\t\tawait this.sprite.play();\n\t\t} else if (this.video) {\n\t\t\ttry {\n\t\t\t\tawait this.video.play().then(() => {\n\t\t\t\t\tthis.updateTexture();\n\t\t\t\t});\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t}\n\t\tthis._setupTimestampHook(this.mediaCurrentTime * 1000);\n\t}\n\n\tupdateTexture() {\n\t\tif (this.texture.valid) {\n\t\t\tthis.texture.update();\n\t\t}\n\t}\n\n\tasync pauseMedia() {\n\t\tif (this.animatedSprite) {\n\t\t\treturn this.sprite.stop();\n\t\t} else if (this.video) {\n\t\t\treturn this.video.pause();\n\t\t}\n\t}\n\n\tget mediaLooping() {\n\t\tif (this.animatedSprite) {\n\t\t\treturn this.sprite.loop;\n\t\t}\n\t\treturn this.video?.loop ?? false;\n\t}\n\n\tset mediaLooping(looping) {\n\t\tif (this.animatedSprite) {\n\t\t\tthis.sprite.loop = looping;\n\t\t\treturn;\n\t\t}\n\t\tif (this.video) {\n\t\t\tthis.video.loop = looping;\n\t\t}\n\t}\n\n\tget mediaIsPlaying() {\n\t\tif (this.animatedSprite) {\n\t\t\treturn this.sprite.playing;\n\t\t}\n\t\treturn this.video;\n\t}\n\n\tget mediaCurrentTime() {\n\t\tif (this.animatedSprite) {\n\t\t\treturn (\n\t\t\t\t(this.sprite.currentFrame / this.sprite.totalFrames) *\n\t\t\t\t(this.sprite.totalFrames / 24)\n\t\t\t);\n\t\t}\n\t\treturn this.video?.currentTime ?? null;\n\t}\n\n\tget mediaPlaybackRate() {\n\t\tif (this.animatedSprite) {\n\t\t\treturn this.sprite.animationSpeed;\n\t\t} else if (this.video) {\n\t\t\treturn this.video.playbackRate;\n\t\t}\n\t}\n\n\tset mediaPlaybackRate(inPlaybackRate) {\n\t\tif (this.animatedSprite) {\n\t\t\tthis.sprite.animationSpeed = 0.4 * inPlaybackRate;\n\t\t} else if (this.video) {\n\t\t\tthis.video.playbackRate = inPlaybackRate;\n\t\t}\n\t}\n\n\tset mediaCurrentTime(newTime) {\n\t\tif (this.animatedSprite) {\n\t\t\tconst newFrame = Math.floor(newTime * this.sprite.totalFrames);\n\t\t\tconst clampedFrame = Math.max(\n\t\t\t\t0,\n\t\t\t\tMath.min(newFrame, this.sprite.totalFrames)\n\t\t\t);\n\t\t\tif (this.mediaIsPlaying) {\n\t\t\t\tthis.sprite.gotoAndPlay(clampedFrame);\n\t\t\t} else {\n\t\t\t\tthis.sprite.gotoAndStop(clampedFrame);\n\t\t\t}\n\t\t} else if (this.video) {\n\t\t\tthis.video.currentTime = newTime;\n\t\t}\n\t}\n\n\tget mediaDuration() {\n\t\tif (this.animatedSprite) {\n\t\t\treturn (\n\t\t\t\tthis.sprite.totalFrames /\n\t\t\t\tthis.sprite.animationSpeed /\n\t\t\t\tPIXI.Ticker.shared.FPS\n\t\t\t);\n\t\t} else if (this.video) {\n\t\t\treturn this.video?.duration / this.mediaPlaybackRate;\n\t\t}\n\t\treturn 1;\n\t}\n\n\tget mediaDurationMs(){\n\t\treturn this.mediaDuration * 1000;\n\t}\n\n\tget hasAnimatedMedia() {\n\t\treturn !!(this.video || this.animatedSprite);\n\t}\n\n\t/**\n\t * The template of the effect, determining the effect's internal grid size, and start/end padding\n\t *\n\t * @returns {object}\n\t */\n\tget template() {\n\t\treturn foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tgridSize: 100,\n\t\t\t\tstartPoint: 0,\n\t\t\t\tendPoint: 0,\n\t\t\t},\n\t\t\tthis._template ?? {}\n\t\t);\n\t}\n\n\t/**\n\t * The grid size difference between the internal effect's grid vs the grid on the canvas. If the effect is in screen space, we ignore this.\n\t *\n\t * @returns {number}\n\t */\n\tget gridSizeDifference() {\n\t\treturn canvas.grid.size / this.template.gridSize;\n\t}\n\n\t/**\n\t * Whether the effect should be flipped on any given axis\n\t *\n\t * @returns {number}\n\t */\n\tget flipX() {\n\t\treturn this.data.flipX ? -1 : 1;\n\t}\n\n\tget flipY() {\n\t\treturn this.data.flipY ? -1 : 1;\n\t}\n\n\t/**\n\t * Whether this effect should play at all, depending on a multitude of factors\n\t *\n\t * @returns {boolean}\n\t */\n\tget shouldPlay() {\n\t\treturn (\n\t\t\t(game.user.viewedScene === this.data.sceneId ||\n\t\t\t\tthis.data.creatorUserId === game.userId) &&\n\t\t\t(game.user.isGM ||\n\t\t\t\t!this.data.users ||\n\t\t\t\tthis.data.users.length === 0 ||\n\t\t\t\tthis.data.users.includes(game.userId))\n\t\t);\n\t}\n\n\tget shouldPlayVisible() {\n\t\tlet playVisible =\n\t\t\tthis.shouldPlay &&\n\t\t\tgame.settings.get(\"sequencer\", \"effectsEnabled\") &&\n\t\t\tgame.user.viewedScene === this.data.sceneId;\n\n\t\tif (game.settings.get(\"core\", \"photosensitiveMode\")) {\n\t\t\tplayVisible = false;\n\t\t\tlib.throttled_custom_warning(\n\t\t\t\tthis.data.moduleName,\n\t\t\t\t\"Photosensitive Mode is turned on, so Sequencer's visual effects aren't being rendered\"\n\t\t\t);\n\t\t}\n\n\t\treturn playVisible;\n\t}\n\n\tstatic make(inData) {\n\t\treturn !inData.persist\n\t\t\t? new CanvasEffect(inData)\n\t\t\t: new PersistentCanvasEffect(inData);\n\t}\n\n\tstatic checkValid(effectData) {\n\t\tif (effectData.delete) {\n\t\t\treturn false;\n\t\t}\n\t\tlet sourceExists = true;\n\t\tlet targetExists = true;\n\t\tif (effectData.source && lib.is_UUID(effectData.source)) {\n\t\t\tsourceExists = fromUuidSync(effectData.source);\n\t\t}\n\t\tif (effectData.target && lib.is_UUID(effectData.target)) {\n\t\t\ttargetExists = fromUuidSync(effectData.target);\n\t\t}\n\t\tfor (let tiedDocumentUuid of effectData?.tiedDocuments ?? []) {\n\t\t\tif (tiedDocumentUuid && lib.is_UUID(tiedDocumentUuid)) {\n\t\t\t\tlet tiedDocumentExists = fromUuidSync(tiedDocumentUuid);\n\t\t\t\tif (!tiedDocumentExists) return false;\n\t\t\t}\n\t\t}\n\t\tif (\n\t\t\teffectData.source &&\n\t\t\tlib.is_UUID(effectData.source) &&\n\t\t\teffectData.target &&\n\t\t\tlib.is_UUID(effectData.target)\n\t\t) {\n\t\t\tconst sourceScene = effectData.source.split(\".\")[1];\n\t\t\tconst targetScene = effectData.target.split(\".\")[1];\n\t\t\tif (sourceScene !== targetScene || sourceScene !== effectData.sceneId)\n\t\t\t\treturn false;\n\t\t}\n\t\treturn sourceExists && targetExists;\n\t}\n\n\t/**\n\t * Validates that the update contains the appropriate data\n\t *\n\t * @param inUpdates\n\t */\n\tstatic validateUpdate(inUpdates) {\n\t\tconst updateKeys = Object.keys(inUpdates);\n\t\tconst protectedValues = updateKeys.filter((key) =>\n\t\t\tCanvasEffect.protectedValues.includes(key)\n\t\t);\n\t\tif (protectedValues.length) {\n\t\t\tthrow lib.custom_error(\n\t\t\t\t\"Sequencer\",\n\t\t\t\t`CanvasEffect | update | You cannot update the following keys of an effect's data: ${protectedValues.join(\n\t\t\t\t\t\"\\n - \"\n\t\t\t\t)}`\n\t\t\t);\n\t\t}\n\t\tif (updateKeys.includes(\"source\")) {\n\t\t\tif (\n\t\t\t\t!(\n\t\t\t\t\tlib.is_UUID(inUpdates.source) ||\n\t\t\t\t\tcanvaslib.is_object_canvas_data(inUpdates.source)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\t\"Sequencer\",\n\t\t\t\t\t`CanvasEffect | update | source must be of type document UUID or object with X and Y coordinates`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tif (updateKeys.includes(\"target\")) {\n\t\t\tif (\n\t\t\t\t!(\n\t\t\t\t\tlib.is_UUID(inUpdates.target) ||\n\t\t\t\t\tcanvaslib.is_object_canvas_data(inUpdates.target)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\t\"Sequencer\",\n\t\t\t\t\t`CanvasEffect | update | target must be of type document UUID or object with X and Y coordinates`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHook(type, uuid) {\n\t\tif (!lib.is_UUID(uuid)) return false;\n\t\tconst parts = uuid.split(\".\");\n\t\treturn type + parts[parts.length - 2];\n\t}\n\n\t/**\n\t * Gets the source hook name\n\t *\n\t * @param {string} type\n\t * @returns {string|boolean}\n\t */\n\tgetSourceHook(type = \"\") {\n\t\treturn this.getHook(type, this.data.source);\n\t}\n\n\t/**\n\t * The source object's current position, or its current position\n\t *\n\t * @returns {boolean|object}\n\t */\n\tgetSourceData() {\n\t\tif (this.data.temporary && !this.owner) {\n\t\t\treturn SequencerEffectManager.getPositionForUUID(this.data.source);\n\t\t}\n\n\t\tconst position =\n\t\t\tthis.source instanceof PlaceableObject && !this.isSourceTemporary\n\t\t\t\t? canvaslib.get_object_position(this.source)\n\t\t\t\t: this.source?.worldPosition || this.source?.center || this.source;\n\n\t\tconst { width, height } = canvaslib.get_object_dimensions(this.source);\n\n\t\tif (this.isIsometricActive && this.source instanceof PlaceableObject) {\n\t\t\tposition.x +=\n\t\t\t\t((this.sourceDocument.elevation ?? 0) / canvas.scene.grid.distance) *\n\t\t\t\tcanvas.grid.size;\n\t\t\tposition.y -=\n\t\t\t\t((this.sourceDocument.elevation ?? 0) / canvas.scene.grid.distance) *\n\t\t\t\tcanvas.grid.size;\n\t\t\tif (\n\t\t\t\tthis.data.isometric?.overlay ||\n\t\t\t\tthis.target instanceof PlaceableObject\n\t\t\t) {\n\t\t\t\tposition.x += (this.source?.height ?? height) / 2;\n\t\t\t\tposition.y -= (this.source?.height ?? height) / 2;\n\t\t\t}\n\t\t}\n\n\t\tif (position !== undefined) {\n\t\t\tthis._cachedSourceData.position = position;\n\t\t}\n\n\t\tif (width !== undefined && height !== undefined) {\n\t\t\tthis._cachedSourceData.width = width;\n\t\t\tthis._cachedSourceData.height = height;\n\t\t}\n\n\t\tlet rotation = 0;\n\t\tif (\n\t\t\tthis.source instanceof MeasuredTemplate &&\n\t\t\tthis.sourceDocument?.t !== \"rect\"\n\t\t) {\n\t\t\trotation = Math.normalizeRadians(\n\t\t\t\tMath.toRadians(this.sourceDocument?.direction)\n\t\t\t);\n\t\t} else if (!(this.source instanceof MeasuredTemplate)) {\n\t\t\trotation = this.sourceDocument?.rotation\n\t\t\t\t? Math.normalizeRadians(Math.toRadians(this.sourceDocument?.rotation))\n\t\t\t\t: 0;\n\t\t}\n\n\t\tif (rotation !== undefined) {\n\t\t\tthis._cachedSourceData.rotation = rotation;\n\t\t}\n\n\t\tconst alpha =\n\t\t\tthis.sourceDocument instanceof TokenDocument || this.sourceDocument instanceof TileDocument\n\t\t\t\t? this.sourceDocument?._source?.alpha ?? 1.0\n\t\t\t\t: 1.0;\n\n\t\tif (alpha !== undefined) {\n\t\t\tthis._cachedSourceData.alpha = alpha;\n\t\t}\n\n\t\treturn {\n\t\t\t...this._cachedSourceData,\n\t\t};\n\t}\n\n\t/**\n\t * Gets the target hook name\n\t *\n\t * @param {string} type\n\t * @returns {string|boolean}\n\t */\n\tgetTargetHook(type = \"\") {\n\t\treturn this.getHook(type, this.data.target);\n\t}\n\n\t/**\n\t * The target object's current position, or its current position\n\t *\n\t * @returns {boolean|object}\n\t */\n\tgetTargetData() {\n\t\tif (this.data.temporary && !this.owner) {\n\t\t\treturn (\n\t\t\t\tSequencerEffectManager.getPositionForUUID(this.data.target) ??\n\t\t\t\tthis.getSourceData()\n\t\t\t);\n\t\t}\n\n\t\tconst position =\n\t\t\tthis.target instanceof PlaceableObject && !this.isTargetTemporary\n\t\t\t\t? canvaslib.get_object_position(this.target, { measure: true })\n\t\t\t\t: this.target?.worldPosition || this.target?.center || this.target;\n\n\t\tconst { width, height } = canvaslib.get_object_dimensions(this.target);\n\n\t\tif (this.isIsometricActive && this.target instanceof PlaceableObject) {\n\t\t\tconst targetHeight = (this.target?.height ?? height) / 2;\n\t\t\tposition.x +=\n\t\t\t\t((this.targetDocument.elevation ?? 0) / canvas.scene.grid.distance) *\n\t\t\t\tcanvas.grid.size +\n\t\t\t\ttargetHeight;\n\t\t\tposition.y -=\n\t\t\t\t((this.targetDocument.elevation ?? 0) / canvas.scene.grid.distance) *\n\t\t\t\tcanvas.grid.size +\n\t\t\t\ttargetHeight;\n\t\t}\n\n\t\tif (width !== undefined && height !== undefined) {\n\t\t\tthis._cachedTargetData.width = width;\n\t\t\tthis._cachedTargetData.height = height;\n\t\t}\n\n\t\tif (position !== undefined) {\n\t\t\tthis._cachedTargetData.position = position;\n\t\t}\n\n\t\tlet rotation = 0;\n\t\tif (\n\t\t\tthis.target instanceof MeasuredTemplate &&\n\t\t\tthis.targetDocument?.t !== \"rect\"\n\t\t) {\n\t\t\trotation = Math.normalizeRadians(\n\t\t\t\tMath.toRadians(this.targetDocument?.direction)\n\t\t\t);\n\t\t} else if (!(this.target instanceof MeasuredTemplate)) {\n\t\t\trotation = this.targetDocument?.rotation\n\t\t\t\t? Math.normalizeRadians(Math.toRadians(this.targetDocument?.rotation))\n\t\t\t\t: 0;\n\t\t}\n\n\t\tif (rotation !== undefined) {\n\t\t\tthis._cachedTargetData.rotation = rotation;\n\t\t}\n\n\t\tconst alpha =\n\t\t\tthis.targetDocument instanceof TokenDocument ||\n\t\t\tthis.targetDocument instanceof TileDocument\n\t\t\t\t? this.targetDocument?.alpha ?? 1.0\n\t\t\t\t: 1.0;\n\n\t\tif (alpha !== undefined) {\n\t\t\tthis._cachedTargetData.alpha = alpha;\n\t\t}\n\n\t\treturn {\n\t\t\t...this._cachedTargetData,\n\t\t};\n\t}\n\n\t/**\n\t * Calculates the offset for a given offset property and name mapping\n\t *\n\t * @param {string} offsetMapName\n\t * @param {boolean} source\n\t * @returns {{x: number, y: number}|*}\n\t * @private\n\t */\n\t_getOffset(offsetMapName, source = false) {\n\t\tconst key = source ? \"source\" : \"target\";\n\n\t\tconst offset = {\n\t\t\tx: 0,\n\t\t\ty: 0,\n\t\t};\n\n\t\tlet twister = this._twister;\n\n\t\tlet nameOffsetMap = this._nameOffsetMap?.[this.data.name];\n\n\t\tif (nameOffsetMap) {\n\t\t\ttwister = nameOffsetMap.twister;\n\t\t}\n\n\t\t// If the effect is missing, and it's not the source we're offsetting OR it is the source, but we don't have a target (it's playing on the spot)\n\t\tif (this.data.missed && (!source || !this.data.target)) {\n\t\t\tlet missedOffset =\n\t\t\t\tthis._offsetCache[key]?.missedOffset ||\n\t\t\t\tcanvaslib.calculate_missed_position(this.source, this.target, twister);\n\t\t\tthis._offsetCache[key].missedOffset = missedOffset;\n\t\t\toffset.x -= missedOffset.x;\n\t\t\toffset.y -= missedOffset.y;\n\t\t}\n\n\t\tconst obj = source ? this.source : this.target;\n\t\tconst multiplier = source\n\t\t\t? this.data.randomOffset?.source\n\t\t\t: this.data.randomOffset?.target;\n\n\t\tif (obj && multiplier) {\n\t\t\tlet randomOffset =\n\t\t\t\tthis._offsetCache[key]?.randomOffset ||\n\t\t\t\tcanvaslib.get_random_offset(obj, multiplier, twister);\n\t\t\tthis._offsetCache[key].randomOffset = randomOffset;\n\t\t\toffset.x -= randomOffset.x;\n\t\t\toffset.y -= randomOffset.y;\n\t\t}\n\n\t\tlet extraOffset = this.data?.offset?.[key];\n\t\tif (extraOffset) {\n\t\t\tlet newOffset = {\n\t\t\t\tx: extraOffset.x,\n\t\t\t\ty: extraOffset.y,\n\t\t\t};\n\t\t\tif (extraOffset.gridUnits) {\n\t\t\t\tnewOffset.x *= canvas.grid.size;\n\t\t\t\tnewOffset.y *= canvas.grid.size;\n\t\t\t}\n\t\t\tif (extraOffset.local) {\n\t\t\t\tif (\n\t\t\t\t\t!this._cachedSourceData?.position ||\n\t\t\t\t\t!this._cachedTargetData?.position\n\t\t\t\t) {\n\t\t\t\t\tthis.getSourceData();\n\t\t\t\t\tthis.getTargetData();\n\t\t\t\t}\n\n\t\t\t\tconst startPos = this._cachedSourceData.position;\n\t\t\t\tconst endPos = this._cachedTargetData.position;\n\n\t\t\t\tconst angle = this.target\n\t\t\t\t\t? new Ray(startPos, endPos).angle\n\t\t\t\t\t: Ray.fromAngle(\n\t\t\t\t\t\tstartPos.x,\n\t\t\t\t\t\tstartPos.y,\n\t\t\t\t\t\tthis._cachedSourceData.rotation,\n\t\t\t\t\t\t1\n\t\t\t\t\t).angle;\n\n\t\t\t\tnewOffset = canvaslib.rotateAroundPoint(\n\t\t\t\t\t0,\n\t\t\t\t\t0,\n\t\t\t\t\tnewOffset.x,\n\t\t\t\t\tnewOffset.y,\n\t\t\t\t\t-angle\n\t\t\t\t);\n\t\t\t}\n\t\t\toffset.x -= newOffset.x;\n\t\t\toffset.y -= newOffset.y;\n\t\t}\n\n\t\tlet offsetMap = this._nameOffsetMap?.[offsetMapName];\n\n\t\tif (!this._offsetCache[key][\"nameCache\"][offsetMapName]) {\n\t\t\tthis._offsetCache[key][\"nameCache\"][offsetMapName] = {};\n\t\t}\n\n\t\tif (offsetMap) {\n\t\t\tif (offsetMap.missed) {\n\t\t\t\tconst missedOffset =\n\t\t\t\t\tthis._offsetCache[key][\"nameCache\"][offsetMapName]?.missedOffset ||\n\t\t\t\t\tcanvaslib.calculate_missed_position(\n\t\t\t\t\t\toffsetMap.sourceObj,\n\t\t\t\t\t\toffsetMap.targetObj,\n\t\t\t\t\t\toffsetMap.twister\n\t\t\t\t\t);\n\t\t\t\tthis._offsetCache[key][\"nameCache\"][offsetMapName].missedOffset =\n\t\t\t\t\tmissedOffset;\n\t\t\t\toffset.x -= missedOffset.x;\n\t\t\t\toffset.y -= missedOffset.y;\n\t\t\t}\n\n\t\t\tconst obj = offsetMap.targetObj || offsetMap.sourceObj;\n\t\t\tconst multiplier =\n\t\t\t\toffsetMap.randomOffset?.source || offsetMap.randomOffset?.target;\n\n\t\t\tif (obj && multiplier) {\n\t\t\t\tlet randomOffset =\n\t\t\t\t\tthis._offsetCache[key][\"nameCache\"][offsetMapName]?.randomOffset ||\n\t\t\t\t\tcanvaslib.get_random_offset(obj, multiplier, offsetMap.twister);\n\t\t\t\tthis._offsetCache[key][\"nameCache\"][offsetMapName].randomOffset =\n\t\t\t\t\trandomOffset;\n\t\t\t\toffset.x -= randomOffset.x;\n\t\t\t\toffset.y -= randomOffset.y;\n\t\t\t}\n\n\t\t\tif (offsetMap.offset) {\n\t\t\t\toffset.x += offsetMap.offset.x;\n\t\t\t\toffset.y += offsetMap.offset.y;\n\t\t\t}\n\t\t}\n\n\t\treturn offset;\n\t}\n\n\t/**\n\t * Initializes the name offset map by establishing targets\n\t *\n\t * @param inOffsetMap\n\t * @returns {{setup}|*}\n\t * @private\n\t */\n\t_setupOffsetMap(inOffsetMap) {\n\t\tif (!inOffsetMap.setup) {\n\t\t\tinOffsetMap.setup = true;\n\t\t\tinOffsetMap.sourceObj = inOffsetMap.source\n\t\t\t\t? this._validateObject(inOffsetMap.source)\n\t\t\t\t: false;\n\t\t\tinOffsetMap.targetObj = inOffsetMap.target\n\t\t\t\t? this._validateObject(inOffsetMap.target)\n\t\t\t\t: false;\n\t\t\tconst repetition = this.data.repetition % inOffsetMap.repetitions;\n\t\t\tconst seed = lib.get_hash(`${inOffsetMap.seed}-${repetition}`);\n\t\t\tinOffsetMap.twister = lib.createMersenneTwister(seed);\n\t\t}\n\n\t\treturn inOffsetMap;\n\t}\n\n\t/**\n\t * Plays the effect, returning two promises; one that resolves once the duration has been established, and another\n\t * when the effect has finished playing\n\t *\n\t * @returns {Object}\n\t */\n\tplay() {\n\t\tconst durationPromise = new Promise((resolve, reject) => {\n\t\t\tthis._durationResolve = resolve;\n\t\t});\n\n\t\tconst finishPromise = new Promise(async (resolve, reject) => {\n\t\t\tthis._resolve = resolve;\n\t\t\tHooks.callAll(\"createSequencerEffect\", this);\n\t\t\tlib.debug(`Playing effect:`, this.data);\n\t\t\tthis._initialize();\n\t\t});\n\n\t\treturn {\n\t\t\tduration: durationPromise,\n\t\t\tpromise: finishPromise,\n\t\t};\n\t}\n\n\t/**\n\t *  Ends the effect\n\t */\n\tendEffect() {\n\t\tif (this._ended) return;\n\t\tHooks.callAll(\"endedSequencerEffect\", this);\n\t\tthis.destroy();\n\t}\n\n\tdestroy(...args) {\n\t\tthis._destroyDependencies();\n\t\treturn super.destroy(...args);\n\t}\n\n\t/**\n\t * Updates this effect with the given parameters\n\t * @param inUpdates\n\t * @returns {Promise}\n\t */\n\tasync update(inUpdates) {\n\t\tif (!this.userCanUpdate)\n\t\t\tthrow lib.custom_error(\n\t\t\t\t\"Sequencer\",\n\t\t\t\t\"CanvasEffect | Update | You do not have permission to update this effect\"\n\t\t\t);\n\t\tCanvasEffect.validateUpdate(inUpdates);\n\n\t\tconst newData = foundry.utils.deepClone(this.data);\n\t\tconst updateKeys = Object.keys(inUpdates);\n\n\t\tupdateKeys.forEach((key) => {\n\t\t\tfoundry.utils.setProperty(newData, key, inUpdates[key]);\n\t\t});\n\n\t\tif (\n\t\t\tObject.keys(foundry.utils.diffObject(newData, this.data)).length === 0\n\t\t) {\n\t\t\tlib.debug(\n\t\t\t\t`Skipped updating effect with ID ${this.id} - no changes needed`\n\t\t\t);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.data.persist) {\n\t\t\tconst originalSourceUUID =\n\t\t\t\tlib.is_UUID(this.data.source) && this.data.attachTo\n\t\t\t\t\t? this.data.source\n\t\t\t\t\t: \"Scene.\" + this.data.sceneId;\n\n\t\t\tconst newSourceUUID =\n\t\t\t\tlib.is_UUID(newData.source) && newData.attachTo\n\t\t\t\t\t? newData.source\n\t\t\t\t\t: \"Scene.\" + newData.sceneId;\n\n\t\t\tif (originalSourceUUID !== newSourceUUID) {\n\t\t\t\tflagManager.removeEffectFlags(originalSourceUUID, newData);\n\t\t\t}\n\n\t\t\tflagManager.addEffectFlags(newSourceUUID, newData);\n\t\t}\n\n\t\tlib.debug(`Updated effect with ID ${this.id}`);\n\n\t\treturn sequencerSocket.executeForEveryone(\n\t\t\tSOCKET_HANDLERS.UPDATE_EFFECT,\n\t\t\tthis.id,\n\t\t\tnewData\n\t\t);\n\t}\n\n\tasync addAnimatedProperties({ animations = [], loopingAnimation = [] } = {}) {\n\t\tconst animationsToAdd = [];\n\t\tif (!Array.isArray(animations)) {\n\t\t\tthrow lib.custom_error(\n\t\t\t\tthis.data.moduleName,\n\t\t\t\t`animations must be an array of arrays`\n\t\t\t);\n\t\t}\n\t\tfor (const animationData of animations) {\n\t\t\tif (!Array.isArray(animationData)) {\n\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\tthis.data.moduleName,\n\t\t\t\t\t`each entry in animations must be an array, each with target, property name, and animation options`\n\t\t\t\t);\n\t\t\t}\n\t\t\tconst result = canvaslib.validateAnimation(...animationData);\n\t\t\tif (typeof result === \"string\") {\n\t\t\t\tthrow lib.custom_error(this.data.moduleName, result);\n\t\t\t}\n\t\t\tresult.creationTimestamp = +new Date();\n\t\t\tanimationsToAdd.push(result);\n\t\t}\n\t\tif (!Array.isArray(loopingAnimation)) {\n\t\t\tthrow lib.custom_error(\n\t\t\t\tthis.data.moduleName,\n\t\t\t\t`loopingAnimation must be an array of arrays`\n\t\t\t);\n\t\t}\n\t\tfor (const animationData of loopingAnimation) {\n\t\t\tif (!Array.isArray(animationData)) {\n\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\tthis.data.moduleName,\n\t\t\t\t\t`each entry in loopingAnimation must be an array, each with target, property name, and animation options`\n\t\t\t\t);\n\t\t\t}\n\t\t\tconst result = canvaslib.validateLoopingAnimation(...animationData);\n\t\t\tif (typeof result === \"string\") {\n\t\t\t\tthrow lib.custom_error(this.data.moduleName, result);\n\t\t\t}\n\t\t\tresult.creationTimestamp = +new Date();\n\t\t\tanimationsToAdd.push(result);\n\t\t}\n\n\t\tif (this.data.persist) {\n\t\t\tconst originalSourceUUID =\n\t\t\t\tlib.is_UUID(this.data.source) && this.data.attachTo\n\t\t\t\t\t? this.data.source\n\t\t\t\t\t: \"Scene.\" + this.data.sceneId;\n\t\t\tconst newData = foundry.utils.deepClone(this.data);\n\t\t\tnewData.animations = (newData.animations ?? []).concat(\n\t\t\t\tfoundry.utils.deepClone(animationsToAdd)\n\t\t\t);\n\t\t\tflagManager.addEffectFlags(originalSourceUUID, newData);\n\t\t}\n\n\t\treturn sequencerSocket.executeForEveryone(\n\t\t\tSOCKET_HANDLERS.ADD_EFFECT_ANIMATIONS,\n\t\t\tthis.id,\n\t\t\tanimationsToAdd\n\t\t);\n\t}\n\n\tasync _addAnimations(inAnimations) {\n\t\tthis._playAnimations(foundry.utils.deepClone(inAnimations));\n\t\tthis.data.animations = (this.data.animations ?? []).concat(inAnimations);\n\t}\n\n\t/**\n\t * Updates the effect\n\t *\n\t * @param inUpdates\n\t * @returns {Promise}\n\t * @private\n\t */\n\t_update(inUpdates) {\n\t\tthis.data = inUpdates;\n\t\tHooks.callAll(\"updateSequencerEffect\", this);\n\t\tthis._destroyDependencies();\n\t\treturn this._reinitialize();\n\t}\n\n\t/**\n\t * Determines whether a position is within the bounds of this effect\n\t *\n\t * @param inPosition\n\t * @returns {boolean}\n\t */\n\tisPositionWithinBounds(inPosition) {\n\t\tif (!this.spriteContainer) return false;\n\t\treturn canvaslib.is_position_within_bounds(\n\t\t\tinPosition,\n\t\t\tthis.spriteContainer,\n\t\t\tthis.parent\n\t\t);\n\t}\n\n\t/**\n\t * Initializes the effect and places it on the canvas\n\t *\n\t * @returns {Promise}\n\t * @private\n\t */\n\tasync _initialize() {\n\t\tthis.ready = false;\n\t\tthis._initializeVariables();\n\t\tawait this._contextLostCallback();\n\t\tawait this._loadTexture();\n\t\tthis._addToContainer();\n\t\tthis._createSprite();\n\t\tthis._calculateDuration();\n\t\tthis._createShapes();\n\t\tawait this._setupMasks();\n\t\tawait this._transformSprite();\n\t\tthis._playPresetAnimations();\n\t\tthis._playCustomAnimations();\n\t\tthis._setEndTimeout();\n\t\tthis._timeoutVisibility();\n\t\tawait this._startEffect();\n\t\tthis.ready = true;\n\t}\n\n\t/**\n\t * Reinitializes the effect after it has been updated\n\t *\n\t * @param play\n\t * @returns {Promise}\n\t * @private\n\t */\n\tasync _reinitialize() {\n\t\tthis.renderable = false;\n\t\tif (!this.shouldPlay) {\n\t\t\treturn Sequencer.EffectManager._removeEffect(this);\n\t\t}\n\t\tthis.actualCreationTime = +new Date();\n\t\treturn this._initialize();\n\t}\n\n\t/**\n\t * Initializes variables core to the function of the effect\n\t * This is run as a part of the construction of the effect\n\t *\n\t * @private\n\t */\n\t_initializeVariables() {\n\t\t// Responsible for rotating the sprite\n\t\tthis.rotationContainer = this.addChild(new PIXI.Container());\n\t\tthis.rotationContainer.id = this.id + \"-rotationContainer\";\n\n\t\tthis.isometricContainer = this.rotationContainer.addChild(\n\t\t\tnew PIXI.Container()\n\t\t);\n\t\tthis.isometricContainer.id = this.id + \"-isometricContainer\";\n\n\t\t// An offset container for the sprite\n\t\tthis.spriteContainer = this.isometricContainer.addChild(\n\t\t\tnew PIXI.Container()\n\t\t);\n\t\tthis.spriteContainer.id = this.id + \"-spriteContainer\";\n\n\t\tthis._template = null;\n\t\tthis._ended = null;\n\t\tthis._maskContainer = null;\n\t\tthis._maskSprite = null;\n\t\tthis._file = null;\n\t\tthis._loopOffset = 0;\n\t\tthis.effectFilters = {};\n\t\tthis._animationDuration = 0;\n\t\tthis._animationTimes = {};\n\t\tthis._twister = lib.createMersenneTwister(this.creationTimestamp);\n\t\tthis._video = null;\n\t\tthis._distanceCache = null;\n\t\tthis._isRangeFind = false;\n\t\tthis._customAngle = 0;\n\t\tthis._currentFilePath = this.data.file;\n\t\tthis._relatedSprites = {};\n\t\tthis._hooks = [];\n\t\tthis._lastDimensions = {};\n\n\t\tif (this._resetTimeout) {\n\t\t\tclearTimeout(this._resetTimeout);\n\t\t}\n\t\tthis._resetTimeout = null;\n\n\t\tthis._source = false;\n\t\tthis._target = false;\n\t\tthis._offsetCache = {\n\t\t\tsource: { nameCache: {} },\n\t\t\ttarget: { nameCache: {} },\n\t\t};\n\n\t\tthis._nameOffsetMap = Object.fromEntries(\n\t\t\tObject.entries(\n\t\t\t\tfoundry.utils.deepClone(this.data.nameOffsetMap ?? {})\n\t\t\t).map((entry) => {\n\t\t\t\treturn [entry[0], this._setupOffsetMap(entry[1])];\n\t\t\t})\n\t\t);\n\n\t\tthis.uuid = !lib.is_UUID(this.context.uuid)\n\t\t\t? this.id\n\t\t\t: this.context.uuid + \".data.flags.sequencer.effects.\" + this.id;\n\n\t\tthis._ticker = CanvasAnimation.ticker;\n\t\tthis._tickerMethods = [];\n\t}\n\n\t_addToTicker(func) {\n\t\tthis._tickerMethods.push(func);\n\t\tthis._ticker.add(func, this);\n\t}\n\n\t/**\n\t * Destroys all dependencies to this element, such as tickers, animations, textures, and child elements\n\t *\n\t * @private\n\t */\n\t_destroyDependencies() {\n\t\tif (this._ended) return;\n\t\tthis._ended = true;\n\n\t\tthis.mask = null;\n\n\t\thooksManager.removeHooks(this.uuid);\n\n\t\tthis._tickerMethods.forEach(func => this._ticker.remove(func, this));\n\t\tthis._ticker = null;\n\n\t\tObject.values(this._relatedSprites).forEach((sprite) =>\n\t\t\tsprite.destroy({ children: true })\n\t\t);\n\n\t\tSequencerAnimationEngine.endAnimations(this.id);\n\n\t\tif (this._maskContainer) this._maskContainer.destroy({ children: true });\n\t\tif (this._maskSprite) {\n\t\t\ttry {\n\t\t\t\tthis._maskSprite.texture.destroy(true);\n\t\t\t\tthis._maskSprite.destroy();\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t}\n\n\t\tif (this._file instanceof SequencerFileBase) {\n\t\t\tthis._file.destroy();\n\t\t}\n\n\t\tif (this.video) {\n\t\t\ttry {\n\t\t\t\tthis.video.removeAttribute(\"src\");\n\t\t\t\tthis.video.pause();\n\t\t\t\tthis.video.load();\n\t\t\t} catch (err) {\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\tif (this.data.screenSpace) {\n\t\t\t\tSequencerAboveUILayer.removeContainerByEffect(this);\n\t\t\t}\n\t\t} catch (err) {\n\t\t}\n\n\t\tif (this.data.syncGroup) {\n\t\t\tSyncGroups.remove(this);\n\t\t}\n\n\t\tthis.removeChildren().forEach((child) => child.destroy({ children: true }));\n\t}\n\n\t/**\n\t * Plays preset animations\n\t *\n\t * @private\n\t */\n\t_playPresetAnimations() {\n\t\tthis._moveTowards();\n\n\t\tthis._fadeIn();\n\t\tthis._fadeInAudio();\n\t\tthis._scaleIn();\n\t\tthis._rotateIn();\n\n\t\tthis._fadeOut();\n\t\tthis._fadeOutAudio();\n\t\tthis._scaleOut();\n\t\tthis._rotateOut();\n\t}\n\n\t/**\n\t * Gets an object based on an identifier, checking if it exists within the named offset map, whether it's a\n\t * coordinate object, or if it's an UUID that needs to be fetched from the scene\n\t *\n\t * @param inIdentifier\n\t * @returns {*}\n\t * @private\n\t */\n\t_getObjectByID(inIdentifier) {\n\t\tlet source = inIdentifier;\n\t\tlet offsetMap = this._nameOffsetMap?.[inIdentifier];\n\t\tif (offsetMap) {\n\t\t\tsource = offsetMap?.targetObj || offsetMap?.sourceObj || source;\n\t\t} else {\n\t\t\tsource = this._validateObject(source);\n\t\t}\n\t\treturn source;\n\t}\n\n\t/**\n\t * Validates the given parameter, whether it's a UUID or a coordinate object, and returns the proper one\n\t *\n\t * @param inObject\n\t * @returns {*}\n\t * @private\n\t */\n\t_validateObject(inObject) {\n\t\tif (lib.is_UUID(inObject) || !canvaslib.is_object_canvas_data(inObject)) {\n\t\t\tinObject = lib.get_object_from_scene(inObject, this.data.sceneId);\n\t\t\tinObject = inObject?._object ?? inObject;\n\t\t}\n\t\treturn inObject;\n\t}\n\n\t/**\n\t * Adds this effect to the appropriate container on the right layer\n\t *\n\t * @private\n\t */\n\t_addToContainer() {\n\t\tlet layer;\n\t\tif (this.data.screenSpaceAboveUI) {\n\t\t\tlayer = SequencerAboveUILayer;\n\t\t} else if (this.data.screenSpace) {\n\t\t\tlayer = canvas.sequencerEffectsUILayer;\n\t\t} else if (this.data.aboveInterface) {\n\t\t\tlayer = canvas.controls;\n\t\t} else if (this.data.aboveLighting) {\n\t\t\tlayer = canvas.interface;\n\t\t} else {\n\t\t\tlayer = canvas.primary;\n\t\t}\n\n\t\tlayer.addChild(this);\n\t\tlayer.sortChildren();\n\t}\n\n\t/**\n\t * Loads the texture for this effect, handling cases where it's a simple path or a database path\n\t *\n\t * @private\n\t */\n\tasync _loadTexture() {\n\n\t\tthis._template = this.data.template;\n\n\t\tif (this.data.file === \"\") {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.data.customRange) {\n\t\t\tthis._file = SequencerFileBase.make(\n\t\t\t\tthis.data.file,\n\t\t\t\tObject.values(this.template),\n\t\t\t\t\"temporary.range.file\"\n\t\t\t);\n\t\t} else {\n\t\t\tif (!Sequencer.Database.entryExists(this.data.file)) {\n\t\t\t\tlet texture = await SequencerFileCache.loadFile(this.data.file);\n\t\t\t\tthis.video = this.data.file.toLowerCase().endsWith(\".webm\")\n\t\t\t\t\t? texture?.baseTexture?.resource?.source ?? false\n\t\t\t\t\t: false;\n\t\t\t\tthis.texture = texture;\n\t\t\t\tthis._file = texture;\n\t\t\t\tthis._currentFilePath = this.data.file;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._file = Sequencer.Database.getEntry(this.data.file).clone();\n\t\t}\n\n\t\tthis._file.fileIndex = this.data.forcedIndex;\n\t\tthis._file.twister = this._twister;\n\n\t\tthis._isRangeFind = this._file?.rangeFind;\n\n\t\tthis.spriteSheet = false;\n\t\tif (this.data.stretchTo) {\n\t\t\tlet ray = new Ray(this.sourcePosition, this.targetPosition);\n\t\t\tif (ray.distance === 0) {\n\t\t\t\tlib.custom_error(\n\t\t\t\t      \"effect\",\n\t\t\t\t      `stretchTo - You are stretching over a distance of \"0\", you may be attempting to stretch between two of the same coordinates!`\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis._rotateTowards(ray);\n\t\t\tray = new Ray(this.sourcePosition, this.targetPosition);\n\t\t\tlet { filePath, texture, sheet } = await this._getTextureForDistance(\n\t\t\t\tray.distance\n\t\t\t);\n\t\t\tthis._currentFilePath = filePath;\n\t\t\tthis.texture = texture;\n\t\t\tthis.spriteSheet = sheet;\n\t\t} else if (\n\t\t\t!this._isRangeFind ||\n\t\t\t(this._isRangeFind && !this.data.stretchTo)\n\t\t) {\n\t\t\tconst { filePath, texture, sheet } = await this._file.getTexture();\n\t\t\tthis._currentFilePath = filePath;\n\t\t\tthis.texture = texture;\n\t\t\tthis.spriteSheet = sheet;\n\t\t}\n\n\t\tif (this._isRangeFind && this.data.stretchTo && this.data.attachTo?.active) {\n\t\t\tlet spriteType = this.data.tilingTexture ? PIXI.TilingSprite : SpriteMesh;\n\t\t\tthis._relatedSprites[this._currentFilePath] = new spriteType(\n\t\t\t\tthis.texture,\n\t\t\t\tthis.data.xray ? null : VisionSamplerShader\n\t\t\t);\n\t\t\tif (this.data.tint) {\n\t\t\t\tthis._relatedSprites[this._currentFilePath].tint = this.data.tint;\n\t\t\t}\n\n\t\t\tnew Promise(async (resolve) => {\n\t\t\t\tfor (let filePath of this._file.getAllFiles()) {\n\t\t\t\t\tif (filePath === this._currentFilePath) continue;\n\n\t\t\t\t\tlet texture = await this._file._getTexture(filePath);\n\t\t\t\t\tlet spriteType = this.data.tilingTexture\n\t\t\t\t\t\t? PIXI.TilingSprite\n\t\t\t\t\t\t: SpriteMesh;\n\t\t\t\t\tlet sprite = new spriteType(\n\t\t\t\t\t\ttexture,\n\t\t\t\t\t\tthis.data.xray ? null : VisionSamplerShader\n\t\t\t\t\t);\n\t\t\t\t\tsprite.renderable = false;\n\t\t\t\t\tthis._relatedSprites[filePath] = sprite;\n\t\t\t\t}\n\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\n\t\tthis._template ??= this._file.template;\n\t\tthis.video = this._currentFilePath.toLowerCase().endsWith(\".webm\")\n\t\t\t? this.texture?.baseTexture?.resource?.source\n\t\t\t: false;\n\t}\n\n\tget startTimeMs(){\n\t\treturn this._startTime * 1000;\n\t}\n\n\tget endTimeMs(){\n\t\treturn this._endTime * 1000;\n\t}\n\n\t/**\n\t * Calculates the duration of this effect, based on animation durations, the video source duration, end/start times, etc\n\t *\n\t * @private\n\t */\n\t_calculateDuration() {\n\t\tlet playbackRate = this.data.playbackRate ? this.data.playbackRate : 1.0;\n\n\t\tthis.mediaPlaybackRate = playbackRate;\n\n\t\tthis._animationDuration = this.data.duration || this.mediaDurationMs;\n\n\t\t// If the effect moves, then infer the duration from the distance divided by the speed\n\t\tif (this.data.moveSpeed && this.data.moves) {\n\t\t\tlet distance = canvaslib.distance_between(\n\t\t\t\tthis.sourcePosition,\n\t\t\t\tthis.targetPosition\n\t\t\t);\n\t\t\tlet durationFromSpeed = (distance / this.data.moveSpeed) * 1000;\n\t\t\tthis._animationDuration = Math.max(durationFromSpeed, this.data.duration);\n\t\t} else if (!this.data.duration && !this.hasAnimatedMedia) {\n\t\t\t// Determine static image duration\n\t\t\tlet fadeDuration =\n\t\t\t\t(this.data.fadeIn?.duration ?? 0) + (this.data.fadeOut?.duration ?? 0);\n\t\t\tlet scaleDuration =\n\t\t\t\t(this.data.scaleIn?.duration ?? 0) +\n\t\t\t\t(this.data.scaleOut?.duration ?? 0);\n\t\t\tlet rotateDuration =\n\t\t\t\t(this.data.rotateIn?.duration ?? 0) +\n\t\t\t\t(this.data.rotateOut?.duration ?? 0);\n\t\t\tlet moveDuration = 0;\n\t\t\tif (this.data.moves) {\n\t\t\t\tlet distance = canvaslib.distance_between(\n\t\t\t\t\tthis.sourcePosition,\n\t\t\t\t\tthis.targetPosition\n\t\t\t\t);\n\t\t\t\tmoveDuration =\n\t\t\t\t\t(this.data.moveSpeed\n\t\t\t\t\t\t? (distance / this.data.moveSpeed) * 1000\n\t\t\t\t\t\t: 1000) + this.data.moves.delay;\n\t\t\t}\n\n\t\t\tlet animationDurations = this.data.animations\n\t\t\t\t? Math.max(\n\t\t\t\t\t...this.data.animations.map((animation) => {\n\t\t\t\t\t\tif (animation.looping) {\n\t\t\t\t\t\t\tif (animation.loops === 0) return 0;\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t(animation?.duration ?? 0) * (animation?.loops ?? 0) +\n\t\t\t\t\t\t\t\t(animation?.delay ?? 0)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn (animation?.duration ?? 0) + (animation?.delay ?? 0);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t)\n\t\t\t\t: 0;\n\n\t\t\tthis._animationDuration = Math.max(\n\t\t\t\tfadeDuration,\n\t\t\t\tscaleDuration,\n\t\t\t\trotateDuration,\n\t\t\t\tmoveDuration,\n\t\t\t\tanimationDurations\n\t\t\t);\n\n\t\t\tthis._animationDuration = this._animationDuration || 1000;\n\t\t}\n\n\t\t// Clamp effect duration to start time and end time\n\t\tthis._startTime = 0;\n\t\tif (this.data.time?.start && this.mediaCurrentTime !== null) {\n\t\t\tlet currentTime = !this.data.time.start.isPerc\n\t\t\t\t? this.data.time.start.value ?? 0\n\t\t\t\t: this._animationDuration * this.data.time.start.value;\n\t\t\tthis.mediaCurrentTime = currentTime / 1000;\n\t\t\tthis._startTime = currentTime / 1000;\n\t\t}\n\n\t\tthis._endTime = this._animationDuration;\n\t\tif (this.data.time?.end) {\n\t\t\tif (this.data.time.end.isPerc) {\n\t\t\t\tthis._endTime = this._animationDuration * this.data.time.end.value;\n\t\t\t} else {\n\t\t\t\tthis._endTime = this.data.time.isRange\n\t\t\t\t\t? this.data.time.end.value\n\t\t\t\t\t: this._animationDuration - this.data.time.end.value;\n\t\t\t}\n\t\t}\n\t\tthis._endTime /= 1000;\n\n\t\tthis._animationDuration = lib.clamp(this.endTimeMs - this.startTimeMs, 0, this._animationDuration);\n\n\t\tif (\n\t\t\tthis._file?.markers &&\n\t\t\tthis._startTime === 0 &&\n\t\t\tthis._endTime === this.mediaDuration\n\t\t) {\n\t\t\tthis._animationTimes.loopStart = this._file.markers.loop.start / playbackRate / 1000;\n\t\t\tthis._animationTimes.loopEnd = this._file.markers.loop.end / playbackRate / 1000;\n\t\t\tthis._animationTimes.forcedEnd = this._file.markers.forcedEnd / playbackRate / 1000;\n\t\t}\n\n\t\tthis._totalDuration = this.loops\n\t\t\t? (this._animationDuration * this.loops) + (this.loopDelay * (this.loops - 1))\n\t\t\t: this._animationDuration;\n\n\t\tif(this.data.persist){\n\t\t\tthis.mediaLooping = (\n\t\t\t\t(!this.data.time || (this._startTime === 0 && this._endTime === this.mediaDuration)) &&\n\t\t\t\tthis._animationTimes.loopStart === undefined &&\n\t\t\t\tthis._animationTimes.loopEnd === undefined &&\n\t\t\t\t!this.loops &&\n\t\t\t\t!this.loopDelay\n\t\t\t);\n\t\t}else{\n\t\t\tthis.mediaLooping = this._startTime === 0 && this._endTime > this.mediaDuration && !(this.loops && this.loopDelay);\n\t\t}\n\n\t\t// Resolve duration promise so that owner of effect may know when it is finished\n\t\tthis._durationResolve(this._totalDuration);\n\n\t}\n\n\t/**\n\t * If this effect is animatable, hold off on rendering it for a bit so that the animations have time to initialize to\n\t * prevent it from spawning and then jumping to the right place\n\t *\n\t * @private\n\t */\n\t_timeoutVisibility() {\n\t\tsetTimeout(\n\t\t\t() => {\n\t\t\t\tthis._setupHooks();\n\t\t\t},\n\t\t\tthis.data.animations ? 50 : 0\n\t\t);\n\t}\n\n\t/**\n\t * If this effect is attached to an object, check whether the object has been destroyed, if so, end the effect\n\t *\n\t * @private\n\t */\n\t_contextLostCallback() {\n\t\tif (this.isSourceTemporary) {\n\t\t\tthis._addToTicker(this._checkSourceDestroyed);\n\t\t}\n\t\tif (this.isTargetTemporary) {\n\t\t\tthis._addToTicker(this._checkTargetDestroyed);\n\t\t}\n\t}\n\n\t_checkSourceDestroyed() {\n\t\tif (this.isSourceDestroyed) {\n\t\t\tthis._source = this.sourcePosition;\n\t\t\tSequencerEffectManager.endEffects({ effects: this });\n\t\t}\n\t}\n\n\t_checkTargetDestroyed() {\n\t\tif (this.isTargetDestroyed) {\n\t\t\tthis._source = this.targetPosition;\n\t\t\tSequencerEffectManager.endEffects({ effects: this });\n\t\t}\n\t}\n\n\n\t/**\n\t * Creates the sprite, and the relevant containers that manage the position and offsets of the overall visual look of the sprite\n\t *\n\t * @private\n\t */\n\t_createSprite() {\n\t\tthis.renderable = false;\n\n\t\tconst args = [this.spriteSheet ? this.spriteSheet : PIXI.Texture.EMPTY];\n\t\tif (\n\t\t\t!this.data.xray &&\n\t\t\t!this.spriteSheet &&\n\t\t\t!this.data.screenSpace &&\n\t\t\t!this.data.screenSpaceAboveUI\n\t\t) {\n\t\t\targs.push(VisionSamplerShader);\n\t\t}\n\n\t\tconst spriteType = this.spriteSheet ? PIXI.AnimatedSprite : SpriteMesh;\n\t\tconst sprite = new spriteType(...args);\n\t\tthis.sprite = this.spriteContainer.addChild(sprite);\n\t\tthis.sprite.id = this.id + \"-sprite\";\n\n\t\tObject.values(this._relatedSprites).forEach((sprite) => {\n\t\t\tif (this.data.tint) {\n\t\t\t\tsprite.tint = this.data.tint;\n\t\t\t}\n\t\t\tthis.sprite.addChild(sprite);\n\t\t});\n\n\t\tthis.animatedSprite = false;\n\t\tif (this.spriteSheet) {\n\t\t\tthis.animatedSprite = true;\n\t\t\tthis.sprite.animationSpeed = 0.4;\n\t\t\tthis.sprite.loop = false;\n\t\t}\n\n\t\tlet textSprite;\n\n\t\tif (this.data.text) {\n\t\t\tconst text = this.data.text.text;\n\t\t\tconst fontSettings = foundry.utils.deepClone(this.data.text);\n\t\t\tfontSettings.fontSize =\n\t\t\t\t(fontSettings?.fontSize ?? 26) * (150 / canvas.grid.size);\n\n\t\t\ttextSprite = new PIXI.Text(text, fontSettings);\n\t\t\ttextSprite.resolution = 5;\n\t\t\ttextSprite.zIndex = 1;\n\n\t\t\ttextSprite.anchor.set(\n\t\t\t\tthis.data.text?.anchor?.x ?? 0.5,\n\t\t\t\tthis.data.text?.anchor?.y ?? 0.5\n\t\t\t);\n\t\t}\n\n\t\tthis.sprite.filters = [];\n\n\t\tif (this.data.filters) {\n\t\t\tfor (let index = 0; index < this.data.filters.length; index++) {\n\t\t\t\tconst filterData = this.data.filters[index];\n\t\t\t\tconst filter = new filters[filterData.className](filterData.data);\n\t\t\t\tfilter.id =\n\t\t\t\t\tthis.id + \"-\" + filterData.className + \"-\" + index.toString();\n\t\t\t\tthis.sprite.filters.push(filter);\n\t\t\t\tconst filterKeyName = filterData.name || filterData.className;\n\t\t\t\tthis.effectFilters[filterKeyName] = filter;\n\t\t\t}\n\t\t}\n\n\t\tthis.alphaFilter = new PIXI.filters.AlphaFilter(this.data.opacity);\n\t\tthis.alphaFilter.id = this.id + \"-alphaFilter\";\n\t\tthis.sprite.filters.push(this.alphaFilter);\n\n\t\tlet spriteOffsetX = this.data.spriteOffset?.x ?? 0;\n\t\tlet spriteOffsetY = this.data.spriteOffset?.y ?? 0;\n\t\tif (this.data.spriteOffset?.gridUnits) {\n\t\t\tspriteOffsetX *= canvas.grid.size;\n\t\t\tspriteOffsetY *= canvas.grid.size;\n\t\t}\n\n\t\tthis.sprite.position.set(spriteOffsetX, spriteOffsetY);\n\n\t\tthis.sprite.anchor.set(\n\t\t\tthis.data.spriteAnchor?.x ?? 0.5,\n\t\t\tthis.data.spriteAnchor?.y ?? 0.5\n\t\t);\n\n\t\tlet spriteRotation = this.data.spriteRotation ?? 0;\n\t\tif (this.data.randomSpriteRotation) {\n\t\t\tspriteRotation += lib.random_float_between(-360, 360, this._twister);\n\t\t}\n\n\t\tthis.sprite.rotation = Math.normalizeRadians(\n\t\t\tMath.toRadians(spriteRotation)\n\t\t);\n\n\t\tthis._customAngle = this.data.angle ?? 0;\n\t\tif (this.data.randomRotation) {\n\t\t\tthis._customAngle += lib.random_float_between(-360, 360, this._twister);\n\t\t}\n\n\t\tthis.spriteContainer.rotation = -Math.normalizeRadians(\n\t\t\tMath.toRadians(this._customAngle)\n\t\t);\n\n\t\tif (CONSTANTS.INTEGRATIONS.ISOMETRIC.ACTIVE) {\n\t\t\tthis.isometricContainer.rotation = Math.PI / 4;\n\t\t}\n\n\t\tif (this.data.tint) {\n\t\t\tthis.sprite.tint = this.data.tint;\n\t\t}\n\n\t\tif (textSprite) {\n\t\t\tif (this.data.tint) {\n\t\t\t\ttextSprite.tint = this.data.tint;\n\t\t\t}\n\t\t\tthis.sprite.addChild(textSprite);\n\t\t}\n\n\t\tthis.filters = [\n\t\t\tnew PIXI.filters.ColorMatrixFilter({\n\t\t\t\tsaturation: this.shouldShowFadedVersion ? -1 : 1,\n\t\t\t}),\n\t\t\tnew PIXI.filters.AlphaFilter(\n\t\t\t\tthis.shouldShowFadedVersion\n\t\t\t\t\t? game.settings.get(CONSTANTS.MODULE_NAME, \"user-effect-opacity\") /\n\t\t\t\t\t100\n\t\t\t\t\t: 1\n\t\t\t),\n\t\t];\n\n\t\tthis.updateElevation();\n\t}\n\n\t_createShapes() {\n\t\tconst nonMaskShapes = (this.data?.shapes ?? []).filter(\n\t\t\t(shape) => !shape.isMask\n\t\t);\n\t\tthis.shapes = {};\n\t\tfor (const shape of nonMaskShapes) {\n\t\t\tconst graphic = canvaslib.createShape(shape);\n\t\t\tgraphic.filters = this.sprite.filters;\n\t\t\tthis.spriteContainer.addChild(graphic);\n\t\t\tthis.shapes[shape?.name ?? \"shape-\" + foundry.utils.randomID()] = graphic;\n\t\t}\n\t}\n\n\tupdateElevation() {\n\t\tlet targetElevation = Math.max(\n\t\t\t\tcanvaslib.get_object_elevation(this.source ?? {}),\n\t\t\t\tcanvaslib.get_object_elevation(this.target ?? {})\n\t\t\t);\n\t\tif(!CONSTANTS.IS_V12) targetElevation += 1;\n\t\tlet effectElevation = this.data.elevation?.elevation ?? 0;\n\t\tif (!this.data.elevation?.absolute) {\n\t\t\teffectElevation += targetElevation;\n\t\t}\n\t\tconst isIsometric = foundry.utils.getProperty(\n\t\t\tgame.scenes.get(this.data.sceneId),\n\t\t\tCONSTANTS.INTEGRATIONS.ISOMETRIC.SCENE_ENABLED\n\t\t);\n\t\tif (CONSTANTS.INTEGRATIONS.ISOMETRIC.ACTIVE && isIsometric) {\n\t\t\tconst sourceSort = this.source\n\t\t\t\t? (this.sourceMesh?.sort ?? 0) + (this.data.isometric?.overlay ? 1 : -1)\n\t\t\t\t: 0;\n\t\t\tconst targetSort = this.target\n\t\t\t\t? (this.targetMesh?.sort ?? 0) + (this.data.isometric?.overlay ? 1 : -1)\n\t\t\t\t: 0;\n\t\t\tthis.sort = Math.max(sourceSort, targetSort);\n\t\t} else {\n\t\t\tthis.sort = !lib.is_real_number(this.data.zIndex)\n\t\t\t\t? this.data.index + (this?.parent?.children?.length ?? 0)\n\t\t\t\t: 100000 + this.data.zIndex;\n\t\t}\n\t\tthis.elevation = effectElevation;\n\t\tthis.zIndex = this.sort;\n\t\tthis.sort += 100;\n\t\tthis.sortLayer = this.data.sortLayer\n\t\tif (this.parent) {\n\t\t\tthis.parent.sortChildren();\n\t\t}\n\t}\n\n\tupdateTransform() {\n\t\tsuper.updateTransform();\n\t\tif (this.data.screenSpace || this.data.screenSpaceAboveUI) {\n\t\t\tconst [screenWidth, screenHeight] = canvas.screenDimensions;\n\n\t\t\tthis.position.set(\n\t\t\t\t(this.data.screenSpacePosition?.x ?? 0) +\n\t\t\t\tscreenWidth *\n\t\t\t\t(this.data.screenSpaceAnchor?.x ?? this.data.anchor?.x ?? 0.5),\n\t\t\t\t(this.data.screenSpacePosition?.y ?? 0) +\n\t\t\t\tscreenHeight *\n\t\t\t\t(this.data.screenSpaceAnchor?.y ?? this.data.anchor?.y ?? 0.5)\n\t\t\t);\n\n\t\t\tif (this.data.screenSpaceScale) {\n\t\t\t\tconst scaleData = this.data.screenSpaceScale ?? { x: 1, y: 1 };\n\n\t\t\t\tlet scaleX = scaleData.x;\n\t\t\t\tlet scaleY = scaleData.y;\n\n\t\t\t\tif (scaleData.fitX) {\n\t\t\t\t\tscaleX = scaleX * (screenWidth / this.sprite.width);\n\t\t\t\t}\n\n\t\t\t\tif (scaleData.fitY) {\n\t\t\t\t\tscaleY = scaleY * (screenHeight / this.sprite.height);\n\t\t\t\t}\n\n\t\t\t\tscaleX = scaleData.ratioX ? scaleY : scaleX;\n\t\t\t\tscaleY = scaleData.ratioY ? scaleX : scaleY;\n\n\t\t\t\tthis.scale.set(scaleX, scaleY);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync _setupMasks() {\n\t\tconst maskShapes = this.data.shapes.filter((shape) => shape.isMask);\n\n\t\tif (!this.data?.masks?.length && !maskShapes.length) return;\n\n\t\tconst maskFilter = MaskFilter.create();\n\n\t\tfor (const uuid of this.data.masks) {\n\t\t\tconst documentObj = fromUuidSync(uuid);\n\n\t\t\tif (!documentObj || documentObj.parent.id !== this.data.sceneId) continue;\n\n\t\t\tconst obj = documentObj.object;\n\n\t\t\tlet shape = obj?.mesh;\n\t\t\tlet shapeToAdd = shape;\n\n\t\t\tif (obj instanceof MeasuredTemplate || obj instanceof Drawing) {\n\t\t\t\tshape = obj?.shape?.geometry?.graphicsData?.[0]?.shape ?? obj?.shape;\n\n\t\t\t\tif (\n\t\t\t\t\tgame.modules.get(\"walledtemplates\")?.active &&\n\t\t\t\t\tobj.walledtemplates?.walledTemplate\n\t\t\t\t) {\n\t\t\t\t\tlet wt = obj.walledtemplates.walledTemplate;\n\t\t\t\t\twt.options.padding = 3 * canvas.dimensions.distancePixels;\n\t\t\t\t\tshape = wt.computeShape();\n\t\t\t\t\twt.options.padding = 0;\n\t\t\t\t}\n\n\t\t\t\tshapeToAdd = new PIXI.LegacyGraphics()\n\t\t\t\t\t.beginFill()\n\t\t\t\t\t.drawShape(shape)\n\t\t\t\t\t.endFill();\n\n\t\t\t\tif (obj instanceof MeasuredTemplate) {\n\t\t\t\t\tshapeToAdd.position.set(documentObj.x, documentObj.y);\n\t\t\t\t} else {\n\t\t\t\t\tconst {\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty,\n\t\t\t\t\t\tshape: { width, height },\n\t\t\t\t\t\trotation,\n\t\t\t\t\t} = documentObj;\n\t\t\t\t\tshapeToAdd.pivot.set(width / 2, height / 2);\n\t\t\t\t\tshapeToAdd.position.set(x + width / 2, y + height / 2);\n\t\t\t\t\tshapeToAdd.angle = rotation;\n\t\t\t\t}\n\t\t\t\tshapeToAdd.cullable = true;\n\t\t\t\tshapeToAdd.custom = true;\n\t\t\t\tshapeToAdd.renderable = false;\n\t\t\t\tshapeToAdd.uuid = uuid;\n\t\t\t\tcanvas.stage.addChild(shapeToAdd);\n\t\t\t}\n\t\t\tshapeToAdd.obj = obj;\n\n\t\t\tconst updateMethod = (doc) => {\n\t\t\t\tif (doc !== documentObj) return;\n\t\t\t\tconst mask = maskFilter.masks.find((shape) => shape.uuid === uuid);\n\t\t\t\tif (!mask) return;\n\t\t\t\tif (!mask.custom) return;\n\t\t\t\tmask.clear();\n\t\t\t\tif (obj instanceof MeasuredTemplate) {\n\t\t\t\t\tmask.position.set(documentObj.x, documentObj.y);\n\t\t\t\t\tlet maskObj = documentObj.object;\n\t\t\t\t\tshape = obj?.shape?.geometry?.graphicsData?.[0]?.shape ?? obj?.shape;\n\t\t\t\t\tif (\n\t\t\t\t\t\tgame.modules.get(\"walledtemplates\")?.active &&\n\t\t\t\t\t\tmaskObj.walledtemplates?.walledTemplate\n\t\t\t\t\t) {\n\t\t\t\t\t\tlet wt = maskObj.walledtemplates.walledTemplate;\n\t\t\t\t\t\twt.options.padding = 3 * canvas.dimensions.distancePixels;\n\t\t\t\t\t\tshape = wt.computeShape();\n\t\t\t\t\t\twt.options.padding = 0;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst {\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty,\n\t\t\t\t\t\tshape: { width, height },\n\t\t\t\t\t\trotation,\n\t\t\t\t\t} = documentObj;\n\t\t\t\t\tmask.pivot.set(width / 2, height / 2);\n\t\t\t\t\tmask.position.set(x + width / 2, y + height / 2);\n\t\t\t\t\tmask.angle = rotation;\n\t\t\t\t}\n\t\t\t\tmask.beginFill().drawShape(shape).endFill();\n\t\t\t};\n\n\t\t\tif (game.modules.get(\"walledtemplates\")?.active) {\n\t\t\t\thooksManager.addHook(this.uuid, \"createWall\", () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tupdateMethod(documentObj);\n\t\t\t\t\t}, 100);\n\t\t\t\t});\n\n\t\t\t\thooksManager.addHook(this.uuid, \"updateWall\", () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tupdateMethod(documentObj);\n\t\t\t\t\t}, 100);\n\t\t\t\t});\n\n\t\t\t\thooksManager.addHook(this.uuid, \"deleteWall\", () => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tupdateMethod(documentObj);\n\t\t\t\t\t}, 100);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\thooksManager.addHook(this.uuid, this.getHook(\"update\", uuid), (doc) => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tupdateMethod(doc);\n\t\t\t\t}, 100);\n\t\t\t});\n\n\t\t\tmaskFilter.masks.push(shapeToAdd);\n\t\t}\n\n\t\tfor (const shapeData of maskShapes) {\n\t\t\tconst shape = canvaslib.createShape(shapeData);\n\t\t\tshape.cullable = true;\n\t\t\tshape.custom = true;\n\t\t\tshape.renderable = false;\n\t\t\tthis.spriteContainer.addChild(shape);\n\t\t\tthis.shapes[shapeData?.name ?? \"shape-\" + foundry.utils.randomID()] = shape;\n\t\t\tmaskFilter.masks.push(shape);\n\t\t}\n\n\t\tthis.sprite.filters.push(maskFilter);\n\t}\n\n\t/**\n\t * Sets up the hooks relating to this effect's source and target\n\t *\n\t * @private\n\t */\n\t_setupHooks() {\n\t\tconst attachedToSource =\n\t\t\tthis.data.attachTo?.active && lib.is_UUID(this.data.source);\n\t\tconst attachedToTarget =\n\t\t\t(this.data.stretchTo?.attachTo || this.data.rotateTowards?.attachTo) &&\n\t\t\tlib.is_UUID(this.data.target);\n\n\t\tconst baseRenderable = this.shouldPlayVisible;\n\t\tlet renderable = baseRenderable;\n\t\tlet alpha = null;\n\n\t\tif (attachedToSource) {\n\t\t\thooksManager.addHook(this.uuid, this.getSourceHook(\"delete\"), (doc) => {\n\t\t\t\tconst uuid = doc.uuid;\n\t\t\t\tif (doc !== this.sourceDocument) return;\n\t\t\t\tthis._source = this._cachedSourceData.position;\n\t\t\t\tSequencerEffectManager.objectDeleted(uuid);\n\t\t\t});\n\n\t\t\tif (this.data.attachTo?.bindVisibility) {\n\t\t\t\thooksManager.addHook(\n\t\t\t\t\tthis.uuid,\n\t\t\t\t\t\"sightRefresh\",\n\t\t\t\t\t() => {\n\t\t\t\t\t\tconst sourceVisible =\n\t\t\t\t\t\t\tthis.source && (!this.sourceMesh?.occluded);\n\t\t\t\t\t\tconst sourceHidden =\n\t\t\t\t\t\t\tthis.sourceDocument && (this.sourceDocument?.hidden ?? false);\n\t\t\t\t\t\tconst targetVisible =\n\t\t\t\t\t\t\tthis.target &&\n\t\t\t\t\t\t\t(!attachedToTarget || (this.targetMesh?.occluded ?? true));\n\t\t\t\t\t\tthis.renderable =\n\t\t\t\t\t\t\tbaseRenderable &&\n\t\t\t\t\t\t\t(sourceVisible || targetVisible) &&\n\t\t\t\t\t\t\tthis._checkWallCollisions();\n\t\t\t\t\t\tthis.alpha = sourceVisible && sourceHidden ? 0.5 : 1.0;\n\t\t\t\t\t\trenderable = baseRenderable && this.renderable;\n\t\t\t\t\t},\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.data.attachTo?.bindAlpha || this.data.attachTo?.bindElevation) {\n\t\t\t\thooksManager.addHook(this.uuid, this.getSourceHook(\"update\"), (doc) => {\n\t\t\t\t\tif (doc !== this.sourceDocument) return;\n\t\t\t\t\tif (this.data.attachTo?.bindAlpha) {\n\t\t\t\t\t\tthis.spriteContainer.alpha = this.getSourceData().alpha;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.data.attachTo?.bindElevation) {\n\t\t\t\t\t\tthis.updateElevation();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.data.attachTo?.bindAlpha) {\n\t\t\t\talpha = this.getSourceData().alpha;\n\t\t\t}\n\t\t}\n\n\t\tif (attachedToTarget) {\n\t\t\thooksManager.addHook(this.uuid, this.getTargetHook(\"delete\"), (doc) => {\n\t\t\t\tif (doc !== this.target) return;\n\t\t\t\tthis._target = this._cachedTargetData.position;\n\t\t\t\tconst uuid = doc.uuid;\n\t\t\t\tSequencerEffectManager.objectDeleted(uuid);\n\t\t\t});\n\t\t\thooksManager.addHook(this.uuid, this.getTargetHook(\"update\"), (doc) => {\n\t\t\t\tif (doc !== this.target) return;\n\t\t\t\tthis.updateElevation();\n\t\t\t});\n\t\t}\n\n\t\tfor (let uuid of this.data?.tiedDocuments ?? []) {\n\t\t\tconst tiedDocument = fromUuidSync(uuid);\n\t\t\tif (tiedDocument) {\n\t\t\t\thooksManager.addHook(\n\t\t\t\t\tthis.uuid,\n\t\t\t\t\tthis.getHook(\"delete\", tiedDocument.uuid),\n\t\t\t\t\t(doc) => {\n\t\t\t\t\t\tif (tiedDocument !== doc) return;\n\t\t\t\t\t\tSequencerEffectManager.objectDeleted(doc.uuid);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tthis.renderable = renderable;\n\t\t\tthis.spriteContainer.alpha = alpha ?? 1.0;\n\t\t}, 25);\n\t}\n\n\t/**\n\t * Calculates the padding and scale to stretch an effect across the given distance\n\t *\n\t * If the file is a SequencerFileBase instance, it will also pick the appropriate file for the right distance\n\t *\n\t * @param distance\n\t * @returns {Object}\n\t * @private\n\t */\n\tasync _getTextureForDistance(distance) {\n\t\tif (!this._distanceCache || this._distanceCache?.distance !== distance) {\n\t\t\tlet scaleX = 1.0;\n\t\t\tlet scaleY = 1.0;\n\t\t\tlet texture;\n\t\t\tlet filePath;\n\t\t\tlet spriteAnchor = this.data.anchor?.x ?? 1.0;\n\n\t\t\tif (this._file instanceof SequencerFileBase) {\n\t\t\t\tconst scaledDistance = distance / (this.data.scale.x ?? 1.0);\n\t\t\t\tconst result = await this._file.getTexture(scaledDistance);\n\n\t\t\t\tfilePath = result.filePath;\n\n\t\t\t\ttexture = result.texture;\n\n\t\t\t\tspriteAnchor = result.spriteAnchor ?? this.data.anchor?.x ?? 0.0;\n\n\t\t\t\tscaleX = result.spriteScale;\n\n\t\t\t\tif (this.data.stretchTo?.onlyX) {\n\t\t\t\t\tconst widthWithPadding =\n\t\t\t\t\t\ttexture.width - (this.template.startPoint + this.template.endPoint);\n\t\t\t\t\tscaleY = widthWithPadding / texture.width;\n\t\t\t\t} else {\n\t\t\t\t\tscaleY = result.spriteScale;\n\t\t\t\t}\n\t\t\t} else if (this._file instanceof PIXI.Texture) {\n\t\t\t\tfilePath = this.data.file;\n\n\t\t\t\ttexture = this._file;\n\n\t\t\t\tspriteAnchor = this.template.startPoint / texture.width;\n\n\t\t\t\tconst widthWithPadding =\n\t\t\t\t\ttexture.width - (this.template.startPoint + this.template.endPoint);\n\t\t\t\tlet spriteScale = distance / widthWithPadding;\n\n\t\t\t\tscaleX = spriteScale;\n\n\t\t\t\tif (this.data.stretchTo?.onlyX) {\n\t\t\t\t\tscaleY = widthWithPadding / texture.width;\n\t\t\t\t} else {\n\t\t\t\t\tscaleY = spriteScale;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._distanceCache = {\n\t\t\t\tfilePath,\n\t\t\t\ttexture,\n\t\t\t\tspriteAnchor,\n\t\t\t\tscaleX,\n\t\t\t\tscaleY,\n\t\t\t\tdistance,\n\t\t\t};\n\t\t}\n\n\t\treturn this._distanceCache;\n\t}\n\n\t/**\n\t * Applies the distance scaling to the sprite based on the previous method\n\t *\n\t * @returns {Promise<void>}\n\t * @private\n\t */\n\tasync _applyDistanceScaling() {\n\t\tconst ray = new Ray(this.sourcePosition, this.targetPosition);\n\n\t\tthis._rotateTowards(ray);\n\n\t\tlet { filePath, texture, spriteAnchor, scaleX, scaleY, distance } =\n\t\t\tawait this._getTextureForDistance(ray.distance);\n\n\t\tif (\n\t\t\tthis._currentFilePath !== filePath ||\n\t\t\tthis._relatedSprites[filePath] === undefined\n\t\t) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.video = filePath.toLowerCase().endsWith(\".webm\")\n\t\t\t\t? texture?.baseTexture?.resource?.source ?? false\n\t\t\t\t: false;\n\n\t\t\tObject.values(this._relatedSprites).forEach((subsprite) => {\n\t\t\t\tsubsprite.renderable = false;\n\t\t\t});\n\n\t\t\tthis._currentFilePath = filePath;\n\n\t\t\tif (this._relatedSprites[filePath]) {\n\t\t\t\tthis._relatedSprites[filePath].renderable = true;\n\t\t\t} else {\n\t\t\t\tlet sprite;\n\t\t\t\tlet spriteType = this.data.tilingTexture\n\t\t\t\t\t? PIXI.TilingSprite\n\t\t\t\t\t: SpriteMesh;\n\t\t\t\tif (this.data.xray) {\n\t\t\t\t\tsprite = new spriteType(texture);\n\t\t\t\t} else {\n\t\t\t\t\tsprite = new spriteType(texture, VisionSamplerShader);\n\t\t\t\t}\n\t\t\t\tthis._relatedSprites[filePath] = sprite;\n\t\t\t\tif (this.data.tint) {\n\t\t\t\t\tsprite.tint = this.data.tint;\n\t\t\t\t}\n\n\t\t\t\tthis.sprite.addChild(sprite);\n\t\t\t}\n\n\t\t\tif (this._endTime) {\n\t\t\t\tif (this._endTime !== this.mediaCurrentTime) {\n\t\t\t\t\tthis.playMedia();\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.pauseMedia()\n\t\t\t\t\t}, (this._endTime - this.mediaCurrentTime) * 1000);\n\t\t\t\t} else {\n\t\t\t\t\tthis.mediaCurrentTime = this._endTime;\n\t\t\t\t\tthis.pauseMedia();\n\t\t\t\t\tthis.updateTexture();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.playMedia();\n\t\t\t}\n\t\t}\n\n\t\tif (this._relatedSprites[filePath]) {\n\t\t\tif (this.data.attachTo?.active) {\n\t\t\t\tthis._applyAttachmentOffset();\n\t\t\t}\n\n\t\t\tconst sprite = this._relatedSprites[filePath];\n\n\t\t\tif (!sprite.parent) {\n\t\t\t\tthis.sprite.addChild(sprite);\n\t\t\t}\n\n\t\t\tif (this.data.tilingTexture) {\n\t\t\t\tconst scaleX = (this.data.scale.x ?? 1.0) * this.gridSizeDifference;\n\t\t\t\tconst scaleY = (this.data.scale.y ?? 1.0) * this.gridSizeDifference;\n\t\t\t\tsprite.width = distance / scaleX;\n\t\t\t\tsprite.height = texture.height;\n\t\t\t\tsprite.scale.set(scaleX * this.flipX, scaleY * this.flipY);\n\n\t\t\t\tsprite.tileScale.x = this.data.tilingTexture.scale.x;\n\t\t\t\tsprite.tileScale.y = this.data.tilingTexture.scale.y;\n\n\t\t\t\tsprite.tilePosition = this.data.tilingTexture.position;\n\t\t\t} else {\n\t\t\t\tsprite.scale.set(\n\t\t\t\t\tscaleX * (this.data.scale.x ?? 1.0) * this.flipX,\n\t\t\t\t\tscaleY * (this.data.scale.y ?? 1.0) * this.flipY\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tsprite.anchor.set(\n\t\t\t\tthis.flipX === 1 ? spriteAnchor : 1 - spriteAnchor,\n\t\t\t\tthis.data.anchor?.y ?? 0.5\n\t\t\t);\n\t\t}\n\t}\n\n\t_checkWallCollisions() {\n\t\tif (\n\t\t\t!this.data.stretchTo?.attachTo ||\n\t\t\t!this.data.stretchTo?.requiresLineOfSight\n\t\t)\n\t\t\treturn true;\n\n\t\tconst ray = new Ray(this.sourcePosition, this.targetPosition);\n\n\t\tconst blockingObjects = canvas.walls.checkCollision(ray, { type: \"sight\" });\n\n\t\tif (!blockingObjects.length && !this.data.stretchTo?.hideLineOfSight) {\n\t\t\tSequencerEffectManager.endEffects({ effects: this });\n\t\t}\n\n\t\treturn !blockingObjects.length;\n\t}\n\n\t/**\n\t * Rotates the effect towards the target\n\t *\n\t * @param ray\n\t * @private\n\t */\n\t_rotateTowards(ray) {\n\t\tif (!ray) {\n\t\t\tconst sourcePosition =\n\t\t\t\tthis.flipX === 1 ? this.sourcePosition : this.targetPosition;\n\t\t\tconst targetPosition =\n\t\t\t\tthis.flipX === 1 ? this.targetPosition : this.sourcePosition;\n\t\t\tray = new Ray(sourcePosition, targetPosition);\n\t\t}\n\n\t\tthis.rotationContainer.rotation = Math.normalizeRadians(\n\t\t\tray.angle + Math.toRadians(this.data.rotateTowards?.rotationOffset ?? 0)\n\t\t);\n\t\tthis._tweakRotationForIsometric();\n\t}\n\n\t_tweakRotationForIsometric() {\n\t\tif (!CONSTANTS.INTEGRATIONS.ISOMETRIC.ACTIVE) return;\n\n\t\tif (this.data.stretchTo) {\n\t\t\tlet skew = Math.normalizeRadians(\n\t\t\t\tthis.rotationContainer.rotation - Math.PI / 4\n\t\t\t);\n\n\t\t\tif (\n\t\t\t\tMath.abs(skew) >= Math.PI / 2 - 0.5 &&\n\t\t\t\tMath.abs(skew) <= Math.PI / 2 + 0.5\n\t\t\t) {\n\t\t\t\tskew -= Math.PI / 2;\n\t\t\t}\n\n\t\t\tthis.isometricContainer.skew.set(Math.normalizeRadians(skew), 0);\n\t\t\tthis.isometricContainer.rotation = 0;\n\t\t} else if (this.data?.isometric?.overlay) {\n\t\t\tthis.rotationContainer.rotation = 0;\n\t\t\tlet skew = Math.PI / 4 + this.rotationContainer.rotation;\n\t\t\tthis.isometricContainer.skew.set(\n\t\t\t\tMath.normalizeRadians(skew - Math.PI / 4),\n\t\t\t\t0\n\t\t\t);\n\t\t\tthis.isometricContainer.scale.set(\n\t\t\t\t1.0,\n\t\t\t\twindow.scale ?? CONSTANTS.INTEGRATIONS.ISOMETRIC.ISOMETRIC_CONVERSION\n\t\t\t);\n\t\t} else {\n\t\t\tthis.isometricContainer.rotation = 0;\n\t\t}\n\t}\n\n\t/**\n\t * Transforms the sprite, rotating it, stretching it, scaling it, sizing it according its data\n\t *\n\t * @private\n\t */\n\tasync _transformSprite() {\n\t\tif (this.data.stretchTo) {\n\t\t\tif (this.data.stretchTo?.attachTo) {\n\t\t\t\tthis._addToTicker(this._transformStretchToAttachedSprite);\n\t\t\t}\n\t\t\tawait this._applyDistanceScaling();\n\t\t} else {\n\t\t\tif (!this.sprite?.texture?.valid && this.texture?.valid) {\n\t\t\t\tthis.sprite.texture = this.texture;\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tthis.video &&\n\t\t\t(this._startTime || this._loopOffset > 0) &&\n\t\t\tthis.video?.currentTime !== undefined\n\t\t) {\n\t\t\tawait lib.wait(20);\n\t\t\tthis.updateTexture();\n\t\t}\n\n\t\tif (!this.data.stretchTo) {\n\t\t\tthis._transformNoStretchSprite();\n\t\t}\n\n\t\tif (this.data.attachTo?.active && !this.data.stretchTo?.attachTo) {\n\t\t\tthis._addToTicker(this._transformAttachedNoStretchSprite);\n\t\t} else {\n\t\t\tif (!this.data.screenSpace) {\n\t\t\t\tthis.position.set(this.sourcePosition.x, this.sourcePosition.y);\n\t\t\t}\n\t\t}\n\n\t\tif (this.data.rotateTowards) {\n\t\t\tthis._rotateTowards();\n\n\t\t\tif (this.data.rotateTowards?.attachTo) {\n\t\t\t\tthis._addToTicker(this._transformRotateTowardsAttachedSprite);\n\t\t\t}\n\t\t}\n\n\t\tthis._tweakRotationForIsometric();\n\n\t\tconst spriteToConsider = this.sprite.children.length\n\t\t\t? this.sprite.children.find(child => child.renderable)\n\t\t\t: this.sprite;\n\n\t\tif (!this.data.anchor && this.data.rotateTowards) {\n\t\t\tconst textureWidth = (this.texture?.width ?? spriteToConsider.width) / 2;\n\t\t\tconst startPointRatio = this.template.startPoint / textureWidth;\n\t\t\tthis.spriteContainer.pivot.set(\n\t\t\t\tspriteToConsider.width * (-0.5 + startPointRatio),\n\t\t\t\t0\n\t\t\t);\n\t\t} else {\n\t\t\tthis.spriteContainer.pivot.set(\n\t\t\t\tlib.interpolate(\n\t\t\t\t\tspriteToConsider.width * -0.5,\n\t\t\t\t\tspriteToConsider.width * 0.5,\n\t\t\t\t\tthis.data.anchor?.x ?? 0.5\n\t\t\t\t),\n\t\t\t\tlib.interpolate(\n\t\t\t\t\tspriteToConsider.height * -0.5,\n\t\t\t\t\tspriteToConsider.height * 0.5,\n\t\t\t\t\tthis.data.anchor?.y ?? 0.5\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t}\n\n\tset texture(inTexture) {\n\t\tif (this.data?.fileOptions?.antialiasing !== PIXI.SCALE_MODES.LINEAR) {\n\t\t\tinTexture.baseTexture.setStyle(0, this.data?.fileOptions?.antialiasing)\n\t\t}\n\t\tthis._texture = inTexture;\n\t}\n\n\tget texture() {\n\t\treturn this._texture;\n\t}\n\n\tasync _transformStretchToAttachedSprite() {\n\t\ttry {\n\t\t\tawait this._applyDistanceScaling();\n\t\t} catch (err) {\n\t\t\t//lib.debug_error(err);\n\t\t}\n\t}\n\n\t_transformNoStretchSprite() {\n\t\tif (this.data.tilingTexture) {\n\t\t\tthis.sprite.tileScale = {\n\t\t\t\tx: this.data.tilingTexture.scale.x * this.gridSizeDifference,\n\t\t\t\ty: this.data.tilingTexture.scale.y * this.gridSizeDifference,\n\t\t\t};\n\n\t\t\tthis.sprite.tilePosition = this.data.tilingTexture.position;\n\t\t}\n\n\t\tconst heightWidthRatio = this.sprite.height / this.sprite.width;\n\t\tconst widthHeightRatio = this.sprite.width / this.sprite.height;\n\n\t\tconst baseScaleX =\n\t\t\t(this.data.scale?.x ?? 1.0) *\n\t\t\t(this.data.spriteScale?.x ?? 1.0) *\n\t\t\tthis.flipX;\n\t\tconst baseScaleY =\n\t\t\t(this.data.scale?.y ?? 1.0) *\n\t\t\t(this.data.spriteScale?.y ?? 1.0) *\n\t\t\tthis.flipY;\n\n\t\tif (this.data.scaleToObject) {\n\n\t\t\tif (this.data?.attachTo?.active && this.data?.attachTo?.bindScale) {\n\t\t\t\tthis._addToTicker(() => {\n\t\t\t\t\tthis._applyScaleToObject(heightWidthRatio, widthHeightRatio, baseScaleX, baseScaleY);\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._applyScaleToObject(heightWidthRatio, widthHeightRatio, baseScaleX, baseScaleY);\n\n\t\t} else if (this.data.size) {\n\n\t\t\tlet { height, width } = this.data.size;\n\n\t\t\tif (this.data.size.width === \"auto\" || this.data.size.height === \"auto\") {\n\t\t\t\theight = this.sprite.height;\n\t\t\t\twidth = this.sprite.width;\n\n\t\t\t\tif (this.data.size.width === \"auto\") {\n\t\t\t\t\theight = this.data.size.height;\n\t\t\t\t\tif (this.data.size.gridUnits) {\n\t\t\t\t\t\theight *= canvas.grid.size;\n\t\t\t\t\t}\n\t\t\t\t\twidth = height * widthHeightRatio;\n\t\t\t\t} else if (this.data.size.height === \"auto\") {\n\t\t\t\t\twidth = this.data.size.width;\n\t\t\t\t\tif (this.data.size.gridUnits) {\n\t\t\t\t\t\twidth *= canvas.grid.size;\n\t\t\t\t\t}\n\t\t\t\t\theight = width * heightWidthRatio;\n\t\t\t\t}\n\t\t\t} else if (this.data.size.gridUnits) {\n\t\t\t\theight *= canvas.grid.size;\n\t\t\t\twidth *= canvas.grid.size;\n\t\t\t}\n\n\t\t\tthis.sprite.width = width * baseScaleX;\n\t\t\tthis.sprite.height = height * baseScaleY;\n\t\t} else {\n\t\t\tthis.sprite.scale.set(\n\t\t\t\tbaseScaleX * this.gridSizeDifference,\n\t\t\t\tbaseScaleY * this.gridSizeDifference\n\t\t\t);\n\t\t}\n\t}\n\n\t_applyScaleToObject(heightWidthRatio, widthHeightRatio, baseScaleX, baseScaleY) {\n\n\t\ttry {\n\t\t\tlet { width, height } = this.getSourceData();\n\n\t\t\tif (this.sourceDocument instanceof TokenDocument) {\n\t\t\t\twidth *= this.data.scaleToObject?.considerTokenScale\n\t\t\t\t\t? this.sourceDocument.texture.scaleX\n\t\t\t\t\t: 1.0;\n\t\t\t\theight *= this.data.scaleToObject?.considerTokenScale\n\t\t\t\t\t? this.sourceDocument.texture.scaleY\n\t\t\t\t\t: 1.0;\n\t\t\t}\n\n\t\t\tif (width === this._lastDimensions.width && height === this._lastDimensions.height) return;\n\n\t\t\tthis._lastDimensions = { width, height };\n\n\t\t\tconst ratioToUse = heightWidthRatio > widthHeightRatio;\n\n\t\t\tif (this.data.scaleToObject?.uniform) {\n\t\t\t\tlet newWidth = Math.max(width, height);\n\t\t\t\theight = Math.max(width, height);\n\t\t\t\twidth = newWidth;\n\t\t\t} else {\n\t\t\t\twidth = width * (ratioToUse ? widthHeightRatio : 1.0);\n\t\t\t\theight = height * (!ratioToUse ? heightWidthRatio : 1.0);\n\t\t\t}\n\n\t\t\tthis.sprite.width = width * (this.data.scaleToObject?.scale ?? 1.0) * baseScaleX;\n\t\t\tthis.sprite.height = height * (this.data.scaleToObject?.scale ?? 1.0) * baseScaleY;\n\n\t\t\tSequencerAnimationEngine.updateStartValues(this.sprite, \"width\");\n\t\t\tSequencerAnimationEngine.updateStartValues(this.sprite, \"height\");\n\t\t\tSequencerAnimationEngine.updateStartValues(this.sprite, \"scale.x\");\n\t\t\tSequencerAnimationEngine.updateStartValues(this.sprite, \"scale.y\");\n\n\t\t} catch (err) {\n\n\t\t}\n\n\t}\n\n\tasync _transformAttachedNoStretchSprite() {\n\n\t\tif (this.isDestroyed) return;\n\n\t\tconst applyRotation =\n\t\t\tthis.data.attachTo?.bindRotation &&\n\t\t\t!(\n\t\t\t\tthis.sourceDocument instanceof TokenDocument &&\n\t\t\t\tthis.sourceDocument.lockRotation\n\t\t\t) &&\n\t\t\t(this.sourceDocument?.rotation !== undefined ||\n\t\t\t\tthis.sourceDocument?.direction !== undefined) &&\n\t\t\t!this.data.rotateTowards &&\n\t\t\t!this.data.stretchTo;\n\n\t\tif (applyRotation) {\n\t\t\tthis.rotationContainer.rotation = this.getSourceData().rotation;\n\t\t}\n\n\t\tthis._tweakRotationForIsometric();\n\n\t\ttry {\n\t\t\tthis._applyAttachmentOffset();\n\t\t} catch (err) {\n\t\t\tlib.debug_error(err);\n\t\t}\n\t}\n\n\t_applyAttachmentOffset() {\n\t\tlet offset = { x: 0, y: 0 };\n\n\t\tif (this.data.attachTo?.align && this.data.attachTo?.align !== \"center\") {\n\t\t\toffset = canvaslib.align({\n\t\t\t\tcontext: this.source,\n\t\t\t\tspriteWidth: this.sprite.width,\n\t\t\t\tspriteHeight: this.sprite.height,\n\t\t\t\talign: this.data.attachTo?.align,\n\t\t\t\tedge: this.data.attachTo?.edge,\n\t\t\t});\n\t\t}\n\n\t\tthis.position.set(\n\t\t\tthis.sourcePosition.x - offset.x,\n\t\t\tthis.sourcePosition.y - offset.y\n\t\t);\n\t}\n\n\tasync _transformRotateTowardsAttachedSprite() {\n\t\tif (this.isDestroyed) return;\n\t\ttry {\n\t\t\tthis._rotateTowards();\n\t\t} catch (err) {\n\t\t\tlib.debug_error(err);\n\t\t}\n\t}\n\n\t/**\n\t * Provided an animation targeting the rotation of the sprite's primary container, this method will counter-rotate\n\t * the sprite in an equal fashion so that the sprite's rotation remains static relative to this animation\n\t *\n\t * @param animation\n\t * @returns {*[]}\n\t * @private\n\t */\n\t_counterAnimateRotation(animation) {\n\t\tif (\n\t\t\tanimation.target === this.spriteContainer &&\n\t\t\tthis.data.zeroSpriteRotation\n\t\t) {\n\t\t\tdelete animation.target;\n\t\t\tlet counterAnimation = foundry.utils.deepClone(animation);\n\t\t\tanimation.target = this.spriteContainer;\n\t\t\tcounterAnimation.target = this.sprite;\n\t\t\tif (counterAnimation.values) {\n\t\t\t\tcounterAnimation.values = counterAnimation.values.map(\n\t\t\t\t\t(value) => value * -1\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tcounterAnimation.from *= -1;\n\t\t\t\tcounterAnimation.to *= -1;\n\t\t\t}\n\t\t\tif (!Array.isArray(animation)) {\n\t\t\t\tanimation = [animation, counterAnimation];\n\t\t\t} else {\n\t\t\t\tanimation.push(counterAnimation);\n\t\t\t}\n\t\t}\n\n\t\treturn animation;\n\t}\n\n\t/**\n\t * Plays the custom animations of this effect\n\t *\n\t * @returns {number}\n\t * @private\n\t */\n\t_playCustomAnimations() {\n\t\tif (!this.data.animations) return 0;\n\n\t\tthis._playAnimations(\n\t\t\tfoundry.utils.deepClone(this.data.animations) ?? [],\n\t\t\tthis.actualCreationTime - this.creationTimestamp\n\t\t);\n\t}\n\n\t_playAnimations(animations, timeDifference = 0) {\n\t\tlet animationsToSend = [];\n\n\t\tconst oneShotAnimations = animations.filter(\n\t\t\t(animation) => !animation.looping && !animation.fromEnd\n\t\t);\n\n\t\tfor (let animation of oneShotAnimations) {\n\t\t\tanimation.target = foundry.utils.getProperty(this, animation.target);\n\n\t\t\tif (!animation.target) continue;\n\n\t\t\tif (animation.propertyName.indexOf(\"rotation\") > -1) {\n\t\t\t\tanimation.from = animation.from * (Math.PI / 180);\n\t\t\t\tanimation.to = animation.to * (Math.PI / 180);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t[\"position.x\", \"position.y\", \"height\", \"width\"].includes(\n\t\t\t\t\tanimation.propertyName\n\t\t\t\t) &&\n\t\t\t\tanimation.gridUnits\n\t\t\t) {\n\t\t\t\tanimation.from *= canvas.grid.size;\n\t\t\t\tanimation.to *= canvas.grid.size;\n\t\t\t}\n\n\t\t\tif ([\"hue\"].includes(animation.propertyName)) {\n\t\t\t\tanimation.getPropertyName = \"values.\" + animation.propertyName;\n\t\t\t}\n\n\t\t\tanimationsToSend = animationsToSend.concat(\n\t\t\t\tthis._counterAnimateRotation(animation)\n\t\t\t);\n\t\t}\n\n\t\tconst loopingAnimations = animations.filter(\n\t\t\t(animation) => animation.looping\n\t\t);\n\n\t\tfor (let animation of loopingAnimations) {\n\t\t\tanimation.target = foundry.utils.getProperty(this, animation.target);\n\n\t\t\tif (!animation.target) continue;\n\n\t\t\tif (animation.propertyName.indexOf(\"rotation\") > -1) {\n\t\t\t\tanimation.values = animation.values.map((angle) => {\n\t\t\t\t\treturn angle * (Math.PI / 180);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t[\"position.x\", \"position.y\", \"height\", \"width\"].includes(\n\t\t\t\t\tanimation.propertyName\n\t\t\t\t) &&\n\t\t\t\tanimation.gridUnits\n\t\t\t) {\n\t\t\t\tanimation.values = animation.values.map((value) => {\n\t\t\t\t\treturn value * canvas.grid.size;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif ([\"hue\"].includes(animation.propertyName)) {\n\t\t\t\tanimation.getPropertyName = \"values.\" + animation.propertyName;\n\t\t\t}\n\n\t\t\tanimationsToSend = animationsToSend.concat(\n\t\t\t\tthis._counterAnimateRotation(animation)\n\t\t\t);\n\t\t}\n\n\t\tif (!(this instanceof PersistentCanvasEffect)) {\n\t\t\tanimationsToSend = animationsToSend.concat(\n\t\t\t\tthis._getFromEndCustomAnimations()\n\t\t\t);\n\t\t}\n\n\t\tsetTimeout(() => {\n\t\t\tSequencerAnimationEngine.addAnimation(\n\t\t\t\tthis.id,\n\t\t\t\tanimationsToSend,\n\t\t\t\ttimeDifference\n\t\t\t);\n\t\t}, 20);\n\t}\n\n\t_getFromEndCustomAnimations(immediate = false) {\n\t\tlet fromEndAnimations = [];\n\n\t\tconst animations = foundry.utils.deepClone(this.data.animations) ?? [];\n\n\t\tconst oneShotEndingAnimations = animations.filter(\n\t\t\t(animation) => !animation.looping && animation.fromEnd\n\t\t);\n\n\t\tfor (let animation of oneShotEndingAnimations) {\n\t\t\tanimation.target = foundry.utils.getProperty(this, animation.target);\n\n\t\t\tif (!animation.target) continue;\n\n\t\t\tanimation.delay = lib.is_real_number(immediate)\n\t\t\t\t? Math.max(immediate - animation.duration + animation.delay, 0)\n\t\t\t\t: Math.max(\n\t\t\t\t\tthis._totalDuration - animation.duration + animation.delay,\n\t\t\t\t\t0\n\t\t\t\t);\n\n\t\t\tif (animation.propertyName.indexOf(\"rotation\") > -1) {\n\t\t\t\tanimation.from = animation.from * (Math.PI / 180);\n\t\t\t\tanimation.to = animation.to * (Math.PI / 180);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t[\"position.x\", \"position.y\", \"height\", \"width\"].includes(\n\t\t\t\t\tanimation.propertyName\n\t\t\t\t) &&\n\t\t\t\tanimation.gridUnits\n\t\t\t) {\n\t\t\t\tanimation.from *= canvas.grid.size;\n\t\t\t\tanimation.to *= canvas.grid.size;\n\t\t\t}\n\n\t\t\tfromEndAnimations = fromEndAnimations.concat(\n\t\t\t\tthis._counterAnimateRotation(animation)\n\t\t\t);\n\t\t}\n\n\t\treturn fromEndAnimations;\n\t}\n\n\t/**\n\t * Fades in the effect at the start of the effect\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_fadeIn() {\n\t\tif (!this.data.fadeIn || !this.sprite) return 0;\n\n\t\tlet fadeIn = this.data.fadeIn;\n\n\t\tif (\n\t\t\tthis.actualCreationTime -\n\t\t\t(this.creationTimestamp + fadeIn.duration + fadeIn.delay) >\n\t\t\t0\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.alphaFilter.alpha = 0.0;\n\n\t\tSequencerAnimationEngine.addAnimation(this.id, {\n\t\t\ttarget: this.alphaFilter,\n\t\t\tpropertyName: \"alpha\",\n\t\t\tto: this.data.opacity,\n\t\t\tduration: fadeIn.duration,\n\t\t\tease: fadeIn.ease,\n\t\t\tdelay: fadeIn.delay,\n\t\t\tabsolute: true,\n\t\t});\n\n\t\treturn fadeIn.duration + fadeIn.delay;\n\t}\n\n\t/**\n\t * Fades in the effect's audio at the start of the effect\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_fadeInAudio() {\n\t\tif (!this.data.fadeInAudio || !this.sprite || !this.video) return 0;\n\n\t\tlet fadeInAudio = this.data.fadeInAudio;\n\n\t\tif (\n\t\t\tthis.actualCreationTime -\n\t\t\t(this.creationTimestamp +\n\t\t\t\tfadeInAudio.duration +\n\t\t\t\tfadeInAudio.delay) >\n\t\t\t0\n\t\t)\n\t\t\treturn;\n\n\t\tthis.video.volume = 0.0;\n\n\t\tSequencerAnimationEngine.addAnimation(this.id, {\n\t\t\ttarget: this,\n\t\t\tpropertyName: \"video.volume\",\n\t\t\tto:\n\t\t\t\t(this.data.volume ?? 0) *\n\t\t\t\tgame.settings.get(\"core\", \"globalInterfaceVolume\"),\n\t\t\tduration: fadeInAudio.duration,\n\t\t\tease: fadeInAudio.ease,\n\t\t\tdelay: fadeInAudio.delay,\n\t\t\tabsolute: true,\n\t\t});\n\n\t\treturn fadeInAudio.duration + fadeInAudio.delay;\n\t}\n\n\t/**\n\t * Fades out the effect at the end of the effect's duration\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_fadeOut(immediate = false) {\n\t\tif (!this.data.fadeOut || !this.sprite) return 0;\n\n\t\tlet fadeOut = this.data.fadeOut;\n\n\t\tfadeOut.delay = lib.is_real_number(immediate)\n\t\t\t? Math.max(immediate - fadeOut.duration + fadeOut.delay, 0)\n\t\t\t: Math.max(this._totalDuration - fadeOut.duration + fadeOut.delay, 0);\n\n\t\tSequencerAnimationEngine.addAnimation(this.id, {\n\t\t\ttarget: this.alphaFilter,\n\t\t\tpropertyName: \"alpha\",\n\t\t\tto: 0.0,\n\t\t\tduration: fadeOut.duration,\n\t\t\tease: fadeOut.ease,\n\t\t\tdelay: fadeOut.delay,\n\t\t\tabsolute: true,\n\t\t});\n\n\t\treturn fadeOut.duration + fadeOut.delay;\n\t}\n\n\t/**\n\t * Fades out the effect at the end of the effect's duration\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_fadeOutAudio(immediate = false) {\n\t\tif (!this.data.fadeOutAudio || !this.sprite || !this.video) return 0;\n\n\t\tlet fadeOutAudio = this.data.fadeOutAudio;\n\n\t\tfadeOutAudio.delay = lib.is_real_number(immediate)\n\t\t\t? Math.max(immediate - fadeOutAudio.duration + fadeOutAudio.delay, 0)\n\t\t\t: Math.max(\n\t\t\t\tthis._totalDuration - fadeOutAudio.duration + fadeOutAudio.delay,\n\t\t\t\t0\n\t\t\t);\n\n\t\tsetTimeout(() => {\n\t\t\tSequencerAnimationEngine.addAnimation(this.id, {\n\t\t\t\ttarget: this,\n\t\t\t\tpropertyName: \"video.volume\",\n\t\t\t\tto: 0.0,\n\t\t\t\tduration: fadeOutAudio.duration,\n\t\t\t\tease: fadeOutAudio.ease,\n\t\t\t\tdelay: fadeOutAudio.delay,\n\t\t\t\tabsolute: true,\n\t\t\t});\n\t\t});\n\n\t\treturn fadeOutAudio.duration + fadeOutAudio.delay;\n\t}\n\n\t/**\n\t * Determines the scale to animate from or to\n\t * @param property\n\t * @returns {{x: number, y: number}}\n\t * @private\n\t */\n\t_determineScale(property) {\n\t\tlet scale = {\n\t\t\tx: this.sprite.scale.x,\n\t\t\ty: this.sprite.scale.y,\n\t\t};\n\n\t\tif (lib.is_real_number(property.value)) {\n\t\t\tscale.x *= property.value * this.gridSizeDifference * this.flipX;\n\t\t\tscale.y *= property.value * this.gridSizeDifference * this.flipY;\n\t\t} else {\n\t\t\tscale.x *= property.value.x * this.gridSizeDifference * this.flipX;\n\t\t\tscale.y *= property.value.y * this.gridSizeDifference * this.flipY;\n\t\t}\n\n\t\treturn scale;\n\t}\n\n\t/**\n\t * Scales the effect in at the start of the effect\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_scaleIn() {\n\t\tif (!this.data.scaleIn || !this.sprite) return 0;\n\n\t\tlet scaleIn = this.data.scaleIn;\n\t\tlet fromScale = this._determineScale(scaleIn);\n\n\t\tif (\n\t\t\tthis.actualCreationTime -\n\t\t\t(this.creationTimestamp + scaleIn.duration + scaleIn.delay) >\n\t\t\t0\n\t\t)\n\t\t\treturn;\n\n\t\tlet toScale = {\n\t\t\tx: this.sprite.scale.x,\n\t\t\ty: this.sprite.scale.y,\n\t\t};\n\n\t\tthis.sprite.scale.set(fromScale.x, fromScale.y);\n\n\t\tSequencerAnimationEngine.addAnimation(this.id, [\n\t\t\t{\n\t\t\t\ttarget: this.sprite,\n\t\t\t\tpropertyName: \"scale.x\",\n\t\t\t\tfrom: fromScale.x,\n\t\t\t\tto: toScale.x,\n\t\t\t\tduration: scaleIn.duration,\n\t\t\t\tease: scaleIn.ease,\n\t\t\t\tdelay: scaleIn.delay,\n\t\t\t\tabsolute: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttarget: this.sprite,\n\t\t\t\tpropertyName: \"scale.y\",\n\t\t\t\tfrom: fromScale.y,\n\t\t\t\tto: toScale.y,\n\t\t\t\tduration: scaleIn.duration,\n\t\t\t\tease: scaleIn.ease,\n\t\t\t\tdelay: scaleIn.delay,\n\t\t\t\tabsolute: true,\n\t\t\t},\n\t\t]);\n\n\t\treturn scaleIn.duration + scaleIn.delay;\n\t}\n\n\t/**\n\t * Scales the effect out at the end of the effect's duration\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_scaleOut(immediate = false) {\n\t\tif (!this.data.scaleOut || !this.sprite) return 0;\n\n\t\tlet scaleOut = this.data.scaleOut;\n\t\tlet scale = this._determineScale(scaleOut);\n\n\t\tscaleOut.delay = lib.is_real_number(immediate)\n\t\t\t? Math.max(immediate - scaleOut.duration + scaleOut.delay, 0)\n\t\t\t: Math.max(\n\t\t\t\tthis._totalDuration - scaleOut.duration + scaleOut.delay,\n\t\t\t\t0\n\t\t\t);\n\n\t\tSequencerAnimationEngine.addAnimation(this.id, [\n\t\t\t{\n\t\t\t\ttarget: this.sprite,\n\t\t\t\tpropertyName: \"scale.x\",\n\t\t\t\tto: scale.x,\n\t\t\t\tduration: scaleOut.duration,\n\t\t\t\tease: scaleOut.ease,\n\t\t\t\tdelay: scaleOut.delay,\n\t\t\t\tabsolute: true,\n\t\t\t},\n\t\t\t{\n\t\t\t\ttarget: this.sprite,\n\t\t\t\tpropertyName: \"scale.y\",\n\t\t\t\tto: scale.y,\n\t\t\t\tduration: scaleOut.duration,\n\t\t\t\tease: scaleOut.ease,\n\t\t\t\tdelay: scaleOut.delay,\n\t\t\t\tabsolute: true,\n\t\t\t},\n\t\t]);\n\n\t\treturn scaleOut.duration + scaleOut.delay;\n\t}\n\n\t/**\n\t * Rotates the effect in at the start of the effect\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_rotateIn() {\n\t\tif (!this.data.rotateIn || !this.sprite) return 0;\n\n\t\tlet rotateIn = this.data.rotateIn;\n\n\t\tif (\n\t\t\tthis.actualCreationTime -\n\t\t\t(this.creationTimestamp + rotateIn.duration + rotateIn.delay) >\n\t\t\t0\n\t\t)\n\t\t\treturn;\n\n\t\tlet original_radians = this.spriteContainer.rotation;\n\t\tthis.spriteContainer.rotation = rotateIn.value * (Math.PI / 180);\n\n\t\tSequencerAnimationEngine.addAnimation(\n\t\t\tthis.id,\n\t\t\tthis._counterAnimateRotation({\n\t\t\t\ttarget: this.spriteContainer,\n\t\t\t\tpropertyName: \"rotation\",\n\t\t\t\tto: original_radians,\n\t\t\t\tduration: rotateIn.duration,\n\t\t\t\tease: rotateIn.ease,\n\t\t\t\tdelay: rotateIn.delay,\n\t\t\t\tabsolute: true,\n\t\t\t})\n\t\t);\n\n\t\treturn rotateIn.duration + rotateIn.delay;\n\t}\n\n\t/**\n\t * Rotates the effect out at the end of the effect's duration\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_rotateOut(immediate = false) {\n\t\tif (!this.data.rotateOut || !this.sprite) return 0;\n\n\t\tlet rotateOut = this.data.rotateOut;\n\n\t\trotateOut.delay = lib.is_real_number(immediate)\n\t\t\t? Math.max(immediate - rotateOut.duration + rotateOut.delay, 0)\n\t\t\t: Math.max(\n\t\t\t\tthis._totalDuration - rotateOut.duration + rotateOut.delay,\n\t\t\t\t0\n\t\t\t);\n\n\t\tSequencerAnimationEngine.addAnimation(\n\t\t\tthis.id,\n\t\t\tthis._counterAnimateRotation({\n\t\t\t\ttarget: this.spriteContainer,\n\t\t\t\tpropertyName: \"rotation\",\n\t\t\t\tto: rotateOut.value * (Math.PI / 180),\n\t\t\t\tduration: rotateOut.duration,\n\t\t\t\tease: rotateOut.ease,\n\t\t\t\tdelay: rotateOut.delay,\n\t\t\t\tabsolute: true,\n\t\t\t})\n\t\t);\n\n\t\treturn rotateOut.duration + rotateOut.delay;\n\t}\n\n\t/**\n\t * Causes the effect to move towards the given location\n\t *\n\t * @returns {number|*}\n\t * @private\n\t */\n\t_moveTowards() {\n\t\tif (!this.data.moves || !this.sprite) return 0;\n\n\t\tlet moves = this.data.moves;\n\n\t\tlet movementDuration = this._totalDuration;\n\t\tif (this.data.moveSpeed) {\n\t\t\tconst distance = canvaslib.distance_between(\n\t\t\t\tthis.sourcePosition,\n\t\t\t\tthis.targetPosition\n\t\t\t);\n\t\t\tmovementDuration = (distance / this.data.moveSpeed) * 1000;\n\t\t}\n\n\t\tif (this.data.moves.rotate) this._rotateTowards();\n\n\t\tconst duration = movementDuration - moves.delay;\n\n\t\tif (\n\t\t\tthis.actualCreationTime -\n\t\t\t(this.creationTimestamp + duration + moves.delay) >\n\t\t\t0\n\t\t)\n\t\t\treturn;\n\n\t\tSequencerAnimationEngine.addAnimation(this.id, [\n\t\t\t{\n\t\t\t\ttarget: this,\n\t\t\t\tpropertyName: \"position.x\",\n\t\t\t\tto: this.targetPosition.x,\n\t\t\t\tduration: duration,\n\t\t\t\tease: moves.ease,\n\t\t\t\tdelay: moves.delay,\n\t\t\t\tabsolute: true\n\t\t\t},\n\t\t\t{\n\t\t\t\ttarget: this,\n\t\t\t\tpropertyName: \"position.y\",\n\t\t\t\tto: this.targetPosition.y,\n\t\t\t\tduration: duration,\n\t\t\t\tease: moves.ease,\n\t\t\t\tdelay: moves.delay,\n\t\t\t\tabsolute: true\n\t\t\t},\n\t\t]);\n\n\t\treturn duration + moves.delay;\n\t}\n\n\t/**\n\t * If this effect is temporary, this sets the timeout for when the effect should resolve and get removed;\n\t *\n\t * @private\n\t */\n\t_setEndTimeout() {\n\t\tsetTimeout(() => {\n\t\t\tthis._resolve(this.data);\n\t\t\tthis.endEffect();\n\t\t}, this._totalDuration);\n\t}\n\n\t_setupTimestampHook(offset) {\n\t\tif (!this._file?.originalMetadata?.timestamps || this._ended) return;\n\t\tconst timestamps = this._file.getTimestamps();\n\t\tconst timestampArray = Array.isArray(timestamps)\n\t\t\t? timestamps\n\t\t\t: [timestamps];\n\t\tfor (const timestamp of timestampArray) {\n\t\t\tif (!lib.is_real_number(timestamp)) continue;\n\t\t\tlet realTimestamp = timestamp - offset / this.mediaPlaybackRate;\n\t\t\tif (realTimestamp < 0) {\n\t\t\t\trealTimestamp += this._endTime;\n\t\t\t}\n\t\t\tsetTimeout(() => {\n\t\t\t\tif (this._ended) return;\n\t\t\t\tHooks.callAll(\"sequencerEffectTimestamp\", this, this._file);\n\t\t\t\tif (this.mediaLooping) {\n\t\t\t\t\tconst offsets = (this._endTime - this.mediaCurrentTime) * -1000;\n\t\t\t\t\tthis._setupTimestampHook(offsets);\n\t\t\t\t}\n\t\t\t}, realTimestamp);\n\t\t}\n\t}\n\n\t/**\n\t * Starts the loop of this effect, calculating the difference between the effect's creation time, and the actual\n\t * creation time on the client\n\t *\n\t * @returns {Promise<void>}\n\t * @private\n\t */\n\tasync _startEffect() {\n\n\t\tif (!this.hasAnimatedMedia) return;\n\n\t\tlet creationTimeDifference = this.data.persist ? this.actualCreationTime - this.creationTimestamp : 0;\n\n\t\tthis._currentLoops = Math.floor(creationTimeDifference / this._totalDuration);\n\n\t\tif (this.loops && this._currentLoops >= this.loops) {\n\t\t\tif(this.data.loopOptions?.endOnLastLoop || !this.data.persist) {\n\t\t\t\treturn this.endEffect();\n\t\t\t}\n\t\t\tawait this.pauseMedia();\n\t\t\tthis.mediaCurrentTime = this._endTime;\n\t\t\tif (this.sprite.texture && this.video) {\n\t\t\t\tconst oldRenderable = this.renderable;\n\t\t\t\tthis.renderable = false;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.updateTexture();\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.renderable = oldRenderable;\n\t\t\t\t\t}, 150)\n\t\t\t\t}, 150);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\treturn this._startLoop(creationTimeDifference);\n\t}\n\n\t/**\n\t * Kicks off the loop, or just sets the video to loop\n\t *\n\t * @param creationTimeDifference\n\t * @returns {Promise<void>}\n\t * @private\n\t */\n\tasync _startLoop(creationTimeDifference) {\n\n\t\tif (!this._animationTimes.loopStart) {\n\t\t\tthis._loopOffset =\n\t\t\t\t(creationTimeDifference % this._animationDuration) / 1000;\n\t\t} else if ((creationTimeDifference / 1000) > this._animationTimes.loopStart) {\n\t\t\tconst loopDuration =\n\t\t\t\tthis._animationTimes.loopEnd - this._animationTimes.loopStart;\n\t\t\tthis._loopOffset =\n\t\t\t\t(creationTimeDifference % (loopDuration * 1000)) / 1000;\n\t\t}\n\n\t\treturn this._resetLoop();\n\t}\n\n\t/**\n\t * Continuously reset the video to the right time so that the start and end time can be preserved\n\t *\n\t * @returns {Promise<void>}\n\t * @private\n\t */\n\tasync _resetLoop(firstLoop = true) {\n\t\tif (this._ended) return;\n\n\t\tlet loopWaitTime = 0;\n\t\tif (this._animationTimes.loopStart) {\n\t\t\tif (this._isEnding) return;\n\t\t\tthis.mediaCurrentTime = (firstLoop ? 0 : this._animationTimes.loopStart) + (this._loopOffset > 0 ? this._loopOffset : 0);\n\t\t\tloopWaitTime = (this._animationTimes.loopEnd - this.mediaCurrentTime) * 1000;\n\t\t} else {\n\t\t\tthis.mediaCurrentTime = this._startTime + this._loopOffset;\n\t\t\tloopWaitTime = this._animationDuration - this._loopOffset * 1000;\n\t\t}\n\n\t\tawait this.playMedia();\n\n\t\tif (this.mediaLooping) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._resetTimeout = setTimeout(() => {\n\t\t\tif (this._ended) return;\n\t\t\tthis._loopOffset = 0;\n\t\t\tthis._currentLoops++;\n\t\t\tif (this.loops && this._currentLoops >= this.loops) {\n\t\t\t\tif(!this.data.persist || (this.data.persist && this.data.loopOptions?.endOnLastLoop)) {\n\t\t\t\t\tthis.endEffect();\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._resetLoop(false);\n\t\t}, loopWaitTime + this.loopDelay);\n\t}\n}\n\nclass PersistentCanvasEffect extends CanvasEffect {\n\n\t/** @OVERRIDE */\n\t_playPresetAnimations() {\n\t\tthis._moveTowards();\n\t\tthis._fadeIn();\n\t\tthis._scaleIn();\n\t\tthis._rotateIn();\n\t}\n\n\t/** @OVERRIDE */\n\t_timeoutVisibility() {\n\t\tlet creationTimeDifference = this.actualCreationTime - this.creationTimestamp;\n\t\tlet timeout =\n\t\t\tcreationTimeDifference === 0 && !this.data.animations ? 0 : 50;\n\t\tsetTimeout(() => {\n\t\t\tthis._setupHooks();\n\t\t}, timeout);\n\t}\n\n\t/** @OVERRIDE */\n\t_setEndTimeout() {\n\t\tlet creationTimeDifference = this.actualCreationTime - this.creationTimestamp;\n\t\tif(this.loops && creationTimeDifference >= this._totalDuration && this.hasAnimatedMedia){\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.pauseMedia();\n\t\t\t}, this._totalDuration);\n\t\t}\n\t}\n\n\t/** @OVERRIDE */\n\tasync endEffect() {\n\t\tif (this._isEnding) return;\n\t\tthis._isEnding = true;\n\t\tlet extraEndDuration = this.data.extraEndDuration ?? 0;\n\t\tthis.mediaLooping = false;\n\t\tif (this._animationTimes?.forcedEnd) {\n\t\t\tthis.mediaCurrentTime = this._animationTimes.forcedEnd;\n\t\t\textraEndDuration += (this.mediaDuration - (this._animationTimes?.forcedEnd ?? 0)) * 1000;\n\t\t} else if (this._animationTimes?.loopEnd) {\n\t\t\textraEndDuration += (this.mediaDuration - this.mediaCurrentTime) * 1000;\n\t\t}\n\t\tconst fromEndCustomAnimations = this._getFromEndCustomAnimations(extraEndDuration);\n\t\tconst durations = [\n\t\t\tthis._fadeOut(extraEndDuration),\n\t\t\tthis._fadeOutAudio(extraEndDuration),\n\t\t\tthis._scaleOut(extraEndDuration),\n\t\t\tthis._rotateOut(extraEndDuration),\n\t\t\textraEndDuration,\n\t\t\t...fromEndCustomAnimations.map(\n\t\t\t\t(animation) => animation.duration + animation.delay\n\t\t\t),\n\t\t].filter(Boolean);\n\t\tSequencerAnimationEngine.addAnimation(this.id, fromEndCustomAnimations);\n\t\tconst waitDuration = Math.max(...durations, 0);\n\t\tthis._resolve(waitDuration);\n\t\treturn new Promise((resolve) =>\n\t\t\tsetTimeout(() => {\n\t\t\t\tsuper.endEffect();\n\t\t\t\tresolve(this.data);\n\t\t\t}, waitDuration)\n\t\t);\n\t}\n}\n","import * as lib from \"./lib.js\";\nimport CanvasEffect from \"../canvas-effects/canvas-effect.js\";\nimport CONSTANTS from \"../constants.js\";\n\nexport function createShape(shape) {\n  const graphic = new PIXI.LegacyGraphics();\n\n\tgraphic.id = \"sequencer-graphics-\" + foundry.utils.randomID();\n\n\tgraphic.beginFill(\n\t\tshape?.isMask || !shape?.fillColor ? 0xffffff : shape?.fillColor,\n\t\tshape?.isMask ? 1 : (shape?.fillAlpha ?? 0)\n\t);\n\n  graphic.lineStyle(\n    shape.lineSize ?? (shape?.isMask ? 1 : 0),\n    shape?.lineColor ?? 0xffffff\n  );\n\n  const offsetX =\n    (shape.offset?.x ?? 0) * (shape.offset?.gridUnits ? canvas.grid.size : 1);\n  const offsetY =\n    (shape.offset?.y ?? 0) * (shape.offset?.gridUnits ? canvas.grid.size : 1);\n  const sizeMultiplier = shape.gridUnits ? canvas.grid.size : 1;\n\n  graphic.offset = {\n    x: offsetX,\n    y: offsetY,\n  };\n\n  switch (shape.type) {\n    case CONSTANTS.SHAPES.CIRC:\n      graphic.drawCircle(\n        graphic.offset.x,\n        graphic.offset.y,\n        shape.radius * sizeMultiplier\n      );\n      break;\n    case CONSTANTS.SHAPES.RECT:\n      graphic.drawRect(\n        graphic.offset.x,\n        graphic.offset.y,\n        shape.width * sizeMultiplier,\n        shape.height * sizeMultiplier\n      );\n      break;\n    case CONSTANTS.SHAPES.ELIP:\n      graphic.drawEllipse(\n        graphic.offset.x,\n        graphic.offset.y,\n        shape.width * sizeMultiplier,\n        shape.height * sizeMultiplier\n      );\n      break;\n    case CONSTANTS.SHAPES.RREC:\n      graphic.drawRoundedRect(\n        graphic.offset.x,\n        graphic.offset.y,\n        shape.width * sizeMultiplier,\n        shape.height * sizeMultiplier,\n        shape.radius * sizeMultiplier\n      );\n      break;\n    case CONSTANTS.SHAPES.POLY:\n      graphic.drawPolygon(\n        shape.points.map((point) => {\n          return new PIXI.Point(\n            point[0] * sizeMultiplier,\n            point[1] * sizeMultiplier\n          );\n        })\n      );\n      break;\n  }\n\n  graphic.alpha = shape.alpha ?? 1.0;\n\n  graphic.endFill();\n\n  return graphic;\n}\n\nexport function calculate_missed_position(source, target, twister) {\n  const sourcePosition = get_object_position(source);\n  const sourceDimensions = get_object_dimensions(source, true);\n\n  if (!target) {\n    const angle = twister.random() * Math.PI * 2;\n    let x = Math.cos(angle) * sourceDimensions.width;\n    let y = Math.sin(angle) * sourceDimensions.height;\n\n    return {\n      x: lib.random_float_between(x * 1.5, x * 2.5, twister),\n      y: lib.random_float_between(y * 1.5, y * 2.5, twister),\n    };\n  }\n\n  const targetDimensions = get_object_dimensions(target, true);\n  const targetPosition = get_object_position(target);\n\n  const ray = new Ray(targetPosition, sourcePosition);\n\n  let startRadians = ray.angle + Math.PI / 2;\n  let endRadians = ray.angle - Math.PI / 2;\n\n  const sizeCompensation = Math.max(\n    1,\n    Math.abs(sourceDimensions.width - targetDimensions.height)\n  );\n  let distance = ray.distance / canvas.grid.size - sizeCompensation;\n\n  if (distance <= 1) {\n    const angle =\n      twister.random() > 0.5\n        ? ray.angle + Math.PI / 4\n        : ray.angle - Math.PI / 4;\n    const x = Math.cos(angle) * targetDimensions.width;\n    const y = Math.sin(angle) * targetDimensions.height;\n    return { x, y };\n  }\n\n  distance = Math.max(Math.abs(distance - 15), 6);\n\n  endRadians -= Math.PI / distance;\n  startRadians += Math.PI / distance;\n\n  const angle = lib.interpolate(startRadians, endRadians, twister.random());\n  const x = Math.cos(angle) * targetDimensions.width;\n  const y = Math.sin(angle) * targetDimensions.height;\n\n  return {\n    x: lib.random_float_between(x * 1.5, x * 2.5, twister),\n    y: lib.random_float_between(y * 1.5, y * 2.5, twister),\n  };\n}\n\nexport function get_object_position(\n  obj,\n  { measure = false, exact = false } = {}\n) {\n  if (obj instanceof CanvasEffect) {\n    return obj.worldPosition;\n  }\n\n  obj = obj?._object ?? obj.object ?? obj;\n\n  let pos = {};\n  if (obj instanceof MeasuredTemplate) {\n    if (measure) {\n      if (obj.document.t === \"cone\" || obj.document.t === \"ray\") {\n        pos.x = obj.ray.B.x;\n        pos.y = obj.ray.B.y;\n      }\n    }\n    if (obj.document.t === \"rect\") {\n      pos.x = obj.x;\n      pos.y = obj.y;\n\n      if (!exact) {\n        pos.x += Math.abs(obj.shape.width / 2) + obj.shape.x;\n        pos.y += Math.abs(obj.shape.height / 2) + obj.shape.y;\n      }\n    }\n  } else if (obj instanceof Tile) {\n    pos = {\n      x: obj.document.x,\n      y: obj.document.y,\n    };\n\n    if (!exact) {\n      pos.x += Math.abs(obj.document.width / 2);\n      pos.y += Math.abs(obj.document.height / 2);\n    }\n  } else if (obj instanceof Token) {\n    const halfSize = get_object_dimensions(obj, true);\n    pos = {\n      x: obj.x + halfSize.width,\n      y: obj.y + halfSize.height,\n    };\n\n    if (exact) {\n      pos.x -= halfSize.width;\n      pos.y -= halfSize.height;\n    }\n  } else if (obj instanceof Drawing) {\n    pos = {\n      x: obj.document.x,\n      y: obj.document.y,\n    };\n\n    if (!exact) {\n      const halfSize = get_object_dimensions(obj, true);\n      pos.x += halfSize.width;\n      pos.y += halfSize.height;\n    }\n  }\n\n  pos = {\n    x:\n      pos.x ??\n      obj?.x ??\n      obj?.position?.x ??\n      obj?.position?._x ??\n      obj?.document?.x ??\n      obj?.document?.position?.x ??\n      null,\n    y:\n      pos.y ??\n      obj?.y ??\n      obj?.position?.y ??\n      obj?.position?._y ??\n      obj?.document?.y ??\n      obj?.document?.position?.y ??\n      null,\n    elevation: obj?.elevation ?? obj?.document?.elevation ?? null,\n  };\n\n  if (pos.x === null) delete pos[\"x\"];\n  if (pos.y === null) delete pos[\"y\"];\n  if (pos.elevation === null) delete pos[\"elevation\"];\n\n  return pos;\n}\n\nexport function get_random_offset(target, randomOffset, twister = false) {\n  let { width, height } = get_object_dimensions(target, true);\n\n  width *= randomOffset;\n  height *= randomOffset;\n\n  return {\n    x: lib.random_float_between(width * -1, width, twister),\n    y: lib.random_float_between(height * -1, height, twister),\n  };\n}\n\nexport function get_object_dimensions(inObj, half = false) {\n  inObj = inObj?.object ?? inObj?._object ?? inObj;\n\n  let width =\n    inObj?.hitArea?.width ??\n    inObj?.w ??\n    inObj?.shape?.width ??\n    (inObj?.shape?.radius ? inObj?.shape?.radius * 2 : undefined) ??\n    inObj?.width ??\n    canvas.grid.size;\n\n  let height =\n    inObj?.hitArea?.height ??\n    inObj?.h ??\n    inObj?.shape?.height ??\n    (inObj?.shape?.radius ? inObj?.shape?.radius * 2 : undefined) ??\n    inObj?.height ??\n    canvas.grid.size;\n\n  return {\n    width: width / (half ? 2 : 1),\n    height: height / (half ? 2 : 1),\n  };\n}\n\nexport const alignments = {\n  \"top-left\": { x: 0.5, y: 0.5 },\n  top: { x: 0, y: 0.5 },\n  \"top-right\": { x: -0.5, y: 0.5 },\n  left: { x: 0.5, y: 0 },\n  center: { x: 0, y: 0 },\n  right: { x: -0.5, y: 0 },\n  \"bottom-left\": { x: 0.5, y: -0.5 },\n  bottom: { x: 0, y: -0.5 },\n  \"bottom-right\": { x: -0.5, y: -0.5 },\n};\n\nexport function align({\n  context,\n  spriteWidth,\n  spriteHeight,\n  align,\n  edge,\n} = {}) {\n  let { width, height } = get_object_dimensions(context);\n\n  const alignRatio = alignments[align];\n  const offset = {\n    x: lib.interpolate(width * -0.5, width * 0.5, alignRatio.x + 0.5),\n    y: lib.interpolate(height * -0.5, height * 0.5, alignRatio.y + 0.5),\n  };\n\n  return {\n    x:\n      offset.x +\n      (edge && edge !== \"on\"\n        ? spriteWidth * alignRatio.x * (edge === \"outer\" ? 1 : -1)\n        : 0),\n    y:\n      offset.y +\n      (edge && edge !== \"on\"\n        ? spriteHeight * alignRatio.y * (edge === \"outer\" ? 1 : -1)\n        : 0),\n  };\n}\n\nexport function is_object_canvas_data(inObj) {\n  if (typeof inObj !== \"object\") return false;\n  const keys = Object.keys(inObj);\n  keys.sort();\n  return (\n    (keys.includes(\"x\") && keys.includes(\"y\")) ||\n    (keys.includes(\"height\") &&\n      keys.includes(\"width\") &&\n      keys.includes(\"x\") &&\n      keys.includes(\"y\"))\n  );\n}\n\nexport function get_object_canvas_data(inObject, measure = false) {\n  inObject = inObject?.object ?? inObject;\n  return {\n    ...get_object_position(inObject, { measure }),\n    ...get_object_dimensions(inObject?.mesh ?? inObject?.tile ?? inObject),\n    elevation: get_object_elevation(inObject),\n    uuid: inObject?.document?.uuid ?? inObject?.uuid,\n    cachedLocation: true,\n  };\n}\n\nexport function get_object_elevation(inObject) {\n  return inObject?.document?.elevation ?? inObject?.elevation ?? 0;\n}\n\nexport function get_mouse_position(snapToGrid = false) {\n  const pos = lib.getCanvasMouse().getLocalPosition(canvas.app.stage);\n\n\tconst snappingOptions = CONSTANTS.IS_V12 ? {\n\t\tmode: CONST.GRID_SNAPPING_MODES.CENTER | CONST.GRID_SNAPPING_MODES.VERTEX | CONST.GRID_SNAPPING_MODES.EDGE_MIDPOINT\n\t} : 2;\n\n\treturn !snapToGrid\n\t\t? new PIXI.Point(pos.x, pos.y)\n\t\t: canvas.grid.getSnappedPoint({ x: pos.x, y: pos.y }, snappingOptions)\n}\n\nexport function distance_between(p1, p2) {\n  return new Ray(p1, p2).distance;\n}\n\n/**\n * Whether the current video is playing or not\n *\n * @returns {boolean}\n */\nexport function is_video_playing(video) {\n  return (\n    !!video &&\n    video.currentTime >= 0 &&\n    !video.paused &&\n    video.currentTime <= video.duration\n  );\n}\n\n/**\n * Determines whether a position is within the bounds of this effect\n *\n * @param inPosition\n * @param inElement\n * @param relativeTo\n * @returns {boolean}\n */\nexport function is_position_within_bounds(inPosition, inElement, relativeTo) {\n  const localPosition = inElement.toLocal(inPosition, relativeTo);\n  return inElement.getLocalBounds().contains(localPosition.x, localPosition.y);\n}\n\nexport function rotate_coordinate(p1, p2, radians) {\n  let cos = Math.cos(radians);\n  let sin = Math.sin(radians);\n  let nx = cos * (p2.x - p1.x) + sin * (p2.y - p1.y) + p1.x;\n  let ny = cos * (p2.y - p1.y) - sin * (p2.x - p1.x) + p1.y;\n  return [nx, ny];\n}\n\n/**\n * Gets the closest token to a certain position\n *\n * @param inPosition\n * @param minimumDistance\n * @returns {*|boolean}\n */\nexport function get_closest_token(\n  inPosition,\n  { minimumDistance = false } = {}\n) {\n  let tokens = Array.from(canvas.scene.tokens);\n  if (minimumDistance) {\n    tokens = tokens.filter(\n      (token) =>\n        distance_between(get_object_position(token), inPosition) <=\n        minimumDistance\n    );\n  }\n  tokens.sort((a, b) => {\n    return (\n      distance_between(get_object_position(a), inPosition) -\n      distance_between(get_object_position(b), inPosition)\n    );\n  });\n  return tokens?.[0] ?? false;\n}\n\nexport function getBezierControlPoints(factor, previous, point, next) {\n  // Calculate distance vectors\n  let vector = { x: next[0] - previous[0], y: next[1] - previous[1] },\n    preDistance = Math.hypot(previous[0] - point[0], previous[1] - point[1]),\n    postDistance = Math.hypot(next[0] - point[0], next[1] - point[1]),\n    distance = preDistance + postDistance;\n\n  // Compute control point locations\n  let cp0d = distance === 0 ? 0 : factor * (preDistance / distance),\n    cp1d = distance === 0 ? 0 : factor * (postDistance / distance);\n\n  // Return points\n  return {\n    cp1: {\n      x: point[0] - vector.x * cp0d,\n      y: point[1] - vector.y * cp0d,\n    },\n    next_cp0: {\n      x: point[0] + vector.x * cp1d,\n      y: point[1] + vector.y * cp1d,\n    },\n  };\n}\n\nexport function rotateAroundPoint(cx, cy, x, y, radians) {\n  const cos = Math.cos(radians);\n  const sin = Math.sin(radians);\n  const nx = cos * (x - cx) + sin * (y - cy) + cx;\n  const ny = cos * (y - cy) - sin * (x - cx) + cy;\n  return { x: nx, y: ny };\n}\n\nexport function validateAnimation(inTarget, inPropertyName, inOptions) {\n  if (typeof inPropertyName !== \"string\") {\n    return `inPropertyName must be of type string`;\n  }\n  if (typeof inTarget !== \"string\") {\n    return `inTarget must be of type string`;\n  }\n  if (!lib.is_real_number(inOptions.from)) {\n    return `inOptions.from must be of type number`;\n  }\n  if (!lib.is_real_number(inOptions.to)) {\n    return `inOptions.to must be of type number`;\n  }\n  if (!lib.is_real_number(inOptions.duration)) {\n    return `inOptions.duration must be of type number`;\n  }\n  if (inOptions?.delay !== undefined && !lib.is_real_number(inOptions.delay)) {\n    return `inOptions.delay must be of type number`;\n  }\n  if (inOptions?.ease !== undefined && typeof inOptions.ease !== \"string\") {\n    return `inOptions.ease must be of type string`;\n  }\n  if (\n    inOptions?.fromEnd !== undefined &&\n    typeof inOptions.fromEnd !== \"boolean\"\n  ) {\n    return `inOptions.fromEnd must be of type boolean`;\n  }\n  if (inOptions?.gridUnits !== undefined) {\n    if (typeof inOptions.gridUnits !== \"boolean\") {\n      return `inOptions.gridUnits must be of type boolean`;\n    }\n    if (\n      inOptions.gridUnits &&\n      ![\n        \"position.x\",\n        \"position.y\",\n        \"scale.x\",\n        \"scale.y\",\n        \"height\",\n        \"width\",\n      ].includes(inPropertyName)\n    ) {\n      return `if inOptions.gridUnits is true, inPropertyName must be position.x, position.y, scale.x, scale.y, width, or height`;\n    }\n  }\n\tif (\n\t\tinOptions?.absolute !== undefined &&\n\t\ttypeof inOptions.absolute !== \"boolean\"\n\t) {\n\t\treturn `inOptions.absolute must be of type boolean`;\n\t}\n\n  return {\n    target: inTarget,\n    propertyName: inPropertyName,\n    from: inOptions?.from,\n    to: inOptions?.to,\n    duration: inOptions?.duration ?? 0,\n    delay: inOptions?.delay ?? 0,\n    ease: inOptions?.ease ?? \"linear\",\n    looping: false,\n    fromEnd: inOptions?.fromEnd ?? false,\n    gridUnits: inOptions?.gridUnits ?? false,\n    absolute: inOptions?.absolute ?? false,\n  };\n}\n\nexport function validateLoopingAnimation(inTarget, inPropertyName, inOptions) {\n  if (typeof inPropertyName !== \"string\") {\n    return `inPropertyName must be of type string`;\n  }\n  if (typeof inTarget !== \"string\") {\n    return `inTarget must be of type string`;\n  }\n\n  if (!inOptions?.values) {\n    if (!inOptions?.from === undefined || !inOptions?.to === undefined) {\n      return `if inOptions.values is not set, you must provide inOptions.from and inOptions.to`;\n    }\n    if (!lib.is_real_number(inOptions.from)) {\n      return `inOptions.from must be of type number`;\n    }\n    if (!lib.is_real_number(inOptions.to)) {\n      return `inOptions.to must be of type number`;\n    }\n    inOptions.values = [inOptions?.from, inOptions?.to];\n    delete inOptions.from;\n    delete inOptions.to;\n  } else {\n    if (!Array.isArray(inOptions.values)) {\n      return `inOptions.values must be of type array`;\n    }\n    inOptions.values.forEach((value) => {\n      if (!lib.is_real_number(value)) {\n        return `values in inOptions.keys must be of type number`;\n      }\n    });\n  }\n\n  if (!lib.is_real_number(inOptions.duration)) {\n    return `inOptions.duration must be of type number`;\n  }\n\n  if (inOptions?.delay !== undefined && !lib.is_real_number(inOptions.delay)) {\n    return `inOptions.delay must be of type number`;\n  }\n  if (inOptions?.ease !== undefined && typeof inOptions.ease !== \"string\") {\n    return `inOptions.ease must be of type string`;\n  }\n  if (inOptions?.loops !== undefined && !lib.is_real_number(inOptions.loops)) {\n    return `inOptions.loops must be of type number`;\n  }\n  if (\n    inOptions?.pingPong !== undefined &&\n    typeof inOptions.pingPong !== \"boolean\"\n  ) {\n    return `inOptions.pingPong must be of type boolean`;\n  }\n  if (inOptions?.gridUnits !== undefined) {\n    if (typeof inOptions.gridUnits !== \"boolean\") {\n      return `inOptions.gridUnits must be of type boolean`;\n    }\n    if (\n      inOptions.gridUnits &&\n      ![\n        \"position.x\",\n        \"position.y\",\n        \"scale.x\",\n        \"scale.y\",\n        \"height\",\n        \"width\",\n      ].includes(inPropertyName)\n    ) {\n      return `if inOptions.gridUnits is true, inPropertyName must be position.x, position.y, scale.x, scale.y, width, or height`;\n    }\n  }\n\n  return {\n    target: inTarget,\n    propertyName: inPropertyName,\n    values: inOptions?.values,\n    duration: inOptions?.duration ?? 0,\n    delay: inOptions?.delay ?? 0,\n    ease: inOptions?.ease ?? \"linear\",\n    looping: true,\n    loops: inOptions?.loops,\n    indefinite:\n      inOptions?.loops === undefined || !lib.is_real_number(inOptions?.loops),\n    pingPong: inOptions?.pingPong ?? false,\n    gridUnits: inOptions?.gridUnits ?? false,\n  };\n}\n","import * as lib from \"../lib/lib.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport { sequencerSocket, SOCKET_HANDLERS } from \"../sockets.js\";\nimport CONSTANTS from \"../constants.js\";\n\nconst flagManager = {\n\tflagEffectAddBuffer: new Map(),\n\tflagEffectRemoveBuffer: new Map(),\n\tflagSoundAddBuffer: new Map(),\n\tflagSoundRemoveBuffer: new Map(),\n\t_latestFlagVersion: false,\n\n\tget latestFlagVersion() {\n\t\tif (!this._latestFlagVersion) {\n\t\t\tconst versions = Object.keys(this.effectMigrations);\n\t\t\tversions.sort((a, b) => {\n\t\t\t\treturn foundry.utils.isNewerVersion(a, b) ? -1 : 1;\n\t\t\t});\n\t\t\tthis._latestFlagVersion = versions[0];\n\t\t}\n\t\treturn this._latestFlagVersion;\n\t},\n\n\t/**\n\t * Sanitizes the effect data, accounting for changes to the structure in previous versions\n\t *\n\t * @param inDocument\n\t * @returns {array}\n\t */\n\tgetEffectFlags(inDocument) {\n\t\tlet effects = foundry.utils.getProperty(inDocument, CONSTANTS.EFFECTS_FLAG);\n\n\t\tif (!effects?.length) return [];\n\n\t\teffects = foundry.utils.deepClone(effects);\n\n\t\tconst changes = [];\n\t\tfor (let [effectId, effectData] of effects) {\n\t\t\tlet effectVersion = effectData?.flagVersion ?? \"1.0.0\";\n\n\t\t\tif (effectData.flagVersion === this.latestFlagVersion) continue;\n\n\t\t\tfor (let [version, migration] of Object.entries(this.effectMigrations)) {\n\t\t\t\tif (!foundry.utils.isNewerVersion(version, effectVersion)) continue;\n\n\t\t\t\teffectData = migration(inDocument, effectData);\n\t\t\t}\n\n\t\t\tlib.debug(\n\t\t\t\t`Migrated effect with ID ${effectId} from version ${effectVersion} to version ${this.latestFlagVersion}`,\n\t\t\t);\n\n\t\t\teffectData.flagVersion = this.latestFlagVersion;\n\n\t\t\tchanges.push(effectData);\n\t\t}\n\n\t\tif (changes.length) {\n\t\t\tflagManager.addEffectFlags(inDocument.uuid, changes);\n\t\t}\n\n\t\treturn effects;\n\t},\n\n\teffectMigrations: {\n\t\t\"2.0.0\": (inDocument, effectData) => {\n\t\t\teffectData._id = effectData.id;\n\t\t\teffectData.creationTimestamp = effectData.timestamp;\n\n\t\t\tif (effectData.template) {\n\t\t\t\teffectData.template = {\n\t\t\t\t\tgridSize: effectData.template[0],\n\t\t\t\t\tstartPoint: effectData.template[1],\n\t\t\t\t\tendPoint: effectData.template[2],\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (effectData.attachTo) {\n\t\t\t\teffectData.attachTo = {\n\t\t\t\t\tactive: true,\n\t\t\t\t\talign: \"center\",\n\t\t\t\t\trotation: true,\n\t\t\t\t\tbindVisibility: true,\n\t\t\t\t\tbindAlpha: true,\n\t\t\t\t};\n\t\t\t\teffectData.source = inDocument.uuid;\n\t\t\t\tconst objectSize = canvaslib.get_object_dimensions(inDocument, true);\n\t\t\t\teffectData.offset = {\n\t\t\t\t\tx: effectData.position.x - objectSize.width,\n\t\t\t\t\ty: effectData.position.y - objectSize.height,\n\t\t\t\t};\n\t\t\t} else if (effectData.position) {\n\t\t\t\teffectData.source = effectData.position;\n\t\t\t}\n\n\t\t\tif (effectData.reachTowards) {\n\t\t\t\teffectData.stretchTo = {\n\t\t\t\t\tattachTo: false,\n\t\t\t\t\tonlyX: false,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (effectData.filters) {\n\t\t\t\teffectData.filters = Object.entries(effectData.filters).map((entry) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tclassName: entry[0],\n\t\t\t\t\t\t...entry[1],\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\n\t\t\teffectData.moveSpeed = effectData.speed;\n\n\t\t\teffectData.target = null;\n\t\t\teffectData.forcedIndex = null;\n\t\t\teffectData.flipX = false;\n\t\t\teffectData.flipY = false;\n\t\t\teffectData.nameOffsetMap = {};\n\t\t\teffectData.sequenceId = 0;\n\n\t\t\tdelete effectData.id;\n\t\t\tdelete effectData.timestamp;\n\t\t\tdelete effectData.position;\n\t\t\tdelete effectData.reachTowards;\n\t\t\tdelete effectData.speed;\n\t\t\tdelete effectData.audioVolume;\n\t\t\tdelete effectData.gridSizeDifference;\n\t\t\tdelete effectData.template;\n\n\t\t\tif (effectData.animatedProperties) {\n\t\t\t\tdelete effectData.animatedProperties.fadeInAudio;\n\t\t\t\tdelete effectData.animatedProperties.fadeOutAudio;\n\t\t\t}\n\n\t\t\teffectData = foundry.utils.mergeObject(\n\t\t\t\teffectData,\n\t\t\t\teffectData.animatedProperties,\n\t\t\t);\n\n\t\t\tdelete effectData.animatedProperties;\n\n\t\t\treturn effectData;\n\t\t},\n\n\t\t\"2.0.6\": (inDocument, effectData) => {\n\t\t\teffectData.private = null;\n\n\t\t\treturn effectData;\n\t\t},\n\n\t\t\"2.0.8\": (inDocument, effectData) => {\n\t\t\tif (effectData.stretchTo) {\n\t\t\t\teffectData.stretchTo.tiling = false;\n\t\t\t}\n\n\t\t\treturn effectData;\n\t\t},\n\n\t\t\"2.0.9\": (inDocument, effectData) => {\n\t\t\teffectData.tilingTexture = false;\n\n\t\t\tif (effectData.stretchTo?.tiling !== undefined) {\n\t\t\t\tif (effectData.stretchTo.tiling) {\n\t\t\t\t\teffectData.tilingTexture = {\n\t\t\t\t\t\tscale: { x: 1, y: 1 },\n\t\t\t\t\t\tposition: { x: 0, y: 0 },\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tdelete effectData.stretchTo.tiling;\n\t\t\t}\n\n\t\t\treturn effectData;\n\t\t},\n\n\t\t\"2.1.0\": (inDocument, effectData) => {\n\t\t\tif (effectData.randomOffset) {\n\t\t\t\teffectData.randomOffset = {\n\t\t\t\t\tsource: !effectData.target ? effectData.randomOffset : false,\n\t\t\t\t\ttarget: !!effectData.target ? effectData.randomOffset : false,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (effectData.nameOffsetMap) {\n\t\t\t\tObject.values(effectData.nameOffsetMap).forEach((offsetMap) => {\n\t\t\t\t\tif (offsetMap.randomOffset) {\n\t\t\t\t\t\toffsetMap.randomOffset = {\n\t\t\t\t\t\t\tsource: !offsetMap.target ? offsetMap.randomOffset : false,\n\t\t\t\t\t\t\ttarget: !!offsetMap.target ? offsetMap.randomOffset : false,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn effectData;\n\t\t},\n\n\t\t\"3.2.0\": (inDocument, effectData) => {\n\t\t\tif(effectData.attachTo?.followRotation !== undefined){\n\t\t\t\teffectData.attachTo.bindRotation = effectData.attachTo.followRotation;\n\t\t\t\tdelete effectData.attachTo.followRotation;\n\t\t\t}\n\t\t\tif (effectData.scaleToObject) {\n\t\t\t\tif (effectData.attachTo?.active) {\n\t\t\t\t\teffectData.attachTo.bindScale = true;\n\t\t\t\t} else if (!effectData.attachTo?.active && !effectData.attachTo?.bindScale) {\n\t\t\t\t\teffectData.scaleToObject = false;\n\t\t\t\t\teffectData.size = canvaslib.get_object_dimensions(inDocument);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn effectData;\n\t\t},\n\n\t\t\"3.2.1\": (inDocument, effectData) => {\n\t\t\tif(effectData.noLoop !== undefined){\n\t\t\t\teffectData.loopOptions = {\n\t\t\t\t\tloops: 1,\n\t\t\t\t\tloopDelay: 0,\n\t\t\t\t\tendOnLastLoop: false\n\t\t\t\t}\n\t\t\t\tdelete effectData.noLoop;\n\t\t\t}\n\t\t\treturn effectData;\n\t\t}\n\t},\n\n\t/**\n\t * Adds effects to a given document\n\t *\n\t * @param inObjectUUID\n\t * @param inEffects\n\t */\n\taddEffectFlags: (inObjectUUID, inEffects) => {\n\t\tif (!Array.isArray(inEffects)) inEffects = [inEffects];\n\t\tsequencerSocket.executeAsGM(\n\t\t\tSOCKET_HANDLERS.ADD_EFFECT_FLAGS,\n\t\t\tinObjectUUID,\n\t\t\tinEffects,\n\t\t);\n\t},\n\n\t/**\n\t * Removes effects from a given document\n\t *\n\t * @param inObjectUUID\n\t * @param inEffects\n\t * @param removeAll\n\t */\n\tremoveEffectFlags: (inObjectUUID, inEffects, removeAll = false) => {\n\t\tsequencerSocket.executeAsGM(\n\t\t\tSOCKET_HANDLERS.REMOVE_EFFECT_FLAGS,\n\t\t\tinObjectUUID,\n\t\t\tinEffects,\n\t\t\tremoveAll,\n\t\t);\n\t},\n\n\t_addEffectFlags: (inObjectUUID, inEffects) => {\n\t\tif (!Array.isArray(inEffects)) inEffects = [inEffects];\n\n\t\tlet flagsToSet = flagManager.flagEffectAddBuffer.get(inObjectUUID) ?? {\n\t\t\teffects: [],\n\t\t};\n\n\t\tflagsToSet.effects.push(...inEffects);\n\n\t\tflagManager.flagEffectAddBuffer.set(inObjectUUID, flagsToSet);\n\n\t\tflagManager.updateEffectFlags();\n\t},\n\n\t_removeEffectFlags: (inObjectUUID, inEffects, removeAll = false) => {\n\t\tif (inEffects && !Array.isArray(inEffects)) inEffects = [inEffects];\n\n\t\tlet flagsToSet = flagManager.flagEffectRemoveBuffer.get(inObjectUUID) ?? {\n\t\t\teffects: [],\n\t\t\tremoveAll: removeAll,\n\t\t};\n\n\t\tif (inEffects) flagsToSet.effects.push(...inEffects);\n\n\t\tflagManager.flagEffectRemoveBuffer.set(inObjectUUID, flagsToSet);\n\n\t\tflagManager.updateEffectFlags();\n\t},\n\n\tupdateEffectFlags: foundry.utils.debounce(async () => {\n\t\tlet flagsToAdd = Array.from(flagManager.flagEffectAddBuffer);\n\t\tlet flagsToRemove = Array.from(flagManager.flagEffectRemoveBuffer);\n\n\t\tflagManager.flagEffectAddBuffer.clear();\n\t\tflagManager.flagEffectRemoveBuffer.clear();\n\n\t\tflagsToAdd.forEach((entry) => (entry[1].original = true));\n\t\tflagsToRemove.forEach((entry) => (entry[1].original = true));\n\n\t\tconst objects = new Set([\n\t\t\t...flagsToAdd.map((effect) => effect[0]).filter(Boolean),\n\t\t\t...flagsToRemove.map((effect) => effect[0]).filter(Boolean),\n\t\t]);\n\n\t\tflagsToAdd = new Map(flagsToAdd);\n\t\tflagsToRemove = new Map(flagsToRemove);\n\n\t\tconst actorUpdates = {};\n\t\tconst sceneObjectsToUpdate = {};\n\n\t\tfor (let objectUUID of objects) {\n\t\t\tlet object = fromUuidSync(objectUUID);\n\n\t\t\tif (!object) {\n\t\t\t\tlib.debug(\n\t\t\t\t\t`Failed to set flags on non-existent object with UUID: ${objectUUID}`,\n\t\t\t\t);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet toAdd = flagsToAdd.get(objectUUID) ?? { effects: [] };\n\t\t\tlet toRemove = flagsToRemove.get(objectUUID) ?? {\n\t\t\t\teffects: [],\n\t\t\t\tremoveAll: false,\n\t\t\t};\n\n\t\t\tconst existingFlags = new Map(\n\t\t\t\tfoundry.utils.getProperty(object, CONSTANTS.EFFECTS_FLAG) ?? [],\n\t\t\t);\n\n\t\t\tif (toRemove?.removeAll) {\n\t\t\t\ttoRemove.effects = Array.from(existingFlags).map((entry) => entry[0]);\n\t\t\t}\n\n\t\t\tfor (let effect of toAdd.effects) {\n\t\t\t\tif (typeof effect === \"string\") {\n\t\t\t\t\teffect = existingFlags.get(effect);\n\t\t\t\t\tif (!effect) continue;\n\t\t\t\t}\n\t\t\t\texistingFlags.set(effect._id, effect);\n\t\t\t}\n\n\t\t\tfor (let effect of toRemove.effects) {\n\t\t\t\tif (typeof effect === \"string\") {\n\t\t\t\t\teffect = existingFlags.get(effect);\n\t\t\t\t\tif (!effect) continue;\n\t\t\t\t}\n\t\t\t\texistingFlags.delete(effect._id);\n\t\t\t}\n\n\t\t\tlet flagsToSet = Array.from(existingFlags);\n\t\t\tconst options = {};\n\n\t\t\tconst isLinkedToken = object instanceof TokenDocument && object.actorLink;\n\t\t\tconst isLinkedActor =\n\t\t\t\tobject instanceof Actor && object.prototypeToken.actorLink;\n\n\t\t\tif (\n\t\t\t\t(isLinkedToken || isLinkedActor) &&\n\t\t\t\t(toAdd.original || toRemove.original)\n\t\t\t) {\n\t\t\t\tconst actor = isLinkedActor ? object : object.actor;\n\t\t\t\tactorUpdates[actor.id] = flagsToSet.filter(\n\t\t\t\t\t(effect) => effect[1]?.persistOptions?.persistTokenPrototype,\n\t\t\t\t);\n\t\t\t\tflagsToSet = flagsToSet.filter(\n\t\t\t\t\t(effect) => !effect[1]?.persistOptions?.persistTokenPrototype,\n\t\t\t\t);\n\t\t\t\tif (\n\t\t\t\t\tisLinkedToken &&\n\t\t\t\t\tgame.modules.get(\"multilevel-tokens\")?.active &&\n\t\t\t\t\tfoundry.utils.getProperty(object, \"flags.multilevel-tokens.stoken\")\n\t\t\t\t) {\n\t\t\t\t\toptions[\"mlt_bypass\"] = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (object?.documentName === \"Scene\") {\n\t\t\t\tconst sceneId = object.id;\n\t\t\t\tsceneObjectsToUpdate[sceneId] = sceneObjectsToUpdate[sceneId] ?? {\n\t\t\t\t\tupdates: {},\n\t\t\t\t\tdocuments: {},\n\t\t\t\t};\n\t\t\t\tsceneObjectsToUpdate[sceneId].updates[CONSTANTS.EFFECTS_FLAG] =\n\t\t\t\t\tflagsToSet;\n\t\t\t} else if (!(object instanceof Actor)) {\n\t\t\t\tconst sceneId = object.parent.id;\n\t\t\t\tconst docName = object.documentName;\n\t\t\t\tsceneObjectsToUpdate[sceneId] = sceneObjectsToUpdate[sceneId] ?? {\n\t\t\t\t\tupdates: {},\n\t\t\t\t\tdocuments: {},\n\t\t\t\t};\n\t\t\t\tsceneObjectsToUpdate[sceneId].documents[docName] = sceneObjectsToUpdate[\n\t\t\t\t\tsceneId\n\t\t\t\t\t].documents[docName] ?? {\n\t\t\t\t\toptions: {},\n\t\t\t\t\tupdates: [],\n\t\t\t\t};\n\t\t\t\tsceneObjectsToUpdate[sceneId].documents[docName].options = options;\n\t\t\t\tsceneObjectsToUpdate[sceneId].documents[docName].updates.push({\n\t\t\t\t\t_id: object.id,\n\t\t\t\t\t[CONSTANTS.EFFECTS_FLAG]: flagsToSet,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfor (const [sceneId, sceneData] of Object.entries(sceneObjectsToUpdate)) {\n\t\t\tconst scene = game.scenes.get(sceneId);\n\t\t\tif (!foundry.utils.isEmpty(sceneData.updates)) {\n\t\t\t\tawait scene.update(sceneData.updates);\n\t\t\t}\n\t\t\tfor (const [documentType, documentData] of Object.entries(\n\t\t\t\tsceneData.documents,\n\t\t\t)) {\n\t\t\t\tawait scene.updateEmbeddedDocuments(\n\t\t\t\t\tdocumentType,\n\t\t\t\t\tdocumentData.updates,\n\t\t\t\t\tdocumentData.options,\n\t\t\t\t);\n\t\t\t\tlib.debug(\n\t\t\t\t\t`Flags set for documents of type \"${documentType}\" in scene with ID \"${sceneId}\"`,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tawait Actor.updateDocuments(\n\t\t\tObject.entries(actorUpdates).map(([actorId, effects]) => ({\n\t\t\t\t_id: actorId,\n\t\t\t\t[CONSTANTS.EFFECTS_FLAG]: effects,\n\t\t\t})),\n\t\t);\n\t}, 250),\n\n\t/**\n\t * Sanitizes the effect data, accounting for changes to the structure in previous versions\n\t *\n\t * @param inDocument\n\t * @returns {array}\n\t */\n\tgetSoundFlags(inDocument) {\n\t\tlet sounds = foundry.utils.getProperty(inDocument, CONSTANTS.SOUNDS_FLAG);\n\n\t\tif (!sounds?.length) return [];\n\n\t\tsounds = foundry.utils.deepClone(sounds);\n\n\t\tconst changes = [];\n\t\tfor (let [soundId, soundData] of sounds) {\n\t\t\tlet soundVersion = soundData?.flagVersion ?? \"1.0.0\";\n\n\t\t\tif (soundData.flagVersion === this.latestFlagVersion) continue;\n\n\t\t\tfor (let [version, migration] of Object.entries(this.soundMigrations)) {\n\t\t\t\tif (!foundry.utils.isNewerVersion(version, soundVersion)) continue;\n\n\t\t\t\tsoundData = migration(inDocument, soundData);\n\t\t\t}\n\n\t\t\tlib.debug(\n\t\t\t\t`Migrated sound with ID ${soundId} from version ${soundVersion} to version ${this.latestFlagVersion}`,\n\t\t\t);\n\n\t\t\tsoundData.flagVersion = this.latestFlagVersion;\n\n\t\t\tchanges.push(soundData);\n\t\t}\n\n\t\tif (changes.length) {\n\t\t\tflagManager.addSoundFlags(inDocument.uuid, changes);\n\t\t}\n\n\t\treturn sounds;\n\t},\n\n\tsoundMigrations: {},\n\n\t/**\n\t * Adds sounds to a given document\n\t *\n\t * @param inObjectUUID\n\t * @param inSounds\n\t */\n\taddSoundFlags: (inObjectUUID, inSounds) => {\n\t\tif (!Array.isArray(inSounds)) inSounds = [inSounds];\n\t\tsequencerSocket.executeAsGM(\n\t\t\tSOCKET_HANDLERS.ADD_EFFECT_FLAGS,\n\t\t\tinObjectUUID,\n\t\t\tinSounds,\n\t\t);\n\t},\n\n\t/**\n\t * Removes sounds from a given document\n\t *\n\t * @param inObjectUUID\n\t * @param inSounds\n\t * @param removeAll\n\t */\n\tremoveSoundFlags: (inObjectUUID, inSounds, removeAll = false) => {\n\t\tsequencerSocket.executeAsGM(\n\t\t\tSOCKET_HANDLERS.REMOVE_EFFECT_FLAGS,\n\t\t\tinObjectUUID,\n\t\t\tinSounds,\n\t\t\tremoveAll,\n\t\t);\n\t},\n\n\t_addSoundFlags: (sceneID, inSounds) => {\n\t\tif (!Array.isArray(inSounds)) inSounds = [inSounds];\n\n\t\tlet flagsToSet = flagManager.flagAddBuffer.get(sceneID) ?? {\n\t\t\teffects: [],\n\t\t};\n\n\t\tflagsToSet.effects.push(...inSounds);\n\n\t\tflagManager.flagSoundAddBuffer.set(sceneID, flagsToSet);\n\n\t\tflagManager.updateSoundFlags();\n\t},\n\n\t_removeSoundFlags: (sceneID, inSounds, removeAll = false) => {\n\t\tif (inSounds && !Array.isArray(inSounds)) inSounds = [inSounds];\n\n\t\tlet flagsToSet = flagManager.flagRemoveBuffer.get(sceneID) ?? {\n\t\t\teffects: [],\n\t\t\tremoveAll: removeAll,\n\t\t};\n\n\t\tif (inSounds) flagsToSet.effects.push(...inSounds);\n\n\t\tflagManager.flagSoundRemoveBuffer.set(sceneID, flagsToSet);\n\n\t\tflagManager.updateSoundFlags();\n\t},\n\n\tupdateFlags: foundry.utils.debounce(async () => {\n\n\t\tlet soundFlagsToAdd = Array.from(flagManager.flagSoundAddBuffer);\n\t\tlet soundFlagsToRemove = Array.from(flagManager.flagSoundRemoveBuffer);\n\n\t\tflagManager.flagSoundAddBuffer.clear();\n\t\tflagManager.flagSoundRemoveBuffer.clear();\n\n\t\tsoundFlagsToAdd.forEach((entry) => (entry[1].original = true));\n\t\tsoundFlagsToRemove.forEach((entry) => (entry[1].original = true));\n\n\t\tconst scenes = new Set([\n\t\t\t...soundFlagsToAdd.map((sound) => sound[0]).filter(Boolean),\n\t\t\t...soundFlagsToRemove.map((sound) => sound[0]).filter(Boolean),\n\t\t]);\n\n\t\tsoundFlagsToAdd = new Map(soundFlagsToAdd);\n\t\tsoundFlagsToRemove = new Map(soundFlagsToRemove);\n\n\t\tconst scenesToUpdate = {};\n\n\t\tfor (let sceneId of scenes) {\n\t\t\tlet scene = game.scenes.get(sceneId);\n\n\t\t\tif (!scene) {\n\t\t\t\tlib.debug(\n\t\t\t\t\t`Failed to set flags on non-existent scene with ID: ${sceneId}`,\n\t\t\t\t);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet soundsToAdd = soundFlagsToAdd.get(sceneId) ?? { sounds: [] };\n\t\t\tlet soundsToRemove = soundFlagsToRemove.get(sceneId) ?? {\n\t\t\t\tsounds: [],\n\t\t\t\tremoveAll: false,\n\t\t\t};\n\n\t\t\tconst existingFlags = new Map(\n\t\t\t\tfoundry.utils.getProperty(scene, CONSTANTS.SOUNDS_FLAG) ?? [],\n\t\t\t);\n\n\t\t\tif (soundsToRemove?.removeAll) {\n\t\t\t\tsoundsToRemove.sounds = Array.from(existingFlags).map((entry) => entry[0]);\n\t\t\t}\n\n\t\t\tfor (let sound of soundsToAdd.sounds) {\n\t\t\t\tif (typeof sound === \"string\") {\n\t\t\t\t\tsound = existingFlags.get(sound);\n\t\t\t\t\tif (!sound) continue;\n\t\t\t\t}\n\t\t\t\texistingFlags.set(sound.sound_id, sound);\n\t\t\t}\n\n\t\t\tfor (let sound of soundsToRemove.sounds) {\n\t\t\t\tif (typeof sound === \"string\") {\n\t\t\t\t\tsound = existingFlags.get(sound);\n\t\t\t\t\tif (!sound) continue;\n\t\t\t\t}\n\t\t\t\texistingFlags.delete(sound.sound_id);\n\t\t\t}\n\n\t\t\tlet flagsToSet = Array.from(existingFlags);\n\n\t\t\tscenesToUpdate[sceneId] = scenesToUpdate[sceneId] ?? {\n\t\t\t\tupdates: {},\n\t\t\t\tdocuments: {},\n\t\t\t};\n\n\t\t\tscenesToUpdate[sceneId].updates[CONSTANTS.EFFECTS_FLAG] = flagsToSet;\n\n\t\t}\n\n\t\tfor (const [sceneId, sceneData] of Object.entries(scenesToUpdate)) {\n\t\t\tconst scene = game.scenes.get(sceneId);\n\t\t\tawait scene.update(sceneData.updates);\n\t\t}\n\n\t}, 250),\n\n};\n\nexport default flagManager;\n","import * as lib from \"../lib/lib.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport { sequencerSocket, SOCKET_HANDLERS } from \"../sockets.js\";\n\nlet lockedView = false;\n\nexport default class SequencerFoundryReplicator {\n  static registerHooks() {\n    Hooks.on(\"canvasPan\", () => {\n      if (!lockedView) return;\n      canvas.stage.pivot.set(lockedView.x, lockedView.y);\n      canvas.stage.scale.set(lockedView.scale, lockedView.scale);\n      canvas.updateBlur(lockedView.scale);\n      canvas.controls._onCanvasPan();\n      canvas.hud.align();\n    });\n  }\n\n  static _validateObject(inObject, sceneId) {\n    if (lib.is_UUID(inObject) || !canvaslib.is_object_canvas_data(inObject)) {\n      inObject = lib.get_object_from_scene(inObject, sceneId);\n    }\n    return inObject?._object ?? inObject;\n  }\n\n  static _getPositionFromData(data) {\n    const source = this._validateObject(data.source, data.sceneId);\n\n    const position =\n      source instanceof PlaceableObject\n        ? canvaslib.get_object_position(source)\n        : source?.worldPosition || source?.center || source;\n\n    const multiplier = data.randomOffset;\n    const twister = lib.createMersenneTwister(data.seed);\n\n    if (source && multiplier) {\n      let randomOffset = canvaslib.get_random_offset(\n        source,\n        multiplier,\n        twister\n      );\n      position.x -= randomOffset.x;\n      position.y -= randomOffset.y;\n    }\n\n    let extraOffset = data.offset;\n    if (extraOffset) {\n      let newOffset = {\n        x: extraOffset.x,\n        y: extraOffset.y,\n      };\n      if (extraOffset.gridUnits) {\n        newOffset.x *= canvas.grid.size;\n        newOffset.y *= canvas.grid.size;\n      }\n      if (extraOffset.local) {\n        newOffset = canvaslib.rotateAroundPoint(\n          0,\n          0,\n          newOffset.x,\n          newOffset.y,\n          source?.rotation ?? 0\n        );\n      }\n      position.x -= newOffset.x;\n      position.y -= newOffset.y;\n    }\n\n    return position;\n  }\n\n  static playScrollingText(data, push = true) {\n    if (push) {\n      sequencerSocket.executeForOthers(\n        SOCKET_HANDLERS.CREATE_SCROLLING_TEXT,\n        data\n      );\n    }\n    return this._playScrollingText(data);\n  }\n\n  static _playScrollingText(data) {\n    if (game.user.viewedScene !== data.sceneId) return;\n    if (data.users.length && !data.users.includes(game.userId)) return;\n\n    canvas.interface.createScrollingText(\n      this._getPositionFromData(data),\n      data.content,\n      data.options\n    );\n\n    return data.options?.duration ?? 2000;\n  }\n\n  static panCanvas(data, push = true) {\n    if (push) {\n      sequencerSocket.executeForOthers(SOCKET_HANDLERS.PAN_CANVAS, data);\n    }\n\n    return this._panCanvas(data);\n  }\n\n  static _panCanvas(data) {\n    if (game.user.viewedScene !== data.sceneId) return;\n    if (data.users.length && !data.users.includes(game.userId)) return;\n\n    if (data.source) {\n      const position = this._getPositionFromData(data);\n\n      canvas.animatePan({\n        x: position.x,\n        y: position.y,\n        scale: data.scale,\n        duration: data.duration,\n        speed: data.speed,\n      });\n\n      if (data.speed) {\n        let ray = new Ray(canvas.stage.pivot, {\n          x: position.x,\n          y: position.y,\n        });\n        data.duration = Math.round((ray.distance * 1000) / data.speed);\n      }\n\n      if (data.lockView > 0) {\n        setTimeout(() => {\n          lockedView = {\n            x: position.x,\n            y: position.y,\n            scale: data.scale,\n          };\n        }, data.duration);\n        setTimeout(() => {\n          lockedView = false;\n        }, data.lockView + data.duration);\n      }\n    } else {\n      data.duration = 0;\n    }\n\n    if (data.shake) {\n      setTimeout(() => {\n        this._shake(data.shake);\n      }, data.duration);\n    }\n\n    return (\n      data.duration + Math.max(data.lockView ?? 0, data.shake?.duration ?? 0)\n    );\n  }\n\n  static _shake(shakeData) {\n\n\t  if(!shakeData.duration || !shakeData.frequency) return;\n\n    let x = lib.random_float_between(-1, 1);\n    let y = lib.random_float_between(-1, 1);\n    let rot = shakeData.rotation ? lib.random_float_between(-1, 1) : 0;\n    let positions = [{ x, y, rot }];\n\n\t\tfor (\n\t\t\tlet index = 0;\n\t\t\tindex < Math.floor(shakeData.duration / shakeData.frequency);\n\t\t\tindex++\n\t\t) {\n\t\t\tx = lib.flip_negate(x, Math.random());\n\t\t\ty = lib.flip_negate(y, Math.random());\n\t\t\trot = shakeData.rotation ? lib.flip_negate(rot, Math.random()) : 0;\n\t\t\tpositions.push({ x, y, rot });\n\t\t}\n\n    let currentDuration = 0;\n    positions = positions.map((pos) => {\n      let fadeStrength = 1;\n      if (\n        shakeData.fadeInDuration &&\n        currentDuration <= shakeData.fadeInDuration\n      ) {\n        fadeStrength = Math.max(\n          0,\n          Math.min(1, currentDuration / shakeData.fadeInDuration)\n        );\n      }\n      if (\n        shakeData.fadeOutDuration &&\n        currentDuration >= shakeData.duration - shakeData.fadeOutDuration\n      ) {\n        fadeStrength = Math.max(\n          0,\n          Math.min(\n            1,\n            (shakeData.duration - currentDuration) / shakeData.fadeOutDuration\n          )\n        );\n      }\n      pos.x *= shakeData.strength * fadeStrength;\n      pos.y *= shakeData.strength * fadeStrength;\n      if (shakeData.rotation) {\n        pos.rot *= (shakeData.strength / 7.5) * fadeStrength;\n      } else {\n        pos.rot = 0;\n      }\n      currentDuration += shakeData.frequency;\n      return {\n        transform: `translate(${pos.x}px, ${pos.y}px) rotate(${pos.rot}deg)`,\n      };\n    });\n\n    document.getElementById(\"board\").animate(positions, {\n      duration: shakeData.duration,\n    });\n  }\n}\n","import { sequencerSocket, SOCKET_HANDLERS } from \"../sockets.js\";\nimport SequencerFileCache from \"./sequencer-file-cache.js\";\nimport LoadingBar from \"../utils/loadingBar.js\";\nimport * as lib from \"../lib/lib.js\";\n\nconst SequencerPreloader = {\n  _usersToRespond: new Set(),\n  _clientsDone: [],\n  _resolve: () => {},\n\n  /**\n   *  Caches provided file(s) locally, vastly improving loading speed of those files.\n   *\n   * @param {Array|String}        inSrcs\n   * @param {Boolean}             showProgressBar\n   * @returns {Promise<void>}\n   */\n  preload(inSrcs, showProgressBar = false) {\n    if (Array.isArray(inSrcs)) {\n      inSrcs.forEach((str) => {\n        if (typeof str !== \"string\") {\n          throw lib.custom_error(\n            \"Sequencer\",\n            \"preload | each entry in inSrcs must be of type string\"\n          );\n        }\n      });\n    } else if (typeof inSrcs !== \"string\") {\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"preload | inSrcs must be of type string or array of strings\"\n      );\n    }\n\n    if (typeof showProgressBar !== \"boolean\") {\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"preload | showProgressBar must be of type of boolean\"\n      );\n    }\n\n    const srcs = this._cleanSrcs(inSrcs);\n\n    if (srcs.length === 0) return;\n\n    return this._preloadLocal(srcs, showProgressBar);\n  },\n\n  /**\n   *  Causes each connected client (including the caller) to fetch and cache the provided file(s) locally, vastly\n   *  improving loading speed of those files.\n   *\n   * @param {Array|String}        inSrcs\n   * @param {Boolean}             showProgressBar\n   * @returns {Promise<void>}\n   */\n  preloadForClients(inSrcs, showProgressBar = false) {\n    if (Array.isArray(inSrcs)) {\n      inSrcs.forEach((str) => {\n        if (typeof str !== \"string\") {\n          throw lib.custom_error(\n            \"Sequencer\",\n            \"preloadForClients | each entry in inSrcs must be of type string\"\n          );\n        }\n      });\n    } else if (typeof inSrcs !== \"string\") {\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"preloadForClients | inSrcs must be of type string or array of strings\"\n      );\n    }\n\n    if (typeof showProgressBar !== \"boolean\") {\n      throw lib.custom_error(\n        \"Sequencer\",\n        \"preloadForClients | showProgressBar must be of type of boolean\"\n      );\n    }\n\n    const srcs = this._cleanSrcs(inSrcs);\n\n    if (srcs.length === 0) return;\n\n    if (!lib.user_can_do(\"permissions-preload\")) {\n      lib.custom_warning(\n        \"Sequencer\",\n        \"preloadForClients - You do not have permission to force other clients to preload. Preloading locally instead.\"\n      );\n      return this._preloadLocal(srcs, showProgressBar);\n    }\n\n    const promise = new Promise((resolve) => {\n      this._resolve = resolve;\n    });\n\n    this._usersToRespond = new Set(\n      game.users.filter((user) => user.active).map((user) => user.id)\n    );\n\n    sequencerSocket.executeForEveryone(\n      SOCKET_HANDLERS.PRELOAD,\n      game.user.id,\n      srcs,\n      showProgressBar\n    );\n\n    return promise;\n  },\n\n  async respond(inSenderId, inSrcs, showProgressBar) {\n    const numFilesFailedToLoad = await this._preloadLocal(\n      inSrcs,\n      showProgressBar\n    );\n    return sequencerSocket.executeAsUser(\n      SOCKET_HANDLERS.PRELOAD_RESPONSE,\n      inSenderId,\n      game.user.id,\n      numFilesFailedToLoad\n    );\n  },\n\n  handleResponse(inUserId, numFilesFailedToLoad) {\n    this._usersToRespond.delete(inUserId);\n    this._clientsDone.push({\n      userId: inUserId,\n      numFilesFailedToLoad: numFilesFailedToLoad,\n    });\n    if (this._usersToRespond.size > 0) return;\n\n    this._clientsDone.forEach((user) => {\n      if (user.numFilesFailedToLoad > 0) {\n        lib.debug(\n          `${\n            game.users.get(user.userId).name\n          } preloaded files, failed to preload ${\n            user.numFilesFailedToLoad\n          } files`\n        );\n      } else {\n        lib.debug(\n          `${game.users.get(user.userId).name} preloaded files successfully`\n        );\n      }\n    });\n    lib.debug(`All clients responded to file preloads`);\n\n    this._resolve();\n\n    this._usersToRespond = new Set();\n    this._clientsDone = [];\n    this._resolve = () => {};\n  },\n\n  /**\n   * Filters and cleans up file paths given to the preload methods\n   *\n   * @private\n   */\n  _cleanSrcs(inSrcs) {\n    if (!Array.isArray(inSrcs)) {\n      inSrcs = [inSrcs];\n    }\n\n    if (inSrcs.length === 0) {\n      lib.custom_warning(\"Sequencer\", \"You need to provide files to preload\");\n      return [];\n    }\n\n    inSrcs = lib\n      .make_array_unique(\n        inSrcs.filter(Boolean).map((src) => {\n          if (Sequencer.Database.entryExists(src)) {\n            return Sequencer.Database.getAllFileEntries(src);\n          }\n          return src;\n        })\n      )\n      .deepFlatten();\n\n    if (inSrcs.length >= 750) {\n      lib.custom_warning(\n        \"Sequencer\",\n        \"You are preloading over 750 files, you are most likely preloading more files than the system can cache.\",\n        true\n      );\n    }\n\n    return inSrcs;\n  },\n\n  /**\n   * The method that actually preloads files locally, with an optional progress bar\n   *\n   * @private\n   */\n  _preloadLocal(inSrcs, showProgressBar) {\n    let startTime = performance.now();\n    let numFilesToLoad = inSrcs.length;\n\n    lib.debug(`Preloading ${numFilesToLoad} files...`);\n    if (showProgressBar)\n      LoadingBar.init(\n        `Sequencer - Preloading ${numFilesToLoad} files`,\n        numFilesToLoad\n      );\n\n    return new Promise(async (resolve) => {\n      let numFilesFailedToLoad = 0;\n      const loadingPromises = inSrcs.map(async (inSrcs) => {\n        const blob = await SequencerFileCache.loadFile(src, true);\n        if (showProgressBar) LoadingBar.incrementProgress();\n        if (!blob) {\n          numFilesFailedToLoad++;\n        }\n      })\n      await Promise.allSettled(loadingPromises)\n      const timeTaken = (performance.now() - startTime) / 1000;\n      let failedToLoad = ` (${numFilesFailedToLoad} failed to load)`;\n      lib.debug(\n        `Preloading ${numFilesToLoad} files took ${timeTaken}s` + failedToLoad\n      );\n      resolve(numFilesFailedToLoad);\n    });\n  },\n};\n\nexport default SequencerPreloader;\n","import CONSTANTS from \"./constants.js\";\nimport * as lib from \"./lib/lib.js\";\nimport FlagManager from \"./utils/flag-manager.js\";\nimport SequencerSoundManager from \"./modules/sequencer-sound-manager.js\";\nimport SequencerEffectManager from \"./modules/sequencer-effect-manager.js\";\nimport SequencerFoundryReplicator from \"./modules/sequencer-foundry-replicator.js\";\nimport SequencerPreloader from './modules/sequencer-preloader.js'\n\nexport const SOCKET_HANDLERS = {\n  PLAY_EFFECT: \"playEffect\",\n  END_EFFECTS: \"endEffects\",\n  UPDATE_EFFECT: \"updateEffects\",\n  ADD_EFFECT_ANIMATIONS: \"addEffectAnimations\",\n  PLAY_SOUND: \"playSound\",\n  END_SOUNDS: \"endSounds\",\n  PRELOAD: \"preload\",\n  PRELOAD_RESPONSE: \"preloadResponse\",\n  PRELOAD_DONE: \"preloadDone\",\n  UPDATE_DOCUMENT: \"updateDocument\",\n  ADD_EFFECT_FLAGS: \"addEffectFlags\",\n  REMOVE_EFFECT_FLAGS: \"removeEffectFlags\",\n  UPDATE_EFFECT_POSITION: \"updateEffectPosition\",\n  ADD_SOUND_FLAGS: \"addSoundFlags\",\n  REMOVE_SOUND_FLAGS: \"removeSoundFlags\",\n  UPDATE_SOUND_POSITION: \"updateSoundPosition\",\n  CREATE_SCROLLING_TEXT: \"createScrollingText\",\n  CREATE_LIGHT_SOURCE: \"createLightSource\",\n  PAN_CANVAS: \"panCanvas\",\n  RUN_SEQUENCE_LOCALLY: \"runSequenceLocally\",\n};\n\nexport let sequencerSocket;\n\nexport function registerSocket() {\n  if (sequencerSocket) return;\n  sequencerSocket = socketlib.registerModule(CONSTANTS.MODULE_NAME);\n  sequencerSocket.register(SOCKET_HANDLERS.PLAY_EFFECT, (...args) =>\n    SequencerEffectManager._playEffect(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.END_EFFECTS, (...args) =>\n    SequencerEffectManager._endManyEffects(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.UPDATE_EFFECT, (...args) =>\n    SequencerEffectManager._updateEffect(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.ADD_EFFECT_ANIMATIONS, (...args) =>\n    SequencerEffectManager._addEffectAnimations(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.PLAY_SOUND, (...args) =>\n    SequencerSoundManager._play(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.END_SOUNDS, (...args) =>\n    SequencerSoundManager._endSounds(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.PRELOAD, (...args) =>\n    SequencerPreloader.respond(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.PRELOAD_RESPONSE, (...args) =>\n    SequencerPreloader.handleResponse(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.UPDATE_DOCUMENT, (...args) =>\n    updateDocument(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.ADD_EFFECT_FLAGS, (...args) =>\n    FlagManager._addEffectFlags(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.REMOVE_EFFECT_FLAGS, (...args) =>\n    FlagManager._removeEffectFlags(...args)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.UPDATE_EFFECT_POSITION, (...args) =>\n    SequencerEffectManager._updatePosition(...args)\n  );\n\tsequencerSocket.register(SOCKET_HANDLERS.ADD_SOUND_FLAGS, (...args) =>\n\t\tFlagManager._addSoundFlags(...args)\n\t);\n\tsequencerSocket.register(SOCKET_HANDLERS.REMOVE_SOUND_FLAGS, (...args) =>\n\t\tFlagManager._removeSoundFlags(...args)\n\t);\n  sequencerSocket.register(SOCKET_HANDLERS.CREATE_SCROLLING_TEXT, (data) =>\n    SequencerFoundryReplicator._playScrollingText(data)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.PAN_CANVAS, (data) =>\n    SequencerFoundryReplicator._panCanvas(data)\n  );\n  sequencerSocket.register(SOCKET_HANDLERS.RUN_SEQUENCE_LOCALLY, (data) => {\n    lib.debug(\"Playing remote Sequence\");\n    new Sequence().fromJSON(data).play();\n  });\n}\n\nasync function updateDocument(documentUuid, updates, animate) {\n  const document = await fromUuid(documentUuid);\n  return document.update(updates, animate);\n}\n","import { sequencerSocket, SOCKET_HANDLERS } from \"../sockets.js\";\nimport SequencerAnimationEngine from \"./sequencer-animation-engine.js\";\nimport * as lib from \"../lib/lib.js\";\nimport SequenceManager from \"./sequence-manager.js\";\nimport { EffectsUIApp } from \"../formapplications/effects-ui/effects-ui-app.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport CONSTANTS from \"../constants.js\";\n\n\nfunction createSoundListener (sound, name, func) {\n\tif(CONSTANTS.IS_V12){\n\t\treturn sound.addEventListener(name, func);\n\t}\n\treturn sound.on(name, func);\n}\n\n\nexport default class SequencerSoundManager {\n\n\tstatic AudioHelper = foundry?.audio?.AudioHelper ?? AudioHelper;\n\tstatic Sound = foundry?.audio?.Sound ?? Sound;\n\n\t/**\n\t * Returns all the currently running sounds\n\t *\n\t * @returns {Array}\n\t */\n\tstatic get sounds() {\n\t\treturn Array.from(SequenceManager.RunningSounds.values());\n\t}\n\n\t/**\n\t * Opens the Sequencer Manager with the sounds tab open\n\t */\n\tstatic show() {\n\t\treturn EffectsUIApp.show({ tab: \"manager\" });\n\t}\n\n\t/**\n\t * Play an audio file.\n\t *\n\t * @param {Object} data The data that describes the audio to play.\n\t * @param {boolean} [push=false] A flag indicating whether to make other clients play the audio, too.\n\t * @returns {Number} A promise that resolves when the audio file has finished playing.\n\t */\n\tstatic async play(data, push = true) {\n\t\tif (push)\n\t\t\tsequencerSocket.executeForOthers(SOCKET_HANDLERS.PLAY_SOUND, data);\n\t\treturn this._play(data);\n\t}\n\n\t/**\n\t * @param {Object} data\n\t * @returns {Number}\n\t * @private\n\t */\n\tstatic async _play(data) {\n\n\t\tif (data.delete) return false;\n\n\t\tHooks.callAll(\"createSequencerSound\", data);\n\n\t\tlib.debug(`Playing sound:`, data);\n\n\t\tconst playSound = game.settings.get(\"sequencer\", \"soundsEnabled\") &&\n\t\t\tgame.user.viewedScene === data.sceneId &&\n\t\t\t(!data?.users?.length || data?.users?.includes(game.userId));\n\n\t\tdata.volume = playSound\n\t\t\t? (data.volume ?? 0.8) * game.settings.get(\"core\", \"globalInterfaceVolume\")\n\t\t\t: 0.0;\n\n\t\tlet sound;\n\n\t\tif(data.location){\n\t\t\tlet location = fromUuidSync(data.location) ?? { x: 0, y: 0, width: canvas.grid.size, height: canvas.grid.size };\n\t\t\tif(data.offset){\n\t\t\t\tlocation.x += data.offset.x * (data.offset.gridUnits ? canvas.grid.size : 1);\n\t\t\t\tlocation.y += data.offset.y * (data.offset.gridUnits ? canvas.grid.size : 1);\n\t\t\t}\n\t\t\tif(data.randomOffset){\n\t\t\t\tlocation = canvaslib.get_random_offset(location, data.randomOffset);\n\t\t\t}\n\t\t\tsound = await canvas.sounds.playAtPosition(data.src, location, data.radius || 5, {\n\t\t\t\tgmAlways: false,\n\t\t\t\twalls: false,\n\t\t\t\teasing: true,\n\t\t\t\tmuffledEffect: { type: \"lowpass\" },\n\t\t\t\t...data.locationOptions,\n\t\t\t\tvolume: data.volume\n\t\t\t});\n\t\t}else {\n\t\t\tsound = await game.audio.play(data.src, {\n\t\t\t\t...data.locationOptions,\n\t\t\t\tvolume: data.fadeIn ? 0 : data.volume,\n\t\t\t\tloop: data.loop,\n\t\t\t\toffset: data.startTime,\n\t\t\t});\n\t\t}\n\n\t\tif(!sound) return false;\n\n\t\tsound.sequencer_data = data;\n\t\tsound.sound_playing = playSound || game.user.isGM;\n\n\t\tSequenceManager.RunningSounds.add(data.id, sound);\n\n\t\tif (data.fadeIn && playSound) {\n\t\t\tSequencerAnimationEngine.addAnimation(data.id, {\n\t\t\t\ttarget: sound.sound,\n\t\t\t\tpropertyName: \"volume\",\n\t\t\t\tfrom: 0.0,\n\t\t\t\tto: data.volume,\n\t\t\t\tduration: Math.min(data.fadeIn.duration, data.duration),\n\t\t\t\tease: data.fadeIn.ease,\n\t\t\t\tdelay: Math.min(data.fadeIn.delay, data.duration),\n\t\t\t});\n\t\t}\n\n\t\tif (data.fadeOut && playSound) {\n\t\t\tSequencerAnimationEngine.addAnimation(data.id, {\n\t\t\t\ttarget: sound.sound,\n\t\t\t\tpropertyName: \"volume\",\n\t\t\t\tfrom: data.volume,\n\t\t\t\tto: 0.0,\n\t\t\t\tduration: Math.min(data.fadeOut.duration, data.duration),\n\t\t\t\tease: data.fadeOut.ease,\n\t\t\t\tdelay: Math.max(\n\t\t\t\t\tdata.duration - data.fadeOut.duration + data.fadeOut.delay,\n\t\t\t\t\t0,\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\n\t\tif (data.duration) {\n\t\t\tsetTimeout(() => {\n\t\t\t\tsound.stop();\n\t\t\t}, data.duration);\n\t\t}\n\n\t\tnew Promise((resolve) => {\n\t\t\tcreateSoundListener(sound, \"stop\", resolve);\n\t\t\tcreateSoundListener(sound, \"end\", resolve);\n\t\t}).then(() => {\n\t\t\tSequenceManager.RunningSounds.delete(data.id);\n\t\t\tHooks.callAll(\"endedSequencerSound\", data);\n\t\t});\n\n\t\treturn data.duration;\n\t}\n\n\tstatic _validateFilters(inFilter) {\n\n\t\tif (inFilter?.sounds) {\n\t\t\tif (!Array.isArray(inFilter.sounds)) {\n\t\t\t\tinFilter.sounds = [inFilter.sounds];\n\t\t\t}\n\t\t\tinFilter.sounds = inFilter.sounds.map((sound) => {\n\t\t\t\tif (!(typeof sound === \"string\" || sound instanceof SequencerSoundManager.Sound))\n\t\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\t\t\"Sequencer\",\n\t\t\t\t\t\t\"SoundManager | collections in inFilter.sounds must be of type string or Sound\",\n\t\t\t\t\t);\n\t\t\t\tif (sound instanceof SequencerSoundManager.Sound) return sound.sequencer_data.id;\n\t\t\t\treturn sound;\n\t\t\t});\n\t\t}\n\n\t\tif (inFilter?.name && typeof inFilter?.name !== \"string\")\n\t\t\tthrow lib.custom_error(\n\t\t\t\t\"Sequencer\",\n\t\t\t\t\"SoundManager | inFilter.name must be of type string\",\n\t\t\t);\n\n\t\tif (inFilter?.sceneId) {\n\t\t\tif (typeof inFilter.sceneId !== \"string\")\n\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\t\"Sequencer\",\n\t\t\t\t\t\"SoundManager | inFilter.sceneId must be of type string\",\n\t\t\t\t);\n\t\t\tif (!game.scenes.get(inFilter.sceneId))\n\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\t\"Sequencer\",\n\t\t\t\t\t\"SoundManager | inFilter.sceneId must be a valid scene id (could not find scene)\",\n\t\t\t\t);\n\t\t} else {\n\t\t\tinFilter.sceneId = game.user.viewedScene;\n\t\t}\n\n\t\tif (inFilter?.origin && typeof inFilter?.origin !== \"string\")\n\t\t\tthrow lib.custom_error(\n\t\t\t\t\"Sequencer\",\n\t\t\t\t\"SoundManager | inFilter.origin must be of type string\",\n\t\t\t);\n\n\t\tif (\n\t\t\t!inFilter.sounds &&\n\t\t\t!inFilter.name &&\n\t\t\t!inFilter.sceneId &&\n\t\t\t!inFilter.origin\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tsounds: null,\n\t\t\t\tname: null,\n\t\t\t\tsceneId: null,\n\t\t\t\torigin: null,\n\t\t\t},\n\t\t\tinFilter,\n\t\t);\n\t}\n\n\tstatic _filterSounds(inFilter) {\n\t\tif (inFilter.name) {\n\t\t\tinFilter.name = new RegExp(\n\t\t\t\t\"^\" + lib.str_to_search_regex_str(lib.safe_str(inFilter.name)) + \"$\",\n\t\t\t\t\"gu\",\n\t\t\t);\n\t\t}\n\t\treturn this.sounds.filter((sound) => {\n\t\t\treturn (\n\t\t\t\t(inFilter.sounds === null || inFilter.sounds.includes(sound.sequencer_data.id)) &&\n\t\t\t\t(inFilter.name === null || (sound.sequencer_data.name && inFilter.name && sound.sequencer_data.name.match(inFilter.name)?.length)) &&\n\t\t\t\t(inFilter.sceneId === null || (sound.sequencer_data.sceneId === inFilter.sceneId)) &&\n\t\t\t\t(inFilter.origin === null || inFilter.origin === sound.sequencer_data.origin)\n\t\t\t)\n\t\t});\n\t}\n\n\tstatic getSounds(inFilter = {}) {\n\t\tconst filters = this._validateFilters(inFilter);\n\t\tif (!inFilter)\n\t\t\tthrow lib.custom_error(\n\t\t\t\t\"Sequencer\",\n\t\t\t\t\"SoundManager | getSounds | Incorrect or incomplete parameters provided\",\n\t\t\t);\n\t\treturn this._filterSounds(filters);\n\t}\n\n\tstatic stop(ids) {\n\t\tlib.custom_warning(\n\t\t\t\"Sequencer\",\n\t\t\t\"SoundManager | stop | This method is becoming deprecated, please use Sequencer.SoundManager.endSounds instead\",\n\t\t\tfalse,\n\t\t);\n\t\treturn this.endSounds({ sounds: ids });\n\t}\n\n\tstatic endSounds(inFilter, push = true) {\n\t\tconst filters = this._validateFilters(inFilter);\n\t\tconst sounds = this._filterSounds(filters);\n\t\tif (!sounds?.length) return;\n\t\tconst ids = sounds.map(sound => sound.sequencer_data.id);\n\t\tif (push && game.user.isGM) {\n\t\t\tsequencerSocket.executeForOthers(SOCKET_HANDLERS.END_SOUNDS, ids);\n\t\t}\n\t\treturn this._endSounds(ids);\n\t}\n\n\t/**\n\t * @param ids\n\t * @private\n\t */\n\tstatic _endSounds(ids) {\n\t\tfor (const id of ids) {\n\t\t\tconst sound = SequenceManager.RunningSounds.get(id);\n\t\t\tif (sound) {\n\t\t\t\tsound.stop();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic endAllSounds(push = true) {\n\t\tconst ids = SequenceManager.RunningSounds.keys();\n\t\tif (push && game.user.isGM) {\n\t\t\tsequencerSocket.executeForOthers(SOCKET_HANDLERS.END_SOUNDS, ids);\n\t\t}\n\t\treturn this._endSounds(ids);\n\t}\n}\n","import CONSTANTS from \"../constants.js\";\nimport SequencerSoundManager from \"./sequencer-sound-manager.js\";\n\nconst SequencerFileCache = {\n  _videos: {},\n  _preloadedFiles: new Set(),\n  _totalCacheSize: 0,\n  _validTypes: [\"video/webm\", \"video/x-webm\", \"application/octet-stream\"],\n\n  async loadVideo(inSrc) {\n    if (!this._videos[inSrc]) {\n      const blob = await fetch(inSrc, {\n        mode: \"cors\",\n        credentials: \"same-origin\",\n      })\n        .then((r) => r.blob())\n        .catch((err) => {\n          console.error(err);\n        });\n\n      if (this._validTypes.indexOf(blob?.type) === -1) return false;\n\n      while (this._totalCacheSize + blob.size > 524288000) {\n        const entries = Object.entries(this._videos);\n\n        entries.sort((a, b) => {\n          return b[1].lastUsed - a[1].lastUsed;\n        });\n\n        const [oldSrc] = entries[0];\n\n        this._preloadedFiles.delete(oldSrc);\n        this._totalCacheSize -= this._videos[oldSrc].blob.size;\n        delete this._videos[oldSrc];\n      }\n\n      this._totalCacheSize += blob.size;\n      this._preloadedFiles.add(inSrc);\n      this._videos[inSrc] = {\n        blob,\n        lastUsed: +new Date(),\n      };\n    }\n\n    this._videos[inSrc].lastUsed = +new Date();\n    return this._videos[inSrc].blob;\n  },\n\n  srcExists(inSrc) {\n    if (this._preloadedFiles.has(inSrc)) {\n      return true;\n    }\n    return srcExists(inSrc);\n  },\n\n  async loadFile(inSrc, preload = false) {\n    if (inSrc.toLowerCase().endsWith(\".webm\")) {\n      let blob = await this.loadVideo(inSrc);\n      if (!blob) return false;\n      this._preloadedFiles.add(inSrc);\n      if (preload) return true;\n      return get_video_texture(blob);\n    } else if (SequencerSoundManager.AudioHelper.hasAudioExtension(inSrc)) {\n      try {\n        const audio = await SequencerSoundManager.AudioHelper.preloadSound(inSrc);\n        if (audio) {\n          this._preloadedFiles.add(inSrc);\n        }\n        return audio;\n      } catch (err) {\n        console.error(`Failed to load audio: ${inSrc}`);\n        return false;\n      }\n    }\n\n    const texture = await loadTexture(inSrc);\n    if (texture) {\n      this._preloadedFiles.add(inSrc);\n    }\n    return texture;\n  },\n};\n\nasync function get_video_texture(inBlob) {\n  return new Promise(async (resolve) => {\n    const video = document.createElement(\"video\");\n    video.preload = \"auto\";\n    video.crossOrigin = \"anonymous\";\n    video.controls = true;\n    video.autoplay = false;\n    video.autoload = true;\n    video.muted = true;\n    video.src = URL.createObjectURL(inBlob);\n\n    let canplay = true;\n    video.oncanplay = async () => {\n      if (!canplay) return;\n      canplay = false;\n\n      video.height = video.videoHeight;\n      video.width = video.videoWidth;\n\n      const baseTexture = PIXI.BaseTexture.from(video, {\n        resourceOptions: { autoPlay: false },\n      });\n\n      if (game.settings.get(CONSTANTS.MODULE_NAME, \"enable-fix-pixi\")) {\n        baseTexture.alphaMode = PIXI.ALPHA_MODES.PREMULTIPLIED_ALPHA;\n      }\n\n      const texture = new PIXI.Texture(baseTexture);\n\n      resolve(texture);\n    };\n\n    video.onerror = () => {\n      URL.revokeObjectURL(video.src);\n      reject();\n    };\n  });\n}\n\nexport default SequencerFileCache;\n","import * as lib from \"../lib/lib.js\";\nimport SequencerFileCache from \"./sequencer-file-cache.js\";\n\nconst flipBookTextureCache = {};\n\nexport class SequencerFileBase {\n  static make(inData, inDBPath, inMetadata) {\n    const originalFile = inData?.file ?? inData;\n    const file = foundry.utils.duplicate(originalFile);\n    const isRangeFind =\n      typeof file !== \"string\" && !Array.isArray(originalFile)\n        ? Object.keys(originalFile).filter((key) => key.endsWith(\"ft\")).length >\n          0\n        : false;\n\n    return isRangeFind\n      ? new SequencerFileRangeFind(inData, inDBPath, inMetadata)\n      : new SequencerFile(inData, inDBPath, inMetadata);\n  }\n}\n\nexport class SequencerFile extends SequencerFileBase {\n  rangeFind = false;\n\n  constructor(inData, inDBPath, inMetadata) {\n    super();\n    inData = foundry.utils.duplicate(inData);\n    inMetadata = foundry.utils.duplicate(inMetadata);\n    this.originalData = inData;\n    this.originalMetadata = inMetadata;\n    for (let [key, value] of Object.entries(inMetadata)) {\n      this[key] = value;\n    }\n    this.dbPath = inDBPath;\n    this.moduleName = inDBPath.split(\".\")[0];\n    this.originalFile = inData?.file ?? inData;\n    this.file = foundry.utils.duplicate(this.originalFile);\n    this.fileIndex = null;\n\n    this.fileTextureMap = Object.fromEntries(\n      this.getAllFiles().map((file) => {\n        return [file, false];\n      })\n    );\n\n    this.twister = false;\n  }\n\n  clone() {\n    return SequencerFile.make(\n      this.originalData,\n      this.dbPath,\n      this.originalMetadata\n    );\n  }\n\n  async validate() {\n    let isValid = true;\n    const directories = {};\n    const allFiles = this.getAllFiles();\n    for (const file of allFiles) {\n      let directory = file.split(\"/\");\n      directory.pop();\n      directory = directory.join(\"/\");\n      if (directories[directory] === undefined) {\n        directories[directory] = await lib.getFiles(directory);\n      }\n    }\n    for (const file of allFiles) {\n      let directory = file.split(\"/\");\n      directory.pop();\n      directory = directory.join(\"/\");\n\n      if (directories[directory].indexOf(file) === -1) {\n        console.warn(\n          `\"${this.dbPath}\" has an incorrect file path, could not find file. Points to:\\n${file}`\n        );\n        isValid = false;\n      }\n    }\n    return isValid;\n  }\n\n  getAllFiles() {\n    return [this.file].deepFlatten();\n  }\n\n  getFile() {\n    if (Array.isArray(this.file)) {\n      this.fileIndex = lib.is_real_number(this.fileIndex)\n        ? this.fileIndex\n        : lib.random_array_element(this.file, {\n            twister: this.twister,\n            index: true,\n          });\n      return this.file[this.fileIndex];\n    }\n    return this.file;\n  }\n\n  getTimestamps() {\n    if (Array.isArray(this.originalMetadata?.timestamps)) {\n      return (\n        this.originalMetadata?.timestamps?.[this.fileIndex] ??\n        this.originalMetadata?.timestamps[0]\n      );\n    }\n    return this.originalMetadata?.timestamps;\n  }\n\n  getPreviewFile(entry) {\n    let parts = entry.split(\".\");\n    let files = this.getAllFiles();\n    if (Array.isArray(files)) {\n      if (lib.is_real_number(parts[parts.length - 1])) {\n        files = files[parts[parts.length - 1]];\n      } else {\n        const index = Math.floor(lib.interpolate(0, files.length - 1, 0.5));\n        files = files?.[index - 1] ?? files[index];\n      }\n    }\n    return files;\n  }\n\n  destroy() {\n    if (this.originalMetadata?.flipbook) return;\n    for (let texture of Object.values(this.fileTextureMap)) {\n      if (!texture) continue;\n      try {\n        texture?.baseTexture?.resource?.source?.removeAttribute(\"src\");\n      } catch (err) {}\n      try {\n        texture?.baseTexture?.resource?.source?.pause();\n      } catch (err) {}\n      try {\n        texture?.baseTexture?.resource?.source?.remove();\n      } catch (err) {}\n      try {\n        texture?.baseTexture?.resource?.source?.load();\n      } catch (err) {}\n      texture.destroy();\n    }\n  }\n\n  async _getTexture(file) {\n    if (this.fileTextureMap[file]) return this.fileTextureMap[file];\n    this.fileTextureMap[file] = await SequencerFileCache.loadFile(file);\n    return this.fileTextureMap[file];\n  }\n\n  _adjustScaleForPadding(distance, width) {\n    return (\n      distance /\n      (width - (this.template ? this.template[1] + this.template[2] : 0))\n    );\n  }\n\n  _adjustAnchorForPadding(width) {\n    return this.template ? this.template[1] / width : undefined;\n  }\n\n  async _getFlipBookSheet(filePath) {\n    if (!this.originalMetadata?.flipbook) return false;\n    if (flipBookTextureCache[filePath]) {\n      return flipBookTextureCache[filePath];\n    }\n    flipBookTextureCache[filePath] = this.file.map((file) => {\n      return PIXI.Texture.from(file);\n    });\n    return flipBookTextureCache[filePath];\n  }\n\n  async getTexture(distance) {\n    const filePath = this.getFile();\n    const texture = await this._getTexture(this.getFile());\n    const sheet = await this._getFlipBookSheet(filePath);\n    return {\n      filePath,\n      texture,\n      sheet,\n      spriteScale: this._adjustScaleForPadding(distance, texture.width),\n      spriteAnchor: this._adjustAnchorForPadding(texture.width),\n    };\n  }\n}\n\nexport class SequencerFileRangeFind extends SequencerFile {\n  rangeFind = true;\n\n  constructor(...args) {\n    super(...args);\n    this._fileDistanceMap = false;\n  }\n\n  static get ftToDistanceMap() {\n    return {\n      \"90ft\": canvas.grid.size * 15,\n      \"60ft\": canvas.grid.size * 9,\n      \"30ft\": canvas.grid.size * 5,\n      \"15ft\": canvas.grid.size * 2,\n      \"05ft\": 0,\n    };\n  }\n\n  get _gridSizeDiff() {\n    return canvas.grid.size / this.template[0];\n  }\n\n  getAllFiles() {\n    return Object.values(this.file).deepFlatten();\n  }\n\n  getFile(inFt) {\n    if (inFt && this.file[inFt]) {\n      if (Array.isArray(this.file[inFt])) {\n        const fileIndex = lib.is_real_number(this.fileIndex)\n          ? Math.min(this.file[inFt].length - 1, this.fileIndex)\n          : lib.random_array_element(this.file[inFt], {\n              twister: this.twister,\n              index: true,\n            });\n        return this.file[inFt][fileIndex];\n      }\n      return this.file[inFt];\n    }\n\n    return this.file;\n  }\n\n  getPreviewFile(entry) {\n    let parts = entry.split(\".\");\n    const ft = parts.find(\n      (part) =>\n        Object.keys(SequencerFileRangeFind.ftToDistanceMap).indexOf(part) > -1\n    );\n    if (!ft) {\n      return super.getPreviewFile(entry);\n    }\n    const fileIndex = parts.slice(parts.indexOf(ft) + 1)?.[0];\n    if (lib.is_real_number(Number(fileIndex))) {\n      this.fileIndex = Number(fileIndex);\n    }\n    return this.getFile(ft);\n  }\n\n  async getTexture(distance = 400) {\n    const { filePath, texture } = await this._getTextureForDistance(distance);\n    return {\n      filePath,\n      texture,\n      spriteScale: this._adjustScaleForPadding(distance, texture.width),\n      spriteAnchor: this._adjustAnchorForPadding(texture.width),\n    };\n  }\n\n  _getMatchingDistance(inEntry) {\n    return SequencerFileRangeFind.ftToDistanceMap[inEntry] / this._gridSizeDiff;\n  }\n\n  _rangeFind(inDistance) {\n    if (!this._fileDistanceMap) {\n      let distances = Object.keys(this.file)\n        .filter(\n          (entry) =>\n            Object.keys(SequencerFileRangeFind.ftToDistanceMap).indexOf(entry) >\n            -1\n        )\n        .map((ft) => {\n          return {\n            file: this.getFile(ft),\n            minDistance: this._getMatchingDistance(ft),\n          };\n        });\n\n      let uniqueDistances = [\n        ...new Set(distances.map((item) => item.minDistance)),\n      ];\n      uniqueDistances.sort((a, b) => a - b);\n\n      let max = Math.max(...uniqueDistances);\n      let min = Math.min(...uniqueDistances);\n\n      this._fileDistanceMap = distances.map((entry) => {\n        entry.distances = {\n          min: entry.minDistance === min ? 0 : entry.minDistance,\n          max:\n            entry.minDistance === max\n              ? Infinity\n              : uniqueDistances[uniqueDistances.indexOf(entry.minDistance) + 1],\n        };\n        return entry;\n      });\n    }\n\n    const possibleFiles = this._fileDistanceMap\n      .filter((entry) => {\n        const relativeDistance = inDistance / this._gridSizeDiff;\n        return (\n          relativeDistance >= entry.distances.min &&\n          relativeDistance < entry.distances.max\n        );\n      })\n      .map((entry) => entry.file)\n      .flat();\n\n    return possibleFiles.length > 1\n      ? lib.random_array_element(possibleFiles, { twister: this.twister })\n      : possibleFiles[0];\n  }\n\n  async _getTextureForDistance(distance) {\n    const filePath = this._rangeFind(distance);\n    const texture = await this._getTexture(filePath);\n    return { filePath, texture };\n  }\n}\n","import * as lib from \"../lib/lib.js\";\nimport LoadingBar from \"../utils/loadingBar.js\";\nimport { SequencerFile, SequencerFileBase } from \"./sequencer-file.js\";\nimport { writable, get } from \"svelte/store\";\nimport CONSTANTS from \"../constants.js\";\n\nclass Database {\n  #entriesStore = writable({});\n\n  privateModules = [];\n  flattenedEntries = [];\n  inverseFlattenedEntries = new Map();\n\n  get entries() {\n    return get(this.#entriesStore);\n  }\n  set entries(entries) {\n    this.#entriesStore.set(entries);\n  }\n  get entriesStore() {\n    return this.#entriesStore;\n  }\n\n  get publicModules() {\n    return Object.keys(this.entries).filter(\n      (module) => !this.privateModules.includes(module)\n    );\n  }\n\n  get publicFlattenedEntries() {\n    return this.flattenedEntries.filter((entry) => {\n      return this.privateModules.indexOf(entry.split(\".\")[0]) === -1;\n    });\n  }\n\n  get publicFlattenedSimpleEntries() {\n    return lib.make_array_unique(\n      this.publicFlattenedEntries.map((entry) => {\n        return entry.split(CONSTANTS.FEET_REGEX)[0];\n      })\n    );\n  }\n\n  /**\n   *  Retrieves an object of every public entry\n   *\n   * @return {object}\n   */\n  get filePathDatabasePaths() {\n    const fileDatabaseObject = {};\n    Object.entries(this.entries)\n      .map((entry) => entry[1])\n      .deepFlatten()\n      .forEach((sequencerFile) => {\n        if (sequencerFile?.rangeFind) {\n          Object.entries(sequencerFile.file).forEach((entry) => {\n            fileDatabaseObject[entry[1]] =\n              sequencerFile.dbPath + \".\" + entry[0];\n          });\n        } else {\n          fileDatabaseObject[sequencerFile.file] = sequencerFile.dbPath;\n        }\n      });\n    return fileDatabaseObject;\n  }\n\n  /**\n   *  Registers a set of entries to the database on the given module name\n   *\n   * @param  {string}      inModuleName  The namespace to assign to the inserted entries\n   * @param  {object}      inEntries     The entries to merge into the database\n   * @param  {boolean}     isPrivate     Whether to mark these entries as private and not show in Effect Player or Database Viewer\n   * @return {boolean}\n   */\n  registerEntries(inModuleName, inEntries, isPrivate = false) {\n    if (inModuleName.includes(\".\"))\n      return this._throwError(\n        \"registerEntries\",\n        \"module name must not contain periods\"\n      );\n    if (this.entries[inModuleName])\n      lib.custom_warning(\n        \"Sequencer\",\n        `registerEntries | module \"${inModuleName}\" has already been registered to the database! Do you have two similar modules active?`,\n        true\n      );\n    this._flatten(inEntries, inModuleName);\n    const processedEntries = this._processEntries(inModuleName, inEntries);\n    if (isPrivate) this.privateModules.push(inModuleName);\n    this.entries = foundry.utils.mergeObject(this.entries, {\n      [inModuleName]: processedEntries,\n    });\n    lib.debug(\n      `Sequencer | Database | Entries for \"${inModuleName}\" registered`\n    );\n    Hooks.callAll(\"registerSequencerDatabaseEntries\", inModuleName);\n    return true;\n  }\n\n  /**\n   *  Validates the entries under a certain module name, checking whether paths to assets are correct or not\n   *\n   * @param  {string}     inModuleName    The namespace to assign to the inserted entries\n   * @return {boolean}\n   */\n  async validateEntries(inModuleName) {\n    let entries = this.getEntry(inModuleName);\n    if (!Array.isArray(entries)) {\n      entries = [entries];\n    }\n    ui.notifications.info(\n      `Validating paths registered to \"${inModuleName}\"...`\n    );\n    let isValid = true;\n    LoadingBar.init(\n      `Validating paths registered to \"${inModuleName}\"...`,\n      entries.length\n    );\n    for (let entry of entries) {\n      const result = await entry.validate();\n      LoadingBar.incrementProgress();\n      isValid = !(!result || !isValid);\n    }\n    if (!isValid) {\n      ui.notifications.error(\n        `Validation of paths registered to \"${inModuleName}\" failed! Errors logged in console.`\n      );\n    } else {\n      ui.notifications.info(\n        `Validation of paths registered to \"${inModuleName}\" complete! No errors found!`\n      );\n    }\n  }\n\n  /**\n   *  Quickly checks if the entry exists in the database\n   *\n   * @param  {string}      inString    The entry to find in the database\n   * @return {boolean}                 If the entry exists in the database\n   */\n  entryExists(inString) {\n    if (typeof inString !== \"string\")\n      return this._throwError(\"entryExists\", \"inString must be of type string\");\n    inString = inString.trim();\n    if (inString === \"\")\n      return this._throwError(\"entryExists\", \"inString cannot be empty\");\n    inString = inString.replace(/\\[[0-9]+]$/, \"\");\n    return this.flattenedEntries.find((entry) => entry.startsWith(inString));\n  }\n\n  /**\n   *  Gets the entry in the database by a dot-notated string\n   *\n   * @param  {string}                     inString        The entry to find in the database\n   * @param  {boolean}                    softFail        Whether it should soft fail (no error) when no entry was found\n   * @return {array|SequencerFile|boolean}                The found entry in the database, or false if not found (with warning)\n   */\n  getEntry(inString, { softFail = false } = {}) {\n    if (typeof inString !== \"string\") {\n      if (softFail) return false;\n      return this._throwError(\"getEntry\", \"inString must be of type string\");\n    }\n    inString = inString.trim();\n    if (inString === \"\") {\n      if (softFail) return false;\n      return this._throwError(\"getEntry\", \"inString cannot be empty\");\n    }\n    inString = inString.replace(/\\[[0-9]+]$/, \"\");\n    if (!this.entryExists(inString)) {\n      if (softFail) return false;\n      return this._throwError(\n        \"getEntry\",\n        `Could not find ${inString} in database`\n      );\n    }\n\n    let ft = false;\n    let index = false;\n    if (CONSTANTS.FEET_REGEX.test(inString)) {\n      ft = inString.match(CONSTANTS.FEET_REGEX)[0];\n      const split = inString.split(ft).filter((str) => str !== \"\");\n      if (split.length > 1) {\n        index = split[1].split(\".\")[0];\n      }\n      inString = split[0];\n    }\n\n    const module = inString.split(\".\")[0];\n    const exactEntries = this.entries[module].filter((entry) => {\n      return entry.dbPath === inString;\n    });\n\n    let filteredEntries = (\n      exactEntries.length\n        ? exactEntries\n        : this.entries[module].filter((entry) => {\n            return entry.dbPath.startsWith(inString);\n          })\n    ).map((entry) => {\n      let foundFile = entry;\n      if (ft) foundFile = entry.file?.[ft] ?? foundFile;\n      if (index) foundFile = foundFile?.[index] ?? foundFile;\n      return foundFile;\n    });\n\n    if (!filteredEntries.length)\n      return this._throwError(\n        \"getEntry\",\n        `Could not find ${inString} in database`\n      );\n\n    const foundEntry =\n      filteredEntries.length === 1 ? filteredEntries[0] : filteredEntries;\n\n    if (index && filteredEntries.length === 1) {\n      foundEntry.fileIndex = Number(index);\n    }\n\n    return foundEntry;\n  }\n\n  /**\n   *  Gets all files under a database path\n   *\n   * @param  {string}         inDBPath    The module to get all files from\n   * @return {array|boolean}                  The found entries in the database under the module's name, or false if not found (with warning)\n   */\n  getAllFileEntries(inDBPath) {\n    if (typeof inDBPath !== \"string\")\n      return this._throwError(\n        \"getAllFileEntries\",\n        \"inDBPath must be of type string\"\n      );\n    inDBPath = inDBPath.trim();\n    if (inDBPath === \"\")\n      return this._throwError(\"getAllFileEntries\", \"inDBPath cannot be empty\");\n    if (!this.entryExists(inDBPath))\n      return this._throwError(\n        \"getAllFileEntries\",\n        `Could not find ${inDBPath} in database`\n      );\n    const entries = this._recurseGetFilePaths(inDBPath);\n    return lib.make_array_unique(entries.flat());\n  }\n\n  /**\n   *  Get all valid entries under a certain path\n   *\n   * @param  {string}             inPath      The database path to get entries under\n   * @return {array|boolean}                  An array containing the next layer of valid paths\n   */\n  getPathsUnder(\n    inPath,\n    {\n      ranges = false,\n      arrays = false,\n      match = false,\n      fullyQualified = false,\n    } = {}\n  ) {\n    if (typeof inPath !== \"string\")\n      return this._throwError(\"getPathsUnder\", \"inPath must be of type string\");\n    inPath = inPath.trim();\n    if (inPath === \"\")\n      return this._throwError(\"getPathsUnder\", \"inPath cannot be empty\");\n    inPath = inPath.replace(/\\[[0-9]+]$/, \"\");\n    if (!this.entryExists(inPath))\n      return this._throwError(\n        \"getPathsUnder\",\n        `Could not find ${inPath} in database`\n      );\n    const entries = this.flattenedEntries.filter((e) => {\n      return (\n        (e.startsWith(inPath + \".\") || e === inPath) &&\n        (!match || (match && e.match(match)))\n      );\n    });\n    if (entries.length === 0) return [];\n    return lib.make_array_unique(\n      entries\n        .map((e) => (!arrays ? e.split(CONSTANTS.ARRAY_REGEX)[0] : e))\n        .map((e) => (!ranges ? e.split(CONSTANTS.FEET_REGEX)[0] : e))\n        .map((e) => (!fullyQualified ? e.split(inPath)[1] : e))\n        .map((e) => (!fullyQualified ? (e ? e.split(\".\")[1] : \"\") : e))\n        .filter(Boolean)\n    );\n  }\n\n  /**\n   *  Get all valid entries under a certain path\n   *\n   * @param  {string}             inPath          The database path to search for\n   * @param  {boolean}            publicOnly      Whether to only search for public modules\n   * @return {array|boolean}                      An array containing potential database paths\n   */\n  searchFor(inPath, publicOnly = true) {\n    const modules = publicOnly ? this.publicModules : Object.keys(this.entries);\n    const originalEntries = publicOnly\n      ? this.publicFlattenedEntries\n      : this.flattenedEntries;\n\n    if ((!inPath || inPath === \"\") && !modules.includes(inPath)) return modules;\n\n    if (typeof inPath !== \"string\") {\n      return this._throwError(\"searchFor\", \"inString must be of type string\");\n    }\n\n    inPath = inPath.trim();\n\n    if (inPath === \"\")\n      return this._throwError(\"searchFor\", \"inString cannot be empty\");\n\n    inPath = inPath.replace(/\\[[0-9]+]$/, \"\");\n    inPath = inPath.trim();\n\n    let entries = originalEntries.filter(\n      (e) => e.startsWith(inPath) && e !== inPath\n    );\n\n    if (inPath.endsWith(\".\")) inPath = inPath.substring(0, inPath.length - 1);\n    let length = inPath.split(\".\").length + 1;\n    let foundEntries = entries.map((e) => {\n      let path = e.split(CONSTANTS.FEET_REGEX)[0];\n      return path.split(\".\").slice(0, length).join(\".\");\n    });\n\n    if (foundEntries.length === 0) {\n      const regexString = lib\n        .str_to_search_regex_str(inPath)\n        .replace(/\\s+/g, \"|\");\n      const searchParts = regexString.split(\"|\").length;\n      const regexSearch = new RegExp(regexString, \"gu\");\n      foundEntries = originalEntries\n        .filter((e) => {\n          return e.match(regexSearch)?.length >= searchParts;\n        })\n        .map((e) => {\n          return e.split(CONSTANTS.FEET_REGEX)[0];\n        });\n    }\n\n    return lib.make_array_unique(foundEntries);\n  }\n\n  /**\n   * Throws an error without THROWING one. Duh.\n   *\n   * @param inFunctionName\n   * @param inError\n   * @returns {boolean}\n   * @private\n   */\n  _throwError(inFunctionName, inError) {\n    let error = `Sequencer | Database | ${inFunctionName} - ${inError}`;\n    ui.notifications.error(error);\n    return false;\n  }\n\n  /**\n   * Gets all file paths from the entirety of\n   *\n   * @param inDBPath\n   * @returns {Array}\n   * @private\n   */\n  _recurseGetFilePaths(inDBPath) {\n    const module = inDBPath.split(\".\")[0];\n    return this.entries[module]\n      .filter((entry) => entry.dbPath.startsWith(inDBPath))\n      .map((entry) => {\n        return entry.getAllFiles();\n      })\n      .flat();\n  }\n\n  /**\n   * Flattens a given object to just their db path and file path\n   *\n   * @param entries\n   * @param inModule\n   * @private\n   */\n  _flatten(entries, inModule) {\n    let flattened = lib.flatten_object(\n      foundry.utils.duplicate({ [inModule]: entries })\n    );\n    this.flattenedEntries = lib.make_array_unique(\n      this.flattenedEntries.concat(\n        Object.keys(flattened).map((file) => file.split(\".file\")[0])\n      )\n    );\n    this.inverseFlattenedEntries = Object.keys(flattened).reduce(\n      (acc, entry) => {\n        return acc.set(flattened[entry], entry.split(\".file\")[0]);\n      },\n      this.inverseFlattenedEntries\n    );\n  }\n\n  /**\n   * Processes and recurse into a large object containing file paths at any given depth\n   *\n   * @param moduleName\n   * @param entries\n   * @returns {object}\n   * @private\n   */\n  _processEntries(moduleName, entries) {\n    const allPaths = new Set(\n      this.flattenedEntries\n        .filter((e) => e.split(\".\")[0] === moduleName)\n        .map((e) => e.split(CONSTANTS.FEET_REGEX)[0])\n    );\n\n    const allTemplates = foundry.utils.mergeObject(entries?._templates ?? {}, {\n      default: [100, 0, 0],\n    });\n\n    if (entries?._templates) {\n      delete entries?._templates;\n    }\n\n    const moduleEntries = [];\n\n    const mediaFileExtensions = Object.keys(CONST.FILE_CATEGORIES.IMAGE)\n      .concat(Object.keys(CONST.FILE_CATEGORIES.VIDEO))\n      .concat(Object.keys(CONST.FILE_CATEGORIES.AUDIO));\n\n    for (let wholeDBPath of allPaths) {\n      let metadata = this._getCleanData(entries);\n      let dbPath = wholeDBPath.split(\".\");\n      dbPath.shift();\n      let combinedPath = \"\";\n      for (let part of dbPath) {\n        combinedPath = combinedPath ? combinedPath + \".\" + part : part;\n        const entry = foundry.utils.getProperty(entries, combinedPath);\n        if (Array.isArray(entry) || typeof entry === \"string\" || entry?.file) {\n          metadata = this._getCleanData(entry, { existingData: metadata });\n          break;\n        }\n        metadata = this._getCleanData(entry, { existingData: metadata });\n      }\n\n      if (!metadata.template) metadata.template = \"default\";\n      if (typeof metadata.template === \"string\") {\n        metadata.template =\n          allTemplates?.[metadata.template] ?? allTemplates?.[\"default\"];\n      }\n\n      let data = foundry.utils.getProperty(entries, dbPath.join(\".\"));\n      if (!Array.isArray(data) && !(typeof data === \"string\")) {\n        data = this._getCleanData(data, { metadata: false });\n      }\n\n      if (typeof data === \"string\") {\n        const existingEntry = this.entryExists(data);\n        const extension = data\n          .split(\".\")\n          [data.split(\".\").length - 1].toLowerCase();\n\n        if (\n          !existingEntry &&\n          extension &&\n          !mediaFileExtensions.includes(extension)\n        ) {\n          console.warn(\n            `Sequencer | Database | registerEntries - failed to register ${wholeDBPath} to ${data}!`\n          );\n          this.flattenedEntries.splice(\n            this.flattenedEntries.indexOf(wholeDBPath),\n            1\n          );\n          continue;\n        } else if (existingEntry) {\n          const sequencerFile = this.getEntry(data);\n          const clone = sequencerFile.clone();\n          clone.dbPath = wholeDBPath;\n          clone.metadata = foundry.utils.mergeObject(\n            clone.metadata ?? {},\n            metadata ?? {}\n          );\n          moduleEntries.push(clone);\n          continue;\n        }\n      }\n\n      moduleEntries.push(SequencerFileBase.make(data, wholeDBPath, metadata));\n    }\n\n    return moduleEntries;\n  }\n\n  _getCleanData(data, { existingData = {}, metadata = true } = {}) {\n    data = Object.entries(data).filter((entry) => {\n      return metadata === entry[0].startsWith(\"_\");\n    });\n    if (metadata) {\n      data = data.map((entry) => [entry[0].slice(1), entry[1]]);\n    }\n    return foundry.utils.mergeObject(existingData, Object.fromEntries(data));\n  }\n}\n\nconst SequencerDatabase = new Database();\n\nexport default SequencerDatabase;\n","<script>\r\n\r\n  import { databaseStore } from \"./DatabaseStore.js\";\r\n\r\n  export let data;\r\n\r\n  const searchRegex = databaseStore.searchRegex;\r\n\r\n  let flashFilePath = false;\r\n  let flashDBPath = false;\r\n\r\n  $: highlight = data.path.replace(\r\n    $searchRegex,\r\n    \"<mark>$&</mark>\"\r\n  );\r\n\r\n</script>\r\n\r\n<div class=\"database-entry\" style=\"margin-left:{data.depth * 15}px;\">\r\n\t<div class=\"database-entry-text-container\">\r\n\t\t{#if data.hasChildren}\r\n\t\t\t<a on:click={(e) => {\r\n\t\t\t\tdatabaseStore.openTreePath(data.fullPath, !data.open, e.ctrlKey);\r\n\t\t\t}}>\r\n\t\t\t\t<i class=\"fas\" class:fa-angle-down={data.open} class:fa-angle-right={!data.open}></i>\r\n\t\t\t</a>\r\n\t\t{/if}\r\n\t\t{#if data.fullPath.includes(\".\")}\r\n\t\t\t{#if !data.hasChildren}\r\n\t\t\t\t<a class=\"database-entry-button\" on:click={(e) => {\r\n\t\t\t\t\tdatabaseStore.copyPath(data.fullPath, true, e.ctrlKey)\r\n\t\t\t\t\tflashFilePath = true;\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tflashFilePath = false\r\n\t\t\t\t\t}, 400);\r\n\t\t\t\t}}>\r\n\t\t\t\t\t<i class=\"fas fa-file\" class:flash-it={flashFilePath}></i>\r\n\t\t\t\t</a>\r\n\t\t\t{/if}\r\n\t\t\t<a class=\"database-entry-button\" on:click={(e) => {\r\n\t\t\t\tdatabaseStore.copyPath(data.fullPath, false, e.ctrlKey)\r\n\t\t\t\tflashDBPath = true;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tflashDBPath = false\r\n\t\t\t\t}, 400);\r\n\t\t\t}}>\r\n\t\t\t\t<i class=\"fas fa-database\" class:flash-it={flashDBPath}></i>\r\n\t\t\t</a>\r\n\t\t\t<a class=\"database-entry-button\" on:click={() => {\r\n\t\t\t\tdatabaseStore.playFile(data.fullPath)\r\n\t\t\t}}>\r\n\t\t\t\t<i class=\"fas fa-play\"></i>\r\n\t\t\t</a>\r\n\t\t{/if}\r\n\t\t<div class=\"database-entry-text\" title=\"{data.path}\">\r\n\t\t\t<div class=\"database-entry-text-highlight\">{@html highlight}</div>\r\n\t\t\t{data.path}\r\n\t\t</div>\r\n\t</div>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .database-entry {\r\n    flex: 1 0 auto;\r\n\r\n    .database-entry-text-container {\r\n      flex: 1;\r\n      display: flex;\r\n      align-items: center;\r\n\r\n      .database-entry-button {\r\n        padding: 0 0 0 3px;\r\n        font-size: 0.7rem;\r\n        line-height: normal;\r\n        cursor: pointer;\r\n      }\r\n\r\n      a {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        max-width: 15px;\r\n      }\r\n\r\n      a > i {\r\n        flex: 0 0 15px;\r\n        min-width: 15px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .database-entry > button > i {\r\n    font-size: 0.7rem;\r\n  }\r\n\r\n  .sub-leaves {\r\n    padding-left: 1rem;\r\n    padding-bottom: 0.25rem;\r\n    display: flex;\r\n    flex-direction: column;\r\n  }\r\n\r\n  .database-entry-text {\r\n    position: relative;\r\n    margin-left: 5px;\r\n  }\r\n\r\n  .database-entry-text-highlight {\r\n    pointer-events: none;\r\n    color: transparent;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .flash-it {\r\n    -webkit-animation: flash linear 400ms forwards;\r\n    animation: flash linear 400ms forwards;\r\n  }\r\n\r\n  @keyframes flash {\r\n    0% {\r\n      opacity: 1;\r\n    }\r\n    25% {\r\n      opacity: .1;\r\n    }\r\n    50% {\r\n      opacity: 1;\r\n    }\r\n    75% {\r\n      opacity: .1;\r\n    }\r\n    100% {\r\n      opacity: 1;\r\n    }\r\n  }\r\n</style>\r\n","<script>\r\n\texport let data;\r\n</script>\r\n\r\n<div style=\"margin-bottom: 0.3rem;\"></div>\r\n","import SequencerDatabase from \"../../modules/sequencer-database.js\";\nimport { SequencerFileBase } from \"../../modules/sequencer-file.js\";\nimport CONSTANTS from \"../../constants.js\";\nimport * as lib from \"../../lib/lib.js\";\nimport { writable, get } from \"svelte/store\";\nimport TreeViewEntry from \"./TreeViewEntry.svelte\";\nimport TreeViewSeparator from \"./TreeViewSeparator.svelte\";\n\nlet lastFile = false;\n\nfunction getFileData(entryText) {\n  let entry = SequencerDatabase.getEntry(entryText);\n\n  if (Array.isArray(entry)) {\n    if (entry.includes(lastFile) && entry.length > 1) {\n      entry.splice(entry.indexOf(lastFile), 1);\n    }\n    entry = lib.random_array_element(entry);\n    lastFile = entry;\n  }\n\n  let previewFile = entry?.file ?? entry;\n  if (entry instanceof SequencerFileBase) {\n    previewFile = entry.clone().getPreviewFile(entryText);\n  }\n\n  let lowerCaseEntry = previewFile ? previewFile.toLowerCase() : \"unknown.jpg\";\n\n  const isAudio =\n    lowerCaseEntry.endsWith(\"ogg\") ||\n    lowerCaseEntry.endsWith(\"mp3\") ||\n    lowerCaseEntry.endsWith(\"wav\");\n  const isImage = !lowerCaseEntry.endsWith(\"webm\") && !isAudio;\n  const isVideo = !isAudio && !isImage;\n  const icon = previewFile\n    ? isVideo\n      ? \"fa-film\"\n      : isAudio\n      ? \"fa-volume-high\"\n      : \"fa-image\"\n    : \"fa-question-mark\";\n  const title = previewFile\n    ? isVideo\n      ? \"Animated WebM\"\n      : isAudio\n      ? \"Audio\"\n      : \"Image\"\n    : \"Unknown\";\n\n  return {\n    file: previewFile ?? \"unknown.jpg\",\n    dbEntry: entry,\n    icon,\n    title,\n    isAudio,\n    isImage,\n    isVideo,\n  };\n}\n\nfunction copyPath(dbPath, getFilepath, quotes = false) {\n  const tempInput = document.createElement(\"input\");\n  tempInput.value = `${dbPath}`;\n\n  let entry;\n  if (getFilepath) {\n    entry = Sequencer.Database.getEntry(dbPath);\n    if (Array.isArray(entry)) {\n      entry = lib.random_array_element(entry);\n    }\n    if (entry instanceof SequencerFileBase) {\n      const specificFt = dbPath.match(CONSTANTS.FEET_REGEX);\n      if (specificFt) {\n        const ft = specificFt[0].replaceAll(\".\", \"\");\n        entry = entry.getFile(ft);\n      } else {\n        const files = entry.getAllFiles();\n        if (Array.isArray(files)) {\n          const index = Math.floor(lib.interpolate(0, files.length - 1, 0.5));\n          entry = files[index];\n        }\n      }\n    }\n\n    tempInput.value = `${entry?.file ?? entry}`;\n  }\n\n  if (quotes) {\n    tempInput.value = `\"${tempInput.value}\"`;\n  }\n\n  document.body.appendChild(tempInput);\n  tempInput.select();\n  document.execCommand(\"copy\");\n  document.body.removeChild(tempInput);\n  document.execCommand(\"copy\");\n}\n\nfunction playFile(entry) {\n  const { file, isAudio, isImage, isVideo } = getFileData(entry);\n\n  databaseStore.elements.audio.classList.toggle(\"hidden\", !isAudio);\n  databaseStore.elements.image.classList.toggle(\"hidden\", !isImage);\n  databaseStore.elements.player.classList.toggle(\"hidden\", !isVideo);\n\n  if (isImage) {\n    databaseStore.elements.image.src = file;\n    databaseStore.metadata.set({\n      type: \"Image\",\n      duration: \"n/a\",\n    });\n    return;\n  }\n\n  const element = isAudio\n    ? databaseStore.elements.audio\n    : databaseStore.elements.player;\n\n  element.onerror = () => {\n    const error = `Sequencer Database Viewer | Could not play file: ${file}`;\n    ui.notifications.error(error);\n    console.error(error);\n  };\n\n  element.oncanplay = () => {\n    element.play();\n  };\n\n  element.onloadedmetadata = () => {\n    databaseStore.metadata.set({\n      type: isVideo ? \"Video\" : isAudio ? \"Audio\" : \"Image\",\n      duration: isImage ? \"n/a\" : element.duration * 1000 + \"ms\",\n    });\n  };\n\n  element.src = file;\n}\n\nconst treeStore = writable({});\nconst visibleTreeStore = writable([]);\nlet flattenedEntries = [];\nconst entriesStore = SequencerDatabase.entriesStore;\nconst packStore = writable(SequencerDatabase.publicModules);\nconst selectedPackStore = writable(\"all\");\nconst searchStore = writable(\"\");\nconst cleanSearchStore = writable(\"\");\nconst searchRegexStore = writable(new RegExp(\"\", \"gu\"));\n\nSequencerDatabase.entriesStore.subscribe(() => {\n  packStore.set(SequencerDatabase.publicModules);\n});\n\nconst databaseStore = {\n  metadata: writable(false),\n  allRanges: writable(false),\n  subLists: writable(false),\n  listView: writable(false),\n  packStore: packStore,\n  selectedPackStore: selectedPackStore,\n  visibleTreeStore: visibleTreeStore,\n  search: searchStore,\n  cleanSearchStore: cleanSearchStore,\n  searchRegex: searchRegexStore,\n  elements: {},\n  copyPath,\n  playFile,\n  openTreePath,\n};\n\nentriesStore.subscribe(() => {\n  filterFlattenedEntries();\n});\n\ndatabaseStore.allRanges.subscribe(() => {\n  filterFlattenedEntries();\n});\n\ndatabaseStore.subLists.subscribe(() => {\n  filterFlattenedEntries();\n});\n\ndatabaseStore.selectedPackStore.subscribe(() => {\n  filterFlattenedEntries();\n});\n\nsearchStore.subscribe((val) => {\n  const cleanSearch = lib.str_to_search_regex_str(val).replace(/\\s+/g, \"|\");\n  cleanSearchStore.set(cleanSearch);\n  searchRegexStore.set(new RegExp(cleanSearch, \"gu\"));\n  updateVisualTree();\n});\n\nfunction filterFlattenedEntries() {\n  const selectedPack = get(selectedPackStore);\n  const search = get(searchStore);\n  const searchRegex = get(searchRegexStore);\n  const subLists = get(databaseStore.subLists);\n  const allRanges = get(databaseStore.allRanges);\n  flattenedEntries = lib.make_array_unique(\n    SequencerDatabase.publicFlattenedEntries\n      .filter((e) => {\n        return (\n          (selectedPack === \"all\" || e.startsWith(selectedPack + \".\")) &&\n          (!search || e.match(searchRegex))\n        );\n      })\n      .map((e) => (!subLists ? e.split(CONSTANTS.ARRAY_REGEX)[0] : e))\n      .map((e) => (!allRanges ? e.split(CONSTANTS.FEET_REGEX)[0] : e))\n  );\n  treeStore.set(\n    flattenedEntries.reduce((acc, entry) => {\n      let path = \"\";\n      for (const part of entry.split(\".\")) {\n        const fullPath = path ? path + \".\" + part : part;\n        path = path ? path + \".children.\" + part : part;\n        if (!foundry.utils.getProperty(acc, path)) {\n          foundry.utils.setProperty(\n            acc,\n            path,\n            foundry.utils.mergeObject(\n              {\n                path: part,\n                fullPath,\n                open: false,\n                children: {},\n              },\n              foundry.utils.getProperty(acc, path)\n            )\n          );\n        }\n      }\n      return acc;\n    }, {})\n  );\n}\n\nfunction openTreePath(fullPath, open, openAll = false) {\n  treeStore.update((tree) => {\n    const fullTreePath = fullPath.split(\".\").join(\".children.\");\n    const node = foundry.utils.getProperty(tree, fullTreePath);\n    foundry.utils.setProperty(tree, fullTreePath + \".open\", open);\n    if ((!open || openAll) && !foundry.utils.isEmpty(node.children)) {\n      recurseOpenTree(node.children, open);\n    }\n    return tree;\n  });\n}\n\nfunction recurseOpenTree(children, open) {\n  for (const node of Object.values(children)) {\n    node.open = open;\n    if (!foundry.utils.isEmpty(node.children)) {\n      recurseOpenTree(node.children, open);\n    }\n  }\n}\n\ntreeStore.subscribe(() => {\n  updateVisualTree();\n});\n\nfunction updateVisualTree() {\n  const tree = get(treeStore);\n  const visibleTree = recurseTree(tree)\n    .deepFlatten()\n    .filter((e) => e.visible);\n  visibleTreeStore.set(visibleTree);\n}\n\nfunction recurseTree(tree, path = \"\", depth = 0) {\n  const search = get(searchStore);\n  const searchRegex = get(searchRegexStore);\n  const searchParts = get(cleanSearchStore).split(\"|\");\n  return Object.entries(tree).map(([key, data]) => {\n    const fullPath = path ? path + \".\" + key : key;\n\n    const children = recurseTree(\n      data.children,\n      fullPath,\n      depth + 1\n    ).deepFlatten();\n\n    const matchParts = lib.make_array_unique(fullPath.match(searchRegex) || []);\n    const open =\n      data.open ||\n      (search &&\n        (matchParts.length >= searchParts.length ||\n          children.filter((e) => e.visible).length));\n    let visible = !search || matchParts.length >= searchParts.length;\n\n    if (visible) {\n      children.forEach((e) => (e.visible = true));\n    } else {\n      visible = children.filter((e) => e.visible).length;\n    }\n\n    const entry = {\n      class: TreeViewEntry,\n      path: key,\n      fullPath: fullPath,\n      open,\n      visible,\n      hasChildren: !foundry.utils.isEmpty(data.children),\n      depth,\n    };\n\n    const leaf = [entry];\n    if ((data.open || entry.open) && entry.hasChildren) {\n      leaf.push(...children, {\n        fullPath: foundry.utils.randomID(),\n        class: TreeViewSeparator,\n      });\n    }\n    return leaf;\n  });\n}\n\nexport { databaseStore };\n","<script>\r\n\r\n\r\n  import { createEventDispatcher } from \"svelte\";\r\n  import { databaseStore } from \"./DatabaseStore.js\";\r\n\r\n  const dispatch = createEventDispatcher();\r\n\r\n\texport let entry;\r\n\r\n  const searchRegex = databaseStore.searchRegex;\r\n\r\n  let flashFilePath = false;\r\n  let flashDBPath = false;\r\n\r\n  $: highlight = entry.replace(\r\n    $searchRegex,\r\n\t\t\"<mark>$&</mark>\"\r\n\t);\r\n\r\n</script>\r\n\r\n<div\r\n\tclass=\"database-entry\"\r\n\tdata-id=\"{entry}\"\r\n>\r\n\t<button type=\"button\" class=\"btn_play\" on:click={() => {\r\n    databaseStore.playFile(entry)\r\n  }}>\r\n\t\t<i class=\"fas fa-play\"></i>\r\n\t</button>\r\n\t<button type=\"button\" class=\"btn_copy_filepath\" on:click={(e) => {\r\n    databaseStore.copyPath(entry, true, e.ctrlKey)\r\n    flashFilePath = true;\r\n    setTimeout(() => {\r\n      flashFilePath = false\r\n    }, 400);\r\n    }}>\r\n\t\t<i class:flash-it={flashFilePath} class=\"fas fa-file\"></i>\r\n\t</button>\r\n\t<button type=\"button\" class=\"btn_copy_databasepath\" on:click={(e) => {\r\n    databaseStore.copyPath(entry, false, e.ctrlKey)\r\n    flashDBPath = true;\r\n    setTimeout(() => {\r\n      flashDBPath = false\r\n    }, 400);\r\n  }}>\r\n\t\t<i class:flash-it={flashDBPath} class=\"fas fa-database\"></i>\r\n\t</button>\r\n\r\n\t<div class=\"database-entry-text\" title=\"{entry}\">\r\n\t\t<div class=\"database-entry-text-highlight\">{@html highlight}</div>\r\n\t\t{entry}\r\n\t</div>\r\n</div>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .database-entry{\r\n    display:flex;\r\n    flex: 1 0 auto;\r\n  }\r\n\r\n  select, input {\r\n    color: black !important;\r\n    background: rgba(255, 255, 255, 0.5) !important;\r\n    margin-right: 0.25rem;\r\n  }\r\n\r\n  .database-entry > button{\r\n    flex: 0;\r\n\t\tpadding: 0 0 0 3px;\r\n    font-size: 0.7rem !important;\r\n    min-height: 20px;\r\n    max-height: 20px;\r\n    min-width: 20px;\r\n    max-width: 20px;\r\n    line-height: normal;\r\n    margin-right: 2px !important;\r\n  }\r\n\r\n  .database-entry > button > i {\r\n    font-size: 0.7rem;\r\n  }\r\n\r\n  .btn_play * {\r\n    pointer-events: none;\r\n  }\r\n\r\n  .btn_copy_filepath, .btn_copy_databasepath{\r\n    min-width: 1.5rem;\r\n    padding: 0;\r\n  }\r\n\r\n  .database-entry > div{\r\n    flex: 1;\r\n    line-height:1.25rem;\r\n  }\r\n\r\n  .database-entry-text {\r\n    position: relative;\r\n\t\tmargin-left: 5px;\r\n  }\r\n\r\n  .database-entry-text-highlight {\r\n    pointer-events: none;\r\n    color: transparent;\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n  }\r\n\r\n  .flash-it {\r\n    -webkit-animation: flash linear 400ms forwards;\r\n    animation: flash linear 400ms forwards;\r\n  }\r\n\r\n  @keyframes flash {\r\n    0% {\r\n      opacity: 1;\r\n    }\r\n    25% {\r\n      opacity: .1;\r\n    }\r\n    50% {\r\n      opacity: 1;\r\n    }\r\n    75% {\r\n      opacity: .1;\r\n    }\r\n    100% {\r\n      opacity: 1;\r\n    }\r\n  }\r\n\r\n</style>\r\n","/**\n * virtual list core calculating center\n */\n\nconst DIRECTION_TYPE = {\n    FRONT: \"FRONT\", // scroll up or left\n    BEHIND: \"BEHIND\", // scroll down or right\n}\nconst CALC_TYPE = {\n    INIT: \"INIT\",\n    FIXED: \"FIXED\",\n    DYNAMIC: \"DYNAMIC\",\n}\nconst LEADING_BUFFER = 2\n\nexport default class {\n    param\n    callUpdate\n    firstRangeTotalSize = 0\n    firstRangeAverageSize = 0\n    lastCalcIndex = 0\n    fixedSizeValue = 0\n    calcType = CALC_TYPE.INIT\n    offset = 0\n    direction = \"\"\n    range\n\n    constructor(param, callUpdate) {\n        this.init(param, callUpdate)\n    }\n\n    init(param, callUpdate) {\n        // param data\n        this.param = param\n        this.callUpdate = callUpdate\n\n        // size data\n        this.sizes = new Map()\n        this.firstRangeTotalSize = 0\n        this.firstRangeAverageSize = 0\n        this.fixedSizeValue = 0\n        this.calcType = CALC_TYPE.INIT\n\n        // scroll data\n        this.offset = 0\n        this.direction = \"\"\n\n        // range data\n        this.range = Object.create(null)\n        if (param) {\n            this.checkRange(0, param.keeps - 1)\n        }\n\n        // benchmark example data\n        // this.__bsearchCalls = 0\n        // this.__getIndexOffsetCalls = 0\n    }\n\n    destroy() {\n        this.init(null, null)\n    }\n\n    // return current render range\n    getRange() {\n        const range = Object.create(null)\n        range.start = this.range.start\n        range.end = this.range.end\n        range.padFront = this.range.padFront\n        range.padBehind = this.range.padBehind\n        return range\n    }\n\n    isBehind() {\n        return this.direction === DIRECTION_TYPE.BEHIND\n    }\n\n    isFront() {\n        return this.direction === DIRECTION_TYPE.FRONT\n    }\n\n    // return start index offset\n    getOffset(start) {\n        return (start < 1 ? 0 : this.getIndexOffset(start)) + this.param.slotHeaderSize\n    }\n\n    updateParam(key, value) {\n        if (this.param && (key in this.param)) {\n            // if uniqueIds change, find out deleted id and remove from size map\n            if (key === \"uniqueIds\") {\n                this.sizes.forEach((v, key) => {\n                    if (!value.includes(key)) {\n                        this.sizes.delete(key)\n                    }\n                })\n            }\n            this.param[key] = value\n        }\n    }\n\n    // save each size map by id\n    saveSize(id, size) {\n        this.sizes.set(id, size)\n\n        // we assume size type is fixed at the beginning and remember first size value\n        // if there is no size value different from this at next coming saving\n        // we think it's a fixed size list, otherwise is dynamic size list\n        if (this.calcType === CALC_TYPE.INIT) {\n            this.fixedSizeValue = size\n            this.calcType = CALC_TYPE.FIXED\n        } else if (this.calcType === CALC_TYPE.FIXED && this.fixedSizeValue !== size) {\n            this.calcType = CALC_TYPE.DYNAMIC\n            // it's no use at all\n            delete this.fixedSizeValue\n        }\n\n        // calculate the average size only in the first range\n        if (this.calcType !== CALC_TYPE.FIXED && typeof this.firstRangeTotalSize !== \"undefined\") {\n            if (this.sizes.size < Math.min(this.param.keeps, this.param.uniqueIds.length)) {\n                this.firstRangeTotalSize = [...this.sizes.values()].reduce((acc, val) => acc + val, 0)\n                this.firstRangeAverageSize = Math.round(this.firstRangeTotalSize / this.sizes.size)\n            } else {\n                // it's done using\n                delete this.firstRangeTotalSize\n            }\n        }\n    }\n\n    // in some special situation (e.g. length change) we need to update in a row\n    // try going to render next range by a leading buffer according to current direction\n    handleDataSourcesChange() {\n        let start = this.range.start\n\n        if (this.isFront()) {\n            start = start - LEADING_BUFFER\n        } else if (this.isBehind()) {\n            start = start + LEADING_BUFFER\n        }\n\n        start = Math.max(start, 0)\n\n        this.updateRange(this.range.start, this.getEndByStart(start))\n    }\n\n    // when slot size change, we also need force update\n    handleSlotSizeChange() {\n        this.handleDataSourcesChange()\n    }\n\n    // calculating range on scroll\n    handleScroll(offset) {\n        this.direction = offset < this.offset ? DIRECTION_TYPE.FRONT : DIRECTION_TYPE.BEHIND\n        this.offset = offset\n\n        if (!this.param) {\n            return\n        }\n\n        if (this.direction === DIRECTION_TYPE.FRONT) {\n            this.handleFront()\n        } else if (this.direction === DIRECTION_TYPE.BEHIND) {\n            this.handleBehind()\n        }\n    }\n\n    // ----------- public method end -----------\n\n    handleFront() {\n        const overs = this.getScrollOvers()\n        // should not change range if start doesn't exceed overs\n        if (overs > this.range.start) {\n            return\n        }\n\n        // move up start by a buffer length, and make sure its safety\n        const start = Math.max(overs - this.param.buffer, 0)\n        this.checkRange(start, this.getEndByStart(start))\n    }\n\n    handleBehind() {\n        const overs = this.getScrollOvers()\n        // range should not change if scroll overs within buffer\n        if (overs < this.range.start + this.param.buffer) {\n            return\n        }\n\n        this.checkRange(overs, this.getEndByStart(overs))\n    }\n\n    // return the pass overs according to current scroll offset\n    getScrollOvers() {\n        // if slot header exist, we need subtract its size\n        const offset = this.offset - this.param.slotHeaderSize\n        if (offset <= 0) {\n            return 0\n        }\n\n        // if is fixed type, that can be easily\n        if (this.isFixedType()) {\n            return Math.floor(offset / this.fixedSizeValue)\n        }\n\n        let low = 0\n        let middle = 0\n        let middleOffset = 0\n        let high = this.param.uniqueIds.length\n\n        while (low <= high) {\n            // this.__bsearchCalls++\n            middle = low + Math.floor((high - low) / 2)\n            middleOffset = this.getIndexOffset(middle)\n\n            if (middleOffset === offset) {\n                return middle\n            } else if (middleOffset < offset) {\n                low = middle + 1\n            } else if (middleOffset > offset) {\n                high = middle - 1\n            }\n        }\n\n        return low > 0 ? --low : 0\n    }\n\n    // return a scroll offset from given index, can efficiency be improved more here?\n    // although the call frequency is very high, its only a superposition of numbers\n    getIndexOffset(givenIndex) {\n        if (!givenIndex) {\n            return 0\n        }\n\n        let offset = 0\n        let indexSize = 0\n        for (let index = 0; index < givenIndex; index++) {\n            // this.__getIndexOffsetCalls++\n            indexSize = this.sizes.get(this.param.uniqueIds[index])\n            offset = offset + (typeof indexSize === \"number\" ? indexSize : this.getEstimateSize())\n        }\n\n        // remember last calculate index\n        this.lastCalcIndex = Math.max(this.lastCalcIndex, givenIndex - 1)\n        this.lastCalcIndex = Math.min(this.lastCalcIndex, this.getLastIndex())\n\n        return offset\n    }\n\n    // is fixed size type\n    isFixedType() {\n        return this.calcType === CALC_TYPE.FIXED\n    }\n\n    // return the real last index\n    getLastIndex() {\n        return this.param.uniqueIds.length - 1\n    }\n\n    // in some conditions range is broke, we need correct it\n    // and then decide whether need update to next range\n    checkRange(start, end) {\n        const keeps = this.param.keeps\n        const total = this.param.uniqueIds.length\n\n        // data less than keeps, render all\n        if (total <= keeps) {\n            start = 0\n            end = this.getLastIndex()\n        } else if (end - start < keeps - 1) {\n            // if range length is less than keeps, correct it base on end\n            start = end - keeps + 1\n        }\n\n        if (this.range.start !== start) {\n            this.updateRange(start, end)\n        }\n    }\n\n    // setting to a new range and rerender\n    updateRange(start, end) {\n        this.range.start = start\n        this.range.end = end\n        this.range.padFront = this.getPadFront()\n        this.range.padBehind = this.getPadBehind()\n        this.callUpdate(this.getRange())\n    }\n\n    // return end base on start\n    getEndByStart(start) {\n        const theoryEnd = start + this.param.keeps - 1\n        const truelyEnd = Math.min(theoryEnd, this.getLastIndex())\n        return truelyEnd\n    }\n\n    // return total front offset\n    getPadFront() {\n        if (this.isFixedType()) {\n            return this.fixedSizeValue * this.range.start\n        } else {\n            return this.getIndexOffset(this.range.start)\n        }\n    }\n\n    // return total behind offset\n    getPadBehind() {\n        const end = this.range.end\n        const lastIndex = this.getLastIndex()\n\n        if (this.isFixedType()) {\n            return (lastIndex - end) * this.fixedSizeValue\n        }\n\n        // if it's all calculated, return the exactly offset\n        if (this.lastCalcIndex === lastIndex) {\n            return this.getIndexOffset(lastIndex) - this.getIndexOffset(end)\n        } else {\n            // if not, use a estimated value\n            return (lastIndex - end) * this.getEstimateSize()\n        }\n    }\n\n    // get the item estimate size\n    getEstimateSize() {\n        return this.isFixedType() ? this.fixedSizeValue : (this.firstRangeAverageSize || this.param.estimateSize)\n    }\n}\n\nexport function isBrowser() {\n    return typeof document !== \"undefined\"\n}","<script>\n    import {afterUpdate, createEventDispatcher, onDestroy, onMount} from \"svelte\"\n\n    export let horizontal = false\n    export let uniqueKey\n    export let type = \"item\"\n\n    let resizeObserver\n    let itemDiv\n    let previousSize\n\n    const dispatch = createEventDispatcher()\n    const shapeKey = horizontal ? \"offsetWidth\" : \"offsetHeight\"\n\n    onMount(() => {\n        if (typeof ResizeObserver !== \"undefined\") {\n            resizeObserver = new ResizeObserver(dispatchSizeChange)\n            resizeObserver.observe(itemDiv)\n        }\n    })\n    afterUpdate(dispatchSizeChange)\n    onDestroy(() => {\n        if (resizeObserver) {\n            resizeObserver.disconnect()\n            resizeObserver = null\n        }\n    })\n\n    function dispatchSizeChange() {\n        const size = itemDiv ? itemDiv[shapeKey] : 0\n        if (size === previousSize) return\n        previousSize = size\n        dispatch(\"resize\", {id: uniqueKey, size, type})\n    }\n</script>\n\n<div bind:this={itemDiv} class=\"virtual-scroll-item\">\n    <slot/>\n</div>\n","<script>\n    import Virtual, {isBrowser} from \"./virtual\"\n    import Item from \"./Item.svelte\"\n    import {createEventDispatcher, onDestroy, onMount} from \"svelte\"\n\n    /**\n     * Unique key for getting data from `data`\n     * @type {string}\n     */\n    export let key = \"id\"\n    /**\n     * Source for list\n     * @type {Array<any>}\n     */\n    export let data\n    /**\n     * Count of rendered items\n     * @type {number}\n     */\n    export let keeps = 30\n    /**\n     * Estimate size of each item, needs for smooth scrollbar\n     * @type {number}\n     */\n    export let estimateSize = 50\n    /**\n     * Scroll direction\n     * @type {boolean}\n     */\n    export let isHorizontal = false\n    /**\n     * scroll position start index\n     */\n    export let start = 0\n    /**\n     * scroll position offset\n     */\n    export let offset = 0\n    /**\n     * Let virtual list using global document to scroll through the list\n     * @type {boolean}\n     */\n    export let pageMode = false\n    /**\n     * The threshold to emit `top` event, attention to multiple calls.\n     * @type {number}\n     */\n    export let topThreshold = 0\n    /**\n     * The threshold to emit `bottom` event, attention to multiple calls.\n     * @type {number}\n     */\n    export let bottomThreshold = 0\n\n    let displayItems = []\n    let paddingStyle\n    let directionKey = isHorizontal ? \"scrollLeft\" : \"scrollTop\"\n    let range = null\n    let virtual = new Virtual({\n        slotHeaderSize: 0,\n        slotFooterSize: 0,\n        keeps: keeps,\n        estimateSize: estimateSize,\n        buffer: Math.round(keeps / 3), // recommend for a third of keeps\n        uniqueIds: getUniqueIdFromDataSources(),\n    }, onRangeChanged)\n    let root\n    let shepherd\n    const dispatch = createEventDispatcher()\n\n    /**\n     * @type {(id: number) => number}\n     */\n    export function getSize(id) {\n        return virtual.sizes.get(id)\n    }\n\n    /**\n     * Count of items\n     * @type {() => number}\n     */\n    export function getSizes() {\n        return virtual.sizes.size\n    }\n\n    /**\n     * @type {() => number}\n     */\n    export function getOffset() {\n        if (pageMode && isBrowser()) {\n            return document.documentElement[directionKey] || document.body[directionKey]\n        } else {\n            return root ? Math.ceil(root[directionKey]) : 0\n        }\n    }\n\n    /**\n     * @type {() => number}\n     */\n    export function getClientSize() {\n        const key = isHorizontal ? \"clientWidth\" : \"clientHeight\"\n        if (pageMode && isBrowser()) {\n            return document.documentElement[key] || document.body[key]\n        } else {\n            return root ? Math.ceil(root[key]) : 0\n        }\n    }\n\n    /**\n     * @type {() => number}\n     */\n    export function getScrollSize() {\n        const key = isHorizontal ? \"scrollWidth\" : \"scrollHeight\"\n        if (pageMode && isBrowser()) {\n            return document.documentElement[key] || document.body[key]\n        } else {\n            return root ? Math.ceil(root[key]) : 0\n        }\n    }\n\n    /**\n     * @type {() => void}\n     */\n    export function updatePageModeFront() {\n        if (root && isBrowser()) {\n            const rect = root.getBoundingClientRect()\n            const {defaultView} = root.ownerDocument\n            const offsetFront = isHorizontal ? (rect.left + defaultView.pageXOffset) : (rect.top + defaultView.pageYOffset)\n            virtual.updateParam(\"slotHeaderSize\", offsetFront)\n        }\n    }\n\n    /**\n     * @type {(offset: number) => void}\n     */\n    export function scrollToOffset(offset) {\n        if (!isBrowser()) return\n        if (pageMode) {\n            document.body[directionKey] = offset\n            document.documentElement[directionKey] = offset\n        } else if (root) {\n            root[directionKey] = offset\n        }\n    }\n\n    /**\n     * @type {(index: number) => void}\n     */\n    export function scrollToIndex(index) {\n        if (index >= data.length - 1) {\n            scrollToBottom()\n        } else {\n            const offset = virtual.getOffset(index)\n            scrollToOffset(offset)\n        }\n    }\n\n    /**\n     * @type {() => void}\n     */\n    export function scrollToBottom() {\n        if (shepherd) {\n            const offset = shepherd[isHorizontal ? \"offsetLeft\" : \"offsetTop\"]\n            scrollToOffset(offset)\n\n            // check if it's really scrolled to the bottom\n            // maybe list doesn't render and calculate to last range,\n            // so we need retry in next event loop until it really at bottom\n            setTimeout(() => {\n                if (getOffset() + getClientSize() + 1 < getScrollSize()) {\n                    scrollToBottom()\n                }\n            }, 3)\n        }\n    }\n\n    onMount(() => {\n        if (start) {\n            scrollToIndex(start)\n        } else if (offset) {\n            scrollToOffset(offset)\n        }\n\n        if (pageMode) {\n            updatePageModeFront()\n\n            document.addEventListener(\"scroll\", onScroll, {\n                passive: false,\n            })\n        }\n    })\n\n    onDestroy(() => {\n        virtual.destroy()\n        if (pageMode && isBrowser()) {\n            document.removeEventListener(\"scroll\", onScroll)\n        }\n    })\n\n    function getUniqueIdFromDataSources() {\n        return data.map((dataSource) => dataSource[key])\n    }\n\n    function onItemResized(event) {\n        const {id, size, type} = event.detail\n        if (type === \"item\")\n            virtual.saveSize(id, size)\n        else if (type === \"slot\") {\n            if (id === \"header\")\n                virtual.updateParam(\"slotHeaderSize\", size)\n            else if (id === \"footer\")\n                virtual.updateParam(\"slotFooterSize\", size)\n\n            // virtual.handleSlotSizeChange()\n        }\n    }\n\n    function onRangeChanged(range_) {\n        range = range_\n        paddingStyle = paddingStyle = isHorizontal ? `0px ${range.padBehind}px 0px ${range.padFront}px` : `${range.padFront}px 0px ${range.padBehind}px`\n        displayItems = data.slice(range.start, range.end + 1)\n    }\n\n    function onScroll(event) {\n        const offset = getOffset()\n        const clientSize = getClientSize()\n        const scrollSize = getScrollSize()\n\n        // \biOS scroll-spring-back behavior will make direction mistake\n        if (offset < 0 || (offset + clientSize > scrollSize) || !scrollSize) {\n            return\n        }\n\n        virtual.handleScroll(offset)\n        emitEvent(offset, clientSize, scrollSize, event)\n    }\n\n    function emitEvent(offset, clientSize, scrollSize, event) {\n        dispatch(\"scroll\", {event, range: virtual.getRange()})\n\n        if (virtual.isFront() && !!data.length && (offset - topThreshold <= 0)) {\n            dispatch(\"top\")\n        } else if (virtual.isBehind() && (offset + clientSize + bottomThreshold >= scrollSize)) {\n            dispatch(\"bottom\")\n        }\n    }\n\n    $: scrollToOffset(offset)\n    $: scrollToIndex(start)\n    $: handleKeepsChange(keeps)\n\n    function handleKeepsChange(keeps) {\n        virtual.updateParam(\"keeps\", keeps)\n        virtual.handleSlotSizeChange()\n    }\n\n    $: handleDataSourcesChange(data)\n\n    async function handleDataSourcesChange(data) {\n        virtual.updateParam(\"uniqueIds\", getUniqueIdFromDataSources())\n        virtual.handleDataSourcesChange()\n    }\n</script>\n\n<div bind:this={root} on:scroll={onScroll} style=\"overflow-y: auto; height: inherit\" class=\"virtual-scroll-root\">\n    {#if $$slots.header}\n        <Item on:resize={onItemResized} type=\"slot\" uniqueKey=\"header\">\n            <slot name=\"header\"/>\n        </Item>\n    {/if}\n    <div style=\"padding: {paddingStyle}\" class=\"virtual-scroll-wrapper\">\n        {#each displayItems as dataItem, dataIndex (dataItem[key])}\n            <Item\n                    on:resize={onItemResized}\n                    uniqueKey={dataItem[key]}\n                    horizontal={isHorizontal}\n                    type=\"item\">\n                <slot data={dataItem} index={dataIndex} />\n            </Item>\n        {/each}\n    </div>\n    {#if $$slots.footer}\n        <Item on:resize={onItemResized} type=\"slot\" uniqueKey=\"footer\">\n            <slot name=\"footer\"/>\n        </Item>\n    {/if}\n    <div bind:this={shepherd} class=\"shepherd\"\n         style=\"width: {isHorizontal ? '0px' : '100%'};height: {isHorizontal ? '100%' : '0px'}\"></div>\n</div>\n","<script>\r\n\r\n  import { ApplicationShell } from \"#runtime/svelte/component/core\";\r\n  import { localize } from '#runtime/svelte/helper';\r\n  import { getContext } from \"svelte\";\r\n\r\n  import DatabaseEntry from \"./DatabaseEntry.svelte\";\r\n  import VirtualScroll from \"svelte-virtual-scroll-list\"\r\n\r\n  import SequencerDatabase from \"../../modules/sequencer-database.js\";\r\n  import { databaseStore } from \"./DatabaseStore.js\";\r\n  import * as lib from \"../../lib/lib.js\";\r\n  import CONSTANTS from \"../../constants.js\";\r\n\r\n  const { application } = getContext(\"#external\");\r\n\r\n  export let elementRoot;\r\n\r\n  let entries = [];\r\n\r\n  let filteredEntries = [];\r\n\r\n  const selectedPackStore = databaseStore.selectedPackStore;\r\n  const packStore = databaseStore.packStore;\r\n  const metadata = databaseStore.metadata;\r\n  const allRanges = databaseStore.allRanges;\r\n  const subLists = databaseStore.subLists;\r\n  const listView = databaseStore.listView;\r\n  const visibleTreeStore = databaseStore.visibleTreeStore;\r\n  const search = databaseStore.search;\r\n  const cleanSearchStore = databaseStore.cleanSearchStore;\r\n  const searchRegex = databaseStore.searchRegex;\r\n  const entriesStore = SequencerDatabase.entriesStore;\r\n\r\n  listView.set(game.settings.get(CONSTANTS.MODULE_NAME, \"db-list-view\"));\r\n\r\n  $: game.settings.set(CONSTANTS.MODULE_NAME, \"db-list-view\", $listView);\r\n\r\n  $: {\r\n    $entriesStore;\r\n    const specificRanges = $allRanges\r\n      ? Sequencer.Database.publicFlattenedEntries\r\n      : Sequencer.Database.publicFlattenedSimpleEntries;\r\n    entries = specificRanges.map(\r\n      (entry) => {\r\n        return {\r\n          pack: entry.split(\".\")[0],\r\n          entry: entry\r\n        };\r\n      }\r\n    );\r\n  }\r\n\r\n  $: {\r\n    const searchParts = $cleanSearchStore.split('|');\r\n    filteredEntries = entries.filter((part) => {\r\n      const matchParts = lib.make_array_unique(part.entry.match($searchRegex) || []);\r\n      return (\r\n        ($selectedPackStore === \"all\" || $selectedPackStore === part.pack) &&\r\n        ($search === \"\" || matchParts.length >= searchParts.length)\r\n      );\r\n    });\r\n  }\r\n\r\n</script>\r\n\r\n<svelte:options accessors={true}/>\r\n\r\n<ApplicationShell bind:elementRoot>\r\n\r\n\t<div class=\"sequencer-database-content\">\r\n\r\n\t\t<div class=\"sequencer-database-header\">\r\n\t\t\t<select bind:value={$selectedPackStore} name=\"pack-select\">\r\n\t\t\t\t<option value=\"all\">{localize(\"SEQUENCER.Database.AllPacks\")}</option>\r\n\t\t\t\t{#each $packStore as pack, index}\r\n\t\t\t\t\t<option>{ pack }</option>\r\n\t\t\t\t{/each}\r\n\t\t\t</select>\r\n\t\t\t<input bind:value={$search} class=\"ml-2\" placeholder='{localize(\"SEQUENCER.Database.Search\")}' type=\"text\">\r\n\t\t\t<input bind:checked={$allRanges} class=\"ml-2\" id=\"database-all-ranges\" type=\"checkbox\">\r\n\t\t\t<label class=\"all-ranges-label\" for=\"database-all-ranges\">{localize(\"SEQUENCER.Database.ShowAllRanges\")}</label>\r\n\t\t\t<input bind:checked={$subLists} class=\"ml-2\" id=\"include-sub-lists\" type=\"checkbox\">\r\n\t\t\t<label class=\"all-ranges-label\" for=\"include-sub-lists\">{localize(\"SEQUENCER.Database.ShowSubLists\")}</label>\r\n\t\t\t<input bind:checked={$listView} class=\"ml-2\" id=\"treeview\" type=\"checkbox\">\r\n\t\t\t<label class=\"all-ranges-label\" for=\"treeview\">{localize(\"SEQUENCER.Database.ListView\")}</label>\r\n\t\t</div>\r\n\r\n\t\t<div class=\"sequencer-database-entries-container\">\r\n\r\n\t\t\t{#if $listView}\r\n        <div class=\"sequencer-database-entries\">\r\n          <VirtualScroll\r\n            data={filteredEntries}\r\n            key=\"entry\"\r\n            let:data\r\n          >\r\n            <DatabaseEntry entry={data.entry}/>\r\n          </VirtualScroll>\r\n        </div>\r\n\t\t\t{:else}\r\n        <div class=\"sequencer-database-entries-tree\">\r\n          <VirtualScroll\r\n            data={$visibleTreeStore}\r\n            key=\"fullPath\"\r\n            let:data\r\n          >\r\n            <svelte:component this={data.class} {data}/>\r\n          </VirtualScroll>\r\n        </div>\r\n\t\t\t{/if}\r\n\r\n\t\t\t<div class=\"sequencer-database-player-container\">\r\n\t\t\t\t<video autoplay bind:this={databaseStore.elements.player} class=\"database-player\" height=\"335\" loop\r\n\t\t\t\t\t\t\t on:mouseenter={() => { databaseStore.elements.player.controls = true; }}\r\n\t\t\t\t\t\t\t on:mouseleave={() => { databaseStore.elements.player.controls = false; }}\r\n\t\t\t\t\t\t\t preload\r\n\t\t\t\t\t\t\t width=\"335\"\r\n\t\t\t\t>\r\n\t\t\t\t</video>\r\n\t\t\t\t<img bind:this={databaseStore.elements.image} class=\"database-image hidden\">\r\n\t\t\t\t<audio bind:this={databaseStore.elements.audio} class=\"database-audio hidden\"\r\n\t\t\t\t\t\t\t on:mouseenter={() => { databaseStore.elements.audio.controls = true; }}\r\n\t\t\t\t\t\t\t on:mouseleave={() => { databaseStore.elements.audio.controls = false; }}\r\n\t\t\t\t>\r\n\t\t\t\t\t<source type=\"audio/ogg\">\r\n\t\t\t\t</audio>\r\n\t\t\t\t<div class=\"sequencer-database-metadata-container\">\r\n\t\t\t\t\t{#if $metadata}\r\n\t\t\t\t\t\tType: {$metadata.type} | Duration: {$metadata.duration}\r\n\t\t\t\t\t{:else}\r\n\t\t\t\t\t\tNo file loaded...\r\n\t\t\t\t\t{/if}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</ApplicationShell>\r\n\r\n<style lang=\"scss\">\r\n\r\n  .sequencer-database {\r\n    &-content {\r\n      display: flex;\r\n      flex-direction: column;\r\n    }\r\n\r\n    &-header {\r\n      display: flex;\r\n      align-items: center;\r\n      flex-direction: row;\r\n\r\n      > select {\r\n\t\t\t\tflex: 0 1 auto;\r\n        border-radius: 5px 0 0 5px;\r\n        border-right: 0;\r\n        height: 28px;\r\n      }\r\n\r\n      > input[type=\"text\"] {\r\n        border-radius: 0 5px 5px 0;\r\n        padding-left: 0.5rem;\r\n        height: 28px;\r\n      }\r\n\r\n\t\t\t> label {\r\n\t\t\t\tflex: 1 0 auto;\r\n        padding-right: 0.25rem;\r\n\t\t\t}\r\n    }\r\n\r\n    &-entries-container {\r\n      padding-top: 0.5rem;\r\n      max-height: calc(420px - 5rem);\r\n      display: flex;\r\n    }\r\n\r\n    &-entries {\r\n      height: 339px;\r\n      flex: 1;\r\n      margin-right: 0.5rem;\r\n\r\n\t\t\t& :global(.virtual-scroll-item) {\r\n        padding: 2px;\r\n        margin-right: 5px;\r\n        border-radius: 4px;\r\n      }\r\n\r\n      & :global(.virtual-scroll-item):nth-child(odd) {\r\n        background-color: rgba(0, 0, 0, 0.1);\r\n      }\r\n    }\r\n\r\n    &-entries-tree {\r\n      height: 339px;\r\n      flex: 1;\r\n      margin-right: 0.5rem;\r\n\r\n      & :global(.virtual-scroll-item) {\r\n        padding: 2px;\r\n        margin-right: 5px;\r\n        border-radius: 4px;\r\n        min-height: 0px;\r\n        max-height: 17px;\r\n        height: auto;\r\n      }\r\n    }\r\n\r\n    &-player-container {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      width: 335px;\r\n      height: 335px;\r\n\r\n      & > * {\r\n        width: 320px;\r\n        height: 320px;\r\n        border-radius: 5px;\r\n      }\r\n    }\r\n\r\n    &-metadata-container {\r\n      text-align: center;\r\n      margin-top: 5px;\r\n      flex: 0;\r\n    }\r\n  }\r\n\r\n  .hidden {\r\n    display: none;\r\n  }\r\n\r\n  .database-player-container {\r\n    padding: 5px;\r\n    width: 355px;\r\n    height: 355px;\r\n  }\r\n\r\n  .database-player {\r\n    background-color: #999999;\r\n    padding: 10px;\r\n    max-width: 320px;\r\n    height: 320px;\r\n    max-height: 320px;\r\n\t\tmin-height: 320px;\r\n  }\r\n\r\n  .database-image {\r\n    max-width: 320px;\r\n    height: 320px;\r\n    max-height: 320px;\r\n    min-height: 320px;\r\n  }\r\n\r\n  .database-audio {\r\n    max-width: 320px;\r\n    height: 320px;\r\n    max-height: 320px;\r\n    min-height: 320px;\r\n    position: absolute;\r\n    bottom: 0;\r\n  }\r\n\r\n</style>\r\n","import { SvelteApplication } from \"#runtime/svelte/application\";\nimport DatabaseShell from \"./database-shell.svelte\";\n\nexport class DatabaseViewerApp extends SvelteApplication {\n  static get defaultOptions() {\n    return foundry.utils.mergeObject(super.defaultOptions, {\n      title: game.i18n.localize(\"SEQUENCER.Database.Title\"),\n      classes: [\"dialog\"],\n      width: 900,\n      height: 425,\n      svelte: {\n        class: DatabaseShell,\n        target: document.body,\n      },\n    });\n  }\n\n  static getActiveApp() {\n    return Object.values(ui.windows).find((app) => {\n      return (\n        app instanceof this && app._state > Application.RENDER_STATES.CLOSED\n      );\n    });\n  }\n\n  static async show(options = {}) {\n    const existingApp = this.getActiveApp();\n    if (existingApp) return existingApp.render(false, { focus: true });\n    return new Promise((resolve) => {\n      options.resolve = resolve;\n      new this(options).render(true, { focus: true });\n    });\n  }\n}\n","import CONSTANTS from \"./constants.js\";\nimport { debug, user_can_do } from \"./lib/lib.js\";\nimport { DatabaseViewerApp } from \"./formapplications/database/database-viewer-app.js\";\nimport { EffectsUIApp } from \"./formapplications/effects-ui/effects-ui-app.js\";\n\nexport function registerSettings() {\n  game.settings.register(CONSTANTS.MODULE_NAME, \"enable-fix-pixi\", {\n    name: \"SEQUENCER.Setting.EnablePixiFix.Title\",\n    hint: \"SEQUENCER.Setting.EnablePixiFix.Label\",\n    scope: \"client\",\n    config: true,\n    default: false,\n    requiresReload: true,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"enable-global-fix-pixi\", {\n    name: \"SEQUENCER.Setting.EnableGlobalPixiFix.Title\",\n    hint: \"SEQUENCER.Setting.EnableGlobalPixiFix.Label\",\n    scope: \"client\",\n    config: true,\n    default: false,\n    requiresReload: true,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"enable-above-ui-screenspace\", {\n    name: \"SEQUENCER.Setting.EnableAboveUIScreenspace.Title\",\n    hint: \"SEQUENCER.Setting.EnableAboveUIScreenspace.Label\",\n    scope: \"client\",\n    config: true,\n    default: true,\n    requiresReload: true,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"debug\", {\n    name: \"SEQUENCER.Setting.Debug.Title\",\n    hint: \"SEQUENCER.Setting.Debug.Label\",\n    scope: \"client\",\n    config: true,\n    default: false,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"showSidebarTools\", {\n    name: \"SEQUENCER.Setting.ShowTools.Title\",\n    hint: \"SEQUENCER.Setting.ShowTools.Label\",\n    scope: \"client\",\n    config: true,\n    default: true,\n    requiresReload: true,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"showTokenSidebarTools\", {\n    name: \"SEQUENCER.Setting.ShowTokenTools.Title\",\n    hint: \"SEQUENCER.Setting.ShowTokenTools.Label\",\n    scope: \"client\",\n    config: true,\n    default: true,\n    requiresReload: true,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"effectsEnabled\", {\n    name: \"SEQUENCER.Setting.EnableEffects.Title\",\n    hint: \"SEQUENCER.Setting.EnableEffects.Label\",\n    scope: \"client\",\n    config: true,\n    default: true,\n    requiresReload: true,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"soundsEnabled\", {\n    name: \"SEQUENCER.Setting.EnableSounds.Title\",\n    hint: \"SEQUENCER.Setting.EnableSounds.Label\",\n    scope: \"client\",\n    config: true,\n    default: true,\n    requiresReload: true,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"user-effect-opacity\", {\n    name: \"SEQUENCER.Setting.ExternalEffectOpacity.Title\",\n    hint: \"SEQUENCER.Setting.ExternalEffectOpacity.Label\",\n    scope: \"client\",\n    config: true,\n    default: 50,\n    type: Number,\n    range: {\n      min: 0,\n      max: 100,\n      step: 1,\n    },\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"db-list-view\", {\n    scope: \"client\",\n    config: false,\n    default: false,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"welcome-shown\", {\n    scope: \"world\",\n    config: false,\n    default: false,\n    type: Boolean,\n  });\n\n  const permissionLevels = [\n    game.i18n.localize(\"SEQUENCER.Permission.Player\"),\n    game.i18n.localize(\"SEQUENCER.Permission.Trusted\"),\n    game.i18n.localize(\"SEQUENCER.Permission.Assistant\"),\n    game.i18n.localize(\"SEQUENCER.Permission.GM\"),\n  ];\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"permissions-effect-create\", {\n    name: \"SEQUENCER.Setting.Permission.EffectCreate.Title\",\n    hint: \"SEQUENCER.Setting.Permission.EffectCreate.Label\",\n    scope: \"world\",\n    config: true,\n    default: 0,\n    type: Number,\n    choices: permissionLevels,\n    requiresReload: true,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"permissions-effect-delete\", {\n    name: \"SEQUENCER.Setting.Permission.EffectDelete.Title\",\n    hint: \"SEQUENCER.Setting.Permission.EffectDelete.Label\",\n    scope: \"world\",\n    config: true,\n    default: 2,\n    type: Number,\n    choices: permissionLevels,\n    requiresReload: true,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"permissions-sound-create\", {\n    name: \"SEQUENCER.Setting.Permission.SoundCreate.Title\",\n    hint: \"SEQUENCER.Setting.Permission.SoundCreate.Label\",\n    scope: \"world\",\n    config: true,\n    default: 0,\n    type: Number,\n    choices: permissionLevels,\n    requiresReload: true,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"permissions-preload\", {\n    name: \"SEQUENCER.Setting.Permission.PreloadClients.Title\",\n    hint: \"SEQUENCER.Setting.Permission.PreloadClients.Label\",\n    scope: \"world\",\n    config: true,\n    default: 1,\n    type: Number,\n    choices: permissionLevels,\n    requiresReload: true,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"permissions-sidebar-tools\", {\n    name: \"SEQUENCER.Setting.Permission.UseSidebarTools.Title\",\n    hint: \"SEQUENCER.Setting.Permission.UseSidebarTools.Label\",\n    scope: \"world\",\n    config: true,\n    default: 0,\n    type: Number,\n    choices: permissionLevels,\n    requiresReload: true,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"effectPresets\", {\n    scope: \"client\",\n    default: {},\n    type: Object,\n  });\n\n  Hooks.on(\"getSceneControlButtons\", (controls) => {\n    if (!game.settings.get(CONSTANTS.MODULE_NAME, \"showSidebarTools\")) return;\n\n    const selectTool = {\n      icon: \"fas fa-expand\",\n      name: \"select-effect\",\n      title: \"SEQUENCER.SidebarButtons.Select\",\n      visible:\n        user_can_do(\"permissions-effect-create\") &&\n        user_can_do(\"permissions-sidebar-tools\"),\n    };\n\n    const playTool = {\n      icon: \"fas fa-play\",\n      name: \"play-effect\",\n      title: \"SEQUENCER.SidebarButtons.Play\",\n      visible:\n        user_can_do(\"permissions-effect-create\") &&\n        user_can_do(\"permissions-sidebar-tools\"),\n      onClick: () => {\n        EffectsUIApp.show({ inFocus: true, tab: \"player\" });\n      },\n    };\n\n    const viewer = {\n      icon: \"fas fa-film\",\n      name: \"effectviewer\",\n      title: \"SEQUENCER.SidebarButtons.Manager\",\n      button: true,\n      visible:\n        user_can_do(\"permissions-effect-create\") &&\n        user_can_do(\"permissions-sidebar-tools\"),\n      onClick: () => {\n        EffectsUIApp.show({ inFocus: true, tab: \"manager\" });\n      },\n    };\n\n    const database = {\n      icon: \"fas fa-database\",\n      name: \"effectdatabase\",\n      title: \"SEQUENCER.SidebarButtons.Database\",\n      button: true,\n      visible: user_can_do(\"permissions-sidebar-tools\"),\n      onClick: () => {\n        DatabaseViewerApp.show();\n      },\n    };\n\n    controls.push({\n      name: CONSTANTS.MODULE_NAME,\n      title: \"Sequencer Layer\",\n      icon: \"fas fa-list-ol\",\n      layer: \"sequencerInterfaceLayer\",\n      visible:\n        user_can_do(\"permissions-effect-create\") &&\n        user_can_do(\"permissions-sidebar-tools\"),\n      activeTool: \"select-effect\",\n      tools: [selectTool, playTool, database, viewer],\n    });\n\n    if (!game.settings.get(CONSTANTS.MODULE_NAME, \"showTokenSidebarTools\"))\n      return;\n\n    const bar = controls.find((c) => c.name === \"token\");\n    bar.tools.push(database);\n    bar.tools.push(viewer);\n  });\n\n  debug(\"Sequencer | Registered settings\");\n}\n\nexport async function migrateSettings() {\n  const oldScreenspaceSetting = game.settings.storage\n    .get(\"client\")\n    .getItem(\"sequencer.disable-above-ui-screenspace\");\n  if (oldScreenspaceSetting) {\n    const value = oldScreenspaceSetting === \"true\";\n    game.settings.storage\n      .get(\"client\")\n      .removeItem(\"sequencer.disable-above-ui-screenspace\");\n    await game.settings.set(\n      CONSTANTS.MODULE_NAME,\n      \"enable-above-ui-screenspace\",\n      !value\n    );\n  }\n}\n","import {\n  BaseEffectsLayer,\n  SequencerInterfaceLayer,\n  UIEffectsLayer,\n} from \"./canvas-effects/effects-layer.js\";\nimport { debug } from \"./lib/lib.js\";\n\nexport default function registerLayers() {\n  CONFIG.Canvas.layers = foundry.utils.mergeObject(Canvas.layers, {\n    sequencerEffects: {\n      layerClass: BaseEffectsLayer,\n      group: \"primary\",\n    },\n    sequencerInterfaceLayer: {\n      layerClass: SequencerInterfaceLayer,\n      group: \"interface\",\n    },\n    sequencerEffectsUILayer: {\n      layerClass: UIEffectsLayer,\n      group: \"interface\",\n    },\n  });\n\n  if (!Object.is(Canvas.layers, CONFIG.Canvas.layers)) {\n    const layers = Canvas.layers;\n    Object.defineProperty(Canvas, \"layers\", {\n      get: function () {\n        return foundry.utils.mergeObject(layers, CONFIG.Canvas.layers);\n      },\n    });\n  }\n\n  debug(\"Registered Layers\");\n}\n","import CONSTANTS from \"./constants.js\";\nimport {\n  EffectPlayer,\n  SelectionManager,\n} from \"./modules/sequencer-interaction-manager.js\";\nimport { PlayerSettings } from \"./formapplications/effects-ui/effect-player-store.js\";\n\nconst hotkeys = {\n  get _ready() {\n    return canvas.ready && canvas.sequencerInterfaceLayer.active;\n  },\n\n  playTool: {\n    playManySequencedDown: () => {\n      if (!hotkeys._ready) return;\n      EffectPlayer.playManySequenced = true;\n    },\n    playManySequencedUp: () => {\n      if (!hotkeys._ready) return;\n      EffectPlayer.playManySequenced = false;\n      if (!EffectPlayer.isActive) return;\n      EffectPlayer.playManyUp();\n    },\n    playManyDown: () => {\n      if (!hotkeys._ready) return;\n      EffectPlayer.playMany = true;\n    },\n    playManyUp: () => {\n      if (!hotkeys._ready) return;\n      EffectPlayer.playMany = false;\n      if (!EffectPlayer.isActive) return;\n      EffectPlayer.playManyUp();\n    },\n    attachToDown: () => {\n      if (!hotkeys._ready) return;\n      PlayerSettings.attachTo.store.set(true);\n      PlayerSettings.stretchToAttach.store.set(true);\n    },\n    attachToUp: () => {\n      if (!hotkeys._ready) return;\n      PlayerSettings.attachTo.store.set(false);\n      PlayerSettings.stretchToAttach.store.set(false);\n    },\n  },\n\n  selectTool: {\n    snapToGridDown: () => {\n      if (!hotkeys._ready) return;\n      SelectionManager.snapToGrid = true;\n    },\n    snapToGridUp: () => {\n      if (!hotkeys._ready) return;\n      SelectionManager.snapToGrid = false;\n    },\n    attachToTargetDown: () => {\n      if (!hotkeys._ready) return;\n      if (!SelectionManager.isActive) return;\n      PlayerSettings.attachTo.store.set(true);\n      PlayerSettings.stretchToAttach.store.set(true);\n    },\n    attachToTargetUp: () => {\n      if (!hotkeys._ready) return;\n      PlayerSettings.attachTo.store.set(false);\n      PlayerSettings.stretchToAttach.store.set(false);\n    },\n    deleteDown: () => {\n      if (!hotkeys._ready) return;\n      SelectionManager.delete();\n    },\n  },\n};\n\nexport default function registerHotkeys() {\n  game.keybindings.register(CONSTANTS.MODULE_NAME, \"play-tool-hotkey-control\", {\n    name: \"SEQUENCER.Hotkeys.PlayTool.Control\",\n    editable: [{ key: \"ControlLeft\" }],\n    onDown: hotkeys.playTool.playManySequencedDown,\n    onUp: hotkeys.playTool.playManySequencedUp,\n  });\n\n  game.keybindings.register(CONSTANTS.MODULE_NAME, \"play-tool-hotkey-shift\", {\n    name: \"SEQUENCER.Hotkeys.PlayTool.Shift\",\n    editable: [{ key: \"ShiftLeft\" }],\n    onDown: hotkeys.playTool.playManyDown,\n    onUp: hotkeys.playTool.playManyUp,\n  });\n\n  game.keybindings.register(CONSTANTS.MODULE_NAME, \"play-tool-hotkey-alt\", {\n    name: \"SEQUENCER.Hotkeys.PlayTool.Alt\",\n    editable: [{ key: \"AltLeft\" }],\n    onDown: hotkeys.playTool.attachToDown,\n    onUp: hotkeys.playTool.attachToDown,\n  });\n\n  game.keybindings.register(\n    CONSTANTS.MODULE_NAME,\n    \"select-tool-hotkey-control\",\n    {\n      name: \"SEQUENCER.Hotkeys.SelectTool.Control\",\n      editable: [{ key: \"ControlLeft\" }],\n      onDown: hotkeys.selectTool.snapToGridDown,\n      onUp: hotkeys.selectTool.snapToGridUp,\n    }\n  );\n\n  game.keybindings.register(CONSTANTS.MODULE_NAME, \"select-tool-hotkey-alt\", {\n    name: \"SEQUENCER.Hotkeys.SelectTool.Alt\",\n    editable: [{ key: \"AltLeft\" }],\n    onDown: hotkeys.selectTool.attachToTargetDown,\n    onUp: hotkeys.selectTool.attachToTargetUp,\n  });\n\n  game.keybindings.register(\n    CONSTANTS.MODULE_NAME,\n    \"select-tool-hotkey-delete\",\n    {\n      name: \"SEQUENCER.Hotkeys.SelectTool.Delete\",\n      editable: [{ key: \"Delete\" }],\n      onDown: hotkeys.selectTool.deleteDown,\n    }\n  );\n}\n","export default async function registerTypes(register) {\n  fetch(\"modules/sequencer/typings/types.d.ts\")\n    .then((response) => response.text())\n    .then((content) => register(\"sequencer/types.d.ts\", content));\n}\n","import { custom_error, debug, is_function } from \"../lib/lib.js\";\n\nconst presetMap = new Map();\n\nexport default class SequencerPresets {\n  /**\n   * Adds a preset that can then be used in sequences\n   *\n   * @param {string} inName\n   * @param {Function} inFunction\n   * @param {boolean} [overwrite=false] overwrite\n   * @returns {Map<string, Function>}\n   */\n  static add(inName, inFunction, overwrite = false) {\n    if (typeof inName !== \"string\") {\n      throw custom_error(\n        \"Sequencer\",\n        `SequencerPresets | inName must be of type string`\n      );\n    }\n\n    if (!is_function(inFunction)) {\n      throw custom_error(\n        \"Sequencer\",\n        `SequencerPresets | inFunction must be of type function`\n      );\n    }\n\n    if (presetMap.get(inName) && !overwrite) {\n      throw custom_error(\n        \"Sequencer\",\n        `SequencerPresets | Preset \"${inName}\" already exists`\n      );\n    }\n\n    presetMap.set(inName, inFunction);\n    debug(`Sequencer | Presets | Added \"${inName}\" preset`);\n    return presetMap;\n  }\n\n  /**\n   * Retrieves all presets\n   *\n   * @returns {Map<string, Function>}\n   */\n  static getAll() {\n    return presetMap;\n  }\n\n  /**\n   * Retrieves preset based on its name\n   *\n   * @param {string} name\n   * @returns {Function}\n   */\n  static get(name) {\n    return presetMap.get(name);\n  }\n}\n","import * as lib from \"../lib/lib.js\";\nimport SequencerPresets from \"../modules/sequencer-presets.js\";\nimport CONSTANTS from \"../constants.js\";\nimport { get, writable } from \"svelte/store\";\n\nexport default class Section {\n  constructor(inSequence) {\n    this.sequence = inSequence;\n    this._applyTraits();\n    this._sectionStatus = writable(CONSTANTS.STATUS.READY);\n    this._playIf = true;\n    this._waitUntilFinished = false;\n    this._async = false;\n    this._waitUntilFinishedDelay = [0, 0];\n    this._repetitions = 1;\n    this._currentRepetition = 0;\n    this._repeatDelayMin = 0;\n    this._repeatDelayMax = 0;\n    this._repeatDelay = 0;\n    this._delayMin = 0;\n    this._delayMax = 0;\n    this._basicDelay = 0;\n    this._duration = false;\n  }\n\n  static niceName = \"Section\";\n\n  /**\n   * @protected\n   */\n  get _shouldAsync() {\n    return this._async || this._waitAnyway;\n  }\n\n  /**\n   * @protected\n   */\n  get shouldWaitUntilFinished() {\n    return this._waitUntilFinished || this._waitAnyway;\n  }\n\n  /**\n   * @protected\n   */\n  get _waitAnyway() {\n    return (\n      ((this._async || this._waitUntilFinished) && this._isLastRepetition) ||\n      (this._isLastRepetition && this._isLastSection)\n    );\n  }\n\n  /**\n   * @protected\n   */\n  get _isLastSection() {\n    return (\n      this.sequence.sections.length - 1 === this.sequence.sections.indexOf(this)\n    );\n  }\n\n  /** ------------------------------------------------------------------------------------------------------------------------------ *\n   * Methods below this point should NOT be overridden by child instances of the class, they are integral to the sequence functioning\n   * ------------------------------------------------------------------------------------------------------------------------------- */\n\n  /**\n   * @protected\n   */\n  get _isLastRepetition() {\n    return (\n      this._repetitions === 1 ||\n      this._repetitions === this._currentRepetition + 1\n    );\n  }\n\n  /**\n   * @protected\n   */\n  get _currentWaitTime() {\n    let waitUntilFinishedDelay = this._waitAnyway\n      ? lib.random_int_between(...this._waitUntilFinishedDelay)\n      : 0;\n    return waitUntilFinishedDelay + this._repeatDelay;\n  }\n\n  /**\n   * Method overwritten by inheriting classes, which is called just before the \"run\" method is called (see below)\n   *\n   * @returns {Promise<void>}\n   * @protected\n   */\n  async preRun() {}\n\n  /**\n   * Method overwritten by inheriting classes, which is called when this section is executed by the Sequence\n   *\n   * @returns {Promise<void>}\n   * @protected\n   */\n  async run() {}\n\n  /**\n   * Method overwritten by inheriting classes, which is called when this section is serialized by the Sequence\n   *\n   * @returns {object}\n   * @private\n   */\n  async _serialize() {\n    return {\n      async: this._async,\n      delay: [this._delayMin, this._delayMax],\n      waitUntilFinished: this._waitUntilFinished,\n      waitUntilFinishedDelay: this._waitUntilFinishedDelay,\n      repetitions: this._repetitions,\n      repetitionsDelay: [this._repeatDelayMin, this._repeatDelayMax],\n    };\n  }\n\n  _deserialize(data) {\n    this._async = data.async;\n    this._waitUntilFinished = data.waitUntilFinished;\n    this._waitUntilFinishedDelay = data.waitUntilFinishedDelay;\n    this._repetitions = data.repetitions;\n    this._repeatDelayMin = data.repetitionsDelay[0];\n    this._repeatDelayMax = data.repetitionsDelay[1];\n    return this;\n  }\n\n  /**\n   * Method overwritten by inheriting classes, which stores data or prepares data before the Sequence executes it (see EffectsSection)\n   *\n   * @protected\n   */\n  async _initialize() {}\n\n  /**\n   * Method overwritten by inheriting classes. Inheriting classes uses the following to apply traits to themselves:\n   * - Object.assign(this.constructor.prototype, trait)\n   *\n   * @protected\n   */\n  _applyTraits() {}\n\n  /**\n   * Causes the section to be repeated n amount of times, with an optional delay. If given inRepeatDelayMin\n   * and inRepeatDelayMax, a random repetition delay will be picked for every repetition\n   *\n   * @param {number} inRepetitions\n   * @param {number} inRepeatDelayMin\n   * @param {number} inRepeatDelayMax\n   * @returns {Section} this\n   */\n  repeats(inRepetitions, inRepeatDelayMin = 0, inRepeatDelayMax) {\n    if (!lib.is_real_number(inRepetitions))\n      throw this.sequence._customError(\n        this,\n        \"repeats\",\n        \"inRepetitions must be of type number\"\n      );\n    if (!lib.is_real_number(inRepeatDelayMin))\n      throw this.sequence._customError(\n        this,\n        \"repeats\",\n        \"repeatDelayMin must be of type number\"\n      );\n    if (inRepeatDelayMax && !lib.is_real_number(inRepeatDelayMax)) {\n      throw this.sequence._customError(\n        this,\n        \"repeats\",\n        \"repeatDelayMax must be of type number\"\n      );\n    }\n    this._repetitions = inRepetitions;\n    this._repeatDelayMin = Math.min(\n      inRepeatDelayMin,\n      inRepeatDelayMax ?? inRepeatDelayMin\n    );\n    this._repeatDelayMax = Math.max(\n      inRepeatDelayMin,\n      inRepeatDelayMax ?? inRepeatDelayMin\n    );\n    return this;\n  }\n\n  /**\n   * Causes the effect or sound to not play, and skip all delays, repetitions, waits, etc. If you pass a function,\n   * the function should return something false-y if you do not want the effect or sound to play.\n   *\n   * @param {boolean|function} inCondition\n   * @returns {Section} this\n   */\n  playIf(inCondition) {\n    this._playIf = inCondition;\n    return this;\n  }\n\n  /**\n   * Causes the section to finish running before starting the next section.\n   *\n   * @param {number|boolean} [minDelay=0] minDelay\n   * @param {number/null} [maxDelay=null] maxDelay\n   * @returns {Section} this\n   */\n  waitUntilFinished(minDelay = 0, maxDelay = null) {\n    if (minDelay === false) return this;\n    if (!lib.is_real_number(minDelay))\n      throw this.sequence._customError(\n        this,\n        \"waitUntilFinished\",\n        \"minDelay must be of type number\"\n      );\n    if (maxDelay !== null && !lib.is_real_number(maxDelay))\n      throw this.sequence._customError(\n        this,\n        \"waitUntilFinished\",\n        \"maxDelay must be of type number\"\n      );\n    this._waitUntilFinished = true;\n    this._waitUntilFinishedDelay = [\n      Math.min(minDelay, maxDelay ?? minDelay),\n      Math.max(minDelay, maxDelay ?? minDelay),\n    ];\n    return this;\n  }\n\n  /**\n   * Causes each effect or sound to finish playing before the next one starts playing. This differs from\n   * .waitUntilFinished() in the sense that this is for each repetition, whilst .waitUntilFinished() is\n   * for the entire section.\n   *\n   * @returns {Section} this\n   */\n  async() {\n    this._async = true;\n    return this;\n  }\n\n  /**\n   * Delays the effect or sound from being played for a set amount of milliseconds. If given a second number, a\n   * random delay between the two numbers will be generated.\n   *\n   * @param {number} [msMin=1] minMs\n   * @param {number} [msMax=1] maxMs\n   * @returns {Section} this\n   */\n  delay(msMin, msMax) {\n    if (!lib.is_real_number(msMin))\n      throw this.sequence._customError(\n        this,\n        \"delay\",\n        \"msMin must be of type number\"\n      );\n    if (msMax && !lib.is_real_number(msMax))\n      throw this.sequence._customError(\n        this,\n        \"delay\",\n        \"msMax must be of type number\"\n      );\n    this._delayMin = Math.min(msMin, msMax ?? msMin);\n    this._delayMax = Math.max(msMin, msMax ?? msMin);\n    return this;\n  }\n\n  /**\n   * Overrides the duration of this section\n   *\n   * @param {number} inDuration\n   * @returns {Section} this\n   */\n  duration(inDuration) {\n    if (!lib.is_real_number(inDuration))\n      throw this.sequence._customError(\n        this,\n        \"duration\",\n        \"inDuration must be of type number\"\n      );\n    this._duration = inDuration;\n    return this;\n  }\n\n  /**\n   * Applies a preset to the current section\n   *\n   * @param {string} presetName\n   * @param {*} args\n   * @returns {Section|FunctionSection|EffectSection|AnimationSection|SoundSection}\n   */\n  preset(presetName, ...args) {\n    if (typeof presetName !== \"string\") {\n      throw this.sequence._customError(\n        this,\n        \"name\",\n        `inName must be of type string`\n      );\n    }\n    const preset = SequencerPresets.get(presetName);\n    if (!preset) {\n      lib.custom_warning(\n        \"Sequencer\",\n        `preset | Could not find preset with name \"${presetName}\"`\n      );\n      return this;\n    }\n    return preset(this, ...args);\n  }\n\n  /**\n   * @protected\n   */\n  async _shouldPlay() {\n    return lib.is_function(this._playIf) ? await this._playIf() : this._playIf;\n  }\n\n  /**\n   * @protected\n   */\n  _validateLocation(inLocation) {\n    inLocation = lib.validate_document(inLocation);\n    if (typeof inLocation === \"string\") {\n      inLocation = lib.get_object_from_scene(inLocation) ?? inLocation;\n    }\n    if (typeof inLocation === \"string\") {\n      inLocation = lib.safe_str(inLocation);\n    }\n    return inLocation;\n  }\n\n  /**\n   * @protected\n   */\n  async _execute() {\n    if (!(await this._shouldPlay())) {\n      this.sectionStatus = CONSTANTS.STATUS.SKIPPED;\n      return;\n    }\n    this._basicDelay = lib.random_float_between(this._delayMin, this._delayMax);\n    return new Promise(async (resolve) => {\n      setTimeout(async () => {\n        this.sectionStatus = CONSTANTS.STATUS.RUNNING;\n        for (let i = 0; i < this._repetitions; i++) {\n          if (get(this.sectionStatus) === CONSTANTS.STATUS.ABORTED) {\n            resolve();\n            return;\n          }\n          this._currentRepetition = i;\n          this._repeatDelay =\n            i !== this._repetitions - 1\n              ? lib.random_float_between(\n                  this._repeatDelayMin,\n                  this._repeatDelayMax\n                )\n              : 0;\n          await this.preRun();\n          if (this._shouldAsync) {\n            await this.run();\n          } else {\n            this.run();\n          }\n          if (this._repetitions > 1 && i !== this._repetitions - 1) {\n            await this._delayBetweenRepetitions();\n          }\n        }\n        resolve();\n      }, this._basicDelay);\n    }).then(() => {\n      this.sectionStatus = CONSTANTS.STATUS.COMPLETE;\n    });\n  }\n\n  set sectionStatus(inStatus) {\n    this._sectionStatus.update((currentStatus) => {\n      if (\n        currentStatus === CONSTANTS.STATUS.READY ||\n        (currentStatus === CONSTANTS.STATUS.RUNNING &&\n          inStatus !== CONSTANTS.STATUS.ABORTED)\n      ) {\n        return inStatus;\n      }\n      return currentStatus;\n    });\n  }\n\n  get sectionStatus() {\n    return this._sectionStatus;\n  }\n\n  _abortSection() {\n    this.sectionStatus = CONSTANTS.STATUS.ABORTED;\n  }\n\n  /**\n   * @protected\n   */\n  async _delayBetweenRepetitions() {\n    let self = this;\n    return new Promise((resolve) => {\n      setTimeout(resolve, self._repeatDelay);\n    });\n  }\n}\n","import * as lib from \"../lib/lib.js\";\nimport Section from \"./section.js\";\n\nexport default class FunctionSection extends Section {\n  constructor(inSequence, inFunc) {\n    super(inSequence);\n    if (!lib.is_function(inFunc))\n      this._customError(\n        \"create\",\n        \"The given function needs to be an actual function\"\n      );\n    this._func = inFunc;\n    this._waitUntilFinished = inFunc.constructor.name === \"AsyncFunction\";\n  }\n\n  static niceName = \"Function\";\n\n  /**\n   * @returns {Promise<void>}\n   */\n  async run() {\n    lib.debug(\"Running function\");\n    await this._func();\n  }\n\n  /**\n   * @returns {Promise}\n   * @private\n   */\n  async _execute() {\n    await this.run();\n  }\n}\n","import { is_real_number } from \"../../lib/lib.js\";\nimport { validateAnimation } from \"../../lib/canvas-lib.js\";\nimport * as canvaslib from \"../../lib/canvas-lib.js\";\n\nexport default {\n  /**\n   * Base properties\n   */\n  _animations: null,\n\n  /**\n   * Animates a property on the target of the animation.\n   *\n   * @param {string} inTarget\n   * @param {string} inPropertyName\n   * @param {object} inOptions\n   *      @param {Number} inOptions.from       - a single number from which to animate\n   *      @param {Number} inOptions.to         - a single number to which to animate\n   *      @param {Number} inOptions.duration   - how long in ms the animation should take\n   *      @param {Number} inOptions.delay      - inserts a delay in ms before the animation starts\n   *      @param {String} inOptions.ease       - what type of easing the animation should use\n   *      @param {Boolean} inOptions.gridUnits - if animating width or height, this will set it to work in the scene's grid units\n   *      @param {Boolean} inOptions.fromEnd   - makes this animation play from the end, like fadeOut, scaleOut, etc\n   *      @param {Boolean} inOptions.absolute  - makes this animation's values override the current value\n   *\n   * @returns this\n   */\n  animateProperty(inTarget, inPropertyName, inOptions = {}) {\n    if (!this._animations) this._animations = [];\n\n    const result = canvaslib.validateAnimation(\n      inTarget,\n      inPropertyName,\n      inOptions\n    );\n\n    if (typeof result === \"string\") {\n      throw this.sequence._customError(this, \"animateProperty\", result);\n    }\n\n    this._animations.push(result);\n\n    return this;\n  },\n\n  /**\n   * Loops a property between a set of values on the target\n   *\n   * @param {string} inTarget\n   * @param {string} inPropertyName\n   * @param {object} inOptions\n   *      @param {Number} inOptions.from       - a single number from which to loop\n   *      @param {Number} inOptions.to         - a single number to which to loop\n   *      @param {Number} inOptions.values     - an array of values to loop between\n   *      @param {Number} inOptions.duration   - how long in ms the loop should take\n   *      @param {Number} inOptions.loops      - how many loops in total this animation should go through - if none are specified, the loop is indefinite\n   *      @param {Number} inOptions.delay      - inserts a delay in ms before the animation starts\n   *      @param {String} inOptions.ease       - what type of easing the animation should use\n   *      @param {Boolean} inOptions.pingPong  - sets whether loop should interpolate to the first value after it reaches the first value, or simply set it to the first value\n   *      @param {Boolean} inOptions.gridUnits - if animating width or height, this will set it to work in the scene's grid units\n   *      @param {Boolean} inOptions.absolute  - makes this animation's values override the current value\n   *\n   * @returns this\n   */\n  loopProperty(inTarget, inPropertyName, inOptions = {}) {\n    if (!this._animations) this._animations = [];\n\n    const result = canvaslib.validateLoopingAnimation(\n      inTarget,\n      inPropertyName,\n      inOptions\n    );\n\n    if (typeof result === \"string\") {\n      throw this.sequence._customError(this, \"loopProperty\", result);\n    }\n\n    this._animations.push(result);\n\n    return this;\n  },\n};\n","import { is_real_number } from \"../../lib/lib.js\";\n\nexport default {\n  /**\n   * Base properties\n   */\n  _volume: null,\n  _fadeInAudio: null,\n  _fadeOutAudio: null,\n\n  /**\n   * Sets the volume of the sound.\n   *\n   * @param {number} inVolume\n   * @returns this\n   */\n  volume(inVolume) {\n    if (!is_real_number(inVolume))\n      throw this.sequence._customError(\n        this,\n        \"volume\",\n        \"inVolume must be of type number\"\n      );\n    this._volume = Math.max(0, Math.min(1.0, inVolume));\n    return this;\n  },\n\n  /**\n   * Causes the animated section to fade in its audio (if any) when played\n   *\n   * @param {number} duration     How long the fade should be\n   * @param {object} [options]    Additional options, such as easing and delay\n   * @returns this\n   */\n  fadeInAudio(duration, options = {}) {\n    if (typeof options !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"fadeInAudio\",\n        \"options must be of type object\"\n      );\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n      },\n      options\n    );\n    if (!is_real_number(duration))\n      throw this.sequence._customError(\n        this,\n        \"fadeInAudio\",\n        \"duration must be of type number\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"fadeInAudio\",\n        \"options.ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"fadeInAudio\",\n        \"options.delay must be of type number\"\n      );\n    this._fadeInAudio = {\n      duration: duration,\n      ease: options.ease,\n      delay: options.delay,\n    };\n    return this;\n  },\n\n  /**\n   * Causes the audio to fade out at the end of the animated section's duration\n   *\n   * @param {number} duration     How long the fade should be\n   * @param {object} [options]    Additional options, such as easing and delay\n   * @returns this\n   */\n  fadeOutAudio(duration, options = {}) {\n    if (typeof options !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"fadeOutAudio\",\n        \"options must be of type object\"\n      );\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n      },\n      options\n    );\n    if (!is_real_number(duration))\n      throw this.sequence._customError(\n        this,\n        \"fadeOutAudio\",\n        \"duration must be of type number\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"fadeOutAudio\",\n        \"ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"fadeOutAudio\",\n        \"delay must be of type number\"\n      );\n    this._fadeOutAudio = {\n      duration: duration,\n      ease: options.ease,\n      delay: options.delay,\n    };\n    return this;\n  },\n};\n","import * as lib from \"../../lib/lib.js\";\nimport { SequencerFileRangeFind } from \"../../modules/sequencer-file.js\";\n\nexport default {\n  /**\n   * Base properties\n   */\n  _file: \"\",\n  _fileOptions: false,\n  _baseFolder: \"\",\n  _mustache: null,\n\n  /**\n   * Defines the base folder that will prepend to the file path. This is mainly just useful to make the file\n   * path easier to manage.\n   *\n   * @param {string} inBaseFolder\n   * @returns this\n   */\n  baseFolder(inBaseFolder) {\n    if (typeof inBaseFolder !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"baseFolder\",\n        \"inBaseFolder must be of type string\"\n      );\n    this._baseFolder = inBaseFolder + (inBaseFolder.endsWith(\"/\") ? \"\" : \"/\");\n    return this;\n  },\n\n  /**\n   * Sets the Mustache of the filepath. This is applied after the randomization of the filepath, if available.\n   *\n   * @param {object} inMustache\n   * @returns this\n   */\n  setMustache(inMustache) {\n    if (typeof inMustache !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"setMustache\",\n        \"inMustache must be of type object\"\n      );\n    this._mustache = inMustache;\n    return this;\n  },\n\n  async _determineFile(inFile) {\n    if (!Array.isArray(inFile) && typeof inFile === \"object\") {\n      return this._validateCustomRange(inFile);\n    }\n\n    if (Array.isArray(inFile))\n      inFile = lib.random_array_element(inFile, { recurse: true });\n\n    inFile = this._applyMustache(inFile);\n\n    if (Sequencer.Database.entryExists(inFile)) {\n      return this._determineDatabaseFile(inFile);\n    }\n\n    const determinedFile = await this._processFile(inFile);\n\n    return { file: determinedFile, forcedIndex: false, customRange: false };\n  },\n\n  async _processFile(inFile) {\n    inFile = this._applyMustache(inFile);\n    inFile = this._applyBaseFolder(inFile);\n    inFile = await this._applyWildcard(inFile);\n    if (Array.isArray(inFile))\n      inFile = lib.random_array_element(inFile, { recurse: true });\n    return inFile;\n  },\n\n  async _validateCustomRange(inFile) {\n    const finalFiles = {};\n    const validRanges = Object.keys(SequencerFileRangeFind.ftToDistanceMap);\n    for (const [range, rangeFile] of Object.entries(inFile)) {\n      if (!validRanges.includes(range)) {\n        throw this.sequence._customError(\n          this,\n          \"file\",\n          `a file-distance key map must only contain the following keys: ${validRanges.join(\n            \", \"\n          )}`\n        );\n      }\n      finalFiles[range] = await this._processFile(rangeFile);\n    }\n\n    return { file: finalFiles, forcedIndex: false, customRange: true };\n  },\n\n  _determineDatabaseFile(inFile) {\n    const entries = Sequencer.Database.getEntry(inFile);\n    const entry = Array.isArray(entries)\n      ? lib.random_array_element(entries)\n      : entries;\n    const match = inFile.match(/(\\d)+$/);\n    return {\n      file: entry,\n      forcedIndex: match ? Number(match[1]) : false,\n      customRange: false,\n    };\n  },\n\n  _applyBaseFolder(inFile) {\n    if (Array.isArray(inFile))\n      return inFile.map((file) => this._applyBaseFolder(file));\n    return inFile.startsWith(this._baseFolder)\n      ? inFile\n      : this._baseFolder + inFile;\n  },\n\n  _applyMustache(inFile) {\n    if (!this._mustache) return inFile;\n    let template = Handlebars.compile(inFile);\n    return template(this._mustache);\n  },\n\n  async _applyWildcard(inFile) {\n    if (!inFile.includes(\"*\")) return inFile;\n    if (Array.isArray(inFile))\n      return inFile.map(async (file) => await this._applyWildcard(file));\n    inFile = this._applyBaseFolder(inFile);\n    return lib.getFiles(inFile, {\n      applyWildCard: true,\n      softFail: this.sequence.softFail,\n    });\n  },\n};\n","import { is_real_number } from \"../../lib/lib.js\";\nimport * as canvaslib from \"../../lib/canvas-lib.js\";\n\nexport default {\n  /**\n   * Base properties\n   */\n  _moveTowards: null,\n  _moveSpeed: null,\n\n  /**\n   * Sets the location to move the target object to\n   *\n   * @param {object|string} inTarget\n   * @param {object} options\n   * @returns this\n   */\n  moveTowards(inTarget, options = {}) {\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n        rotate: true,\n        cacheLocation: false,\n      },\n      options\n    );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"moveTowards\",\n        \"options.ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"moveTowards\",\n        \"options.delay must be of type number\"\n      );\n    if (typeof options.rotate !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"moveTowards\",\n        \"options.rotate must be of type boolean\"\n      );\n    if (typeof options.cacheLocation !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"moveTowards\",\n        \"options.cacheLocation must be of type boolean\"\n      );\n    options.target = this._validateLocation(inTarget);\n    if (!options.target)\n      throw this.sequence._customError(\n        this,\n        \"moveTowards\",\n        \"could not find position of given object\"\n      );\n    options.target = options.cacheLocation\n      ? canvaslib.get_object_position(options.cacheLocation, { measure: true })\n      : options.target;\n    this._moveTowards = options;\n    return this;\n  },\n\n  /**\n   * Sets the speed (pixels per frame) to move the target object\n   *\n   * @param {number} inSpeed\n   * @returns this\n   */\n  moveSpeed(inSpeed) {\n    if (!is_real_number(inSpeed))\n      throw this.sequence._customError(\n        this,\n        \"moveSpeed\",\n        \"inSpeed must be of type number\"\n      );\n    this._moveSpeed = inSpeed;\n    return this;\n  },\n};\n","import { is_real_number } from \"../../lib/lib.js\";\n\nexport default {\n  /**\n   * Base properties\n   */\n  _opacity: null,\n  _fadeIn: null,\n  _fadeOut: null,\n\n  /**\n   * Sets the opacity of the effect. If used with ._fadeIn() and/or ._fadeOut(), this defines what the effect will fade to/from\n   *\n   * @param {number} inOpacity\n   * @returns this\n   */\n  opacity(inOpacity) {\n    if (!is_real_number(inOpacity))\n      throw this.sequence._customError(\n        this,\n        \"opacity\",\n        \"inOpacity must be of type number\"\n      );\n    this._opacity = inOpacity;\n    return this;\n  },\n\n  /**\n   * Causes the effect to fade in when played\n   *\n   * @param {number} duration     How long the fade should be\n   * @param {object} [options]    Additional options, such as easing and delay\n   * @returns this\n   */\n  fadeIn(duration, options = {}) {\n    if (typeof options !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"fadeIn\",\n        \"options must be of type object\"\n      );\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n      },\n      options\n    );\n    if (!is_real_number(duration))\n      throw this.sequence._customError(\n        this,\n        \"fadeIn\",\n        \"duration must be of type number\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"fadeIn\",\n        \"options.ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"fadeIn\",\n        \"options.delay must be of type number\"\n      );\n    this._fadeIn = {\n      duration: duration,\n      ease: options.ease,\n      delay: options.delay,\n    };\n    return this;\n  },\n\n  /**\n   * Causes the effect to fade out at the end of the effect's duration\n   *\n   * @param {number} duration     How long the fade should be\n   * @param {object} [options]    Additional options, such as easing and delay\n   * @returns this\n   */\n  fadeOut(duration, options = {}) {\n    if (typeof options !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"fadeOut\",\n        \"options must be of type object\"\n      );\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n      },\n      options\n    );\n    if (!is_real_number(duration))\n      throw this.sequence._customError(\n        this,\n        \"fadeOut\",\n        \"duration must be of type number\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"fadeOut\",\n        \"ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"fadeOut\",\n        \"delay must be of type number\"\n      );\n    this._fadeOut = {\n      duration: duration,\n      ease: options.ease,\n      delay: options.delay,\n    };\n    return this;\n  },\n};\n","import { is_real_number } from \"../../lib/lib.js\";\n\nexport default {\n  /**\n   * Base properties\n   */\n  _angle: null,\n  _rotateIn: null,\n  _rotateOut: null,\n  _randomRotation: null,\n  _rotateTowards: null,\n\n  /**\n   * The object gets a random rotation, which means it should not be used with .stretchTo()\n   *\n   * @param {boolean} [inBool=true] inBool\n   * @returns this\n   */\n  randomRotation(inBool = true) {\n    if (typeof inBool !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"randomRotation\",\n        \"inBool must be of type boolean\"\n      );\n    this._randomRotation = inBool;\n    return this;\n  },\n\n  /**\n   * Sets the rotation of the object, which is added on top of the calculated rotation after .rotateTowards() or .randomRotation()\n   *\n   * @param {number} inRotation\n   * @returns this\n   */\n  rotate(inRotation) {\n    if (!is_real_number(inRotation))\n      throw this.sequence._customError(\n        this,\n        \"opacity\",\n        \"inRotation must be of type number\"\n      );\n    this._angle = inRotation;\n    return this;\n  },\n\n  /**\n   *  Causes the object to rotate when it starts playing\n   *\n   * @param {number} degrees\n   * @param {number} duration\n   * @param {object} [options] options\n   * @returns this\n   */\n  rotateIn(degrees, duration, options = {}) {\n    if (typeof options !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"rotateIn\",\n        \"options must be of type object\"\n      );\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n      },\n      options\n    );\n    if (!is_real_number(degrees))\n      throw this.sequence._customError(\n        this,\n        \"rotateOut\",\n        \"degrees must be of type number\"\n      );\n    if (!is_real_number(duration))\n      throw this.sequence._customError(\n        this,\n        \"rotateOut\",\n        \"duration must be of type number\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"rotateIn\",\n        \"options.ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"rotateIn\",\n        \"options.delay must be of type number\"\n      );\n    this._rotateIn = {\n      value: degrees,\n      duration: duration,\n      ease: options.ease,\n      delay: options.delay,\n    };\n    return this;\n  },\n\n  /**\n   *  Causes the object to rotate at the end of the effect's duration\n   *\n   * @param {number} degrees\n   * @param {number} duration\n   * @param {object} [options] options\n   * @returns this\n   */\n  rotateOut(degrees, duration, options = {}) {\n    if (typeof options !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"rotateOut\",\n        \"options must be of type object\"\n      );\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n      },\n      options\n    );\n    if (!is_real_number(degrees))\n      throw this.sequence._customError(\n        this,\n        \"rotateOut\",\n        \"degrees must be of type number\"\n      );\n    if (!is_real_number(duration))\n      throw this.sequence._customError(\n        this,\n        \"rotateOut\",\n        \"duration must be of type number\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"rotateOut\",\n        \"options.ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"rotateOut\",\n        \"options.delay must be of type number\"\n      );\n    this._rotateOut = {\n      value: degrees,\n      duration: duration,\n      ease: options.ease,\n      delay: options.delay,\n    };\n    return this;\n  },\n};\n","import { is_real_number } from \"../../lib/lib.js\";\n\nexport default {\n  _scaleMin: null,\n  _scaleMax: null,\n  _scaleIn: null,\n  _scaleOut: null,\n\n  /**\n   *  A method that can take the following:\n   *  - A number to set the scale uniformly\n   *  - An object with x and y for non-uniform scaling\n   *  - Two numbers which the Sequencer will randomly pick a uniform scale between\n   *\n   * @param {number|object} inScaleMin\n   * @param {number} [inScaleMax] inScaleMax\n   * @returns this\n   */\n  scale(inScaleMin, inScaleMax) {\n    if (!is_real_number(inScaleMin) && typeof inScaleMin !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"scale\",\n        \"inScale must be of type number or object\"\n      );\n    if (is_real_number(inScaleMin)) {\n      if (inScaleMax && !is_real_number(inScaleMax)) {\n        throw this.sequence._customError(\n          this,\n          \"scale\",\n          \"if inScaleMin is a number, inScaleMax must also be of type number\"\n        );\n      }\n    }\n    this._scaleMin = inScaleMin;\n    this._scaleMax = inScaleMax ?? false;\n    return this;\n  },\n\n  /**\n   *  Causes the effect to scale when it starts playing\n   *\n   * @param {number|object} scale\n   * @param {number} duration\n   * @param {object} [options] options\n   * @returns this\n   */\n  scaleIn(scale, duration, options = {}) {\n    if (typeof options !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"scaleIn\",\n        \"options must be of type object\"\n      );\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n      },\n      options\n    );\n    if (!is_real_number(duration))\n      throw this.sequence._customError(\n        this,\n        \"scaleIn\",\n        \"duration must be of type number\"\n      );\n    if (!is_real_number(scale) && typeof scale !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"scaleIn\",\n        \"scale must be of type number or object\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"scaleIn\",\n        \"options.ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"scaleIn\",\n        \"options.delay must be of type number\"\n      );\n    this._scaleIn = {\n      value: scale,\n      duration: duration,\n      ease: options.ease,\n      delay: options.delay,\n    };\n    return this;\n  },\n\n  /**\n   *  Causes the effect to scale at the end of the effect's duration\n   *\n   * @param {number|object} scale\n   * @param {number} duration\n   * @param {object} [options] options\n   * @returns this\n   */\n  scaleOut(scale, duration, options = {}) {\n    if (typeof options !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"scaleOut\",\n        \"options must be of type object\"\n      );\n    options = foundry.utils.mergeObject(\n      {\n        ease: \"linear\",\n        delay: 0,\n      },\n      options\n    );\n    if (!is_real_number(duration))\n      throw this.sequence._customError(\n        this,\n        \"scaleOut\",\n        \"duration must be of type number\"\n      );\n    if (!is_real_number(scale) && typeof scale !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"scaleOut\",\n        \"scale must be of type number or object\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"scaleOut\",\n        \"options.ease must be of type string\"\n      );\n    if (!is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"scaleOut\",\n        \"options.delay must be of type number\"\n      );\n    this._scaleOut = {\n      value: scale,\n      duration: duration,\n      ease: options.ease,\n      delay: options.delay,\n    };\n    return this;\n  },\n};\n","import { is_real_number } from \"../../lib/lib.js\";\n\nexport default {\n  _hasTime: true,\n  _isRange: false,\n  _startTime: null,\n  _startPerc: null,\n  _endTime: null,\n  _endPerc: null,\n\n  /**\n   * Sets the start and end time of the section, playing only that range\n   *\n   * @param {number} inMsStart\n   * @param {number} inMsEnd\n   * @returns this\n   */\n  timeRange(inMsStart, inMsEnd) {\n    if (!is_real_number(inMsStart))\n      throw this.sequence._customError(\n        this,\n        \"timeRange\",\n        \"inMsStart must be of type number\"\n      );\n    if (!is_real_number(inMsEnd))\n      throw this.sequence._customError(\n        this,\n        \"timeRange\",\n        \"inMsEnd must be of type number\"\n      );\n    this._startTime = inMsStart;\n    this._endTime = inMsEnd;\n    this._isRange = true;\n    return this;\n  },\n\n  /**\n   * Sets the start time of the section.\n   *\n   * @param {number} inMs\n   * @returns this\n   */\n  startTime(inMs) {\n    if (!is_real_number(inMs))\n      throw this.sequence._customError(\n        this,\n        \"startTime\",\n        \"inMs must be of type number\"\n      );\n    this._startTime = inMs;\n    this._startPerc = false;\n    this._isRange = false;\n    return this;\n  },\n\n  /**\n   * Sets the start time of the section based on a percentage from its total duration.\n   *\n   * @param {number} inPercentage\n   * @returns this\n   */\n  startTimePerc(inPercentage) {\n    if (!is_real_number(inPercentage))\n      throw this.sequence._customError(\n        this,\n        \"startTimePerc\",\n        \"inPercentage must be of type number\"\n      );\n    this._startTime = inPercentage;\n    this._startPerc = true;\n    this._isRange = false;\n    return this;\n  },\n\n  /**\n   * Sets the ending time of the section (from the end).\n   *\n   * @param {number} inMs\n   * @returns this\n   */\n  endTime(inMs) {\n    if (!is_real_number(inMs))\n      throw this.sequence._customError(\n        this,\n        \"endTime\",\n        \"inMs must be of type number\"\n      );\n    this._endTime = inMs;\n    this._endPerc = false;\n    this._isRange = false;\n    return this;\n  },\n\n  /**\n   * Sets the ending time of the section based on a percentage from the total duration.\n   *\n   * @param {number} inPercentage\n   * @returns this\n   */\n  endTimePerc(inPercentage) {\n    if (!is_real_number(inPercentage))\n      throw this.sequence._customError(\n        this,\n        \"endTimePerc\",\n        \"inPercentage must be of type number\"\n      );\n    this._endTime = inPercentage;\n    this._endPerc = true;\n    this._isRange = false;\n    return this;\n  },\n};\n","export default {\n  _users: null,\n\n  _addUser(inUser) {\n    if (!this._users) this._users = [];\n    if (typeof inUser !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"_addUser\",\n        \"inUser must be of type string\"\n      );\n    if (!game.users.has(inUser)) {\n      if (game.users.getName(inUser)) {\n        inUser = game.users.getName(inUser).id;\n      } else {\n        throw this.sequence._customError(\n          this,\n          \"_addUser\",\n          `user with id or name \"${inUser}\" does not exist!`\n        );\n      }\n    }\n\n    if (!this._users.includes(inUser)) this._users.push(inUser);\n  },\n\n  _deleteUser(inUser) {\n    if (!this._users) this._users = [];\n    if (this._users.includes(inUser)) {\n      let index = this._users.indexOf(inUser);\n      this._users.splice(index, 1);\n    }\n  },\n\n  /**\n   * Causes section to be executed only locally, and not push to other connected clients.\n   *\n   * @param {boolean} inLocally\n   * @returns this\n   */\n  locally(inLocally = true) {\n    if (inLocally) this._addUser(game.userId);\n    else this._deleteUser(game.userId);\n    return this;\n  },\n\n  /**\n   * Causes the section to be executed for only a set of users.\n   *\n   * @param {string|User|array<string|User>} inUsers\n   * @returns this\n   */\n  forUsers(inUsers) {\n    if (!Array.isArray(inUsers)) {\n      if (typeof inUsers !== \"string\")\n        throw this.sequence._customError(\n          this,\n          \"forUsers\",\n          \"inUser must be of type string\"\n        );\n      inUsers = [inUsers];\n    }\n    inUsers.forEach((u) => this._addUser(u));\n    return this;\n  },\n};\n","import filters from \"../../lib/filters.js\";\n\nexport default {\n  _filters: null,\n\n  _addFilter(inFilterName, inData, inName = false) {\n    if (!this._filters) this._filters = [];\n    this._filters.push({\n      className: inFilterName,\n      name: inName,\n      data: inData,\n    });\n  },\n\n  _testFilter(inFilterName, inData) {\n    let filter = new filters[inFilterName](inData);\n    if (!filter.isValid)\n      throw this.sequence._customError(\n        this,\n        \"filter\",\n        `Could not create ${inFilterName} filter - data is malformed!`\n      );\n  },\n\n  filter(inFilterName, inData = {}, inName = \"\") {\n    if (typeof inFilterName !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"filter\",\n        `inFilterName must be of type string`\n      );\n    if (!Object.keys(filters).includes(inFilterName))\n      throw this.sequence._customError(\n        this,\n        \"filter\",\n        `\"${inFilterName}\" does not exist`\n      );\n    this._testFilter(inFilterName, inData);\n    this._addFilter(inFilterName, inData, inName);\n    return this;\n  },\n};\n","import * as lib from \"../../lib/lib.js\";\nimport { is_real_number } from \"../../lib/lib.js\";\n\nexport default {\n  _tint: null,\n\n  /**\n   * Tints the target of this section by the color given to the\n   *\n   * @param {number|string} inColor\n   * @returns this\n   */\n  tint(inColor) {\n    if (!is_real_number(inColor) && typeof inColor !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"tint\",\n        `inColor must be of type string (hexadecimal) or number (decimal)!`\n      );\n    this._tint = lib.parseColor(inColor);\n    return this;\n  },\n};\n","import * as lib from \"../../lib/lib.js\";\nimport * as canvaslib from \"../../lib/canvas-lib.js\";\n\nexport default {\n  /**\n   * Base properties\n   */\n  _source: null,\n\t_offset: null,\n\t_randomOffset: null,\n\n  /**\n   *  A smart method that can take a reference to an object, or a direct on the canvas to play the effect at,\n   *  or a string reference (see .name())\n   *\n   * @param {Object|String} inLocation\n   * @param {Object} inOptions\n   * @returns {EffectSection}\n   */\n  atLocation(inLocation, inOptions = {}) {\n    if (!inLocation || !(typeof inLocation === \"object\" || typeof inLocation === \"string\")) {\n      throw this.sequence._customError(\n        this,\n        \"atLocation\",\n        `inLocation is invalid, and must be of type of object, string, placeable object, or document`\n      );\n    }\n    if (typeof inOptions !== \"object\")\n      throw this.sequence._customError(\n        this,\n        \"atLocation\",\n        `inOptions must be of type object`\n      );\n    inOptions = foundry.utils.mergeObject(\n      {\n        cacheLocation: false,\n        offset: false,\n        randomOffset: false,\n        gridUnits: false,\n        local: false,\n      },\n      inOptions\n    );\n    inLocation = this._validateLocation(inLocation);\n    if (inLocation === undefined)\n      throw this.sequence._customError(\n        this,\n        \"atLocation\",\n        \"could not find position of given object\"\n      );\n    if (typeof inOptions.cacheLocation !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"atLocation\",\n        \"inOptions.cacheLocation must be of type boolean\"\n      );\n    if (\n      !(\n        typeof inOptions.randomOffset === \"boolean\" ||\n        lib.is_real_number(inOptions.randomOffset)\n      )\n    )\n      throw this.sequence._customError(\n        this,\n        \"atLocation\",\n        \"inOptions.randomOffset must be of type boolean or number\"\n      );\n\n    if (inOptions.offset) {\n      const offsetData = this._validateOffset(\n        \"atLocation\",\n        inOptions.offset,\n        inOptions\n      );\n      this._offset = {\n        source: offsetData,\n        target: this._offset?.target ?? false,\n      };\n    }\n\n    this._randomOffset = {\n      source: inOptions.randomOffset,\n      target: this._randomOffset?.target ?? false,\n    };\n\n    this._source =\n      inOptions.cacheLocation && typeof inLocation !== \"string\"\n        ? canvaslib.get_object_canvas_data(inLocation)\n        : inLocation;\n    return this;\n  },\n};\n","import * as lib from \"../../lib/lib.js\";\n\nexport default {\n  _offset: null,\n  _randomOffset: null,\n\n  _validateOffset(functionName, inOffset, inOptions = {}) {\n    inOffset = foundry.utils.mergeObject(\n      {\n        x: 0,\n        y: 0,\n      },\n      inOffset\n    );\n    inOptions = foundry.utils.mergeObject(\n      {\n        gridUnits: false,\n        local: false,\n      },\n      inOptions\n    );\n    if (typeof inOptions.gridUnits !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        functionName,\n        \"inOptions.gridUnits must be of type boolean\"\n      );\n    if (typeof inOptions.local !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        functionName,\n        \"inOptions.local must be of type boolean\"\n      );\n    if (!lib.is_real_number(inOffset.x))\n      throw this.sequence._customError(\n        this,\n        functionName,\n        `inOffset.x must be of type number!`\n      );\n    if (!lib.is_real_number(inOffset.y))\n      throw this.sequence._customError(\n        this,\n        functionName,\n        `inOffset.y must be of type number!`\n      );\n    return {\n      ...inOffset,\n      ...inOptions,\n    };\n  },\n};\n","export default {\n  _text: null,\n\n  /**\n   *  Creates a text element, attached to the sprite. The options for the text are available here:\n   *  https://pixijs.io/pixi-text-style/\n   *\n   * @param {String} inText\n   * @param {Object} inOptions\n   * @returns {EffectSection}\n   */\n  text(inText, inOptions = {}) {\n    if (typeof inText !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"text\",\n        \"inText must be of type string\"\n      );\n    this._text = foundry.utils.mergeObject(\n      {\n        text: inText,\n      },\n      inOptions\n    );\n    return this;\n  },\n};\n","import * as lib from \"../../lib/lib.js\";\r\n\r\nexport default {\r\n\r\n  _name: null,\r\n  _origin: null,\r\n\r\n  /**\r\n   * Causes the effect or sound to be named, which affects them differently. In the case of effects, names can be used\r\n   * in the place of \r\n   *\r\n   * @param {String} inName\r\n   * @returns {EffectSection}\r\n   */\r\n  name(inName) {\r\n    if (typeof inName !== \"string\")\r\n      throw this.sequence._customError(\r\n        this,\r\n        \"name\",\r\n        \"inName must be of type string\"\r\n      );\r\n    this._name = lib.safe_str(inName);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   *  This is for adding extra information to an sound, like the origin of the sound in the form of the item's uuid.\r\n   *  The method accepts a string or a Document that has an UUID.\r\n   *\r\n   * @param {string|document} inOrigin\r\n   * @returns {Section}\r\n   */\r\n  origin(inOrigin) {\r\n    inOrigin = lib.validate_document(inOrigin);\r\n    if (inOrigin instanceof foundry.abstract.Document) {\r\n      inOrigin = inOrigin?.uuid;\r\n      if (!inOrigin)\r\n        throw this.sequence._customError(\r\n          this,\r\n          \"origin\",\r\n          \"could not find the UUID for the given Document\"\r\n        );\r\n    }\r\n    if (typeof inOrigin !== \"string\")\r\n      throw this.sequence._customError(\r\n        this,\r\n        \"origin\",\r\n        \"inOrigin must be of type string\"\r\n      );\r\n    this._origin = inOrigin;\r\n    return this;\r\n  }\r\n\r\n}\r\n","import animation from \"./animation.js\";\nimport audio from \"./audio.js\";\nimport files from \"./files.js\";\nimport moves from \"./moves.js\";\nimport opacity from \"./opacity.js\";\nimport rotation from \"./rotation.js\";\nimport scale from \"./scale.js\";\nimport time from \"./time.js\";\nimport users from \"./users.js\";\nimport filter from \"./filter.js\";\nimport tint from \"./tint.js\";\nimport location from \"./location.js\";\nimport offset from \"./offset.js\";\nimport text from \"./text.js\";\nimport name from \"./name.js\";\n\nexport default {\n  animation,\n  audio,\n  files,\n  moves,\n  opacity,\n  rotation,\n  scale,\n  time,\n  users,\n  filter,\n  tint,\n  location,\n  offset,\n  text,\n  name\n};\n","import * as lib from \"../lib/lib.js\";\nimport { is_real_number } from \"../lib/lib.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport Section from \"./section.js\";\nimport traits from \"./traits/_traits.js\";\nimport CanvasEffect from \"../canvas-effects/canvas-effect.js\";\nimport flagManager from \"../utils/flag-manager.js\";\nimport SequencerFileCache from \"../modules/sequencer-file-cache.js\";\nimport CONSTANTS from \"../constants.js\";\n\nexport default class EffectSection extends Section {\n\tconstructor(inSequence, inFile = \"\") {\n\t\tsuper(inSequence);\n\t\tthis._deserializedData = null;\n\t\tthis._file = inFile;\n\t\tthis._text = null;\n\t\tthis._source = null;\n\t\tthis._stretchTo = null;\n\t\tthis._attachTo = null;\n\t\tthis._from = null;\n\t\tthis._anchor = null;\n\t\tthis._spriteAnchor = null;\n\t\tthis._randomOffset = null;\n\t\tthis._missed = null;\n\t\tthis._private = null;\n\t\tthis._randomMirrorX = null;\n\t\tthis._randomMirrorY = null;\n\t\tthis._mirrorX = null;\n\t\tthis._mirrorY = null;\n\t\tthis._playbackRate = null;\n\t\tthis._template = null;\n\t\tthis._overrides = [];\n\t\tthis._zIndex = null;\n\t\tthis._offset = null;\n\t\tthis._spriteOffset = null;\n\t\tthis._size = null;\n\t\tthis._syncGroup = null;\n\t\tthis._persist = null;\n\t\tthis._persistOptions = null;\n\t\tthis._zeroSpriteRotation = null;\n\t\tthis._extraEndDuration = null;\n\t\tthis._loopOptions = null;\n\t\tthis._tilingTexture = null;\n\t\tthis._snapToGrid = null;\n\t\tthis._scaleToObject = null;\n\t\tthis._screenSpace = null;\n\t\tthis._screenSpaceAboveUI = null;\n\t\tthis._screenSpaceAnchor = null;\n\t\tthis._screenSpacePosition = null;\n\t\tthis._screenSpaceScale = null;\n\t\tthis._elevation = null;\n\t\tthis._sortLayer = 800;\n\t\tthis._masks = [];\n\t\tthis._tiedDocuments = [];\n\t\tthis._selfMask = false;\n\t\tthis._temporaryEffect = false;\n\t\tthis._spriteRotation = 0;\n\t\tthis._randomSpriteRotation = false;\n\t\tthis._isRangedEffect = null;\n\t\tthis._offsetLegacy = null;\n\t\tthis._randomOffsetLegacy = null;\n\t\tthis._aboveLighting = null;\n\t\tthis._aboveInterface = null;\n\t\tthis._spriteScaleMin = 1.0;\n\t\tthis._spriteScaleMax = null;\n\t\tthis._isometric = null;\n\t\tthis._shapes = [];\n\t\tthis._xray = null;\n\t\tthis._playEffect = true;\n\t}\n\n\tstatic niceName = \"Effect\";\n\n\t/**\n\t * @private\n\t */\n\tget _target() {\n\t\treturn this._stretchTo || this._rotateTowards || this._moveTowards || false;\n\t}\n\n\tstatic debounceWarning() {\n\t\tlib.custom_warning(\n\t\t\t\"Sequencer\",\n\t\t\t\"Effect | This user does not have permissions to play effects. This can be configured in Sequencer's module settings.\"\n\t\t);\n\t}\n\n\t/**\n\t * Causes the effect to persist indefinitely on the canvas until _ended via SequencerEffectManager.endAllEffects() or\n\t * name the effect with .name() and then end it through SequencerEffectManager.endEffect()\n\t *\n\t * @param {Boolean} [inBool=true] inBool\n\t * @param {Object} [inOptions={}] inOptions\n\t * @returns {EffectSection}\n\t */\n\tpersist(inBool = true, inOptions = {}) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"persist\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"persist\",\n\t\t\t\t`inOptions must be of type object`\n\t\t\t);\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tid: foundry.utils.randomID(),\n\t\t\t\tpersistTokenPrototype: false\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\t\tif (typeof inOptions.persistTokenPrototype !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"persist\",\n\t\t\t\t\"inOptions.persistTokenPrototype must be of type boolean\"\n\t\t\t);\n\t\tthis._persist = inBool;\n\t\tthis._persistOptions = inOptions;\n\t\treturn this;\n\t}\n\n\tsyncGroup(inString) {\n\t\tif (typeof inString !== \"string\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"syncGroup\",\n\t\t\t\t\"inString must be of type string\"\n\t\t\t);\n\t\tthis._syncGroup = inString;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to become temporary, which means it will not be stored in the flags of any object,\n\t * even if it .persist() is called\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\ttemporary(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"temporary\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._temporaryEffect = inBool || this._temporaryEffect;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the effect's playback rate. A playback rate of 2.0 would make it play 2x as fast, 0.5 would make\n\t * it play half as fast.\n\t *\n\t * @param {Number} inNumber\n\t * @returns {EffectSection}\n\t */\n\tplaybackRate(inNumber = 1.0) {\n\t\tif (!lib.is_real_number(inNumber))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"playbackRate\",\n\t\t\t\t\"inNumber must be of type number\"\n\t\t\t);\n\t\tthis._playbackRate = inNumber;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to target a location close to the .stretchTowards() location, but not on it.\n\t *\n\t * @param {Boolean} [inBool=true] inBool\n\t * @returns {EffectSection}\n\t */\n\tmissed(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"missed\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._missed = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a function that will run at the end of the effect serialization step, but before it is played. Allows direct\n\t * modifications of effect's data. For example, it could be manipulated to change which file will be used based\n\t * on the distance to the target.\n\t *\n\t * @param {Function} inFunc\n\t * @returns {EffectSection}\n\t */\n\taddOverride(inFunc) {\n\t\tif (!lib.is_function(inFunc))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"addOverride\",\n\t\t\t\t\"The given function needs to be an actual function.\"\n\t\t\t);\n\t\tthis._overrides.push(inFunc);\n\t\treturn this;\n\t}\n\n\t/**\n\t *  A smart method that can take a reference to an object, or a direct on the canvas to attach an effect to,\n\t *  or a string reference (see .name())\n\t *\n\t * @param {Object|String} inObject\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tattachTo(inObject, inOptions = {}) {\n\t\tif (!inObject || !(typeof inObject === \"object\" || typeof inObject === \"string\")) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t`inObject is invalid, and must be of type of object, string, placeable object, or document`\n\t\t\t);\n\t\t}\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t`inOptions must be of type object`\n\t\t\t);\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\talign: \"center\",\n\t\t\t\tedge: \"on\",\n\t\t\t\tbindVisibility: true,\n\t\t\t\tbindAlpha: true,\n\t\t\t\tbindElevation: true,\n\t\t\t\tbindScale: true,\n\t\t\t\tbindRotation: true,\n\t\t\t\toffset: false,\n\t\t\t\trandomOffset: false,\n\t\t\t\tgridUnits: false,\n\t\t\t\tlocal: false,\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\n\t\tconst validatedObject = this._validateLocation(inObject);\n\t\tif (validatedObject === undefined)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t\"could not find given object\"\n\t\t\t);\n\n\t\tlet isValidObject = true;\n\t\tif (typeof inObject === \"string\") {\n\t\t\tisValidObject =\n\t\t\t\tvalidatedObject instanceof Token ||\n\t\t\t\tvalidatedObject instanceof TokenDocument ||\n\t\t\t\tvalidatedObject instanceof Tile ||\n\t\t\t\tvalidatedObject instanceof TileDocument ||\n\t\t\t\tvalidatedObject instanceof Drawing ||\n\t\t\t\tvalidatedObject instanceof DrawingDocument ||\n\t\t\t\tvalidatedObject instanceof MeasuredTemplate ||\n\t\t\t\tvalidatedObject instanceof MeasuredTemplateDocument ||\n\t\t\t\tvalidatedObject instanceof CanvasEffect;\n\t\t\tif (!isValidObject) {\n\t\t\t\tthis.sequence._showWarning(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"attachTo\",\n\t\t\t\t\t\"Only Tokens, Tiles, Drawings, and MeasuredTemplates may have attached effects - will play effect on target's location\"\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tconst aligns = Object.keys(canvaslib.alignments);\n\t\tif (\n\t\t\ttypeof inOptions.align !== \"string\" ||\n\t\t\t!aligns.includes(inOptions.align)\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t`inOptions.align must be of type string, one of: ${aligns.join(\", \")}`\n\t\t\t);\n\t\t}\n\t\tif (\n\t\t\ttypeof inOptions.edge !== \"string\" ||\n\t\t\t!(\n\t\t\t\tinOptions.edge === \"on\" ||\n\t\t\t\tinOptions.edge === \"inner\" ||\n\t\t\t\tinOptions.edge === \"outer\"\n\t\t\t)\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t`inOptions.edge must of type string with the value of either \"on\", \"inner\", or \"outer\"`\n\t\t\t);\n\t\t}\n\t\tif (typeof inOptions.bindVisibility !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t`inOptions.bindVisibility must be of type boolean`\n\t\t\t);\n\t\tif (inOptions.followRotation !== undefined) {\n\t\t\tinOptions.bindRotation = inOptions.followRotation;\n\t\t\tthis.sequence._showWarning(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t\"inOptions.followRotation is deprecated, please use inOptions.bindRotation instead\"\n\t\t\t);\n\t\t}\n\t\tif (typeof inOptions.bindRotation !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t`inOptions.bindRotation must be of type boolean`\n\t\t\t);\n\t\tif (typeof inOptions.bindAlpha !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t\"inOptions.bindAlpha must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.bindElevation !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t\"inOptions.bindElevation must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.bindScale !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t\"inOptions.bindScale must be of type boolean\"\n\t\t\t);\n\t\tif (\n\t\t\t!(\n\t\t\t\ttypeof inOptions.randomOffset === \"boolean\" ||\n\t\t\t\tlib.is_real_number(inOptions.randomOffset)\n\t\t\t)\n\t\t)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"attachTo\",\n\t\t\t\t\"inOptions.randomOffset must be of type boolean or number\"\n\t\t\t);\n\n\t\tthis._source = validatedObject;\n\n\t\tif (inOptions.offset) {\n\t\t\tconst offsetData = this._validateOffset(\n\t\t\t\t\"attachTo\",\n\t\t\t\tinOptions.offset,\n\t\t\t\tinOptions\n\t\t\t);\n\t\t\tthis._offset = {\n\t\t\t\tsource: offsetData,\n\t\t\t\ttarget: this._offset?.target ?? false,\n\t\t\t};\n\t\t}\n\n\t\tthis._randomOffset = {\n\t\t\tsource: inOptions.randomOffset,\n\t\t\ttarget: this._randomOffset?.target ?? false,\n\t\t};\n\n\t\tthis._attachTo = {\n\t\t\tactive: isValidObject,\n\t\t\talign: inOptions.align,\n\t\t\tedge: inOptions.edge,\n\t\t\tbindVisibility: inOptions.bindVisibility,\n\t\t\tbindAlpha: inOptions.bindAlpha,\n\t\t\tbindScale: inOptions.bindScale,\n\t\t\tbindElevation: inOptions.bindElevation,\n\t\t\tbindRotation: inOptions.bindRotation,\n\t\t};\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Causes the effect to be rotated and stretched towards an object, or a direct on the canvas to play the effect at, or a string reference (see .name())\n\t *  This effectively calculates the proper X scale for the effect to reach the target\n\t *\n\t * @param {Object|String} inLocation\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tstretchTo(inLocation, inOptions = {}) {\n\t\tif (!inLocation || !(typeof inLocation === \"object\" || typeof inLocation === \"string\")) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t`inLocation is invalid, and must be of type of object, string, placeable object, or document`\n\t\t\t);\n\t\t}\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t`inOptions must be of type object`\n\t\t\t);\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tcacheLocation: false,\n\t\t\t\tattachTo: false,\n\t\t\t\tonlyX: false,\n\t\t\t\ttiling: false,\n\t\t\t\toffset: false,\n\t\t\t\trandomOffset: false,\n\t\t\t\tgridUnits: false,\n\t\t\t\tlocal: false,\n\t\t\t\trequiresLineOfSight: false,\n\t\t\t\thideLineOfSight: false,\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\t\tconst validatedObject = this._validateLocation(inLocation);\n\t\tif (validatedObject === undefined)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"could not find position of given object\"\n\t\t\t);\n\t\tif (typeof inOptions.cacheLocation !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"inOptions.cacheLocation must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.attachTo !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"inOptions.attachTo must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.onlyX !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"inOptions.onlyX must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.tiling !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"inOptions.tiling must be of type boolean\"\n\t\t\t);\n\t\tif (\n\t\t\t!(\n\t\t\t\ttypeof inOptions.randomOffset === \"boolean\" ||\n\t\t\t\tlib.is_real_number(inOptions.randomOffset)\n\t\t\t)\n\t\t)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"inOptions.randomOffset must be of type boolean or number\"\n\t\t\t);\n\n\t\tif (inOptions.cacheLocation && inOptions.attachTo) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"cacheLocation and attachTo cannot both be true - pick one or the other\"\n\t\t\t);\n\t\t}\n\n\t\tif (typeof inOptions.requiresLineOfSight !== \"boolean\") {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"requiresLineOfSight must be of type boolean\"\n\t\t\t);\n\t\t}\n\n\t\tif (!inOptions.attachTo && inOptions.requiresLineOfSight) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"requiresLineOfSight requires that attachTo is true\"\n\t\t\t);\n\t\t}\n\n\t\tif (typeof inOptions.hideLineOfSight !== \"boolean\") {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"hideLineOfSight must be of type boolean\"\n\t\t\t);\n\t\t}\n\n\t\tif (!inOptions.requiresLineOfSight && inOptions.hideLineOfSight) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"hideLineOfSight requires that requiresLineOfSight is true\"\n\t\t\t);\n\t\t}\n\n\t\tif (inOptions.tiling) this.tilingTexture();\n\n\t\tif (inOptions.offset) {\n\t\t\tconst offsetData = this._validateOffset(\n\t\t\t\t\"stretchTo\",\n\t\t\t\tinOptions.offset,\n\t\t\t\tinOptions\n\t\t\t);\n\t\t\tthis._offset = {\n\t\t\t\tsource: this._offset?.source ?? false,\n\t\t\t\ttarget: offsetData,\n\t\t\t};\n\t\t}\n\n\t\tthis._randomOffset = {\n\t\t\tsource: this._randomOffset?.source ?? false,\n\t\t\ttarget: inOptions.randomOffset,\n\t\t};\n\n\t\tthis._stretchTo = {\n\t\t\ttarget: inOptions.cacheLocation\n\t\t\t\t? canvaslib.get_object_canvas_data(validatedObject, { measure: true })\n\t\t\t\t: validatedObject,\n\t\t\tattachTo: inOptions.attachTo,\n\t\t\tonlyX: inOptions.onlyX,\n\t\t\trequiresLineOfSight: inOptions.requiresLineOfSight,\n\t\t\thideLineOfSight: inOptions.hideLineOfSight,\n\t\t};\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the location to rotate the object to\n\t *\n\t * @param {object|string} inLocation\n\t * @param {object} inOptions\n\t * @returns this\n\t */\n\trotateTowards(inLocation, inOptions = {}) {\n\t\tif (!inLocation || !(typeof inLocation === \"object\" || typeof inLocation === \"string\")) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"inLocation\",\n\t\t\t\t`inLocation is invalid, and must be of type of object, string, placeable object, or document`\n\t\t\t);\n\t\t}\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\trotationOffset: 0,\n\t\t\t\tcacheLocation: false,\n\t\t\t\tattachTo: false,\n\t\t\t\toffset: false,\n\t\t\t\trandomOffset: false,\n\t\t\t\tlocal: false,\n\t\t\t\tgridUnits: false,\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\t\tif (!lib.is_real_number(inOptions.rotationOffset))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"rotateTowards\",\n\t\t\t\t\"inOptions.rotationOffset must be of type number\"\n\t\t\t);\n\t\tif (typeof inOptions.attachTo !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"rotateTowards\",\n\t\t\t\t\"inOptions.attachTo must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.cacheLocation !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"rotateTowards\",\n\t\t\t\t\"inOptions.cacheLocation must be of type boolean\"\n\t\t\t);\n\t\tconst validatedObject = this._validateLocation(inLocation);\n\t\tif (!validatedObject)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"rotateTowards\",\n\t\t\t\t\"could not find position of given object\"\n\t\t\t);\n\n\t\tif (inOptions.offset) {\n\t\t\tconst offsetData = this._validateOffset(\n\t\t\t\t\"attachTo\",\n\t\t\t\tinOptions.offset,\n\t\t\t\tinOptions\n\t\t\t);\n\t\t\tthis._offset = {\n\t\t\t\tsource: offsetData,\n\t\t\t\ttarget: this._offset?.target ?? false,\n\t\t\t};\n\t\t}\n\n\t\tthis._randomOffset = {\n\t\t\tsource: inOptions.randomOffset,\n\t\t\ttarget: this._randomOffset?.target ?? false,\n\t\t};\n\n\t\tthis._rotateTowards = {\n\t\t\ttarget: inOptions.cacheLocation\n\t\t\t\t? canvaslib.get_object_canvas_data(validatedObject, { measure: true })\n\t\t\t\t: validatedObject,\n\t\t\trotationOffset: inOptions.rotationOffset,\n\t\t\tcacheLocation: inOptions.cacheLocation,\n\t\t\tattachTo: inOptions.attachTo,\n\t\t};\n\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Create an effect based on the given object, effectively copying the object as an effect. Useful when you want to do some effect magic on tokens or tiles.\n\t *\n\t * @param {Object} inObject\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tfrom(inObject, inOptions = {}) {\n\t\tif (\n\t\t\t!(\n\t\t\t\tinObject instanceof Token ||\n\t\t\t\tinObject instanceof Tile ||\n\t\t\t\tinObject instanceof TokenDocument ||\n\t\t\t\tinObject instanceof TileDocument\n\t\t\t)\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"from\",\n\t\t\t\t\"inObject must be of type Token, Tile, TokenDocument, or TileDocument\"\n\t\t\t);\n\t\t}\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"from\",\n\t\t\t\t`inOptions must be of type object`\n\t\t\t);\n\t\tinObject = inObject.document ?? inObject;\n\t\tif (!inObject?.texture?.src)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"from\",\n\t\t\t\t\"could not find the image for the given object\"\n\t\t\t);\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tcacheLocation: false,\n\t\t\t\toffset: false,\n\t\t\t\trandomOffset: false,\n\t\t\t\tlocal: false,\n\t\t\t\tgridUnits: false,\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\t\tif (typeof inOptions.cacheLocation !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"from\",\n\t\t\t\t\"inOptions.cacheLocation must be of type boolean\"\n\t\t\t);\n\t\tif (\n\t\t\t!(\n\t\t\t\ttypeof inOptions.randomOffset === \"boolean\" ||\n\t\t\t\tlib.is_real_number(inOptions.randomOffset)\n\t\t\t)\n\t\t)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"from\",\n\t\t\t\t\"inOptions.randomOffset must be of type boolean or number\"\n\t\t\t);\n\n\t\tif (inOptions.offset) {\n\t\t\tconst offsetData = this._validateOffset(\n\t\t\t\t\"attachTo\",\n\t\t\t\tinOptions.offset,\n\t\t\t\tinOptions\n\t\t\t);\n\t\t\tthis._offset = {\n\t\t\t\tsource: offsetData,\n\t\t\t\ttarget: this._offset?.target ?? false,\n\t\t\t};\n\t\t}\n\n\t\tthis._randomOffset = {\n\t\t\tsource: inOptions.randomOffset,\n\t\t\ttarget: this._randomOffset?.target ?? false,\n\t\t};\n\n\t\tthis._from = {\n\t\t\tobject: inObject,\n\t\t\toptions: inOptions,\n\t\t};\n\t\treturn this;\n\t}\n\n\tshape(inType, inOptions = {}) {\n\t\tif (typeof inType !== \"string\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"type must be of type string\"\n\t\t\t);\n\n\t\tif (!Object.values(CONSTANTS.SHAPES).includes(inType)) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"type must be one of: \" + Object.values(CONSTANTS.SHAPES).join(\", \")\n\t\t\t);\n\t\t}\n\n\t\tif (inType === CONSTANTS.SHAPES.POLY) {\n\t\t\tif (!Array.isArray(inOptions.points)) {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"shape\",\n\t\t\t\t\t\"if creating polygon, inOptions.points must be of type array\"\n\t\t\t\t);\n\t\t\t}\n\t\t\tinOptions.points = inOptions.points.map((point) => {\n\t\t\t\tif (Array.isArray(point)) {\n\t\t\t\t\tif (!is_real_number(point[0]) || !is_real_number(point[1])) {\n\t\t\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\"shape\",\n\t\t\t\t\t\t\t\"inOptions.points must be an array, containing an array of two numbers or objects with x and y number properties\"\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn point;\n\t\t\t\t}\n\t\t\t\tif (typeof point === \"object\") {\n\t\t\t\t\tif (!is_real_number(point?.x) || !is_real_number(point?.y)) {\n\t\t\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\"shape\",\n\t\t\t\t\t\t\t\"inOptions.points must be an array, containing an array of two numbers or objects with x and y number properties\"\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn [point.x, point.y];\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (inType === CONSTANTS.SHAPES.CIRC) {\n\t\t\tif (typeof inOptions.radius !== \"number\") {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"shape\",\n\t\t\t\t\t\"if creating circle, inOptions.radius must be of type number\"\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (\n\t\t\tinType === CONSTANTS.SHAPES.RECT ||\n\t\t\tinType === CONSTANTS.SHAPES.RREC ||\n\t\t\tinType === CONSTANTS.SHAPES.ELIP\n\t\t) {\n\t\t\tif (inOptions.width ^ inOptions.height) {\n\t\t\t\tinOptions.width = inOptions.width ?? inOptions.height;\n\t\t\t\tinOptions.height = inOptions.height ?? inOptions.width;\n\t\t\t}\n\t\t\tif (typeof inOptions.width !== \"number\") {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"shape\",\n\t\t\t\t\t`if creating rectangle, rounded rectangle, or an ellipse, inOptions.width must be of type number`\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (typeof inOptions.height !== \"number\") {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"shape\",\n\t\t\t\t\t\"if creating rectangle, rounded rectangle, or an ellipse, inOptions.height must be of type number\"\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (\n\t\t\t\tinType === CONSTANTS.SHAPES.RREC &&\n\t\t\t\ttypeof inOptions.radius !== \"number\"\n\t\t\t) {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"shape\",\n\t\t\t\t\t\"if creating rounded border rectangle, inOptions.radius must be of type number\"\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tinOptions.gridUnits !== undefined &&\n\t\t\ttypeof inOptions.gridUnits !== \"boolean\"\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.gridUnits must be of type boolean\"\n\t\t\t);\n\t\t}\n\n\t\tif (inOptions.name && typeof inOptions.name !== \"string\") {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.name must be of type string\"\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tinOptions.fillColor &&\n\t\t\t!is_real_number(inOptions.fillColor) &&\n\t\t\ttypeof inOptions.fillColor !== \"string\"\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.fillColor must be of type string (hexadecimal) or number (decimal)\"\n\t\t\t);\n\t\t} else {\n\t\t\tinOptions.fillColor = lib.parseColor(inOptions.fillColor).decimal;\n\t\t}\n\n\t\tif (inOptions.fillAlpha && !is_real_number(inOptions.fillAlpha)) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.fillAlpha must be of type number\"\n\t\t\t);\n\t\t}\n\n\t\tif (inOptions.alpha && !is_real_number(inOptions.alpha)) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.alpha must be of type number\"\n\t\t\t);\n\t\t}\n\n\t\tif (inOptions.lineSize && !is_real_number(inOptions.lineSize)) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.lineSize must be of type number\"\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tinOptions.lineColor &&\n\t\t\t!is_real_number(inOptions.lineColor) &&\n\t\t\ttypeof inOptions.lineColor !== \"string\"\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.lineColor must be of type string (hexadecimal) or number (decimal)\"\n\t\t\t);\n\t\t} else {\n\t\t\tinOptions.lineColor = lib.parseColor(inOptions.lineColor).decimal;\n\t\t}\n\n\t\tif (inOptions.offset) {\n\t\t\tinOptions.offset = this._validateOffset(\n\t\t\t\t\"shape\",\n\t\t\t\tinOptions.offset,\n\t\t\t\tinOptions.offset\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tinOptions.texture !== undefined &&\n\t\t\ttypeof inOptions.texture !== \"string\"\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.texture must be of type string\"\n\t\t\t);\n\t\t}\n\n\t\tif (\n\t\t\tinOptions.isMask !== undefined &&\n\t\t\ttypeof inOptions.isMask !== \"boolean\"\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"shape\",\n\t\t\t\t\"inOptions.isMask must be of type boolean\"\n\t\t\t);\n\t\t}\n\n\t\tthis._shapes.push({\n\t\t\t...inOptions,\n\t\t\ttype: inType,\n\t\t});\n\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Causes the effect's sprite to be offset relative to its location based on a given vector\n\t *\n\t * @param {Object} inOffset\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tspriteOffset(inOffset, inOptions = {}) {\n\t\tif (inOffset === undefined)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"spriteOffset\",\n\t\t\t\t\"inOffset must not be undefined\"\n\t\t\t);\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"spriteOffset\",\n\t\t\t\t\"options must be of type object\"\n\t\t\t);\n\t\tthis._spriteOffset = this._validateOffset(\n\t\t\t\"spriteOffset\",\n\t\t\tinOffset,\n\t\t\tinOptions\n\t\t);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the final effect location to be snapped to the grid\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\tsnapToGrid(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"snapToGrid\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._snapToGrid = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to be scaled to the target object's width\n\t *\n\t * @param {Number} inScale\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tscaleToObject(inScale = 1.0, inOptions = {}) {\n\t\tif (!lib.is_real_number(inScale))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"scaleToObject\",\n\t\t\t\t`inScale must be of type number!`\n\t\t\t);\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"scaleToObject\",\n\t\t\t\t\"inOptions must be of type object\"\n\t\t\t);\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tscale: inScale,\n\t\t\t\tconsiderTokenScale: false,\n\t\t\t\tuniform: false\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\t\tif (typeof inOptions.considerTokenScale !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"scaleToObject\",\n\t\t\t\t\"inOptions.considerTokenScale must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.uniform !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"scaleToObject\",\n\t\t\t\t\"inOptions.uniform must be of type boolean\"\n\t\t\t);\n\t\tthis._scaleToObject = inOptions;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the width and the height of the effect in pixels, this size is set before any scaling\n\t *\n\t * @param {Number|Object<{width: {Number}, height: {Number}}>} inSize\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tsize(inSize, inOptions = {}) {\n\t\tif (!lib.is_real_number(inSize) && typeof inSize !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"size\",\n\t\t\t\t\"inSize must be of type number or object\"\n\t\t\t);\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"size\",\n\t\t\t\t\"inOptions must be of type object\"\n\t\t\t);\n\t\tif (lib.is_real_number(inSize)) {\n\t\t\tinSize = {\n\t\t\t\twidth: inSize,\n\t\t\t\theight: inSize,\n\t\t\t};\n\t\t}\n\n\t\tif ((inSize.width === undefined) ^ (inSize.height === undefined)) {\n\t\t\tif (inSize.width) {\n\t\t\t\tif (!lib.is_real_number(inSize.width))\n\t\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\"size\",\n\t\t\t\t\t\t\"inSize.width must be of type number or string 'auto'\"\n\t\t\t\t\t);\n\t\t\t\tinSize[\"height\"] = \"auto\";\n\t\t\t} else {\n\t\t\t\tif (!lib.is_real_number(inSize.height))\n\t\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\"size\",\n\t\t\t\t\t\t\"inSize.height must be of type number or string 'auto'\"\n\t\t\t\t\t);\n\t\t\t\tinSize[\"width\"] = \"auto\";\n\t\t\t}\n\t\t}\n\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tgridUnits: false,\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\n\t\tif (!lib.is_real_number(inSize.width) && inSize.width !== \"auto\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"size\",\n\t\t\t\t\"inSize.width must be of type number or string 'auto'\"\n\t\t\t);\n\t\tif (!lib.is_real_number(inSize.height) && inSize.height !== \"auto\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"size\",\n\t\t\t\t\"inSize.height must be of type number or string 'auto'\"\n\t\t\t);\n\t\tif (typeof inOptions.gridUnits !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"size\",\n\t\t\t\t\"inOptions.gridUnits must be of type boolean\"\n\t\t\t);\n\n\t\tthis._size = {\n\t\t\twidth: inSize.width ?? canvas.grid.size,\n\t\t\theight: inSize.height ?? canvas.grid.size,\n\t\t\t...inOptions,\n\t\t};\n\t\treturn this;\n\t}\n\n\t/**\n\t *  This scales the sprite of the effect, and this method can take the following:\n\t *  - A number to set the scale uniformly\n\t *  - An object with x and y for non-uniform scaling\n\t *  - Two numbers which the Sequencer will randomly pick a uniform scale between\n\t *\n\t * @param {number|object} inScaleMin\n\t * @param {number} [inScaleMax] inScaleMax\n\t * @returns this\n\t */\n\tspriteScale(inScaleMin, inScaleMax) {\n\t\tif (!lib.is_real_number(inScaleMin) && typeof inScaleMin !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"spriteScale\",\n\t\t\t\t\"inScale must be of type number or object\"\n\t\t\t);\n\t\tif (lib.is_real_number(inScaleMin)) {\n\t\t\tif (inScaleMax && !lib.is_real_number(inScaleMax)) {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"spriteScale\",\n\t\t\t\t\t\"if inScaleMin is a number, inScaleMax must also be of type number\"\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tthis._spriteScaleMin = inScaleMin;\n\t\tthis._spriteScaleMax = inScaleMax ?? false;\n\t\treturn this;\n\t}\n\n\t/**\n\t * This defines the internal padding of this effect. Gridsize determines the internal grid size of this effect which will determine how big it is on the canvas\n\t * relative to the canvas's grid size. Start and end point defines padding at the left and right of the effect\n\t *\n\t * @param {Number} gridSize\n\t * @param {Number} startPoint\n\t * @param {Number} endPoint\n\t * @returns {EffectSection}\n\t */\n\ttemplate({ gridSize, startPoint, endPoint } = {}) {\n\t\tif (gridSize && !lib.is_real_number(gridSize))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"template\",\n\t\t\t\t\"gridSize must be of type number\"\n\t\t\t);\n\t\tif (startPoint && !lib.is_real_number(startPoint))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"template\",\n\t\t\t\t\"startPoint must be of type number\"\n\t\t\t);\n\t\tif (endPoint && !lib.is_real_number(endPoint))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"template\",\n\t\t\t\t\"endPoint must be of type number\"\n\t\t\t);\n\t\tif (!gridSize && !startPoint && !endPoint)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"template\",\n\t\t\t\t\"You need to define at least one parameter!\"\n\t\t\t);\n\t\tif (!this._template) this._template = {};\n\t\tif (gridSize) this._template[\"gridSize\"] = gridSize;\n\t\tif (startPoint) this._template[\"startPoint\"] = startPoint;\n\t\tif (endPoint) this._template[\"endPoint\"] = endPoint;\n\t\treturn this;\n\t}\n\n\t/**\n\t * This makes the texture of the effect tile, effectively repeat itself within the sprite's dimensions\n\t *\n\t * @param {Object|Number} scale\n\t * @param {Object} position\n\t * @returns {EffectSection}\n\t */\n\ttilingTexture(scale = { x: 1.0, y: 1.0 }, position = { x: 0, y: 0 }) {\n\t\tif (lib.is_real_number(scale)) {\n\t\t\tscale = { x: scale, y: scale };\n\t\t}\n\n\t\tscale = { x: scale?.x ?? 1.0, y: scale?.y ?? 1.0 };\n\n\t\tif (!lib.is_real_number(scale.x))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"tilingTexture\",\n\t\t\t\t`scale.x must be of type number!`\n\t\t\t);\n\t\tif (!lib.is_real_number(scale.y))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"tilingTexture\",\n\t\t\t\t`scale.y must be of type number!`\n\t\t\t);\n\n\t\tposition = { x: position?.x ?? 0, y: position?.y ?? 0 };\n\n\t\tif (!lib.is_real_number(position.x))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"tilingTexture\",\n\t\t\t\t`position.x must be of type number!`\n\t\t\t);\n\t\tif (!lib.is_real_number(position.y))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"tilingTexture\",\n\t\t\t\t`position.y must be of type number!`\n\t\t\t);\n\n\t\tthis._tilingTexture = {\n\t\t\tscale,\n\t\t\tposition,\n\t\t};\n\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Anchors the sprite's container according to the given x and y coordinates, or uniformly based on a single number\n\t *\n\t * @param {Number|Object} inAnchor\n\t * @returns {EffectSection}\n\t */\n\tanchor(inAnchor) {\n\t\tif (lib.is_real_number(inAnchor)) {\n\t\t\tinAnchor = {\n\t\t\t\tx: inAnchor,\n\t\t\t\ty: inAnchor,\n\t\t\t};\n\t\t}\n\n\t\tinAnchor = {\n\t\t\tx: inAnchor?.x ?? 0.5,\n\t\t\ty: inAnchor?.y ?? 0.5,\n\t\t};\n\n\t\tif (!lib.is_real_number(inAnchor.x))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"anchor\",\n\t\t\t\t`inAnchor.x must be of type number!`\n\t\t\t);\n\t\tif (!lib.is_real_number(inAnchor.y))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"anchor\",\n\t\t\t\t`inAnchor.y must be of type number!`\n\t\t\t);\n\n\t\tthis._anchor = inAnchor;\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Anchors the sprite according to the given x and y coordinates, or uniformly based on a single number\n\t *\n\t * @param {Number|Object} inAnchor\n\t * @returns {EffectSection}\n\t */\n\tspriteAnchor(inAnchor) {\n\t\tif (lib.is_real_number(inAnchor)) {\n\t\t\tinAnchor = {\n\t\t\t\tx: inAnchor,\n\t\t\t\ty: inAnchor,\n\t\t\t};\n\t\t}\n\n\t\tinAnchor = {\n\t\t\tx: inAnchor?.x ?? 0.5,\n\t\t\ty: inAnchor?.y ?? 0.5,\n\t\t};\n\n\t\tif (!lib.is_real_number(inAnchor.x))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"anchor\",\n\t\t\t\t`inAnchor.x must be of type number!`\n\t\t\t);\n\t\tif (!lib.is_real_number(inAnchor.y))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"anchor\",\n\t\t\t\t`inAnchor.y must be of type number!`\n\t\t\t);\n\n\t\tthis._spriteAnchor = inAnchor;\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Centers the sprite, effectively giving it an anchor of {x: 0.5, y: 0.5}\n\t *\n\t *  Note: If this is used, it will override the anchor set by Aim Towards, which sets the sprite's anchor to the\n\t *  outermost edge of the location the sprite is played at\n\t *\n\t * @returns {EffectSection}\n\t */\n\tcenter() {\n\t\tthis.anchor(0.5);\n\t\treturn this;\n\t}\n\n\t/**\n\t * The sprite gets a randomized flipped X scale. If the scale on that axis was 1, it can\n\t * become 1 or -1, effectively mirroring the sprite on its horizontal axis\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\trandomizeMirrorX(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"randomizeMirrorX\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._randomMirrorX = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * The sprite gets a randomized flipped Y scale. If the scale on that axis was 1, it can\n\t * become 1 or -1, effectively mirroring the sprite on its vertical axis\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\trandomizeMirrorY(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"randomizeMirrorY\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._randomMirrorY = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * The sprite gets a flipped X scale. If the scale on that axis was 1, it will become 1 or -1, effectively\n\t * mirroring the sprite on its horizontal axis\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\tmirrorX(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"mirrorX\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._mirrorX = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * The sprite gets a flipped Y scale. If the scale on that axis was 1, it will become 1 or -1, effectively\n\t * mirroring the sprite on its vertical axis\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\tmirrorY(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"mirrorY\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._mirrorY = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to play beneath most tokens\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\tbelowTokens(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"belowTokens\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tif (game.release.generation >= 12) {\n\t\t\treturn this.sortLayer(inBool ? 600 : 800);\n\t\t} else {\n\t\t\tif (!inBool) return this;\n\t\t\treturn this.elevation(0, { absolute: true });\n\t\t}\n\t}\n\n\t/**\n\t * Causes the effect to play beneath most tiles\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\tbelowTiles(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"belowTokens\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tif (game.release.generation >= 12) {\n\t\t\treturn this.sortLayer(inBool ? 300 : 500);\n\t\t} else {\n\t\t\tif (!inBool) return this;\n\t\t\treturn this.elevation(-1, { absolute: true });\n\t\t}\n\t}\n\n\t/**\n\t * Causes the effect to be played on top of the vision mask\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\taboveLighting(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"aboveLighting\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._aboveLighting = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to be played on top of interface\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\taboveInterface(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"aboveInterface\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._aboveInterface = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Changes the effect's elevation\n\t *\n\t * @param {Number} inElevation\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\televation(inElevation, inOptions = {}) {\n\t\tif (typeof inElevation !== \"number\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"elevation\",\n\t\t\t\t\"inElevation must be of type number\"\n\t\t\t);\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"elevation\",\n\t\t\t\t`inOptions must be of type object`\n\t\t\t);\n\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\televation: 1,\n\t\t\t\tabsolute: false,\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\n\t\tif (typeof inOptions.absolute !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"elevation\",\n\t\t\t\t\"inOptions.absolute must be of type boolean\"\n\t\t\t);\n\t\tthis._elevation = {\n\t\t\televation: inElevation,\n\t\t\tabsolute: inOptions.absolute,\n\t\t};\n\t\treturn this;\n\t}\n\n\t/**\n\t * Changes the effect's sortLayer, potentially displaying effects below tiles, above tokens or even weather effects\n\t * in case of identical elevations\n\t *\n\t * @param {Number} inSortLayer\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tsortLayer(inSortLayer, inOptions = {}) {\n\t\tthis._sortLayer = inSortLayer;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets the zIndex of the effect, potentially displaying it on top of other effects the same elevation and sort\n\t *\n\t * @param {Number} inZIndex\n\t * @returns {EffectSection}\n\t */\n\tzIndex(inZIndex) {\n\t\tif (!lib.is_real_number(inZIndex))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"zIndex\",\n\t\t\t\t\"inZIndex must be of type number\"\n\t\t\t);\n\t\tthis._zIndex = inZIndex;\n\t\treturn this;\n\t}\n\n\t/**\n\t * This method only modifies .persist()ed effects and causes them to not immediately end, but stick around for the given duration passed to this method.\n\t *\n\t * @param {Number} inExtraDuration\n\t * @returns {EffectSection}\n\t */\n\textraEndDuration(inExtraDuration) {\n\t\tif (!lib.is_real_number(inExtraDuration))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"extraEndDuration\",\n\t\t\t\t\"inExtraDuration must be of type number\"\n\t\t\t);\n\t\tthis._extraEndDuration = inExtraDuration;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Rotates the sprite\n\t *\n\t * @param {Number} inAngle\n\t * @returns {EffectSection}\n\t */\n\tspriteRotation(inAngle) {\n\t\tif (!lib.is_real_number(inAngle))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"spriteRotation\",\n\t\t\t\t\"inAngle must be of type number\"\n\t\t\t);\n\t\tthis._spriteRotation = inAngle;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Rotates the sprite\n\t *\n\t * @param {Boolean} inBool\n\t * @returns {EffectSection}\n\t */\n\trandomSpriteRotation(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"randomSpriteRotation\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._randomSpriteRotation = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to not rotate should its container rotate\n\t *\n\t * @param {Boolean} [inBool=true] inBool\n\t * @returns {EffectSection}\n\t */\n\tzeroSpriteRotation(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"zeroSpriteRotation\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._zeroSpriteRotation = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @deprecated\n\t */\n\tnoLoop(inBool = true) {\n\t\tthis.sequence._showWarning(\n\t\t\tthis,\n\t\t\t\"noLoop\",\n\t\t\t\".noLoop() is deprecated, please use .loopOptions({ loops: 1 }) instead\"\n\t\t);\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"noLoop\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\n\t\tthis._loopOptions = foundry.utils.mergeObject(\n\t\t\tthis._loopOptions ?? {\n\t\t\t\tloopDelay: 0,\n\t\t\t\tloops: 0,\n\t\t\t},\n\t\t\t{\n\t\t\t\tloops: 1\n\t\t\t}\n\t\t);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Allows you to control the number of loops and the delays between each loop\n\t *\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tloopOptions(inOptions={}){\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"loopOptions\",\n\t\t\t\t`inOptions must be of type object`\n\t\t\t);\n\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tloopDelay: 0,\n\t\t\t\tloops: 0,\n\t\t\t\tendOnLastLoop: false\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\n\t\tif (typeof inOptions.endOnLastLoop !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"loopOptions\",\n\t\t\t\t\"inOptions.endOnLastLoop must be of type boolean\"\n\t\t\t);\n\n\t\tif (typeof inOptions.loopDelay !== \"number\" || inOptions.loopDelay < 0)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"loopOptions\",\n\t\t\t\t\"inOptions.loopDelay must be of type number that is not below 0\"\n\t\t\t);\n\n\t\tif (typeof inOptions.loops !== \"number\" || inOptions.loops < 0)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"loopOptions\",\n\t\t\t\t\"inOptions.loops must be of type number that is not below 0\"\n\t\t\t);\n\n\t\tthis._loopOptions = inOptions;\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to not show up in the Effect Manager UI - DO NOT USE UNLESS YOU KNOW WHAT YOU ARE DOING\n\t *\n\t * @param inBool\n\t * @returns {EffectSection}\n\t */\n\tprivate(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"private\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._private = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to be played in screen space instead of world space (where tokens are)\n\t *\n\t * @param {Boolean} [inBool=true] inBool\n\t * @returns {EffectSection}\n\t */\n\tscreenSpace(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpace\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._screenSpace = inBool;\n\t\tthis._screenSpaceAnchor = this._screenSpaceAnchor ?? { x: 0.5, y: 0.5 };\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to be played above all of the UI elements\n\t *\n\t * @param {Boolean} [inBool=true] inBool\n\t * @returns {EffectSection}\n\t */\n\tscreenSpaceAboveUI(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceAboveUI\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._screenSpaceAboveUI = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Positions the effect in a screen space position, offset from its .screenSpaceAnchor()\n\t *\n\t * @param {Object} inPosition\n\t * @returns {EffectSection}\n\t */\n\tscreenSpacePosition(inPosition) {\n\t\tinPosition = {\n\t\t\tx: inPosition?.x ?? 0,\n\t\t\ty: inPosition?.y ?? 0,\n\t\t};\n\t\tif (!lib.is_real_number(inPosition.x))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpacePosition\",\n\t\t\t\t`inPosition.x must be of type number!`\n\t\t\t);\n\t\tif (!lib.is_real_number(inPosition.y))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpacePosition\",\n\t\t\t\t`inPosition.y must be of type number!`\n\t\t\t);\n\t\tthis._screenSpacePosition = inPosition;\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Anchors the sprite according to the given x and y coordinates, or uniformly based on a single number in screen space\n\t *\n\t * @param {Number|Object} inAnchor\n\t * @returns {EffectSection}\n\t */\n\tscreenSpaceAnchor(inAnchor) {\n\t\tif (lib.is_real_number(inAnchor)) {\n\t\t\tinAnchor = {\n\t\t\t\tx: inAnchor,\n\t\t\t\ty: inAnchor,\n\t\t\t};\n\t\t}\n\n\t\tinAnchor = {\n\t\t\tx: inAnchor?.x ?? 0.5,\n\t\t\ty: inAnchor?.y ?? 0.5,\n\t\t};\n\n\t\tif (!lib.is_real_number(inAnchor.x))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceAnchor\",\n\t\t\t\t`inAnchor.x must be of type number!`\n\t\t\t);\n\t\tif (!lib.is_real_number(inAnchor.y))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceAnchor\",\n\t\t\t\t`inAnchor.y must be of type number!`\n\t\t\t);\n\n\t\tthis._screenSpaceAnchor = inAnchor;\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Sets up various properties relating to scale of the effect on the screen\n\t *\n\t * @param {Object} inOptions\n\t * @returns {EffectSection}\n\t */\n\tscreenSpaceScale(inOptions) {\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceScale\",\n\t\t\t\t`inOptions must be of type object`\n\t\t\t);\n\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\tx: 1.0,\n\t\t\t\ty: 1.0,\n\t\t\t\tfitX: false,\n\t\t\t\tfitY: false,\n\t\t\t\tratioX: false,\n\t\t\t\tratioY: false,\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\n\t\tif (!lib.is_real_number(inOptions.x))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceScale\",\n\t\t\t\t`inOptions.x must be of type number!`\n\t\t\t);\n\t\tif (!lib.is_real_number(inOptions.y))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceScale\",\n\t\t\t\t`inOptions.y must be of type number!`\n\t\t\t);\n\t\tif (typeof inOptions.fitX !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceScale\",\n\t\t\t\t\"inOptions.fitX must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.fitY !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceScale\",\n\t\t\t\t\"inOptions.fitY must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.ratioX !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceScale\",\n\t\t\t\t\"inOptions.ratioX must be of type boolean\"\n\t\t\t);\n\t\tif (typeof inOptions.ratioY !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceScale\",\n\t\t\t\t\"inOptions.ratioY must be of type boolean\"\n\t\t\t);\n\n\t\tif (inOptions.ratioX && inOptions.ratioY)\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"screenSpaceScale\",\n\t\t\t\t\"both ratioX and ratioY cannot be true, one axis must fit or be set directly\"\n\t\t\t);\n\n\t\tthis._screenSpaceScale = inOptions;\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Ties the effect to any number of documents in Foundry - if those get deleted, the effect is ended.\n\t *\n\t * @param {String|PlaceableObject|foundry.abstract.Document|Array<String|PlaceableObject|foundry.abstract.Document>} inDocuments\n\t * @returns {EffectSection}\n\t */\n\ttieToDocuments(inDocuments) {\n\t\tif (!Array.isArray(inDocuments)) {\n\t\t\tinDocuments = [inDocuments];\n\t\t}\n\t\tfor (let doc of inDocuments) {\n\t\t\tif (\n\t\t\t\ttypeof doc !== \"string\" &&\n\t\t\t\t!(doc instanceof PlaceableObject) &&\n\t\t\t\t!(doc instanceof foundry.abstract.Document)\n\t\t\t) {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"tieToDocument\",\n\t\t\t\t\t\"inOrigin must be of type string, PlaceableObject, or Document, or an array thereof\"\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (typeof doc === \"string\") {\n\t\t\t\tconst obj = fromUuidSync(doc);\n\t\t\t\tif (!obj)\n\t\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\"tieToDocument\",\n\t\t\t\t\t\t`could not find document with UUID \"${doc}\"`\n\t\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tdoc = lib.validate_document(doc);\n\t\t\t\tif (doc instanceof foundry.abstract.Document) {\n\t\t\t\t\tdoc = doc?.uuid;\n\t\t\t\t\tif (!doc)\n\t\t\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\"tieToDocument\",\n\t\t\t\t\t\t\t\"could not find the UUID for the given object\"\n\t\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._tiedDocuments.push(doc);\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t *  Masks the effect to the given object or objects. If no object is given, the effect will be masked to the source\n\t *  of the effect.\n\t *\n\t * @param {Token/TokenDocument/Tile/TileDocument/Drawing/DrawingDocument/MeasuredTemplate/MeasuredTemplateDocument/Array} inObject\n\t * @returns {Section}\n\t */\n\tmask(inObject) {\n\t\tif (!inObject) {\n\t\t\tthis._selfMask = true;\n\t\t\treturn this;\n\t\t}\n\n\t\tif (Array.isArray(inObject)) {\n\t\t\tfor (let obj of inObject) {\n\t\t\t\tthis.mask(obj);\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tconst validatedObject = this._validateLocation(inObject);\n\n\t\tconst isValidObject =\n\t\t\tvalidatedObject instanceof TokenDocument ||\n\t\t\tvalidatedObject instanceof TileDocument ||\n\t\t\tvalidatedObject instanceof DrawingDocument ||\n\t\t\tvalidatedObject instanceof MeasuredTemplateDocument;\n\t\tif (!isValidObject) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"mask\",\n\t\t\t\t\"A foundry object was provided, but only Tokens, Tiles, Drawings, and MeasuredTemplates may be used to create effect masks\"\n\t\t\t);\n\t\t}\n\n\t\tthis._masks.push(lib.get_object_identifier(validatedObject));\n\n\t\treturn this;\n\t}\n\n\t/**\n\t * Causes the effect to be visible through walls\n\t *\n\t * @param inBool\n\t * @returns {EffectSection}\n\t */\n\txray(inBool = true) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"xray\",\n\t\t\t\t\"inBool must be of type boolean\"\n\t\t\t);\n\t\tthis._xray = inBool;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Declares which file to be played. This may also be an array of paths, which will be randomly picked from each\n\t * time the section is played.\n\t *\n\t * @param {string|array} inFile\n\t * @param {object} inOptions\n\t * @returns this\n\t */\n\tfile(inFile, inOptions = {}) {\n\t\tif(typeof inOptions === \"boolean\"){\n\t\t\tinOptions = {};\n\t\t\tthis.sequence._showWarning(\n\t\t\t\tthis,\n\t\t\t\t\"file\",\n\t\t\t\t\"passing a boolean as a second argument to .file() is deprecated, please softFail: true on the sequence itself instead\"\n\t\t\t);\n\t\t}\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"file\",\n\t\t\t\t\"inOptions must be of type object\"\n\t\t\t);\n\t\tinOptions = foundry.utils.mergeObject({\n\t\t\tantialiasing: PIXI.SCALE_MODES.LINEAR\n\t\t}, inOptions)\n\t\tif(typeof inOptions.antialiasing !== \"number\" || !(inOptions.antialiasing >= 0 && inOptions.antialiasing <= 1)){\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"file\",\n\t\t\t\t\"inOptions.antialiasing must be of type number of 0 or 1 (see PIXI.SCALE_MODES)\"\n\t\t\t);\n\t\t}\n\t\tthis._file = inFile;\n\t\tthis._fileOptions = inOptions;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Configures the isometric configuration of this effect\n\t *\n\t * @param inOptions\n\t * @returns {EffectSection}\n\t */\n\tisometric(inOptions = {}) {\n\t\tif (typeof inOptions !== \"object\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"isometric\",\n\t\t\t\t`inOptions must be of type object`\n\t\t\t);\n\t\tinOptions = foundry.utils.mergeObject(\n\t\t\t{\n\t\t\t\toverlay: false,\n\t\t\t},\n\t\t\tinOptions\n\t\t);\n\t\tif (typeof inOptions?.overlay !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"isometric\",\n\t\t\t\t\"inOptions.overlay must be of type boolean\"\n\t\t\t);\n\t\tthis._isometric = inOptions;\n\t\treturn this;\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_expressWarnings() {\n\t\tif (this._stretchTo && this._anchor?.x) {\n\t\t\tthis.sequence._showWarning(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"you have called .stretchTo() and .anchor() - stretchTo will manually set the X axis of the anchor and may not behave like you expect.\",\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\t\tif (this._stretchTo && this._scaleToObject) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"You're trying to stretch towards an object, while scaling to fit another??? Make up your mind!\"\n\t\t\t);\n\t\t}\n\t\tif (this._stretchTo && this._randomRotation) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"You're trying to stretch towards an object, while trying to randomly rotate the effect? What?\"\n\t\t\t);\n\t\t}\n\t\tif (this._stretchTo && this._moveTowards) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"You're trying to stretch towards an object, while moving towards it? You're insane.\"\n\t\t\t);\n\t\t}\n\t\tif (\n\t\t\tthis._attachTo &&\n\t\t\tthis._stretchTo?.attachTo &&\n\t\t\t(this._startTime || this._endTime) &&\n\t\t\tthis._isRangedEffect\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"stretchTo\",\n\t\t\t\t\"Dual-attached range-finding effects combined while using any of the time methods is stable - modern web browsers cannot handle it and it may crash them, so this feature has been disabled.\"\n\t\t\t);\n\t\t}\n\n\t\tconst source = this._getSourceObject();\n\t\tconst target = this._getTargetObject();\n\n\t\tif (\n\t\t\t!this._screenSpace &&\n\t\t\tthis._persistOptions?.persistTokenPrototype &&\n\t\t\tthis._masks.filter((uuid) => uuid !== source).length > 0\n\t\t) {\n\t\t\tthis.sequence._showWarning(\n\t\t\t\tthis,\n\t\t\t\t\"persist\",\n\t\t\t\t\"You have applied persistTokenPrototype with multiple masks from objects in the scene - these will not be persisted across scenes!\",\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (!source && !target && !this._screenSpace) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"play\",\n\t\t\t\t\"Could not determine where to play the effect!\"\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * @OVERRIDE\n\t */\n\tasync preRun() {\n\t\tif (this._from) {\n\t\t\tthis._file = this._file || this._from.object?.texture?.src;\n\n\t\t\tif (this._source === null) {\n\t\t\t\tthis._source = this._validateLocation(this._from.object);\n\t\t\t}\n\n\t\t\tif (this._size === null) {\n\t\t\t\tconst size = canvaslib.get_object_dimensions(this._from.object);\n\t\t\t\tthis._size = {\n\t\t\t\t\twidth: size?.width ?? canvas.grid.size,\n\t\t\t\t\theight: size?.height ?? canvas.grid.size,\n\t\t\t\t\tgridUnits: false,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis._mirrorX === null &&\n\t\t\t\t(this._from.object.mirrorX ||\n\t\t\t\t\t(this._from.object?.tile && this._from.object?.tile.scale.x < 0))\n\t\t\t) {\n\t\t\t\tthis._mirrorX = true;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tthis._mirrorY === null &&\n\t\t\t\t(this._from.object.mirrorY ||\n\t\t\t\t\t(this._from.object?.tile && this._from.object?.tile.scale.y < 0))\n\t\t\t) {\n\t\t\t\tthis._mirrorY = true;\n\t\t\t}\n\n\t\t\tif (this._angle === null && this._from.object?.rotation) {\n\t\t\t\tthis._angle = -this._from.object.rotation;\n\t\t\t}\n\n\t\t\tthis._randomOffset = {\n\t\t\t\tsource: this._randomOffset?.source ?? this._from.options.randomOffset,\n\t\t\t\ttarget: this._randomOffset?.target ?? false,\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * @OVERRIDE\n\t * @returns {Promise<void>}\n\t */\n\tasync run() {\n\t\tif (!lib.user_can_do(\"permissions-effect-create\") || !this._playEffect) {\n\t\t\tif (!lib.user_can_do(\"permissions-effect-create\")) {\n\t\t\t\tfoundry.utils.debounce(EffectSection.debounceWarning, 1000);\n\t\t\t}\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\t\tif (!this._deserializedData) this._expressWarnings();\n\t\tconst data = await this._sanitizeEffectData();\n\t\tif (Hooks.call(\"preCreateSequencerEffect\", data) === false) return;\n\t\tlet push =\n\t\t\t!(data?.users?.length === 1 && data?.users?.includes(game.userId)) &&\n\t\t\t!this.sequence.localOnly;\n\t\tlet canvasEffectData = await Sequencer.EffectManager.play(data, push);\n\t\tlet totalDuration = this._currentWaitTime;\n\t\tif (this._persist) {\n\t\t\ttotalDuration += await canvasEffectData.promise;\n\t\t} else {\n\t\t\ttotalDuration += await canvasEffectData.duration;\n\t\t}\n\t\tawait new Promise((resolve) => setTimeout(resolve, totalDuration));\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_applyTraits() {\n\t\tObject.assign(this.constructor.prototype, traits.files);\n\t\tObject.assign(this.constructor.prototype, traits.audio);\n\t\tObject.assign(this.constructor.prototype, traits.moves);\n\t\tObject.assign(this.constructor.prototype, traits.opacity);\n\t\tObject.assign(this.constructor.prototype, traits.rotation);\n\t\tObject.assign(this.constructor.prototype, traits.scale);\n\t\tObject.assign(this.constructor.prototype, traits.time);\n\t\tObject.assign(this.constructor.prototype, traits.users);\n\t\tObject.assign(this.constructor.prototype, traits.animation);\n\t\tObject.assign(this.constructor.prototype, traits.filter);\n\t\tObject.assign(this.constructor.prototype, traits.tint);\n\t\tObject.assign(this.constructor.prototype, traits.location);\n\t\tObject.assign(this.constructor.prototype, traits.offset);\n\t\tObject.assign(this.constructor.prototype, traits.text);\n\t\tObject.assign(this.constructor.prototype, traits.name);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tasync _initialize() {\n\t\tif (this._name) {\n\t\t\tif (!this.sequence.nameOffsetMap) {\n\t\t\t\tthis.sequence.nameOffsetMap = {};\n\t\t\t}\n\n\t\t\tif (!this.sequence.nameOffsetMap[this._name]) {\n\t\t\t\tconst source = this._getSourceObject();\n\t\t\t\tconst target = this._getTargetObject();\n\n\t\t\t\tif (this._offsetLegacy && !this._offset) {\n\t\t\t\t\tthis._offset = {\n\t\t\t\t\t\tsource: !target ? this._offsetLegacy : false,\n\t\t\t\t\t\ttarget: !!target ? this._offsetLegacy : false,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (this._randomOffsetLegacy && !this._randomOffset) {\n\t\t\t\t\tthis._randomOffset = {\n\t\t\t\t\t\tsource: !target ? this._randomOffsetLegacy : false,\n\t\t\t\t\t\ttarget: !!target ? this._randomOffsetLegacy : false,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis.sequence.nameOffsetMap[this._name] = {\n\t\t\t\t\tseed: `${this._name}-${foundry.utils.randomID()}`,\n\t\t\t\t\tsource: source,\n\t\t\t\t\ttarget: target,\n\t\t\t\t\trandomOffset: this._randomOffset,\n\t\t\t\t\tmissed: this._missed,\n\t\t\t\t\toffset: this._offset,\n\t\t\t\t\trepetitions: this._repetitions,\n\t\t\t\t\ttwister: {},\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\t!this._file &&\n\t\t\t!this._from &&\n\t\t\t!this._text &&\n\t\t\t!this._shapes.length &&\n\t\t\tthis.sequence.softFail\n\t\t) {\n\t\t\tthis._playEffect = false;\n\t\t\treturn;\n\t\t}\n\n\t\tlet fileData = this._file\n\t\t\t? await this._determineFile(this._file)\n\t\t\t: {\n\t\t\t\tfile: this._file,\n\t\t\t\tforcedIndex: false,\n\t\t\t\tcustomRange: false,\n\t\t\t};\n\n\t\tthis._isRangedEffect = fileData?.file?.rangeFind;\n\n\t\tif (fileData.customRange || fileData.file?.dbPath) return;\n\n\t\tlet exists = false;\n\t\ttry {\n\t\t\texists = await SequencerFileCache.srcExists(fileData.file);\n\t\t} catch (err) {\n\t\t}\n\n\t\tif (!exists) {\n\t\t\tif (this.sequence.softFail) {\n\t\t\t\tthis._playEffect = false;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"Play\",\n\t\t\t\t`Could not find file:<br>${fileData.file}`\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_getSourceObject() {\n\t\tif (!this._source || typeof this._source !== \"object\") return this._source;\n\t\tif (this._source?.cachedLocation || !this._attachTo) {\n\t\t\treturn canvaslib.get_object_canvas_data(this._source);\n\t\t}\n\t\treturn (\n\t\t\tlib.get_object_identifier(this._source) ??\n\t\t\tcanvaslib.get_object_canvas_data(this._source)\n\t\t);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_getTargetObject() {\n\t\tif (!this._target?.target) return this._target;\n\t\tif (typeof this._target.target !== \"object\") return this._target.target;\n\t\tif (\n\t\t\tthis._target?.target?.cachedLocation ||\n\t\t\t!(this._stretchTo?.attachTo || this._rotateTowards?.attachTo)\n\t\t) {\n\t\t\treturn canvaslib.get_object_canvas_data(this._target.target, true);\n\t\t}\n\t\treturn (\n\t\t\tlib.get_object_identifier(this._target.target) ??\n\t\t\tcanvaslib.get_object_canvas_data(this._target.target, true)\n\t\t);\n\t}\n\n\t/**\n\t * @private\n\t */\n\tasync _sanitizeEffectData() {\n\t\tif (this._deserializedData) {\n\t\t\tthis._deserializedData.creationTimestamp = +new Date();\n\t\t\tthis._deserializedData.remote = true;\n\t\t\treturn this._deserializedData;\n\t\t}\n\n\t\tconst { file, forcedIndex, customRange } =\n\t\t\tthis._file && this._playEffect\n\t\t\t\t? await this._determineFile(this._file)\n\t\t\t\t: {\n\t\t\t\t\tfile: this._file,\n\t\t\t\t\tforcedIndex: false,\n\t\t\t\t\tcustomRange: false,\n\t\t\t\t};\n\n\t\tconst source = this._getSourceObject();\n\t\tconst target = this._getTargetObject();\n\n\t\tthis._temporaryEffect =\n\t\t\tthis._temporaryEffect ||\n\t\t\t(source instanceof foundry.abstract.Document ||\n\t\t\tsource instanceof MeasuredTemplate\n\t\t\t\t? !lib.is_UUID(source?.uuid)\n\t\t\t\t: this._temporaryEffect || false);\n\n\t\tif (this._offsetLegacy) {\n\t\t\tthis._offset = {\n\t\t\t\tsource:\n\t\t\t\t\t!target && this._offset?.source\n\t\t\t\t\t\t? this._offsetLegacy\n\t\t\t\t\t\t: this._offset?.source,\n\t\t\t\ttarget:\n\t\t\t\t\t!!target && this._offset?.target\n\t\t\t\t\t\t? this._offsetLegacy\n\t\t\t\t\t\t: this._offset?.target,\n\t\t\t};\n\t\t}\n\n\t\tif (this._randomOffsetLegacy) {\n\t\t\tthis._randomOffset = {\n\t\t\t\tsource:\n\t\t\t\t\t!target && this._randomOffset?.source\n\t\t\t\t\t\t? this._randomOffsetLegacy\n\t\t\t\t\t\t: this._randomOffset?.source,\n\t\t\t\ttarget:\n\t\t\t\t\t!!target && this._randomOffset?.target\n\t\t\t\t\t\t? this._randomOffsetLegacy\n\t\t\t\t\t\t: this._randomOffset?.target,\n\t\t\t};\n\t\t}\n\n\t\tif (this._selfMask) {\n\t\t\tthis._masks.push(\n\t\t\t\tlib.get_object_identifier(this._source) ??\n\t\t\t\tcanvaslib.get_object_canvas_data(this._source)\n\t\t\t);\n\t\t}\n\n\t\tlet sceneId = game.user.viewedScene;\n\t\tif (lib.is_UUID(source)) {\n\t\t\tconst potentialSceneId = source.split(\".\")[1];\n\t\t\tif (game.scenes.get(potentialSceneId)) {\n\t\t\t\tsceneId = potentialSceneId;\n\t\t\t}\n\t\t} else if (lib.is_UUID(target)) {\n\t\t\tconst potentialSceneId = target.split(\".\")[1];\n\t\t\tif (game.scenes.get(potentialSceneId)) {\n\t\t\t\tsceneId = potentialSceneId;\n\t\t\t}\n\t\t}\n\n\t\tlet data = foundry.utils.duplicate({\n\t\t\t/**\n\t\t\t * Core properties\n\t\t\t */\n\t\t\t_id: foundry.utils.randomID(),\n\t\t\tflagVersion: flagManager.latestFlagVersion,\n\t\t\tsequenceId: this.sequence.id,\n\t\t\tcreationTimestamp: +new Date(),\n\t\t\tsceneId,\n\t\t\tcreatorUserId: game.userId,\n\t\t\tmoduleName: this.sequence.moduleName,\n\t\t\tusers: this._users ? Array.from(this._users) : false,\n\t\t\tname: this._name,\n\t\t\torigin: this._origin,\n\t\t\tindex: this.sequence.effectIndex,\n\t\t\trepetition: this._currentRepetition,\n\t\t\tprivate: this._private,\n\t\t\ttemporary: this._temporaryEffect,\n\t\t\ttiedDocuments: Array.from(new Set(this._tiedDocuments)),\n\n\t\t\t/**\n\t\t\t * Source/target properties\n\t\t\t */\n\t\t\tsource: source,\n\t\t\ttarget: target,\n\t\t\trotateTowards: this._rotateTowards,\n\t\t\tstretchTo: this._stretchTo\n\t\t\t\t? {\n\t\t\t\t\tattachTo: this._stretchTo.attachTo,\n\t\t\t\t\tonlyX: this._stretchTo.onlyX,\n\t\t\t\t\trequiresLineOfSight: this._stretchTo.requiresLineOfSight,\n\t\t\t\t\thideLineOfSight: this._stretchTo.hideLineOfSight,\n\t\t\t\t}\n\t\t\t\t: false,\n\t\t\tmoveTowards: this._moveTowards\n\t\t\t\t? {\n\t\t\t\t\tease: this._moveTowards.ease,\n\t\t\t\t\trotate: this._moveTowards.rotate,\n\t\t\t\t}\n\t\t\t\t: false,\n\n\t\t\tattachTo: this._attachTo,\n\t\t\tmissed: this._missed,\n\n\t\t\t/**\n\t\t\t * Sprite properties\n\t\t\t */\n\t\t\tfile: file?.dbPath ?? file,\n\t\t\tcustomRange,\n\t\t\tforcedIndex,\n\t\t\tfileOptions: this._fileOptions,\n\t\t\ttext: this._text,\n\t\t\ttilingTexture: this._tilingTexture,\n\t\t\tmasks: Array.from(new Set(this._masks)),\n\t\t\tshapes: this._shapes,\n\t\t\tvolume: this._volume,\n\t\t\tisometric: this._isometric,\n\t\t\tsyncGroup: this._syncGroup,\n\n\t\t\t// Transforms\n\t\t\tscale: this._getCalculatedScale(\"scale\"),\n\t\t\tspriteScale: this._getCalculatedScale(\"spriteScale\"),\n\t\t\tangle: this._angle,\n\t\t\tsize: this._size,\n\t\t\toffset: this._offset,\n\t\t\tanchor: this._anchor,\n\t\t\tspriteOffset: this._spriteOffset,\n\t\t\tspriteAnchor: this._spriteAnchor,\n\t\t\ttemplate: this._template,\n\t\t\tzeroSpriteRotation: this._zeroSpriteRotation,\n\t\t\trandomOffset: this._randomOffset,\n\t\t\trandomRotation: this._randomRotation,\n\t\t\tscaleToObject: this._scaleToObject,\n\t\t\televation: this._elevation,\n\t\t\tsortLayer: this._sortLayer,\n\t\t\taboveLighting: this._aboveLighting,\n\t\t\taboveInterface: this._aboveInterface,\n\t\t\txray: this._xray,\n\n\t\t\t// Appearance\n\t\t\tzIndex: this._zIndex,\n\t\t\topacity: lib.is_real_number(this._opacity) ? this._opacity : 1.0,\n\t\t\tfilters: this._filters,\n\t\t\tloopOptions: this._loopOptions,\n\t\t\tspriteRotation: this._spriteRotation,\n\t\t\trandomSpriteRotation: this._randomSpriteRotation,\n\t\t\ttint: this._tint?.decimal,\n\t\t\tflipX: this._mirrorX || (this._randomMirrorX && Math.random() < 0.5),\n\t\t\tflipY: this._mirrorY || (this._randomMirrorY && Math.random() < 0.5),\n\n\t\t\t/**\n\t\t\t * Time properties\n\t\t\t */\n\t\t\tduration: this._duration,\n\t\t\tpersist: this._persist,\n\t\t\tpersistOptions: this._persistOptions,\n\t\t\tplaybackRate: this._playbackRate,\n\t\t\textraEndDuration: this._extraEndDuration,\n\t\t\ttime:\n\t\t\t\tthis._startTime || this._endTime\n\t\t\t\t\t? {\n\t\t\t\t\t\tstart: lib.is_real_number(this._startTime)\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tvalue: this._startTime,\n\t\t\t\t\t\t\t\tisPerc: this._startPerc,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t: false,\n\t\t\t\t\t\tend: lib.is_real_number(this._endTime)\n\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\tvalue: this._endTime,\n\t\t\t\t\t\t\t\tisPerc: this._endPerc,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t: false,\n\t\t\t\t\t\tisRange: this._isRange,\n\t\t\t\t\t}\n\t\t\t\t\t: false,\n\n\t\t\t/**\n\t\t\t * Animation properties\n\t\t\t */\n\t\t\tmoves: this._moveTowards,\n\t\t\tmoveSpeed: this._moveSpeed,\n\t\t\tfadeIn: this._fadeIn,\n\t\t\tfadeOut: this._fadeOut,\n\t\t\tscaleIn: this._scaleIn,\n\t\t\tscaleOut: this._scaleOut,\n\t\t\trotateIn: this._rotateIn,\n\t\t\trotateOut: this._rotateOut,\n\t\t\tfadeInAudio: this._fadeInAudio,\n\t\t\tfadeOutAudio: this._fadeOutAudio,\n\t\t\tanimations: this._animations,\n\n\t\t\t/**\n\t\t\t * Screenspace properties\n\t\t\t */\n\t\t\tscreenSpace: this._screenSpace,\n\t\t\tscreenSpaceAboveUI: this._screenSpaceAboveUI,\n\t\t\tscreenSpaceAnchor: this._screenSpaceAnchor,\n\t\t\tscreenSpacePosition: this._screenSpacePosition,\n\t\t\tscreenSpaceScale: this._screenSpaceScale,\n\n\t\t\tnameOffsetMap: this.sequence.nameOffsetMap,\n\t\t});\n\n\t\tfor (let override of this._overrides) {\n\t\t\tdata = await override(this, data);\n\t\t}\n\n\t\tif (\n\t\t\t(typeof data.file !== \"string\" || data.file === \"\") &&\n\t\t\t!data.text &&\n\t\t\t!data.shapes &&\n\t\t\t!data.customRange\n\t\t) {\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"file\",\n\t\t\t\t\"an effect must have a file, text, or have a shape!\"\n\t\t\t);\n\t\t}\n\n\t\t// TODO: Revisit this at some point?\n\t\t// data = Object.fromEntries(Object.entries(data).filter(entry => entry[1] !== null && entry[1] !== false));\n\n\t\treturn data;\n\t}\n\n\tasync _serialize() {\n\t\tconst data = await super._serialize();\n\t\tawait this.preRun();\n\t\tconst sectionData = await this._sanitizeEffectData();\n\t\treturn {\n\t\t\t...data,\n\t\t\ttype: \"effect\",\n\t\t\tsectionData,\n\t\t};\n\t}\n\n\tasync _deserialize(data) {\n\t\tthis._deserializedData = data.sectionData;\n\t\treturn super._deserialize(data);\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_getCalculatedScale(type) {\n\t\tconst min = this[\"_\" + type + \"Min\"];\n\t\tconst max = this[\"_\" + type + \"Max\"];\n\n\t\tlet scale = min;\n\t\tif (lib.is_real_number(min)) {\n\t\t\tif (max && lib.is_real_number(max)) {\n\t\t\t\tscale = lib.random_float_between(min, max);\n\t\t\t}\n\t\t\tscale = {\n\t\t\t\tx: scale,\n\t\t\t\ty: scale,\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tx: scale?.x ?? 1.0,\n\t\t\ty: scale?.y ?? 1.0,\n\t\t};\n\t}\n}\n","import * as lib from \"../lib/lib.js\";\nimport SequencerSoundManager from \"../modules/sequencer-sound-manager.js\";\nimport Section from \"./section.js\";\nimport traits from \"./traits/_traits.js\";\nimport { SequencerFileBase } from \"../modules/sequencer-file.js\";\nimport CONSTANTS from \"../constants.js\";\n\nclass SoundSection extends Section {\n\tconstructor(inSequence, inFile = \"\") {\n\t\tsuper(inSequence);\n\t\tthis._file = inFile;\n\t\tthis._volume = 0.8;\n\t\tthis._overrides = [];\n\t\tthis._locationOptions = {};\n\t}\n\n\tstatic niceName = \"Sound\";\n\n\t/**\n\t * Declares which file to be played. This may also be an array of paths, which will be randomly picked from each\n\t * time the section is played.\n\t *\n\t * @param {string|array} inFile\n\t * @returns this\n\t */\n\tfile(inFile) {\n\t\tthis._file = inFile;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a function that will run at the end of the sound serialization step, but before it is played. Allows direct\n\t * modifications of sound's data.\n\t *\n\t * @param {function} inFunc\n\t * @returns {SoundSection}\n\t */\n\taddOverride(inFunc) {\n\t\tif (!lib.is_function(inFunc))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"addOverride\",\n\t\t\t\t\"The given function needs to be an actual function.\",\n\t\t\t);\n\t\tthis._overrides.push(inFunc);\n\t\treturn this;\n\t}\n\n\tradius(inNumber) {\n\t\tif (!lib.is_real_number(inNumber))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"radius\",\n\t\t\t\t\"inNumber must be of type number\"\n\t\t\t);\n\t\tthis._locationOptions['radius'] = inNumber;\n\t\treturn this;\n\t}\n\n\tconstrainedByWalls(inBool) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"constrainedByWalls\",\n\t\t\t\t`inBool must be of type boolean`\n\t\t\t);\n\t\tthis._locationOptions['walls'] = inBool;\n\t\treturn this;\n\t}\n\n\tdistanceEasing(inBool) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"distanceEasing\",\n\t\t\t\t`inBool must be of type boolean`\n\t\t\t);\n\t\tthis._locationOptions['easing'] = inBool;\n\t\treturn this;\n\t}\n\n\talwaysForGMs(inBool) {\n\t\tif (typeof inBool !== \"boolean\")\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"alwaysForGMs\",\n\t\t\t\t`inBool must be of type boolean`\n\t\t\t);\n\t\tthis._locationOptions['gmAlways'] = inBool;\n\t\treturn this;\n\t}\n\n\tbaseEffect(options = {}) {\n\t\toptions = foundry.utils.mergeObject({\n\t\t\ttype: \"\",\n\t\t\tintensity: 0\n\t\t}, options);\n\t\tif (typeof options.type !== \"string\" || !CONFIG.soundEffects[options.type])\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"baseEffect\",\n\t\t\t\t`options.type must be of type string, and one of ${Object.keys(CONFIG.soundEffects).join(\", \")}`\n\t\t\t);\n\t\tif (!lib.is_real_number(options.intensity))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"baseEffect\",\n\t\t\t\t\"options.intensity must be of type number\"\n\t\t\t);\n\t\tthis._locationOptions['baseEffect'] = {\n\t\t\ttype: options.type,\n\t\t\tintensity: options.intensity\n\t\t};\n\t\treturn this;\n\t}\n\n\tmuffledEffect(options = {}) {\n\t\toptions = foundry.utils.mergeObject({\n\t\t\ttype: \"\",\n\t\t\tintensity: 0\n\t\t}, options);\n\t\tif (typeof options.type !== \"string\" || !CONFIG.soundEffects[options.type])\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"baseEffect\",\n\t\t\t\t`options.type must be of type string, and one of ${Object.keys(CONFIG.soundEffects).join(\", \")}`\n\t\t\t);\n\t\tif (!lib.is_real_number(options.intensity))\n\t\t\tthrow this.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"baseEffect\",\n\t\t\t\t\"options.intensity must be of type number\"\n\t\t\t);\n\t\tthis._locationOptions['muffledEffect'] = {\n\t\t\ttype: options.type,\n\t\t\tintensity: options.intensity\n\t\t};\n\t\treturn this;\n\t}\n\n\t/**\n\t * @private\n\t */\n\t_applyTraits() {\n\t\tObject.assign(this.constructor.prototype, traits.files);\n\t\tObject.assign(this.constructor.prototype, traits.audio);\n\t\tObject.assign(this.constructor.prototype, traits.time);\n\t\tObject.assign(this.constructor.prototype, traits.users);\n\t\tObject.assign(this.constructor.prototype, traits.name);\n\t\tObject.assign(this.constructor.prototype, traits.location);\n\t}\n\n\t/**\n\t * @OVERRIDE\n\t * @returns {Promise}\n\t */\n\tasync run() {\n\t\tconst playData = await this._sanitizeSoundData();\n\n\t\tif (typeof playData.src !== \"string\" || playData.src === \"\") {\n\t\t\tif (this.sequence.softFail) {\n\t\t\t\tplayData.play = false;\n\t\t\t} else {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"file\",\n\t\t\t\t\t\"a sound must have a src of type string!\",\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (playData.location && CONSTANTS.IS_V12) {\n\t\t\tif (this.sequence.softFail) {\n\t\t\t\tplayData.play = false;\n\t\t\t} else {\n\t\t\t\tthrow this.sequence._customError(\n\t\t\t\t\tthis,\n\t\t\t\t\t\"atLocation\",\n\t\t\t\t\t\"a sound cannot have a location in v11\",\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (!playData.play && this.sequence.softFail) {\n\t\t\treturn new Promise((reject) => {\n\t\t\t\treject();\n\t\t\t});\n\t\t}\n\n\t\tif (!playData?.play) {\n\t\t\tthis.sequence._customError(\n\t\t\t\tthis,\n\t\t\t\t\"Play\",\n\t\t\t\t`File not found: ${playData.src}`,\n\t\t\t);\n\t\t\treturn new Promise((reject) => reject());\n\t\t}\n\n\t\tif (Hooks.call(\"preCreateSequencerSound\", playData) === false) return;\n\n\t\tlet push =\n\t\t\t!(\n\t\t\t\tplayData?.users?.length === 1 && playData?.users?.includes(game.userId)\n\t\t\t) && !this.sequence.localOnly;\n\n\t\tSequencerSoundManager.play(playData, push);\n\n\t\tawait new Promise((resolve) =>\n\t\t\tsetTimeout(resolve, this._currentWaitTime + playData.duration),\n\t\t);\n\t}\n\n\t/**\n\t * @returns {Promise}\n\t * @private\n\t */\n\tasync _sanitizeSoundData() {\n\t\tif (this._deserializedData) {\n\t\t\treturn this._deserializedData;\n\t\t}\n\n\t\tif (!this._file) {\n\t\t\treturn {\n\t\t\t\tplay: false,\n\t\t\t\tsrc: false,\n\t\t\t};\n\t\t}\n\n\t\tlet { file, forcedIndex } = await this._determineFile(this._file);\n\n\t\tif (!file) {\n\t\t\treturn {\n\t\t\t\tplay: false,\n\t\t\t\tsrc: false,\n\t\t\t};\n\t\t}\n\n\t\tif (file instanceof SequencerFileBase) {\n\t\t\tfile.forcedIndex = forcedIndex;\n\t\t\tif (file.timeRange) {\n\t\t\t\t[this._startTime, this._endTime] = file.timeRange;\n\t\t\t\tthis._isRange = true;\n\t\t\t}\n\t\t\tfile = file.getFile();\n\t\t}\n\n\t\tlet soundFile = await SequencerSoundManager.AudioHelper.preloadSound(file);\n\t\tif (!soundFile || soundFile.failed) {\n\t\t\treturn {\n\t\t\t\tplay: false,\n\t\t\t\tsrc: this._file,\n\t\t\t};\n\t\t}\n\t\tlet duration = soundFile.duration * 1000;\n\n\t\tlet startTime =\n\t\t\t(this._startTime\n\t\t\t\t? !this._startPerc\n\t\t\t\t\t? this._startTime\n\t\t\t\t\t: this._startTime * duration\n\t\t\t\t: 0) / 1000;\n\n\t\tif (this._endTime) {\n\t\t\tduration = !this._endPerc\n\t\t\t\t? Number(\n\t\t\t\t\tthis._isRange\n\t\t\t\t\t\t? this._endTime - this._startTime\n\t\t\t\t\t\t: duration - this._endTime,\n\t\t\t\t)\n\t\t\t\t: this._endTime * duration;\n\t\t}\n\n\t\tlet data = {\n\t\t\tid: foundry.utils.randomID(),\n\t\t\tplay: true,\n\t\t\tsrc: file,\n\t\t\tlocation: this._source?.uuid || null,\n\t\t\toffset: this._offset,\n\t\t\trandomOffset: this._randomOffset,\n\t\t\tlocationOptions: this._locationOptions,\n\t\t\tloop: this._duration > duration,\n\t\t\tvolume: this._volume,\n\t\t\tfadeIn: this._fadeInAudio,\n\t\t\tfadeOut: this._fadeOutAudio,\n\t\t\tstartTime: startTime,\n\t\t\tduration: this._duration || duration,\n\t\t\tsceneId: this._source?.parent?.id || game.user.viewedScene,\n\t\t\tusers: this._users ? Array.from(this._users) : null,\n\t\t\tname: this._name,\n\t\t\torigin: this._origin,\n\t\t};\n\n\t\tfor (let override of this._overrides) {\n\t\t\tdata = await override(this, data);\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tasync _serialize() {\n\t\tconst data = await super._serialize();\n\t\tconst sectionData = await this._sanitizeSoundData();\n\t\treturn {\n\t\t\t...data,\n\t\t\ttype: \"sound\",\n\t\t\tsectionData,\n\t\t};\n\t}\n\n\tasync _deserialize(data) {\n\t\tthis._deserializedData = data.sectionData;\n\t\treturn super._deserialize(data);\n\t}\n}\n\nexport default SoundSection;\n","import * as lib from \"../lib/lib.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport Section from \"./section.js\";\nimport traits from \"./traits/_traits.js\";\nimport { sequencerSocket, SOCKET_HANDLERS } from \"../sockets.js\";\n\nclass AnimationSection extends Section {\n  constructor(inSequence, inTarget) {\n    super(inSequence);\n    this._teleportTo = false;\n    this._originObject = false;\n    this._moveSpeed = 23;\n    this._offset = { x: 0, y: 0 };\n    this._closestSquare = false;\n    this._snapToGrid = false;\n    this._hide = undefined;\n    if (inTarget) this.on(inTarget);\n  }\n\n  static niceName = \"Animation\";\n\n  /**\n   * Sets the target object to be animated\n   *\n   * @param {object|string} inTarget\n   * @returns {AnimationSection}\n   */\n  on(inTarget) {\n    inTarget = this._validateLocation(inTarget);\n    if (!inTarget)\n      throw this.sequence._customError(\n        this,\n        \"on\",\n        \"could not find position of given object\"\n      );\n    this._originObject = this._validateLocation(inTarget);\n    return this;\n  }\n\n  /**\n   * Sets the location to teleport the target object to\n   *\n   * @param {object|string} inTarget\n   * @param {object} options\n   * @returns {AnimationSection}\n   */\n  teleportTo(inTarget, options = {}) {\n    options = foundry.utils.mergeObject(\n      {\n        delay: 0,\n        relativeToCenter: false,\n      },\n      options\n    );\n    if (!lib.is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"teleportTo\",\n        \"options.delay must be of type number\"\n      );\n    inTarget = this._validateLocation(inTarget);\n    if (!inTarget)\n      throw this.sequence._customError(\n        this,\n        \"teleportTo\",\n        \"could not find position of given object\"\n      );\n    options.target = this._validateLocation(inTarget);\n    this._teleportTo = options;\n    return this;\n  }\n\n  /**\n   * Sets the location to rotate the object to\n   *\n   * @param {object|string} inLocation\n   * @param {object} options\n   * @returns this\n   */\n  rotateTowards(inLocation, options = {}) {\n    options = foundry.utils.mergeObject(\n      {\n        duration: 0,\n        ease: \"linear\",\n        delay: 0,\n        rotationOffset: 0,\n        towardsCenter: true,\n        cacheLocation: false,\n      },\n      options\n    );\n    if (!lib.is_real_number(options.duration))\n      throw this.sequence._customError(\n        this,\n        \"rotateTowards\",\n        \"options.duration must be of type number\"\n      );\n    if (typeof options.ease !== \"string\")\n      throw this.sequence._customError(\n        this,\n        \"rotateTowards\",\n        \"options.ease must be of type string\"\n      );\n    if (!lib.is_real_number(options.delay))\n      throw this.sequence._customError(\n        this,\n        \"rotateTowards\",\n        \"options.delay must be of type number\"\n      );\n    if (!lib.is_real_number(options.rotationOffset))\n      throw this.sequence._customError(\n        this,\n        \"rotateTowards\",\n        \"options.rotationOffset must be of type number\"\n      );\n    if (typeof options.towardsCenter !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"rotateTowards\",\n        \"options.towardsCenter must be of type boolean\"\n      );\n    if (typeof options.cacheLocation !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"rotateTowards\",\n        \"options.cacheLocation must be of type boolean\"\n      );\n    options.target = this._validateLocation(inLocation);\n    if (!options.target)\n      throw this.sequence._customError(\n        this,\n        \"rotateTowards\",\n        \"could not find position of given object\"\n      );\n    options.target = options.cacheLocation\n      ? canvaslib.get_object_position(options.target, { measure: true })\n      : options.target;\n    this._rotateTowards = options;\n    return this;\n  }\n\n  /**\n   * Causes the movement or teleportation to be offset in the X and/or Y axis\n   *\n   * @param {object} inOffset\n   * @returns {AnimationSection}\n   */\n  offset(inOffset) {\n    inOffset = foundry.utils.mergeObject({ x: 0, y: 0 }, inOffset);\n    this._offset = this._validateLocation(inOffset);\n    return this;\n  }\n\n  /**\n   * Causes the movement or teleportation to pick the closest non-intersecting square, if the target is a token or tile\n   *\n   * @param {boolean} inBool\n   * @returns {AnimationSection}\n   */\n  closestSquare(inBool = true) {\n    if (typeof inBool !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"closestSquare\",\n        \"inBool must be of type boolean\"\n      );\n    this._closestSquare = inBool;\n    return this;\n  }\n\n  /**\n   * Causes the final location to be snapped to the grid\n   *\n   * @param {boolean} inBool\n   * @returns {AnimationSection}\n   */\n  snapToGrid(inBool = true) {\n    if (typeof inBool !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"snapToGrid\",\n        \"inBool must be of type boolean\"\n      );\n    this._snapToGrid = inBool;\n    return this;\n  }\n\n  /**\n   * Causes the object to become hidden\n   *\n   * @param {boolean} inBool\n   * @returns {AnimationSection}\n   */\n  hide(inBool = true) {\n    if (typeof inBool !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"hide\",\n        \"inBool must be of type boolean\"\n      );\n    this._hide = inBool;\n    return this;\n  }\n\n  /**\n   * Causes the object to become visible\n   *\n   * @param {boolean} inBool\n   * @returns {AnimationSection}\n   */\n  show(inBool = true) {\n    if (typeof inBool !== \"boolean\")\n      throw this.sequence._customError(\n        this,\n        \"show\",\n        \"inBool must be of type boolean\"\n      );\n    this._hide = !inBool;\n    return this;\n  }\n\n  /**\n   * @private\n   */\n  async run() {\n    return this._runAnimate();\n  }\n\n  /**\n   * @private\n   */\n  _applyTraits() {\n    Object.assign(this.constructor.prototype, traits.moves);\n    Object.assign(this.constructor.prototype, traits.opacity);\n    Object.assign(this.constructor.prototype, traits.rotation);\n    Object.assign(this.constructor.prototype, traits.audio);\n    Object.assign(this.constructor.prototype, traits.tint);\n  }\n\n  /**\n   * @private\n   */\n  async _updateObject(obj, updates, animate = false, animation = {}) {\n    const uuid = obj?.uuid ?? obj?.document?.uuid;\n    await sequencerSocket.executeAsGM(\n      SOCKET_HANDLERS.UPDATE_DOCUMENT,\n      uuid,\n      updates,\n      { animate, animation }\n    );\n  }\n\n  /**\n   * @private\n   */\n  async _waitForTokenRefresh(obj) {\n    let token;\n\n    if (obj instanceof Token) {\n      token = obj;\n    }\n\n    if (obj instanceof TokenDocument) {\n      token = obj.object;\n    }\n\n    if (token == null || token.mesh != null) {\n      return;\n    }\n\n    let refreshTokenID;\n\n    return await new Promise((resolve) => {\n      refreshTokenID = Hooks.on(\"refreshToken\", async (tokenDoc) => {\n        if (tokenDoc.document.actorId !== token.document.actorId || !token.mesh)\n          return;\n        Hooks.off(\"refreshToken\", refreshTokenID);\n        resolve();\n      });\n    });\n  }\n\n  /**\n   * @private\n   */\n  async _execute() {\n    if (!(await this._shouldPlay())) return;\n    let self = this;\n    this._basicDelay = lib.random_float_between(this._delayMin, this._delayMax);\n    return new Promise(async (resolve) => {\n      setTimeout(async () => {\n        await this._waitForTokenRefresh(this._originObject);\n        if (this._shouldAsync) {\n          await self.run();\n        } else {\n          self.run();\n        }\n        resolve();\n      }, this._basicDelay);\n    });\n  }\n\n  /**\n   * @private\n   */\n  _getClosestSquare(origin, target) {\n    let originLoc = canvaslib.get_object_position(origin, { exact: true });\n    let targetLoc = canvaslib.get_object_position(target, { exact: true });\n\n    let originDimensions = canvaslib.get_object_dimensions(origin);\n    let targetDimensions = canvaslib.get_object_dimensions(target);\n\n    let originBottom = Math.max(\n      originDimensions.width - canvas.grid.size,\n      canvas.grid.size\n    );\n    let originRight = Math.max(\n      originDimensions.height - canvas.grid.size,\n      canvas.grid.size\n    );\n\n    let ray = new Ray(originLoc, targetLoc);\n\n    let dx = ray.dx;\n    let dy = ray.dy;\n\n    if (dx > 0 && Math.abs(dx) > originRight) {\n      dx -= originDimensions.width;\n    } else if (dx < 0 && Math.abs(dx) > targetDimensions.width) {\n      dx += targetDimensions.height;\n    } else {\n      dx = 0;\n    }\n\n    if (dy > 0 && Math.abs(dy) > originBottom) {\n      dy -= originDimensions.height;\n    } else if (dy < 0 && Math.abs(dy) > targetDimensions.height) {\n      dy += targetDimensions.height;\n    } else {\n      dy = 0;\n    }\n\n    const pos = {\n      x: originLoc.x + dx,\n      y: originLoc.y + dy,\n      elevation: targetLoc?.elevation,\n    };\n\n    if (!pos.elevation) {\n      delete pos[\"elevation\"];\n    }\n\n    return pos;\n  }\n\n  /**\n   * @private\n   */\n  _snapLocationToGrid(inLocation) {\n    return canvas.grid.getSnappedPosition(inLocation.x, inLocation.y);\n  }\n\n  /**\n   * This needs a rewrite, jeesus.\n   */\n  async _runAnimate() {\n    let animData = {\n      attributes: [],\n      maxFPS: 1000 / game.settings.get(\"core\", \"maxFPS\"),\n      lastTimespan: performance.now(),\n      totalDt: 0,\n    };\n\n    let overallDuration = this._duration ? this._duration : 0;\n    const originLocation = canvaslib.get_object_position(this._originObject, {\n      exact: true,\n    });\n\n    if (this._rotateTowards) {\n      let offset =\n        (this._angle ? this._angle : 0) + this._rotateTowards.rotationOffset;\n\n      let targetLoc =\n        this._moveTowards?.target ||\n        this._teleportTo?.target ||\n        this._originObject;\n\n      targetLoc = this._closestSquare\n        ? this._getClosestSquare(this._originObject, targetLoc)\n        : canvaslib.get_object_position(targetLoc, { exact: true });\n\n      targetLoc.x += this._offset.x;\n      targetLoc.y += this._offset.y;\n\n      if (this._snapToGrid) {\n        targetLoc = this._snapLocationToGrid(targetLoc);\n      }\n\n      if (this._originObject instanceof TokenDocument) {\n        setTimeout(async () => {\n          let startLocation = this._originObject.object?.center ?? targetLoc;\n          let targetLocation =\n            this._rotateTowards.target?.object ?? this._rotateTowards.target;\n          if (this._rotateTowards.towardsCenter) {\n            targetLocation = targetLocation?.center ?? targetLocation;\n          }\n          let ray = new Ray(startLocation, targetLocation);\n          let angle = Math.normalizeDegrees((ray.angle * 180) / Math.PI - 90);\n          angle += offset;\n          await this._updateObject(\n            this._originObject,\n            { rotation: angle },\n            this._rotateTowards.duration > 0,\n            {\n              duration: this._rotateTowards.duration,\n              easing: this._rotateTowards.ease,\n            }\n          );\n        }, this._rotateTowards.delay ?? 0);\n      } else {\n        animData.attributes.push({\n          name: \"rotationTowards\",\n          offset: offset,\n          origin: this._originObject,\n          originLocation: targetLoc,\n          target:\n            this._rotateTowards.target?.object ?? this._rotateTowards.target,\n          towardsCenter: this._rotateTowards.towardsCenter,\n          from: false,\n          to: false,\n          progress: 0,\n          done: false,\n          duration: this._rotateTowards.duration,\n          durationDone: 0,\n          delay: this._rotateTowards.delay,\n          ease: this._rotateTowards.ease,\n        });\n      }\n\n      let rotateDuration =\n        this._rotateTowards.duration + this._rotateTowards.delay;\n\n      overallDuration =\n        overallDuration > rotateDuration ? overallDuration : rotateDuration;\n    }\n\n    if (this._fadeIn) {\n      let to = lib.is_real_number(this._opacity) ? this._opacity : 1.0;\n\n      if (this._originObject instanceof TokenDocument) {\n        setTimeout(async () => {\n          await this._updateObject(this._originObject, { alpha: to }, true, {\n            duration: this._fadeIn.duration,\n            easing: this._fadeIn.ease,\n          });\n        }, this._fadeIn.delay ?? 0);\n      } else {\n        animData.attributes.push({\n          name: \"alpha\",\n          from: 0.0,\n          to: to,\n          progress: 0,\n          done: false,\n          duration: this._fadeIn.duration,\n          durationDone: 0,\n          delay: this._fadeIn.delay,\n          ease: this._fadeIn.ease,\n        });\n      }\n\n      let fadeDuration = this._fadeIn.duration + this._fadeIn.delay;\n\n      overallDuration =\n        overallDuration > fadeDuration ? overallDuration : fadeDuration;\n    }\n\n    if (this._fadeInAudio && this._originObject?.video?.volume !== undefined) {\n      let to = lib.is_real_number(this._volume) ? this._volume : 1.0;\n\n      animData.attributes.push({\n        name: \"video.volume\",\n        from: 0.0,\n        to: to,\n        progress: 0,\n        done: false,\n        duration: this._fadeInAudio.duration,\n        durationDone: 0,\n        delay: this._fadeInAudio.delay,\n        ease: this._fadeInAudio.ease,\n      });\n\n      let fadeDuration = this._fadeInAudio.duration + this._fadeInAudio.delay;\n\n      overallDuration =\n        overallDuration > fadeDuration ? overallDuration : fadeDuration;\n    }\n\n    if (this._rotateIn) {\n      let from = this._angle ? this._angle : this._originObject.rotation;\n      let to = this._rotateIn.value;\n\n      if (Math.abs(from - to) > 180) {\n        if (to < 0) {\n          to += 360;\n        } else if (from > to) {\n          from -= 360;\n        }\n      }\n\n      if (this._originObject instanceof TokenDocument) {\n        setTimeout(async () => {\n          if (this._originObject.rotation !== from) {\n            await this._updateObject(\n              this._originObject,\n              { rotation: from },\n              false\n            );\n          }\n          await this._updateObject(this._originObject, { rotation: to }, true, {\n            duration: this._rotateIn.duration,\n            easing: this._rotateIn.ease,\n          });\n        }, this._rotateIn.delay ?? 0);\n      } else {\n        animData.attributes.push({\n          name: \"rotation\",\n          from: from,\n          to: to,\n          progress: 0,\n          done: false,\n          duration: this._rotateIn.duration,\n          durationDone: 0,\n          delay: this._rotateIn.delay,\n          ease: this._rotateIn.ease,\n        });\n      }\n\n      let rotateDuration = this._rotateIn.duration + this._rotateIn.delay;\n\n      overallDuration =\n        overallDuration > rotateDuration ? overallDuration : rotateDuration;\n    }\n\n    if (this._moveTowards) {\n      let originLocation = canvaslib.get_object_position(this._originObject, {\n        exact: true,\n      });\n      let targetLocation = this._closestSquare\n        ? this._getClosestSquare(this._originObject, this._moveTowards.target)\n        : canvaslib.get_object_position(this._moveTowards.target, {\n            exact: true,\n          });\n\n      targetLocation.x += this._offset.x;\n      targetLocation.y += this._offset.y;\n      targetLocation.elevation =\n        targetLocation?.elevation ?? this._originObject?.elevation;\n\n      if (this._moveTowards.relativeToCenter) {\n        const dimensions = canvaslib.get_object_dimensions(this._originObject);\n        targetLocation.x -= dimensions.width / 2;\n        targetLocation.y -= dimensions.height / 2;\n        if (this._snapToGrid) {\n          targetLocation.x -= 0.01;\n          targetLocation.y -= 0.01;\n        }\n      }\n\n      if (this._snapToGrid) {\n        targetLocation = this._snapLocationToGrid(targetLocation);\n      }\n\n      let originalDx = targetLocation.x - originLocation.x;\n      let originalDy = targetLocation.y - originLocation.y;\n      let originalDistance = Math.sqrt(\n        originalDx * originalDx + originalDy * originalDy\n      );\n\n      let duration = this._duration\n        ? this._duration\n        : (originalDistance / this._moveSpeed) * animData.maxFPS;\n\n      let moveDuration = duration + this._moveTowards.delay;\n\n      overallDuration =\n        overallDuration > moveDuration ? overallDuration : moveDuration;\n\n      if (this._originObject instanceof TokenDocument) {\n        setTimeout(async () => {\n          await this._updateObject(this._originObject, targetLocation, true, {\n            movementSpeed: this._moveSpeed,\n            duration,\n            easing: this._moveTowards.ease,\n          });\n        }, this._moveTowards.delay ?? 0);\n      } else {\n        if (!(duration === 0 || originalDistance === 0)) {\n          animData.attributes.push({\n            name: \"position\",\n            origin: originLocation,\n            target: targetLocation,\n            originalDistance: originalDistance,\n            currentDistance: 0,\n            progress: 0,\n            speed: 0,\n            duration: duration,\n            done: false,\n            ease: this._moveTowards.ease,\n            delay: this._moveTowards.delay,\n          });\n        }\n      }\n    }\n\n    if (this._fadeOut) {\n      let from = lib.is_real_number(this._opacity)\n        ? this._opacity\n        : this._originObject.alpha ?? 1.0;\n\n      if (this._originObject instanceof TokenDocument) {\n        setTimeout(async () => {\n          await this._updateObject(this._originObject, { alpha: 0 }, true, {\n            duration: this._fadeOut.duration,\n            easing: this._fadeOut.ease,\n          });\n        }, this._fadeOut.delay ?? 0);\n      } else {\n        animData.attributes.push({\n          name: \"alpha\",\n          from: from,\n          to: 0.0,\n          progress: 0,\n          done: false,\n          duration: this._fadeOut.duration,\n          durationDone: 0,\n          delay: overallDuration - this._fadeOut.duration,\n          ease: this._fadeOut.ease,\n        });\n      }\n\n      let fadeOutDuration = this._fadeOut.duration + this._fadeOut.delay;\n\n      overallDuration =\n        overallDuration > fadeOutDuration ? overallDuration : fadeOutDuration;\n    }\n\n    if (this._fadeOutAudio && this._originObject?.video?.volume !== undefined) {\n      let from = lib.is_real_number(this._volume)\n        ? this._volume\n        : this._originObject.video.volume;\n\n      animData.attributes.push({\n        name: \"video.volume\",\n        from: from,\n        to: 0.0,\n        progress: 0,\n        done: false,\n        duration: this._fadeOutAudio.duration,\n        durationDone: 0,\n        delay: overallDuration - this._fadeOutAudio.duration,\n        ease: this._fadeOutAudio.ease,\n      });\n\n      let fadeOutAudioDuration =\n        this._fadeOutAudio.duration + this._fadeOutAudio.delay;\n\n      overallDuration =\n        overallDuration > fadeOutAudioDuration\n          ? overallDuration\n          : fadeOutAudioDuration;\n    }\n\n    if (this._rotateOut) {\n      let from = this._rotateOut.value;\n      let to = this._angle ? this._angle : this._originObject.rotation;\n\n      if (this._rotateIn) from += this._rotateIn.value;\n\n      if (Math.abs(from - to) > 180) {\n        if (to < 0) {\n          to += 360;\n        } else if (from > to) {\n          from -= 360;\n        }\n      }\n\n      if (this._originObject instanceof TokenDocument) {\n        setTimeout(async () => {\n          if (this._originObject.rotation !== from) {\n            await this._updateObject(\n              this._originObject,\n              { rotation: from },\n              false\n            );\n          }\n          await this._updateObject(this._originObject, { rotation: to }, true, {\n            duration: this._rotateOut.duration,\n            easing: this._rotateOut.ease,\n          });\n        }, this._rotateOut.delay ?? 0);\n      } else {\n        animData.attributes.push({\n          name: \"rotation\",\n          from: from,\n          to: to,\n          progress: 0,\n          done: false,\n          duration: this._rotateOut.duration,\n          durationDone: 0,\n          delay: overallDuration - this._rotateOut.duration,\n          ease: this._rotateOut.ease,\n        });\n      }\n\n      let rotateOutDuration = this._rotateOut.duration + this._rotateOut.delay;\n\n      overallDuration =\n        overallDuration > rotateOutDuration\n          ? overallDuration\n          : rotateOutDuration;\n    }\n\n    if (this._teleportTo) {\n      setTimeout(async () => {\n        let targetLocation = this._closestSquare\n          ? this._getClosestSquare(this._originObject, this._teleportTo.target)\n          : canvaslib.get_object_position(this._teleportTo.target, {\n              exact: true,\n            });\n        if (targetLocation.x === undefined) targetLocation.x = originLocation.x;\n        if (targetLocation.y === undefined) targetLocation.y = originLocation.y;\n        if (targetLocation.elevation === undefined)\n          targetLocation.elevation = originLocation.elevation;\n        targetLocation.x += this._offset.x;\n        targetLocation.y += this._offset.y;\n        targetLocation.elevation =\n          targetLocation?.elevation ?? this._originObject?.elevation;\n        const dimensions = canvaslib.get_object_dimensions(this._originObject);\n        if (this._teleportTo.relativeToCenter) {\n          targetLocation.x -= dimensions.width / 2;\n          targetLocation.y -= dimensions.height / 2;\n          if (this._snapToGrid) {\n            targetLocation.x -= 0.01;\n            targetLocation.y -= 0.01;\n          }\n        }\n        if (this._snapToGrid) {\n          targetLocation.x -= dimensions.width / 2;\n          targetLocation.y -= dimensions.height / 2;\n          targetLocation = this._snapLocationToGrid(targetLocation);\n        }\n        await this._updateObject(this._originObject, targetLocation, false);\n      }, this._teleportTo.delay);\n      if (overallDuration <= this._teleportTo.delay) {\n        this._waitUntilFinished = true;\n      }\n      overallDuration =\n        overallDuration > this._teleportTo.delay\n          ? overallDuration\n          : this._teleportTo.delay;\n    }\n\n    let updateAttributes = {};\n    if (\n      lib.is_real_number(this._angle) &&\n      !this._rotateIn &&\n      !this._rotateOut\n    ) {\n      updateAttributes[\"rotation\"] = this._angle;\n    }\n\n    if (lib.is_real_number(this._opacity) && !this._fadeIn && !this._fadeOut) {\n      updateAttributes[\"alpha\"] = this._opacity;\n    }\n\n    if (\n      lib.is_real_number(this._volume) &&\n      !this._fadeInAudio &&\n      !this._fadeOutAudio &&\n      this._originObject?.video?.volume !== undefined\n    ) {\n      updateAttributes[\"video.volume\"] = this._volume;\n    }\n\n    if (this._tint) {\n      updateAttributes[\"tint\"] = this._tint.hexadecimal;\n    }\n\n    if (this._hide !== undefined) {\n      updateAttributes[\"hidden\"] = this._hide;\n    }\n\n    if (Object.keys(updateAttributes).length) {\n      await lib.wait(1);\n      await this._updateObject(this._originObject, updateAttributes);\n      await lib.wait(1);\n    }\n\n    return new Promise(async (resolve) => {\n      this._animate(animData, resolve);\n      setTimeout(\n        resolve,\n        Math.max(0, overallDuration + this._currentWaitTime + animData.maxFPS)\n      );\n    });\n  }\n\n  /**\n   * @private\n   */\n  async _animate(animData, resolve, timespan) {\n    // If it's not the first tick\n    if (timespan) {\n      let animatedAttributes = {};\n\n      let dt = timespan - animData.lastTimespan;\n\n      // Limit to set FPS\n      if (dt >= animData.maxFPS) {\n        animData.totalDt += dt;\n\n        for (let attribute of animData.attributes) {\n          if (attribute.done) continue;\n\n          if (animData.totalDt < attribute.delay) continue;\n\n          if (attribute.name === \"position\") {\n            attribute.speed =\n              attribute.originalDistance / (attribute.duration / dt);\n\n            attribute.currentDistance += attribute.speed;\n\n            attribute.progress =\n              attribute.currentDistance / attribute.originalDistance;\n\n            let x = lib.interpolate(\n              attribute.origin.x,\n              attribute.target.x,\n              attribute.progress,\n              attribute.ease\n            );\n            let y = lib.interpolate(\n              attribute.origin.y,\n              attribute.target.y,\n              attribute.progress,\n              attribute.ease\n            );\n\n            if (attribute.currentDistance >= attribute.originalDistance) {\n              x = attribute.target.x;\n              y = attribute.target.y;\n              attribute.done = true;\n            }\n\n            animatedAttributes[\"x\"] = x;\n            animatedAttributes[\"y\"] = y;\n          } else {\n            if (\n              attribute.name === \"rotationTowards\" &&\n              !attribute.from &&\n              !attribute.to\n            ) {\n              let target = attribute.target;\n              if (this._rotateTowards.towardsCenter)\n                target = target?.center ?? target;\n              let ray = new Ray(attribute.originLocation, target);\n              let angle = (ray.angle * 180) / Math.PI - 90;\n              angle += attribute.offset;\n              attribute.from = attribute.origin.rotation;\n              attribute.to = angle;\n              if (Math.abs(attribute.from - attribute.to) > 180) {\n                if (attribute.to < 0) {\n                  attribute.to += 360;\n                } else if (attribute.from > attribute.to) {\n                  attribute.from -= 360;\n                }\n              }\n              attribute.name = \"rotation\";\n            }\n\n            attribute.durationDone += dt;\n\n            attribute.progress = attribute.durationDone / attribute.duration;\n\n            let val = lib.interpolate(\n              attribute.from,\n              attribute.to,\n              attribute.progress,\n              attribute.ease\n            );\n\n            if (attribute.progress >= 1.0) {\n              val = attribute.to;\n              attribute.done = true;\n            }\n\n            animatedAttributes[attribute.name] = val;\n          }\n        }\n\n        if (Object.keys(animatedAttributes).length > 0) {\n          await this._updateObject(this._originObject, animatedAttributes);\n        }\n\n        animData.attributes = animData.attributes.filter((a) => !a.done);\n\n        if (animData.attributes.length === 0) return;\n\n        animData.lastTimespan = timespan;\n      }\n    }\n\n    let self = this;\n    requestAnimationFrame(function (timespan) {\n      self._animate(animData, resolve, timespan);\n    });\n  }\n}\n\nexport default AnimationSection;\n","import Section from \"./section.js\";\nimport traits from \"./traits/_traits.js\";\nimport * as lib from \"../lib/lib.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport SequencerFoundryReplicator from \"../modules/sequencer-foundry-replicator.js\";\n\nexport default class ScrollingTextSection extends Section {\n  constructor(inSequence, target, text, textOptions) {\n    super(inSequence);\n    this._deserializedData = null;\n    this._source = null;\n    this._text = \"\";\n    this._duration = 2000;\n    this._distance = null;\n    this._jitter = 0;\n    this._anchor = null;\n    this._direction = null;\n    this._seed = lib.get_hash(foundry.utils.randomID());\n    if (target) {\n      this.atLocation(target);\n    }\n    if (text) {\n      this.text(text, textOptions);\n    }\n  }\n\n  static niceName = \"Scrolling Text\";\n\n  /**\n   * @private\n   */\n  _applyTraits() {\n    Object.assign(this.constructor.prototype, traits.users);\n    Object.assign(this.constructor.prototype, traits.location);\n    Object.assign(this.constructor.prototype, traits.offset);\n    Object.assign(this.constructor.prototype, traits.text);\n  }\n\n  direction(inDirection) {\n    if (!(typeof inDirection === \"string\" || lib.is_real_number(inDirection))) {\n      throw this.sequence._customError(\n        this,\n        \"direction\",\n        \"inDirection must be of type string (CONST.TEXT_ANCHOR_POINTS) or number\"\n      );\n    }\n    if (\n      typeof inDirection === \"string\" &&\n      !CONST.TEXT_ANCHOR_POINTS[inDirection]\n    ) {\n      throw this.sequence._customError(\n        this,\n        \"direction\",\n        `${inDirection} does not exist in CONST.TEXT_ANCHOR_POINTS!`\n      );\n    } else if (typeof inDirection === \"string\") {\n      this._direction = CONST.TEXT_ANCHOR_POINTS[inDirection];\n    } else {\n      this._direction = inDirection;\n    }\n    return this;\n  }\n\n  anchor(inAnchor) {\n    if (!(typeof inAnchor === \"string\" || lib.is_real_number(inAnchor))) {\n      throw this.sequence._customError(\n        this,\n        \"direction\",\n        \"inAnchor must be of type string (CONST.TEXT_ANCHOR_POINTS) or number\"\n      );\n    }\n    if (\n      (typeof inAnchor === \"string\" && !CONST.TEXT_ANCHOR_POINTS[inAnchor]) ||\n      (lib.is_real_number(inAnchor) &&\n        !Object.values(CONST.TEXT_ANCHOR_POINTS).includes(inAnchor))\n    ) {\n      throw this.sequence._customError(\n        this,\n        \"direction\",\n        `${inAnchor} does not exist in CONST.TEXT_ANCHOR_POINTS!`\n      );\n    } else if (typeof inAnchor === \"string\") {\n      this._anchor = CONST.TEXT_ANCHOR_POINTS[inAnchor];\n    } else {\n      this._anchor = inAnchor;\n    }\n    return this;\n  }\n\n  jitter(inJitter) {\n    if (!(lib.is_real_number(inJitter) && inJitter >= 0 && inJitter <= 1.0)) {\n      throw this.sequence._customError(\n        this,\n        \"jitter\",\n        \"inJitter must be of type number between 0 and 1\"\n      );\n    }\n    this._jitter = inJitter;\n    return this;\n  }\n\n  async run() {\n    const data = await this._sanitizeTextData();\n    if (Hooks.call(\"preCreateScrollingText\", data) === false) return;\n    const push =\n      !(data?.users?.length === 1 && data?.users?.includes(game.userId)) &&\n      !this.sequence.localOnly;\n    const duration = SequencerFoundryReplicator.playScrollingText(data, push);\n    await new Promise((resolve) =>\n      setTimeout(resolve, this._currentWaitTime + duration)\n    );\n  }\n\n  _getSourceObject() {\n    if (!this._source || typeof this._source !== \"object\") return this._source;\n    return (\n      lib.get_object_identifier(this._source) ??\n      canvaslib.get_object_canvas_data(this._source)\n    );\n  }\n\n  async _sanitizeTextData() {\n    if (this._deserializedData) {\n      return this._deserializedData;\n    }\n\n    return {\n      sceneId: game.user.viewedScene,\n      seed: this._seed,\n      sequenceId: this.sequence.id,\n      creatorUserId: game.userId,\n      users: this._users ? Array.from(this._users) : false,\n      moduleName: this.sequence.moduleName,\n      source: this._getSourceObject(),\n      offset: this._offset?.source ?? false,\n      randomOffset: this._randomOffset?.source ?? false,\n      content: this._text?.text ?? \"\",\n      options: {\n        anchor: this._anchor,\n        direction: this._direction,\n        duration: this._duration,\n        distance: this._distance,\n        jitter: this._jitter,\n        ...this._text,\n      },\n    };\n  }\n\n  async _serialize() {\n    const data = await super._serialize();\n    const sectionData = await this._sanitizeTextData();\n    return {\n      ...data,\n      type: \"scrollingText\",\n      sectionData,\n    };\n  }\n\n  async _deserialize(data) {\n    this._deserializedData = data.sectionData;\n    return super._deserialize(data);\n  }\n}\n","import Section from \"./section.js\";\nimport traits from \"./traits/_traits.js\";\nimport * as lib from \"../lib/lib.js\";\nimport { is_real_number } from \"../lib/lib.js\";\nimport * as canvaslib from \"../lib/canvas-lib.js\";\nimport SequencerFoundryReplicator from \"../modules/sequencer-foundry-replicator.js\";\n\nexport default class CanvasPanSection extends Section {\n  constructor(inSequence, target, duration, scale) {\n    super(inSequence);\n    this._deserializedData = null;\n    this._source = null;\n    this._duration = duration ?? 250;\n    this._speed = null;\n    this._scale = scale ?? 1.0;\n    this._lockView = null;\n    this._shake = null;\n    this._seed = lib.get_hash(foundry.utils.randomID());\n    if (target) {\n      this.atLocation(target);\n    }\n  }\n\n  static niceName = \"Canvas Pan\";\n\n  /**\n   * @private\n   */\n  _applyTraits() {\n    Object.assign(this.constructor.prototype, traits.users);\n    Object.assign(this.constructor.prototype, traits.location);\n    Object.assign(this.constructor.prototype, traits.offset);\n  }\n\n  /**\n   * Sets the speed (pixels per frame) of the canvas pan\n   *\n   * @param {number} inSpeed\n   * @returns this\n   */\n  speed(inSpeed) {\n    if (!is_real_number(inSpeed))\n      throw this.sequence._customError(\n        this,\n        \"speed\",\n        \"inSpeed must be of type number\"\n      );\n    if (inSpeed < 0) {\n      throw this.sequence._customError(\n        this,\n        \"speed\",\n        \"inSpeed must be greater or equal to 0\"\n      );\n    }\n    this._speed = inSpeed;\n    return this;\n  }\n\n  /**\n   * Sets the zoom level of the canvas pan\n   *\n   * @param {number} inScale\n   * @returns this\n   */\n  scale(inScale) {\n    if (!is_real_number(inScale))\n      throw this.sequence._customError(\n        this,\n        \"scale\",\n        \"inScale must be of type number\"\n      );\n    if (inScale <= 0) {\n      throw this.sequence._customError(\n        this,\n        \"scale\",\n        \"inScale must be greater than 0\"\n      );\n    }\n    this._scale = inScale;\n    return this;\n  }\n\n  /**\n   * Locks the canvas at the given location for the given duration\n   *\n   * @param {number} inDuration\n   * @returns this\n   */\n  lockView(inDuration) {\n    if (!is_real_number(inDuration))\n      throw this.sequence._customError(\n        this,\n        \"lockView\",\n        \"inDuration must be of type number\"\n      );\n    if (inDuration < 0) {\n      throw this.sequence._customError(\n        this,\n        \"lockView\",\n        \"inDuration must be greater or equal to 0\"\n      );\n    }\n    this._lockView = inDuration;\n    return this;\n  }\n\n  /**\n   * Shakes the canvas\n   *\n   * @param {number} duration\n   * @param {number} strength\n   * @param {number} frequency\n   * @param {number} fadeInDuration\n   * @param {number} fadeOutDuration\n   * @param {boolean} rotation\n   * @returns this\n   */\n  shake({\n    duration = 250,\n    strength = 20,\n    frequency = 10,\n    fadeInDuration = 0,\n    fadeOutDuration = 200,\n    rotation = true,\n  } = {}) {\n    if (!is_real_number(duration)) {\n      throw this.sequence._customError(\n        this,\n        \"shake\",\n        \"duration must be of type number\"\n      );\n    }\n    if (!is_real_number(strength)) {\n      throw this.sequence._customError(\n        this,\n        \"shake\",\n        \"strength must be of type number\"\n      );\n    }\n    if (!is_real_number(strength)) {\n      throw this.sequence._customError(\n        this,\n        \"shake\",\n        \"frequency must be of type number\"\n      );\n    }\n    if (!is_real_number(fadeInDuration)) {\n      throw this.sequence._customError(\n        this,\n        \"shake\",\n        \"fadeInDuration must be of type number\"\n      );\n    }\n    if (!is_real_number(fadeOutDuration)) {\n      throw this.sequence._customError(\n        this,\n        \"shake\",\n        \"fadeOutDuration must be of type number\"\n      );\n    }\n    if (typeof rotation !== \"boolean\") {\n      throw this.sequence._customError(\n        this,\n        \"shake\",\n        \"rotation must be of type boolean\"\n      );\n    }\n    this._shake = {\n      duration,\n      strength,\n      frequency,\n      fadeInDuration,\n      fadeOutDuration,\n      rotation,\n    };\n    return this;\n  }\n\n  async run() {\n    const data = await this._sanitizeData();\n    if (Hooks.call(\"preCanvasPan\", data) === false) return;\n    const push =\n      !(data?.users?.length === 1 && data?.users?.includes(game.userId)) &&\n      !this.sequence.localOnly;\n    const duration = SequencerFoundryReplicator.panCanvas(data, push);\n    await new Promise((resolve) =>\n      setTimeout(resolve, this._currentWaitTime + duration)\n    );\n  }\n\n  _getSourceObject() {\n    if (!this._source || typeof this._source !== \"object\") return this._source;\n    return (\n      lib.get_object_identifier(this._source) ??\n      canvaslib.get_object_canvas_data(this._source)\n    );\n  }\n\n  async _sanitizeData() {\n    if (this._deserializedData) {\n      return this._deserializedData;\n    }\n\n    return {\n      sceneId: game.user.viewedScene,\n      seed: this._seed,\n      sequenceId: this.sequence.id,\n      creatorUserId: game.userId,\n      users: this._users ? Array.from(this._users) : false,\n      moduleName: this.sequence.moduleName,\n      source: this._getSourceObject(),\n      offset: this._offset?.source ?? false,\n      randomOffset: this._randomOffset?.source ?? false,\n      duration: this._duration,\n      speed: this._speed,\n      scale: this._scale,\n      lockView: this._lockView,\n      shake: this._shake,\n    };\n  }\n\n  async _serialize() {\n    const data = await super._serialize();\n    const sectionData = await this._sanitizeData();\n    return {\n      ...data,\n      type: \"canvasPan\",\n      sectionData,\n    };\n  }\n\n  async _deserialize(data) {\n    this._deserializedData = data.sectionData;\n    return super._deserialize(data);\n  }\n}\n","import * as lib from \"../lib/lib.js\";\nimport Section from \"./section.js\";\n\nexport default class WaitSection extends Section {\n  constructor(inSequence, msMin, msMax) {\n    super(inSequence);\n    this._waitUntilFinished = true;\n    this._waitDuration = lib.random_int_between(msMin, Math.max(msMin, msMax));\n  }\n\n  static niceName = \"Wait\";\n\n  /**\n   * @returns {Promise<void>}\n   */\n  async run() {\n    lib.debug(\"Running wait\");\n    await new Promise(async (resolve) => {\n      setTimeout(resolve, this._waitDuration);\n    });\n  }\n\n  /**\n   * @returns {Promise}\n   * @private\n   */\n  async _execute() {\n    await this.run();\n  }\n\n  async _serialize() {\n    const data = await super._serialize();\n    return {\n      ...data,\n      type: \"wait\",\n      sectionData: {\n        waitDuration: this._waitDuration,\n      },\n    };\n  }\n\n  async _deserialize(data) {\n    this._waitDuration = data.sectionData.waitDuration;\n    return super._deserialize(data);\n  }\n}\n","import * as lib from \"../lib/lib.js\";\nimport FunctionSection from \"../sections/func.js\";\nimport EffectSection from \"../sections/effect.js\";\nimport SoundSection from \"../sections/sound.js\";\nimport AnimationSection from \"../sections/animation.js\";\nimport Section from \"../sections/section.js\";\nimport SequencerPresets from \"./sequencer-presets.js\";\nimport ScrollingTextSection from \"../sections/scrollingText.js\";\nimport { sequencerSocket, SOCKET_HANDLERS } from \"../sockets.js\";\nimport CanvasPanSection from \"../sections/canvasPan.js\";\nimport SequenceManager from \"./sequence-manager.js\";\nimport { get, writable } from \"svelte/store\";\nimport CONSTANTS from \"../constants.js\";\nimport WaitSection from \"../sections/wait.js\";\n\nexport default class Sequence {\n\tconstructor(\n\t\toptions = {\n\t\t\tmoduleName: \"Sequencer\",\n\t\t\tsoftFail: false,\n\t\t},\n\t\tsoftFail = false\n\t) {\n\t\tthis.id = foundry.utils.randomID();\n\t\tthis.moduleName =\n\t\t\ttypeof options === \"string\"\n\t\t\t\t? options\n\t\t\t\t: options?.moduleName ?? \"Sequencer\";\n\t\tthis.softFail = options?.softFail ?? softFail;\n\t\tthis.sections = [];\n\t\tthis.nameOffsetMap = false;\n\t\tthis.effectIndex = 0;\n\t\tthis.sectionToCreate = undefined;\n\t\tthis.localOnly = false;\n\t\tthis._status = writable(CONSTANTS.STATUS.READY);\n\t\treturn lib.sequence_proxy_wrap(this);\n\t}\n\n\t/**\n\t * Plays all of this sequence's sections\n\t *\n\t * @returns {Promise}\n\t */\n\tasync play({ remote = false, preload = false, local = false } = {}) {\n\t\tthis.localOnly = local || remote;\n\t\tif (remote) {\n\t\t\tconst data = await this.toJSON();\n\t\t\tsequencerSocket.executeForOthers(\n\t\t\t\tSOCKET_HANDLERS.RUN_SEQUENCE_LOCALLY,\n\t\t\t\tdata\n\t\t\t);\n\t\t\treturn new Sequence().fromJSON(data).play();\n\t\t}\n\t\tHooks.callAll(\"createSequencerSequence\", this);\n\t\tlib.debug(\"Initializing sections\");\n\t\tconst initializationPromises = this.sections.map((section) => section._initialize())\n\t\tawait Promise.allSettled(initializationPromises)\n\t\tif (preload) {\n\t\t\tconst preloadFiles = this.sections.filter(section => !!section._file).map(section => section._file)\n\t\t\tif(local) {\n\t\t\t\tawait Sequencer.Preloader.preload(preloadFiles)\n\t\t\t}else {\n\t\t\t\tawait Sequencer.Preloader.preloadForClients(preloadFiles)\n\t\t\t}\n\t\t}\n\t\tSequenceManager.RunningSequences.add(this.id, this);\n\t\tthis.effectIndex = 0;\n\t\tlib.debug(\"Playing sections\");\n\t\tthis.status = CONSTANTS.STATUS.RUNNING;\n\t\tconst promises = [];\n\t\tfor (let section of this.sections) {\n\t\t\tif (section instanceof EffectSection) this.effectIndex++;\n\t\t\tif (section.shouldWaitUntilFinished) {\n\t\t\t\tpromises.push(await section._execute());\n\t\t\t} else {\n\t\t\t\tpromises.push(section._execute());\n\t\t\t}\n\t\t\tif (this.status === CONSTANTS.STATUS.ABORTED) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (!section._isLastSection) {\n\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 1));\n\t\t\t}\n\t\t}\n\n\t\treturn Promise.allSettled(promises).then(() => {\n\t\t\tHooks.callAll(\"endedSequencerSequence\");\n\t\t\tlib.debug(\"Finished playing sections\");\n\t\t\tthis.status = CONSTANTS.STATUS.COMPLETE;\n\t\t});\n\t}\n\n\t/**\n\t * Creates a section that will run a function.\n\t *\n\t * @param {function} inFunc\n\t * @returns {Sequence} this\n\t */\n\tthenDo(inFunc) {\n\t\tconst func = lib.section_proxy_wrap(new FunctionSection(this, inFunc));\n\t\tthis.sections.push(func);\n\t\treturn func;\n\t}\n\n\t/**\n\t * Creates a section that will run a macro based on a name or a direct reference to a macro.\n\t *\n\t * @param {string|Macro} inMacro\n\t * @param {object} args\n\t * @returns {Sequence} this\n\t */\n\tmacro(inMacro, ...args) {\n\t\tlet macro;\n\t\tlet compendium = false;\n\t\tif (typeof inMacro === \"string\") {\n\t\t\tif (inMacro.startsWith(\"Compendium\")) {\n\t\t\t\tlet packArray = inMacro.split(\".\");\n\t\t\t\tlet pack = game.packs.get(`${packArray[1]}.${packArray[2]}`);\n\t\t\t\t// Catch invalid compendium pack\n\t\t\t\tif (!pack) {\n\t\t\t\t\tif (this.softFail) {\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t}\n\t\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\t\tthis.moduleName,\n\t\t\t\t\t\t`macro - Compendium '${packArray[1]}.${packArray[2]}' was not found`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tmacro = packArray;\n\t\t\t\tcompendium = pack;\n\t\t\t} else {\n\t\t\t\tmacro = game.macros.getName(inMacro);\n\t\t\t\tif (!macro) {\n\t\t\t\t\tif (this.softFail) {\n\t\t\t\t\t\treturn this;\n\t\t\t\t\t}\n\t\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\t\tthis.moduleName,\n\t\t\t\t\t\t`macro - Macro '${inMacro}' was not found`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (inMacro instanceof Macro) {\n\t\t\tmacro = inMacro;\n\t\t} else {\n\t\t\tthrow lib.custom_error(\n\t\t\t\tthis.moduleName,\n\t\t\t\t`macro - inMacro must be of instance string or Macro`\n\t\t\t);\n\t\t}\n\n\t\targs = args.length ? args?.[0] : {};\n\t\tif (typeof args !== \"object\") {\n\t\t\tthrow lib.custom_error(\n\t\t\t\tthis.moduleName,\n\t\t\t\t`macro - Secondary argument must be an object`\n\t\t\t);\n\t\t}\n\n\t\tconst func = lib.section_proxy_wrap(\n\t\t\tnew FunctionSection(\n\t\t\t\tthis,\n\t\t\t\tasync () => {\n\t\t\t\t\tif (compendium) {\n\t\t\t\t\t\tconst macroData = (await compendium.getDocuments())\n\t\t\t\t\t\t\t.find((i) => i.name === macro[3])\n\t\t\t\t\t\t\t?.toObject();\n\t\t\t\t\t\tif (!macroData) {\n\t\t\t\t\t\t\tif (this.softFail) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthrow lib.custom_error(\n\t\t\t\t\t\t\t\tthis.moduleName,\n\t\t\t\t\t\t\t\t`macro - Macro '${macro[3]}' was not found in compendium '${macro[1]}.${macro[2]}'`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmacro = new Macro(macroData);\n\t\t\t\t\t\tmacro.ownership.default = CONST.DOCUMENT_OWNERSHIP_LEVELS.OWNER;\n\t\t\t\t\t}\n\n\t\t\t\t\tawait macro.execute(args);\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t)\n\t\t);\n\t\tthis.sections.push(func);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Creates an effect section. Until you call .then(), .effect(), .sound(), or .wait(), you'll be working on the Effect section.\n\t *\n\t * @param {string} [inFile] inFile\n\t * @returns {Section}\n\t */\n\teffect(inFile = \"\") {\n\t\tconst effect = lib.section_proxy_wrap(new EffectSection(this, inFile));\n\t\tthis.sections.push(effect);\n\t\treturn effect;\n\t}\n\n\t/**\n\t * Creates a sound section. Until you call .then(), .effect(), .sound(), or .wait(), you'll be working on the Sound section.\n\t *\n\t * @param {string} [inFile] inFile\n\t * @returns {Section}\n\t */\n\tsound(inFile = \"\") {\n\t\tconst sound = lib.section_proxy_wrap(new SoundSection(this, inFile));\n\t\tthis.sections.push(sound);\n\t\treturn sound;\n\t}\n\n\t/**\n\t * Creates an animation. Until you call .then(), .effect(), .sound(), or .wait(), you'll be working on the Animation section.\n\t *\n\t * @param {Token|Tile} [inTarget=false] inTarget\n\t * @returns {AnimationSection}\n\t */\n\tanimation(inTarget) {\n\t\tconst animation = lib.section_proxy_wrap(\n\t\t\tnew AnimationSection(this, inTarget)\n\t\t);\n\t\tthis.sections.push(animation);\n\t\treturn animation;\n\t}\n\n\t/**\n\t * Creates a scrolling text. Until you call .then(), .effect(), .sound(), or .wait(), you'll be working on the Scrolling Text section.\n\t *\n\t * @param {Object|String|Boolean} [inTarget=false] inTarget\n\t * @param {String|Boolean} [inText=false] inText\n\t * @param {Object} [inTextOptions={}] inTextOptions\n\t * @returns {AnimationSection}\n\t */\n\tscrollingText(inTarget = false, inText = false, inTextOptions = {}) {\n\t\tconst scrolling = lib.section_proxy_wrap(\n\t\t\tnew ScrollingTextSection(this, inTarget, inText, inTextOptions)\n\t\t);\n\t\tthis.sections.push(scrolling);\n\t\treturn scrolling;\n\t}\n\n\t/**\n\t * Pans the canvas text. Until you call any other sections you'll be working on the Canvas Pan section.\n\t *\n\t * @param {Object|String|Boolean} [inTarget=false] inTarget\n\t * @param {Boolean|Number} inDuration\n\t * @param {Boolean|Number} inSpeed\n\t * @returns {AnimationSection}\n\t */\n\tcanvasPan(inTarget = false, inDuration = null, inSpeed = null) {\n\t\tconst panning = lib.section_proxy_wrap(\n\t\t\tnew CanvasPanSection(this, inTarget)\n\t\t);\n\t\tthis.sections.push(panning);\n\t\treturn panning;\n\t}\n\n\t/**\n\t * Causes the sequence to wait after the last section for as many milliseconds as you pass to this method. If given\n\t * a second number, a random wait time between the two given numbers will be generated.\n\t *\n\t * @param {number} [msMin=1] minMs\n\t * @param {number} [msMax=1] maxMs\n\t * @returns {Sequence} this\n\t */\n\twait(msMin = 1, msMax = 1) {\n\t\tif (msMin < 1)\n\t\t\tthrow lib.custom_error(\n\t\t\t\tthis.moduleName,\n\t\t\t\t`wait - Wait ms cannot be less than 1`\n\t\t\t);\n\t\tif (msMax < 1)\n\t\t\tthrow lib.custom_error(\n\t\t\t\tthis.moduleName,\n\t\t\t\t`wait - Max wait ms cannot be less than 1`\n\t\t\t);\n\t\tconst section = lib.section_proxy_wrap(new WaitSection(this, msMin, msMax));\n\t\tthis.sections.push(section);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Applies a preset to the sequence\n\t *\n\t * @param {string} presetName\n\t * @param {*} args\n\t * @returns {Sequence|FunctionSection|EffectSection|AnimationSection|SoundSection}\n\t */\n\tpreset(presetName, ...args) {\n\t\tif (typeof presetName !== \"string\") {\n\t\t\tthrow this._customError(this, \"name\", `inName must be of type string`);\n\t\t}\n\t\tconst preset = SequencerPresets.get(presetName);\n\t\tif (!preset) {\n\t\t\tlib.custom_warning(\n\t\t\t\t\"Sequencer\",\n\t\t\t\t`preset | Could not find preset with name \"${presetName}\"`\n\t\t\t);\n\t\t\treturn this;\n\t\t}\n\t\tconst lastSection = this.sections[this.sections.length - 1] || this;\n\t\treturn preset(lastSection, ...args);\n\t}\n\n\t/**\n\t * Adds the sections from a given Sequence to this Sequence\n\t *\n\t * @param {Sequence|FunctionSection|EffectSection|AnimationSection|SoundSection} inSequence\n\t * @returns {Sequence} this\n\t */\n\taddSequence(inSequence) {\n\t\tif (inSequence instanceof Section) inSequence = inSequence.sequence;\n\t\tif (!(inSequence instanceof Sequence)) {\n\t\t\tthrow lib.custom_error(\n\t\t\t\tthis.moduleName,\n\t\t\t\t`addSequence - could not find the sequence from the given parameter`\n\t\t\t);\n\t\t}\n\t\tconst newSections = inSequence.sections.map((section) => {\n\t\t\tconst newSection = Object.assign(\n\t\t\t\tObject.create(Object.getPrototypeOf(section)),\n\t\t\t\tsection\n\t\t\t);\n\t\t\tnewSection.sequence = this;\n\t\t\treturn newSection;\n\t\t});\n\t\tthis.sections = this.sections.concat(newSections);\n\t\treturn this;\n\t}\n\n\tasync toJSON() {\n\t\tconst data = {\n\t\t\toptions: { moduleName: this.moduleName, softFail: this.softFail },\n\t\t\tsections: [],\n\t\t};\n\t\tfor (const section of this.sections) {\n\t\t\tconst sectionData = await section._serialize();\n\t\t\tif (!sectionData.type) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`Sequencer | toJson | ${section.constructor.name} does not support serialization!`\n\t\t\t\t);\n\t\t\t}\n\t\t\tdata.sections.push(sectionData);\n\t\t}\n\t\treturn data;\n\t}\n\n\tfromJSON(data) {\n\t\tthis.moduleName = data.options.moduleName;\n\t\tthis.softFail = data.options.softFail;\n\t\tthis.localOnly = true;\n\t\tfor (const section of data.sections) {\n\t\t\tthis[section.type]()._deserialize(section);\n\t\t}\n\t\treturn this;\n\t}\n\n\t_createCustomSection(...args) {\n\t\tconst func = lib.section_proxy_wrap(\n\t\t\tnew this.sectionToCreate(this, ...args)\n\t\t);\n\t\tthis.sectionToCreate = undefined;\n\t\tthis.sections.push(func);\n\t\treturn func;\n\t}\n\n\t_showWarning(self, func, warning, notify = false) {\n\t\tlib.custom_warning(\n\t\t\tthis.moduleName,\n\t\t\t`${self.constructor.name.replace(\"Section\", \"\")} | ${func} - ${warning}`,\n\t\t\tnotify\n\t\t);\n\t}\n\n\t_customError(self, func, error) {\n\t\treturn lib.custom_error(\n\t\t\tthis.moduleName,\n\t\t\t`${self.constructor.name.replace(\"Section\", \"\")} | ${func} - ${error}`\n\t\t);\n\t}\n\n\tset status(inStatus) {\n\t\tthis._status.update((currentStatus) => {\n\t\t\tif (\n\t\t\t\tcurrentStatus === CONSTANTS.STATUS.READY ||\n\t\t\t\tcurrentStatus === CONSTANTS.STATUS.RUNNING\n\t\t\t) {\n\t\t\t\treturn inStatus;\n\t\t\t}\n\t\t\treturn currentStatus;\n\t\t});\n\t}\n\n\tget status() {\n\t\treturn get(this._status);\n\t}\n\n\tget statusStore() {\n\t\treturn this._status;\n\t}\n\n\t_abort() {\n\t\tthis.status = CONSTANTS.STATUS.ABORTED;\n\t\tfor (const section of this.sections) {\n\t\t\tsection._abortSection();\n\t\t}\n\t}\n}\n","import Section from \"../sections/section.js\";\nimport * as lib from \"../lib/lib.js\";\n\nclass SequencerSectionManager {\n\n\t#sections = {};\n\n\tget externalSections(){\n\t\treturn this.#sections;\n\t}\n\n  /**\n   * Registers a class by a name that will then be available through the Sequencer\n   *\n   * @param {String}      inModuleName\n   * @param {String}      inMethodName\n   * @param {Class}       inClass\n   * @param {Boolean}     overwrite\n   * @returns {Boolean}               Whether the registration succeeded\n   */\n  registerSection(inModuleName, inMethodName, inClass, overwrite = false) {\n    if (!(inClass.prototype instanceof Section)) {\n      throw lib.custom_error(\n        inModuleName,\n        `inClass must be instance of Sequencer.BaseSection`\n      );\n    }\n\n    let coreMethods = Object.getOwnPropertyNames(Sequence.prototype).filter(\n      (method) => {\n        return !method.startsWith(\"_\") && method !== \"constructor\";\n      }\n    );\n\n    if (coreMethods.includes(inMethodName)) {\n      throw lib.custom_error(\n        inModuleName,\n        `${inMethodName} is an existing protected method of the Sequence class - please register with another method name!`\n      );\n    }\n\n    if (this.#sections[inMethodName] && !overwrite) {\n      throw lib.custom_error(\n        inModuleName,\n        `${inMethodName} is already a registered Section with the class ${this.#sections[inMethodName].constructor.name}`\n      );\n    }\n\n    coreMethods = coreMethods.concat(Object.keys(this.#sections));\n\n    const clashingMethods = Object.getOwnPropertyNames(\n      inClass.prototype\n    ).filter((method) => coreMethods.includes(method));\n\n    if (clashingMethods.length) {\n      let errors = clashingMethods.join(\", \");\n      throw lib.custom_error(\n        inModuleName,\n        `${inMethodName} cannot contain the following methods: ${errors}<br>These methods are existing methods on the Sequence or from already registered Sections. Please rename these methods to avoid conflicts.`\n      );\n    }\n\n    lib.debug(\n      `SectionManager | Successfully registered ${inMethodName} with Sequencer!`\n    );\n\n    this.#sections[inMethodName] = inClass;\n\n    return true;\n  }\n}\n\nconst sectionManager = new SequencerSectionManager();\n\nexport default sectionManager;\n","// SPDX-License-Identifier: MIT\n// Copyright  2021 fvtt-lib-wrapper Rui Pinheiro\n\n\"use strict\";\n\n// A shim for the libWrapper library\nexport let libWrapper = undefined;\n\nexport const VERSIONS = [1, 12, 2];\nexport const TGT_SPLIT_RE = new RegExp(\n  \"([^.[]+|\\\\[('([^'\\\\\\\\]|\\\\\\\\.)+?'|\\\"([^\\\"\\\\\\\\]|\\\\\\\\.)+?\\\")\\\\])\",\n  \"g\"\n);\nexport const TGT_CLEANUP_RE = new RegExp(\"(^\\\\['|'\\\\]$|^\\\\[\\\"|\\\"\\\\]$)\", \"g\");\n\n// Main shim code\nHooks.once(\"init\", () => {\n  // Check if the real module is already loaded - if so, use it\n  if (globalThis.libWrapper && !(globalThis.libWrapper.is_fallback ?? true)) {\n    libWrapper = globalThis.libWrapper;\n    return;\n  }\n\n  // Fallback implementation\n  libWrapper = class {\n    static get is_fallback() {\n      return true;\n    }\n\n    static get WRAPPER() {\n      return \"WRAPPER\";\n    }\n    static get MIXED() {\n      return \"MIXED\";\n    }\n    static get OVERRIDE() {\n      return \"OVERRIDE\";\n    }\n\n    static register(\n      package_id,\n      target,\n      fn,\n      type = \"MIXED\",\n      { chain = undefined, bind = [] } = {}\n    ) {\n      const is_setter = target.endsWith(\"#set\");\n      target = !is_setter ? target : target.slice(0, -4);\n      const split = target\n        .match(TGT_SPLIT_RE)\n        .map((x) => x.replace(/\\\\(.)/g, \"$1\").replace(TGT_CLEANUP_RE, \"\"));\n      const root_nm = split.splice(0, 1)[0];\n\n      let obj, fn_name;\n      if (split.length == 0) {\n        obj = globalThis;\n        fn_name = root_nm;\n      } else {\n        const _eval = eval;\n        fn_name = split.pop();\n        obj = split.reduce(\n          (x, y) => x[y],\n          globalThis[root_nm] ?? _eval(root_nm)\n        );\n      }\n\n      let iObj = obj;\n      let descriptor = null;\n      while (iObj) {\n        descriptor = Object.getOwnPropertyDescriptor(iObj, fn_name);\n        if (descriptor) break;\n        iObj = Object.getPrototypeOf(iObj);\n      }\n      if (!descriptor || descriptor?.configurable === false)\n        throw new Error(\n          `libWrapper Shim: '${target}' does not exist, could not be found, or has a non-configurable descriptor.`\n        );\n\n      let original = null;\n      const wrapper =\n        chain ?? (type.toUpperCase?.() != \"OVERRIDE\" && type != 3)\n          ? function (...args) {\n              return fn.call(this, original.bind(this), ...bind, ...args);\n            }\n          : function (...args) {\n              return fn.call(this, ...bind, ...args);\n            };\n      if (!is_setter) {\n        if (descriptor.value) {\n          original = descriptor.value;\n          descriptor.value = wrapper;\n        } else {\n          original = descriptor.get;\n          descriptor.get = wrapper;\n        }\n      } else {\n        if (!descriptor.set)\n          throw new Error(\n            `libWrapper Shim: '${target}' does not have a setter`\n          );\n        original = descriptor.set;\n        descriptor.set = wrapper;\n      }\n\n      descriptor.configurable = true;\n      Object.defineProperty(obj, fn_name, descriptor);\n    }\n  };\n});\n","import CONSTANTS from \"./constants.js\";\nimport { libWrapper } from \"./lib/libWrapper/shim.js\";\n\nexport default function registerLibwrappers() {\n  libWrapper.register(CONSTANTS.MODULE_NAME, \"PIXI.BaseImageResource.prototype.upload\", PIXIUPLOAD);\n}\n\nfunction PIXIUPLOAD(wrapped, ...args) {\n  let baseTexture = args[1];\n\n  if (\n    baseTexture.sequencer_patched ||\n    !game.settings.get(CONSTANTS.MODULE_NAME, \"enable-global-fix-pixi\")\n  ) {\n    return wrapped(...args);\n  }\n\n  let source = args[3];\n  source = source || this.source;\n  const isVideo = !!source.videoWidth;\n  if (isVideo) {\n    baseTexture.alphaMode = PIXI.ALPHA_MODES.PREMULTIPLIED_ALPHA;\n    baseTexture.sequencer_patched = true;\n  }\n  return wrapped(...args);\n}\n","import CONSTANTS from \"./constants.js\";\nimport { custom_warning, debug } from \"./lib/lib.js\";\n\nexport default async function runMigrations() {\n  const sortedMigrations = Object.entries(migrations).sort((a, b) => {\n    return foundry.utils.isNewerVersion(b[0], a[0]) ? -1 : 1;\n  });\n\n  for (const [version, migration] of sortedMigrations) {\n    try {\n      await migration(version);\n    } catch (err) {\n      custom_warning(\n        \"Sequencer\",\n        `Something went wrong when migrating to version ${version}. Please check the console for the error!`,\n        true\n      );\n      console.error(err);\n    }\n  }\n}\n\nfunction getSequencerEffectTokens(version, tokenFilter = false) {\n  return Array.from(game.scenes)\n    .map((scene) => [\n      scene,\n      Array.from(scene.tokens)\n        .filter((token) => token.isOwner)\n        .filter((token, index) => {\n          if (tokenFilter) {\n            return tokenFilter(token, index);\n          }\n          const effects = foundry.utils.getProperty(token, CONSTANTS.EFFECTS_FLAG) ?? [];\n          const effectsOutOfDate = effects.filter((e) =>\n            foundry.utils.isNewerVersion(version, e[1].flagVersion)\n          );\n          return effectsOutOfDate.length;\n        }),\n    ])\n    .filter(([_, tokens]) => tokens.length);\n}\n\nfunction getSequencerEffectActors(version, actorFilter = false) {\n  return Array.from(game.actors)\n    .filter((actor) => actor.isOwner)\n    .filter((actor, index) => {\n      if (actorFilter) {\n        return actorFilter(actor, index);\n      }\n      const effects = foundry.utils.getProperty(actor, CONSTANTS.EFFECTS_FLAG) ?? [];\n      const effectsOutOfDate = effects.filter((e) =>\n        foundry.utils.isNewerVersion(version, e[1].flagVersion)\n      );\n      return effectsOutOfDate.length;\n    });\n}\n\nconst migrations = {\n  \"3.0.0\": async (version) => {\n    const actorsToUpdate = getSequencerEffectActors(version, (actor) => {\n      const effects =\n        foundry.utils.getProperty(actor, \"prototypeToken.\" + CONSTANTS.EFFECTS_FLAG) ?? [];\n      const effectsOutOfDate = effects.filter((e) =>\n        foundry.utils.isNewerVersion(version, e[1].flagVersion)\n      );\n      return effectsOutOfDate.length;\n    });\n\n    const actorUpdateArray = actorsToUpdate.map((actor) => {\n      const effectsToMoveFromTokenPrototype = foundry.utils.getProperty(\n        actor.prototypeToken,\n        CONSTANTS.EFFECTS_FLAG\n      )\n        .filter(([_, effect]) => {\n          return effect.persistOptions?.persistTokenPrototype;\n        })\n        .map(([id, effect]) => {\n          effect.flagVersion = version;\n          return [id, effect];\n        });\n\n      const effectsToKeepOnTokenPrototype = foundry.utils.getProperty(\n        actor.prototypeToken,\n        CONSTANTS.EFFECTS_FLAG\n      )\n        .filter(([_, effect]) => {\n          return !effect.persistOptions?.persistTokenPrototype;\n        })\n        .map(([id, effect]) => {\n          effect.flagVersion = version;\n          return [id, effect];\n        });\n\n      return {\n        _id: actor.id,\n        [CONSTANTS.EFFECTS_FLAG]: effectsToMoveFromTokenPrototype,\n        [\"prototypeToken.\" + CONSTANTS.EFFECTS_FLAG]:\n          effectsToKeepOnTokenPrototype,\n      };\n    });\n\n    const tokensOnScenes = getSequencerEffectTokens(version, (t) => {\n      let actor;\n      try {\n        actor = t.actor;\n      } catch (err) {\n        return false;\n      }\n      const effects = foundry.utils.getProperty(t, CONSTANTS.EFFECTS_FLAG) ?? [];\n      const prototypeTokenEffects =\n        foundry.utils.getProperty(actor, \"prototypeToken.\" + CONSTANTS.EFFECTS_FLAG) ?? [];\n      const effectsOutOfDate = effects.filter((e) =>\n        foundry.utils.isNewerVersion(version, e[1].flagVersion)\n      );\n      const prototypeEffectsOutOfDate = prototypeTokenEffects.filter((e) =>\n        foundry.utils.isNewerVersion(version, e[1].flagVersion)\n      );\n      return (\n        t.actorLink &&\n        (effectsOutOfDate.length || prototypeEffectsOutOfDate.length)\n      );\n    });\n\n    for (const [scene, tokens] of tokensOnScenes) {\n      const updates = [];\n      for (const token of tokens) {\n        const effectsToKeepOnToken = foundry.utils.getProperty(token, CONSTANTS.EFFECTS_FLAG)\n          .filter(([_, effect]) => {\n            return !effect.persistOptions?.persistTokenPrototype;\n          })\n          .map(([id, effect]) => {\n            effect.flagVersion = version;\n            return [id, effect];\n          });\n\n        updates.push({\n          _id: token.id,\n          [CONSTANTS.EFFECTS_FLAG]: effectsToKeepOnToken,\n        });\n      }\n\n      if (updates.length) {\n        debug(\n          `Sequencer | Updated ${updates.length} tokens' effects on scene ${scene.id} to version ${version}`\n        );\n        await scene.updateEmbeddedDocuments(\"Token\", updates);\n      }\n    }\n\n    if (actorUpdateArray.length) {\n      debug(\n        `Sequencer | Updated ${actorUpdateArray.length} actors' effects to version ${version}`\n      );\n      await Actor.updateDocuments(actorUpdateArray);\n    }\n  },\n};\n","import \"./styles/module.scss\";\n\nimport { registerSettings, migrateSettings } from \"./settings.js\";\nimport registerLayers from \"./layers.js\";\nimport registerHotkeys from \"./hotkeys.js\";\nimport registerTypes from \"../typings/typings.js\";\nimport { registerSocket } from \"./sockets.js\";\nimport { EASE, easeFunctions, registerEase } from \"./canvas-effects/ease.js\";\n\nimport Sequence from \"./modules/sequencer.js\";\nimport SequencerDatabase from \"./modules/sequencer-database.js\";\nimport SequencerPreloader from \"./modules/sequencer-preloader.js\";\nimport SequencerEffectManager from \"./modules/sequencer-effect-manager.js\";\nimport SequencerSectionManager from \"./modules/sequencer-section-manager.js\";\nimport {\n  EffectPlayer,\n  InteractionManager,\n} from \"./modules/sequencer-interaction-manager.js\";\nimport Section from \"./sections/section.js\";\nimport * as lib from \"./lib/lib.js\";\nimport { SequencerAboveUILayer } from \"./canvas-effects/effects-layer.js\";\nimport SequencerPresets from \"./modules/sequencer-presets.js\";\nimport registerLibwrappers from \"./libwrapper.js\";\nimport { DatabaseViewerApp } from \"./formapplications/database/database-viewer-app.js\";\nimport CONSTANTS from \"./constants.js\";\nimport { PlayerSettings } from \"./formapplications/effects-ui/effect-player-store.js\";\nimport runMigrations from \"./migrations.js\";\nimport SequencerFoundryReplicator from \"./modules/sequencer-foundry-replicator.js\";\n\nimport SequencerSoundManager from \"./modules/sequencer-sound-manager.js\";\n\nlet moduleValid = false;\nlet moduleReady = false;\nlet canvasReady = false;\n\nHooks.once(\"init\", async function() {\n  // CONFIG.debug.hooks = true;\n  if (!game.modules.get(\"socketlib\")?.active) return;\n  moduleValid = true;\n  CONSTANTS.INTEGRATIONS.ISOMETRIC.ACTIVE = !!game.modules.get(\n    CONSTANTS.INTEGRATIONS.ISOMETRIC.MODULE_NAME,\n  )?.active;\n\tCONSTANTS.IS_V12 = foundry.utils.isNewerVersion(game.version, \"12\");\n  initializeModule();\n  registerSocket();\n});\n\nHooks.once(\"socketlib.ready\", registerSocket);\n\nHooks.once(\"ready\", async function() {\n  if (!game.modules.get(\"socketlib\")?.active) {\n    ui.notifications.error(\n      \"Sequencer requires the SocketLib module to be active and will not work without it!\",\n      { console: true },\n    );\n    return;\n  }\n\n  for (const [name, func] of Object.entries(easeFunctions)) {\n    if (!CanvasAnimation[name]) {\n      CanvasAnimation[name] = func;\n    }\n  }\n\n  if (game.user.isGM) {\n    await runMigrations();\n    await migrateSettings();\n    await PlayerSettings.migrateOldPresets();\n  }\n\n  SequencerFoundryReplicator.registerHooks();\n  InteractionManager.initialize();\n});\n\nHooks.on(\"canvasTearDown\", () => {\n  canvasReady = false;\n  SequencerEffectManager.tearDownPersists();\n});\n\nconst setupModule = foundry.utils.debounce(() => {\n  if (!moduleValid) return;\n  if (!moduleReady) {\n    moduleReady = true;\n    lib.debug(\"Ready to go!\");\n    Hooks.callAll(\"sequencer.ready\");\n    Hooks.callAll(\"sequencerReady\");\n  }\n  if (!canvasReady) {\n    canvasReady = true;\n    SequencerEffectManager.initializePersistentEffects();\n  }\n}, 25);\n\nHooks.on(\"canvasReady\", () => {\n  setTimeout(() => {\n    setupModule();\n  }, 450);\n});\n\nHooks.on(\"refreshToken\", setupModule);\nHooks.on(\"refreshDrawing\", setupModule);\nHooks.on(\"refreshTile\", setupModule);\nHooks.on(\"refreshMeasuredTemplate\", setupModule);\n\n/**\n * Creation & delete hooks for persistent effects\n */\nfunction initializeModule() {\n  window.Sequence = Sequence;\n  window.Sequencer = {\n    Player: EffectPlayer,\n    Presets: SequencerPresets,\n    Database: SequencerDatabase,\n    DatabaseViewer: DatabaseViewerApp,\n    Preloader: SequencerPreloader,\n    EffectManager: SequencerEffectManager,\n    SoundManager: SequencerSoundManager,\n    SectionManager: SequencerSectionManager,\n    registerEase: registerEase,\n    BaseSection: Section,\n    CONSTANTS: {\n      EASE,\n    },\n    Helpers: {\n      wait: lib.wait,\n      clamp: lib.clamp,\n      interpolate: lib.interpolate,\n      random_float_between: lib.random_float_between,\n      random_int_between: lib.random_int_between,\n      shuffle_array: lib.shuffle_array,\n      random_array_element: lib.random_array_element,\n      random_object_element: lib.random_object_element,\n      make_array_unique: lib.make_array_unique,\n    },\n  };\n\n  registerSettings();\n  registerLayers();\n  registerHotkeys();\n  registerLibwrappers();\n\n  SequencerAboveUILayer.setup();\n  SequencerEffectManager.setup();\n\n}\n\nHooks.once(\"ready\", async () => {\n\n\tif(!game.user.isGM || game.settings.get(CONSTANTS.MODULE_NAME, \"welcome-shown\")) return;\n\tawait game.settings.set(CONSTANTS.MODULE_NAME, \"welcome-shown\", true);\n\n\tconst chatMessages = game.messages.filter(message => {\n\t\treturn message.content.includes(\"sequencer-welcome\")\n\t}).map(message => message.id);\n\n\tif(chatMessages.length){\n\t\treturn ChatMessage.deleteDocuments(chatMessages.slice(0, -1))\n\t}\n\n\tawait ChatMessage.create({\n\t\tcontent: `\n<div class=\"sequencer-welcome\">\n<img src=\"modules/sequencer/images/sequencer.png\"/>\n<div class=\"sequencer-divider\"></div>\n<p>Sequencer remains open, free, and regularly updated with the support of the Foundry community.</p>\n<p>Please consider supporting us if you enjoy Foundry & visual effects!</p>\n<div class=\"sequencer-divider\"></div>\n<p><a target=\"_blank\" href=\"https://fantasycomputer.works/\">Website</a> | <a target=\"_blank\" href=\"https://fantasycomputer.works/FoundryVTT-Sequencer/#/\">Docs</a> | <a target=\"_blank\" href=\"https://discord.gg/qFHQUwBZAz\">Discord</a> | <a target=\"_blank\" href=\"https://ko-fi.com/fantasycomputerworks\">Donate</a></p>\n</div>`,\n\t});\n\n});\n\nHooks.once(\"monaco-editor.ready\", registerTypes);\n"],"names":["lib.custom_error","lib.is_function","lib.debug","is_function","wait","clamp","layer","document","hash","src","now","name","text","element","animation","detach","linear","create_each_block","insert","update","instance","create_fragment","subscribe","run","get","debug","scale","interpolate","duration","ease","options","width","parent","rotation","active","children","promise","writable","draggable","ctx","create_if_block","booleanStore","dragDefault","TJSHeaderButton","storeResizing","lib.get_object_identifier","attr","lib.deep_get","lib.deep_set","lib.interpolate","lib.clamp","lib.wait","create_if_block_1","canvaslib.get_mouse_position","canvaslib.distance_between","canvaslib.get_closest_token","canvaslib.get_object_position","SequencerFileCache","effect","create_if_block_2","users","EffectsUIShell","lib.user_can_do","lib.custom_warning","filters","lib.make_array_unique","lib.str_to_search_regex_str","lib.safe_str","lib\n        .get_all_documents_from_scene","lib.get_object_from_scene","flagManager","lib.get_all_documents_from_scene","lib.is_UUID","lib.group_by","canvaslib.rotate_coordinate","child","time","offset","lib.throttled_custom_warning","canvaslib.is_object_canvas_data","canvaslib.get_object_dimensions","canvaslib.calculate_missed_position","canvaslib.get_random_offset","canvaslib.rotateAroundPoint","obj","multiplier","lib.get_hash","lib.createMersenneTwister","reject","canvaslib.validateAnimation","canvaslib.validateLoopingAnimation","canvaslib.is_position_within_bounds","func","spriteType","sprite","filter","lib.random_float_between","canvaslib.createShape","canvaslib.get_object_elevation","lib.is_real_number","shape","scaleX","scaleY","lib.debug_error","canvaslib.align","moves","angle","x","y","align","lib.getCanvasMouse","lib.flip_negate","lib\n      .make_array_unique","inSrcs","FlagManager","location","audio","lib.getFiles","lib.random_array_element","files","module","lib\n        .str_to_search_regex_str","lib.flatten_object","key","resizeObserver","dispatch","keeps","data","selectedPackStore","packStore","visibleTreeStore","cleanSearchStore","entriesStore","DatabaseShell","lib.random_int_between","lib.validate_document","lib.parseColor","canvaslib.get_object_canvas_data","canvaslib.alignments","originLocation","timespan","Sequence","lib.sequence_proxy_wrap","lib.section_proxy_wrap","bind","SequencerSectionManager"],"mappings":"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","x_google_ignoreList":[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,94,95,96]}